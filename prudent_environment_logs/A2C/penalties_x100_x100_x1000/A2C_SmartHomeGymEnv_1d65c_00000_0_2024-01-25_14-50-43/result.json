{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -930987392.0, "policy_entropy": 4295.3291015625, "var_gnorm": 22.627458572387695, "vf_loss": 8731197702144.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": 2.980232238769531e-07, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -1011863.0442888482, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -1011863.0442888482, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15671246129610417, "mean_inference_ms": 5.216012015187068, "mean_action_processing_ms": 0.14747073459342255, "mean_env_wait_ms": 0.2614192509863426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.06220340728759765}}, "episode_reward_max": -1011863.0442888482, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -1011863.0442888482, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15671246129610417, "mean_inference_ms": 5.216012015187068, "mean_action_processing_ms": 0.14747073459342255, "mean_env_wait_ms": 0.2614192509863426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.06220340728759765}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2007.294, "learn_time_ms": 55.168, "learn_throughput": 6090.497, "synch_weights_time_ms": 0.202}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-50-51", "timestamp": 1706194251, "time_this_iter_s": 2.007533311843872, "time_total_s": 2.007533311843872, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2fb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7839f793f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.007533311843872, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 8.733333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -739087168.0, "policy_entropy": 4258.30419921875, "var_gnorm": 22.629030227661133, "vf_loss": 5567434194944.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -2.9802322387695312e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -916241.5943190804, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15649517441517458, "mean_inference_ms": 5.222668700894957, "mean_action_processing_ms": 0.1476164315657332, "mean_env_wait_ms": 0.2608557031182816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01506805419921875, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.061762332916259766}}, "episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -916241.5943190804, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15649517441517458, "mean_inference_ms": 5.222668700894957, "mean_action_processing_ms": 0.1476164315657332, "mean_env_wait_ms": 0.2608557031182816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01506805419921875, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.061762332916259766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 1990.234, "learn_time_ms": 37.233, "learn_throughput": 9024.369, "synch_weights_time_ms": 0.175}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-50-53", "timestamp": 1706194253, "time_this_iter_s": 1.9734272956848145, "time_total_s": 3.9809606075286865, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2bc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236dfb50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 3.9809606075286865, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 8.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -810746368.0, "policy_entropy": 4099.08935546875, "var_gnorm": 22.630502700805664, "vf_loss": 7116101255168.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.602836608886719e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -915417.8082734788, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564301286713356, "mean_inference_ms": 5.227145144416283, "mean_action_processing_ms": 0.14774178262765358, "mean_env_wait_ms": 0.26101598057258985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01609325408935547, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.06155172983805338}}, "episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -915417.8082734788, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564301286713356, "mean_inference_ms": 5.227145144416283, "mean_action_processing_ms": 0.14774178262765358, "mean_env_wait_ms": 0.26101598057258985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01609325408935547, "StateBufferConnector_ms": 0.0024318695068359375, "ViewRequirementAgentConnector_ms": 0.06155172983805338}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 1985.929, "learn_time_ms": 31.273, "learn_throughput": 10744.103, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-50-55", "timestamp": 1706194255, "time_this_iter_s": 1.9775586128234863, "time_total_s": 5.958519220352173, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f30d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823723d90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 5.958519220352173, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 8.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -693822720.0, "policy_entropy": 3661.790771484375, "var_gnorm": 22.633474349975586, "vf_loss": 6703706275840.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -8.940696716308594e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -904260.9340665509, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15604186238103748, "mean_inference_ms": 5.2279069700115395, "mean_action_processing_ms": 0.14755714283617333, "mean_env_wait_ms": 0.2604794678863729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015562772750854492, "StateBufferConnector_ms": 0.0024080276489257812, "ViewRequirementAgentConnector_ms": 0.0609278678894043}}, "episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -904260.9340665509, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15604186238103748, "mean_inference_ms": 5.2279069700115395, "mean_action_processing_ms": 0.14755714283617333, "mean_env_wait_ms": 0.2604794678863729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015562772750854492, "StateBufferConnector_ms": 0.0024080276489257812, "ViewRequirementAgentConnector_ms": 0.0609278678894043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 1978.606, "learn_time_ms": 28.125, "learn_throughput": 11946.621, "synch_weights_time_ms": 0.166}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-50-57", "timestamp": 1706194257, "time_this_iter_s": 1.9568865299224854, "time_total_s": 7.915405750274658, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea6b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352a440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.915405750274658, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 9.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -615263296.0, "policy_entropy": 3233.07177734375, "var_gnorm": 22.637317657470703, "vf_loss": 6660550033408.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.1920928955078125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -899678.3738101985, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1556492827260935, "mean_inference_ms": 5.227044388160884, "mean_action_processing_ms": 0.14728916421814986, "mean_env_wait_ms": 0.25990496408142155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015096664428710938, "StateBufferConnector_ms": 0.0023984909057617188, "ViewRequirementAgentConnector_ms": 0.060400962829589844}}, "episode_reward_max": -820620.1443493125, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -899678.3738101985, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1556492827260935, "mean_inference_ms": 5.227044388160884, "mean_action_processing_ms": 0.14728916421814986, "mean_env_wait_ms": 0.25990496408142155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015096664428710938, "StateBufferConnector_ms": 0.0023984909057617188, "ViewRequirementAgentConnector_ms": 0.060400962829589844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1973.223, "learn_time_ms": 26.251, "learn_throughput": 12799.637, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-50-59", "timestamp": 1706194259, "time_this_iter_s": 1.9519445896148682, "time_total_s": 9.867350339889526, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352b010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.867350339889526, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 9.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -538562880.0, "policy_entropy": 2890.68310546875, "var_gnorm": 22.638648986816406, "vf_loss": 4867333029888.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.811981201171875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -758279.7272651849, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -876111.9327193629, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553183867136704, "mean_inference_ms": 5.225712593344691, "mean_action_processing_ms": 0.1470416390561435, "mean_env_wait_ms": 0.2594169584006851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014921029408772787, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.060470898946126304}}, "episode_reward_max": -758279.7272651849, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -876111.9327193629, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553183867136704, "mean_inference_ms": 5.225712593344691, "mean_action_processing_ms": 0.1470416390561435, "mean_env_wait_ms": 0.2594169584006851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014921029408772787, "StateBufferConnector_ms": 0.0023762385050455728, "ViewRequirementAgentConnector_ms": 0.060470898946126304}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1969.812, "learn_time_ms": 25.075, "learn_throughput": 13400.014, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-00", "timestamp": 1706194260, "time_this_iter_s": 1.953010082244873, "time_total_s": 11.8203604221344, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.8203604221344, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 9.233333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2235878912.0, "policy_entropy": 2533.349853515625, "var_gnorm": 22.641498565673828, "vf_loss": 4639898468352.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -2.3603439331054688e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -744954.7440784589, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -857375.191484948, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15506985290089728, "mean_inference_ms": 5.225251538631945, "mean_action_processing_ms": 0.14686379930836835, "mean_env_wait_ms": 0.25907107488655745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01480238778250558, "StateBufferConnector_ms": 0.002356937953404018, "ViewRequirementAgentConnector_ms": 0.06041526794433594}}, "episode_reward_max": -744954.7440784589, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -857375.191484948, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15506985290089728, "mean_inference_ms": 5.225251538631945, "mean_action_processing_ms": 0.14686379930836835, "mean_env_wait_ms": 0.25907107488655745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01480238778250558, "StateBufferConnector_ms": 0.002356937953404018, "ViewRequirementAgentConnector_ms": 0.06041526794433594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1969.928, "learn_time_ms": 24.217, "learn_throughput": 13874.555, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-02", "timestamp": 1706194262, "time_this_iter_s": 1.9708893299102783, "time_total_s": 13.791249752044678, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2f20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352b5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.791249752044678, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 9.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -229357387776.0, "policy_entropy": 2164.25341796875, "var_gnorm": 22.645421981811523, "vf_loss": 4470591193088.0}, "grad_gnorm": 40.0, "vf_explained_var": -2.6941299438476562e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -717262.044544897, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -839861.0481174416, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487755343822113, "mean_inference_ms": 5.225186314527106, "mean_action_processing_ms": 0.1467303047340343, "mean_env_wait_ms": 0.25879544128593646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674663543701172, "StateBufferConnector_ms": 0.002339482307434082, "ViewRequirementAgentConnector_ms": 0.06015598773956299}}, "episode_reward_max": -717262.044544897, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -839861.0481174416, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487755343822113, "mean_inference_ms": 5.225186314527106, "mean_action_processing_ms": 0.1467303047340343, "mean_env_wait_ms": 0.25879544128593646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674663543701172, "StateBufferConnector_ms": 0.002339482307434082, "ViewRequirementAgentConnector_ms": 0.06015598773956299}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1969.858, "learn_time_ms": 23.565, "learn_throughput": 14258.329, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-04", "timestamp": 1706194264, "time_this_iter_s": 1.9696450233459473, "time_total_s": 15.760894775390625, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce39b10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236383a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.760894775390625, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 9.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -412469231616.0, "policy_entropy": 1880.2928466796875, "var_gnorm": 22.647817611694336, "vf_loss": 4355163422720.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -2.8014183044433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -717262.044544897, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -826258.0734098303, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15471091251957145, "mean_inference_ms": 5.224651187850704, "mean_action_processing_ms": 0.14660462552347991, "mean_env_wait_ms": 0.2585700104324642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014564726087782118, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.059949027167426214}}, "episode_reward_max": -717262.044544897, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -826258.0734098303, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15471091251957145, "mean_inference_ms": 5.224651187850704, "mean_action_processing_ms": 0.14660462552347991, "mean_env_wait_ms": 0.2585700104324642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014564726087782118, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.059949027167426214}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1967.628, "learn_time_ms": 23.049, "learn_throughput": 14577.867, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-06", "timestamp": 1706194266, "time_this_iter_s": 1.9500553607940674, "time_total_s": 17.710950136184692, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2200>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823529f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.710950136184692, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1399437131776.0, "policy_entropy": 1679.507080078125, "var_gnorm": 22.649065017700195, "vf_loss": 3904829390848.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -3.325939178466797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -809431.9217692127, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15458789847814022, "mean_inference_ms": 5.22458364865486, "mean_action_processing_ms": 0.14650784944072553, "mean_env_wait_ms": 0.25839837990739223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01466989517211914, "StateBufferConnector_ms": 0.0023317337036132812, "ViewRequirementAgentConnector_ms": 0.06008148193359375}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -809431.9217692127, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15458789847814022, "mean_inference_ms": 5.22458364865486, "mean_action_processing_ms": 0.14650784944072553, "mean_env_wait_ms": 0.25839837990739223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01466989517211914, "StateBufferConnector_ms": 0.0023317337036132812, "ViewRequirementAgentConnector_ms": 0.06008148193359375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1968.463, "learn_time_ms": 22.666, "learn_throughput": 14824.198, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-08", "timestamp": 1706194268, "time_this_iter_s": 1.9762392044067383, "time_total_s": 19.68718934059143, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea0b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236dec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.68718934059143, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -32646973358080.0, "policy_entropy": 1466.3121337890625, "var_gnorm": 22.65044593811035, "vf_loss": 4104981053440.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -3.170967102050781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -798619.843402313, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544914288256333, "mean_inference_ms": 5.224822042150402, "mean_action_processing_ms": 0.1464300642422016, "mean_env_wait_ms": 0.2582465849934945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514391465620561, "StateBufferConnector_ms": 0.0023343346335671163, "ViewRequirementAgentConnector_ms": 0.060057640075683594}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -798619.843402313, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544914288256333, "mean_inference_ms": 5.224822042150402, "mean_action_processing_ms": 0.1464300642422016, "mean_env_wait_ms": 0.2582465849934945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514391465620561, "StateBufferConnector_ms": 0.0023343346335671163, "ViewRequirementAgentConnector_ms": 0.060057640075683594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1965.417, "learn_time_ms": 19.145, "learn_throughput": 17549.914, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-10", "timestamp": 1706194270, "time_this_iter_s": 1.977104902267456, "time_total_s": 21.664294242858887, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823638d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.664294242858887, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -38166895525888.0, "policy_entropy": 1319.15869140625, "var_gnorm": 22.65088653564453, "vf_loss": 4789290663936.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2782554626464844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -793223.8386708698, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15438301062154722, "mean_inference_ms": 5.224500647056038, "mean_action_processing_ms": 0.1463416671921039, "mean_env_wait_ms": 0.2580891409806574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503427823384603, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.0599980354309082}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -793223.8386708698, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15438301062154722, "mean_inference_ms": 5.224500647056038, "mean_action_processing_ms": 0.1463416671921039, "mean_env_wait_ms": 0.2580891409806574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503427823384603, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.0599980354309082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1961.681, "learn_time_ms": 19.096, "learn_throughput": 17594.897, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-12", "timestamp": 1706194272, "time_this_iter_s": 1.9360942840576172, "time_total_s": 23.600388526916504, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb3a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352ab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.600388526916504, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 9.766666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -192415642157056.0, "policy_entropy": 1194.758056640625, "var_gnorm": 22.651500701904297, "vf_loss": 4312827691008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -786995.8760677682, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15429252674778796, "mean_inference_ms": 5.224209131492996, "mean_action_processing_ms": 0.14626514467328702, "mean_env_wait_ms": 0.25796023972325455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149690187894381, "StateBufferConnector_ms": 0.0023236641517052283, "ViewRequirementAgentConnector_ms": 0.06009615384615385}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -786995.8760677682, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15429252674778796, "mean_inference_ms": 5.224209131492996, "mean_action_processing_ms": 0.14626514467328702, "mean_env_wait_ms": 0.25796023972325455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149690187894381, "StateBufferConnector_ms": 0.0023236641517052283, "ViewRequirementAgentConnector_ms": 0.06009615384615385}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1960.172, "learn_time_ms": 19.095, "learn_throughput": 17596.215, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-14", "timestamp": 1706194274, "time_this_iter_s": 1.9625134468078613, "time_total_s": 25.562901973724365, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce73cd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823638ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.562901973724365, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1111224473354240.0, "policy_entropy": 1087.1273193359375, "var_gnorm": 22.652231216430664, "vf_loss": 3986792120320.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -779377.5806365928, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421205502734003, "mean_inference_ms": 5.223960760958074, "mean_action_processing_ms": 0.14619215802179783, "mean_env_wait_ms": 0.25783017167347577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014860289437430245, "StateBufferConnector_ms": 0.002316066196986607, "ViewRequirementAgentConnector_ms": 0.060045719146728516}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -779377.5806365928, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421205502734003, "mean_inference_ms": 5.223960760958074, "mean_action_processing_ms": 0.14619215802179783, "mean_env_wait_ms": 0.25783017167347577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014860289437430245, "StateBufferConnector_ms": 0.002316066196986607, "ViewRequirementAgentConnector_ms": 0.060045719146728516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1960.618, "learn_time_ms": 19.156, "learn_throughput": 17539.997, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-16", "timestamp": 1706194276, "time_this_iter_s": 1.9613568782806396, "time_total_s": 27.524258852005005, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823639630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.524258852005005, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 9.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -19651075506176.0, "policy_entropy": 989.5528564453125, "var_gnorm": 22.65303611755371, "vf_loss": 4244399980544.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -774398.6336226814, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541477310471837, "mean_inference_ms": 5.224021004451182, "mean_action_processing_ms": 0.1461295984424821, "mean_env_wait_ms": 0.2577156912010436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015187263488769531, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.06007035573323568}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -774398.6336226814, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541477310471837, "mean_inference_ms": 5.224021004451182, "mean_action_processing_ms": 0.1461295984424821, "mean_env_wait_ms": 0.2577156912010436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015187263488769531, "StateBufferConnector_ms": 0.0023285547892252603, "ViewRequirementAgentConnector_ms": 0.06007035573323568}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1963.835, "learn_time_ms": 19.191, "learn_throughput": 17508.096, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-18", "timestamp": 1706194278, "time_this_iter_s": 1.9841399192810059, "time_total_s": 29.50839877128601, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2aa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352b0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.50839877128601, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 10.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1092937240805376.0, "policy_entropy": 906.8074951171875, "var_gnorm": 22.65388298034668, "vf_loss": 4570915799040.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.218650817871094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -771372.1255569913, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408996728929525, "mean_inference_ms": 5.224093254955727, "mean_action_processing_ms": 0.14607483908618507, "mean_env_wait_ms": 0.2576094005526681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015132129192352295, "StateBufferConnector_ms": 0.0023230910301208496, "ViewRequirementAgentConnector_ms": 0.06003379821777344}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -771372.1255569913, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408996728929525, "mean_inference_ms": 5.224093254955727, "mean_action_processing_ms": 0.14607483908618507, "mean_env_wait_ms": 0.2576094005526681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015132129192352295, "StateBufferConnector_ms": 0.0023230910301208496, "ViewRequirementAgentConnector_ms": 0.06003379821777344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1965.035, "learn_time_ms": 19.152, "learn_throughput": 17544.015, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-20", "timestamp": 1706194280, "time_this_iter_s": 1.9650530815124512, "time_total_s": 31.473451852798462, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce8640>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823639240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.473451852798462, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -137788439658496.0, "policy_entropy": 837.5367431640625, "var_gnorm": 22.65474510192871, "vf_loss": 4014602452992.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -766666.7330541044, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15403834438214392, "mean_inference_ms": 5.2240091624534175, "mean_action_processing_ms": 0.14602537639042276, "mean_env_wait_ms": 0.25751166862049746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015038602492388557, "StateBufferConnector_ms": 0.0023070503683651194, "ViewRequirementAgentConnector_ms": 0.05996227264404297}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -766666.7330541044, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15403834438214392, "mean_inference_ms": 5.2240091624534175, "mean_action_processing_ms": 0.14602537639042276, "mean_env_wait_ms": 0.25751166862049746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015038602492388557, "StateBufferConnector_ms": 0.0023070503683651194, "ViewRequirementAgentConnector_ms": 0.05996227264404297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1962.861, "learn_time_ms": 19.122, "learn_throughput": 17570.963, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-22", "timestamp": 1706194282, "time_this_iter_s": 1.9491510391235352, "time_total_s": 33.422602891922, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823639ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.422602891922, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3135544632541184.0, "policy_entropy": 773.1337890625, "var_gnorm": 22.65561294555664, "vf_loss": 4271540011008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.552436828613281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -762805.9123455717, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539951592617102, "mean_inference_ms": 5.224062371649395, "mean_action_processing_ms": 0.1459835418193349, "mean_env_wait_ms": 0.2574340277503206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503096686469184, "StateBufferConnector_ms": 0.0023100111219618055, "ViewRequirementAgentConnector_ms": 0.06006028917100695}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -762805.9123455717, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539951592617102, "mean_inference_ms": 5.224062371649395, "mean_action_processing_ms": 0.1459835418193349, "mean_env_wait_ms": 0.2574340277503206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503096686469184, "StateBufferConnector_ms": 0.0023100111219618055, "ViewRequirementAgentConnector_ms": 0.06006028917100695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1963.82, "learn_time_ms": 19.157, "learn_throughput": 17539.517, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-24", "timestamp": 1706194284, "time_this_iter_s": 1.9792513847351074, "time_total_s": 35.401854276657104, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823529fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.401854276657104, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 10.266666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -318876961210368.0, "policy_entropy": 719.4649658203125, "var_gnorm": 22.656463623046875, "vf_loss": 4075971411968.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6597251892089844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759052.3591798132, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153953749636219, "mean_inference_ms": 5.224094958230514, "mean_action_processing_ms": 0.14594555016046704, "mean_env_wait_ms": 0.25736282602745025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266318070261102, "StateBufferConnector_ms": 0.002307640878777755, "ViewRequirementAgentConnector_ms": 0.06001372086374383}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759052.3591798132, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153953749636219, "mean_inference_ms": 5.224094958230514, "mean_action_processing_ms": 0.14594555016046704, "mean_env_wait_ms": 0.25736282602745025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015266318070261102, "StateBufferConnector_ms": 0.002307640878777755, "ViewRequirementAgentConnector_ms": 0.06001372086374383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1965.026, "learn_time_ms": 19.19, "learn_throughput": 17509.336, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-26", "timestamp": 1706194286, "time_this_iter_s": 1.9621481895446777, "time_total_s": 37.36400246620178, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce98d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236384c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.36400246620178, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 10.350000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -204753724243968.0, "policy_entropy": 670.4654541015625, "var_gnorm": 22.657291412353516, "vf_loss": 4433558634496.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757375.8909487155, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539131492111417, "mean_inference_ms": 5.2240769868512364, "mean_action_processing_ms": 0.14590755967568292, "mean_env_wait_ms": 0.2572909532516462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.06003975868225098}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757375.8909487155, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539131492111417, "mean_inference_ms": 5.2240769868512364, "mean_action_processing_ms": 0.14590755967568292, "mean_env_wait_ms": 0.2572909532516462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.06003975868225098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1962.993, "learn_time_ms": 19.178, "learn_throughput": 17520.502, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-28", "timestamp": 1706194288, "time_this_iter_s": 1.9559473991394043, "time_total_s": 39.31994986534119, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea800>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.31994986534119, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -917178119356416.0, "policy_entropy": 624.923583984375, "var_gnorm": 22.6580867767334, "vf_loss": 4492445089792.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7670135498046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755923.6170697674, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387748126538542, "mean_inference_ms": 5.224142953982353, "mean_action_processing_ms": 0.14587422620784912, "mean_env_wait_ms": 0.25722752130027216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015139579772949219, "StateBufferConnector_ms": 0.0023035776047479538, "ViewRequirementAgentConnector_ms": 0.06008829389299665}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755923.6170697674, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387748126538542, "mean_inference_ms": 5.224142953982353, "mean_action_processing_ms": 0.14587422620784912, "mean_env_wait_ms": 0.25722752130027216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015139579772949219, "StateBufferConnector_ms": 0.0023035776047479538, "ViewRequirementAgentConnector_ms": 0.06008829389299665}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1962.95, "learn_time_ms": 19.094, "learn_throughput": 17596.918, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-30", "timestamp": 1706194290, "time_this_iter_s": 1.9766957759857178, "time_total_s": 41.296645641326904, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce8640>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823529f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.296645641326904, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 10.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -777795894509568.0, "policy_entropy": 589.7662353515625, "var_gnorm": 22.658849716186523, "vf_loss": 4808689844224.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.159046173095703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755535.233013953, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384946656518703, "mean_inference_ms": 5.224191703405175, "mean_action_processing_ms": 0.1458444361143673, "mean_env_wait_ms": 0.257165935693375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015097314661199396, "StateBufferConnector_ms": 0.0023029067299582743, "ViewRequirementAgentConnector_ms": 0.060155174948952415}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755535.233013953, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384946656518703, "mean_inference_ms": 5.224191703405175, "mean_action_processing_ms": 0.1458444361143673, "mean_env_wait_ms": 0.257165935693375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015097314661199396, "StateBufferConnector_ms": 0.0023029067299582743, "ViewRequirementAgentConnector_ms": 0.060155174948952415}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1965.623, "learn_time_ms": 19.133, "learn_throughput": 17561.307, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-32", "timestamp": 1706194292, "time_this_iter_s": 1.962843894958496, "time_total_s": 43.2594895362854, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823638ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.2594895362854, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.946835875581133e+16, "policy_entropy": 555.7825317382812, "var_gnorm": 22.659574508666992, "vf_loss": 5156791910400.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -756913.804038915, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382504962590843, "mean_inference_ms": 5.224174063571436, "mean_action_processing_ms": 0.1458155802268464, "mean_env_wait_ms": 0.25710499006478343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015146835990574049, "StateBufferConnector_ms": 0.002299184384553329, "ViewRequirementAgentConnector_ms": 0.060167519942573876}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -756913.804038915, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382504962590843, "mean_inference_ms": 5.224174063571436, "mean_action_processing_ms": 0.1458155802268464, "mean_env_wait_ms": 0.25710499006478343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015146835990574049, "StateBufferConnector_ms": 0.002299184384553329, "ViewRequirementAgentConnector_ms": 0.060167519942573876}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1964.603, "learn_time_ms": 19.101, "learn_throughput": 17590.856, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-34", "timestamp": 1706194294, "time_this_iter_s": 1.9523003101348877, "time_total_s": 45.21178984642029, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3a020>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363ab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.21178984642029, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0620830279008256e+16, "policy_entropy": 523.1929931640625, "var_gnorm": 22.660261154174805, "vf_loss": 4397024149504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755554.1419511875, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380296246034028, "mean_inference_ms": 5.224135245177003, "mean_action_processing_ms": 0.14578872347768201, "mean_env_wait_ms": 0.2570509598797736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015112757682800293, "StateBufferConnector_ms": 0.002298752466837565, "ViewRequirementAgentConnector_ms": 0.06021261215209961}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755554.1419511875, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380296246034028, "mean_inference_ms": 5.224135245177003, "mean_action_processing_ms": 0.14578872347768201, "mean_env_wait_ms": 0.2570509598797736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015112757682800293, "StateBufferConnector_ms": 0.002298752466837565, "ViewRequirementAgentConnector_ms": 0.06021261215209961}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1964.462, "learn_time_ms": 19.098, "learn_throughput": 17593.425, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-36", "timestamp": 1706194296, "time_this_iter_s": 1.9600133895874023, "time_total_s": 47.17180323600769, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236dec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.17180323600769, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3723367546880000.0, "policy_entropy": 496.7018737792969, "var_gnorm": 22.660905838012695, "vf_loss": 4348872491008.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2438507080078125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754752.4604917163, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378395970334172, "mean_inference_ms": 5.22408766817303, "mean_action_processing_ms": 0.1457620644368488, "mean_env_wait_ms": 0.25699559994120824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515960693359375, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.06023979187011719}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754752.4604917163, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378395970334172, "mean_inference_ms": 5.22408766817303, "mean_action_processing_ms": 0.1457620644368488, "mean_env_wait_ms": 0.25699559994120824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515960693359375, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.06023979187011719}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1962.036, "learn_time_ms": 19.097, "learn_throughput": 17594.26, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-38", "timestamp": 1706194298, "time_this_iter_s": 1.9598989486694336, "time_total_s": 49.131702184677124, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78236395a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.131702184677124, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 10.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3835063271686144.0, "policy_entropy": 473.8448181152344, "var_gnorm": 22.66151237487793, "vf_loss": 4692085047296.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.695487976074219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754040.632893831, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377777184296343, "mean_inference_ms": 5.224124094043883, "mean_action_processing_ms": 0.145736698552878, "mean_env_wait_ms": 0.25696342200012023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228528242844801, "StateBufferConnector_ms": 0.0023025732774000903, "ViewRequirementAgentConnector_ms": 0.06038500712468074}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754040.632893831, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377777184296343, "mean_inference_ms": 5.224124094043883, "mean_action_processing_ms": 0.145736698552878, "mean_env_wait_ms": 0.25696342200012023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015228528242844801, "StateBufferConnector_ms": 0.0023025732774000903, "ViewRequirementAgentConnector_ms": 0.06038500712468074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1964.379, "learn_time_ms": 19.123, "learn_throughput": 17570.547, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-40", "timestamp": 1706194300, "time_this_iter_s": 1.9885058403015137, "time_total_s": 51.12020802497864, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9c30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363b400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.12020802497864, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 10.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6166635123572736.0, "policy_entropy": 453.84771728515625, "var_gnorm": 22.662078857421875, "vf_loss": 4714111434752.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6597251892089844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753977.140572424, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377593158373534, "mean_inference_ms": 5.224147886682534, "mean_action_processing_ms": 0.14571435420661183, "mean_env_wait_ms": 0.25693695876853906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015240245395236544, "StateBufferConnector_ms": 0.0023020638359917533, "ViewRequirementAgentConnector_ms": 0.06043822677047164}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753977.140572424, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377593158373534, "mean_inference_ms": 5.224147886682534, "mean_action_processing_ms": 0.14571435420661183, "mean_env_wait_ms": 0.25693695876853906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015240245395236544, "StateBufferConnector_ms": 0.0023020638359917533, "ViewRequirementAgentConnector_ms": 0.06043822677047164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1965.862, "learn_time_ms": 19.139, "learn_throughput": 17555.685, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-42", "timestamp": 1706194302, "time_this_iter_s": 1.9640283584594727, "time_total_s": 53.08423638343811, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb3d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7838361510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.08423638343811, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6991970534686720.0, "policy_entropy": 428.71380615234375, "var_gnorm": 22.66260528564453, "vf_loss": 4655616098304.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.731250762939453e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753079.1204479274, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377678851439006, "mean_inference_ms": 5.22420126495296, "mean_action_processing_ms": 0.14569497105402582, "mean_env_wait_ms": 0.2569155956882971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152085508619036, "StateBufferConnector_ms": 0.002299887793404715, "ViewRequirementAgentConnector_ms": 0.06046976361955915}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753079.1204479274, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377678851439006, "mean_inference_ms": 5.22420126495296, "mean_action_processing_ms": 0.14569497105402582, "mean_env_wait_ms": 0.2569155956882971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152085508619036, "StateBufferConnector_ms": 0.002299887793404715, "ViewRequirementAgentConnector_ms": 0.06046976361955915}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1965.374, "learn_time_ms": 19.09, "learn_throughput": 17601.006, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-44", "timestamp": 1706194304, "time_this_iter_s": 1.9744086265563965, "time_total_s": 55.05864500999451, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2f50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363a9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 55.05864500999451, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 11.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6755472992370688.0, "policy_entropy": 415.32098388671875, "var_gnorm": 22.663097381591797, "vf_loss": 4482283339776.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752194.2576709627, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377857501162576, "mean_inference_ms": 5.224256386153198, "mean_action_processing_ms": 0.14567672357833655, "mean_env_wait_ms": 0.2568956521765372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189729887863686, "StateBufferConnector_ms": 0.0022962175566574624, "ViewRequirementAgentConnector_ms": 0.06050076977959994}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752194.2576709627, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377857501162576, "mean_inference_ms": 5.224256386153198, "mean_action_processing_ms": 0.14567672357833655, "mean_env_wait_ms": 0.2568956521765372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189729887863686, "StateBufferConnector_ms": 0.0022962175566574624, "ViewRequirementAgentConnector_ms": 0.06050076977959994}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1965.789, "learn_time_ms": 19.047, "learn_throughput": 17640.111, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-46", "timestamp": 1706194306, "time_this_iter_s": 1.9663307666778564, "time_total_s": 57.02497577667236, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce39d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363bbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 57.02497577667236, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6162626845343744.0, "policy_entropy": 404.4501037597656, "var_gnorm": 22.66355323791504, "vf_loss": 5189597134848.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 30, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752935.9366088144, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378172488004285, "mean_inference_ms": 5.224317895631213, "mean_action_processing_ms": 0.14565898928676876, "mean_env_wait_ms": 0.2568751986244506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537481943766276, "StateBufferConnector_ms": 0.0022943814595540366, "ViewRequirementAgentConnector_ms": 0.06047407786051432}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752935.9366088144, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378172488004285, "mean_inference_ms": 5.224317895631213, "mean_action_processing_ms": 0.14565898928676876, "mean_env_wait_ms": 0.2568751986244506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01537481943766276, "StateBufferConnector_ms": 0.0022943814595540366, "ViewRequirementAgentConnector_ms": 0.06047407786051432}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 1966.973, "learn_time_ms": 19.06, "learn_throughput": 17628.637, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-48", "timestamp": 1706194308, "time_this_iter_s": 1.967811107635498, "time_total_s": 58.99278688430786, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363a830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 58.99278688430786, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4981131808079872.0, "policy_entropy": 391.2874755859375, "var_gnorm": 22.663976669311523, "vf_loss": 5011724566528.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2901763916015625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 31, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753127.5096319279, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378418485017634, "mean_inference_ms": 5.2243932522951315, "mean_action_processing_ms": 0.1456410846596503, "mean_env_wait_ms": 0.25685412532448776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331083728421119, "StateBufferConnector_ms": 0.0022942020047095513, "ViewRequirementAgentConnector_ms": 0.060472180766444054}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753127.5096319279, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378418485017634, "mean_inference_ms": 5.2243932522951315, "mean_action_processing_ms": 0.1456410846596503, "mean_env_wait_ms": 0.25685412532448776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331083728421119, "StateBufferConnector_ms": 0.0022942020047095513, "ViewRequirementAgentConnector_ms": 0.060472180766444054}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 1966.234, "learn_time_ms": 19.032, "learn_throughput": 17654.188, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-50", "timestamp": 1706194310, "time_this_iter_s": 1.969322919845581, "time_total_s": 60.96210980415344, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352a0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.96210980415344, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 11.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4059153190354944.0, "policy_entropy": 380.1241760253906, "var_gnorm": 22.66436767578125, "vf_loss": 4965502287872.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.695487976074219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 32, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753434.8623256334, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537896111804012, "mean_inference_ms": 5.224497095932102, "mean_action_processing_ms": 0.14562397342992833, "mean_env_wait_ms": 0.2568386892295842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527145504951477, "StateBufferConnector_ms": 0.002296268939971924, "ViewRequirementAgentConnector_ms": 0.060451775789260864}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753434.8623256334, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537896111804012, "mean_inference_ms": 5.224497095932102, "mean_action_processing_ms": 0.14562397342992833, "mean_env_wait_ms": 0.2568386892295842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01527145504951477, "StateBufferConnector_ms": 0.002296268939971924, "ViewRequirementAgentConnector_ms": 0.060451775789260864}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1967.851, "learn_time_ms": 19.017, "learn_throughput": 17668.397, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-52", "timestamp": 1706194312, "time_this_iter_s": 1.9790387153625488, "time_total_s": 62.94114851951599, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782352a440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.94114851951599, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2483136415924224.0, "policy_entropy": 365.238037109375, "var_gnorm": 22.66472625732422, "vf_loss": 4766432231424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 33, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753252.3307596149, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379500532698723, "mean_inference_ms": 5.224584538145696, "mean_action_processing_ms": 0.1456068338023942, "mean_env_wait_ms": 0.2568219051532716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250841776529947, "StateBufferConnector_ms": 0.00229604316480232, "ViewRequirementAgentConnector_ms": 0.06044777956875888}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753252.3307596149, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379500532698723, "mean_inference_ms": 5.224584538145696, "mean_action_processing_ms": 0.1456068338023942, "mean_env_wait_ms": 0.2568219051532716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250841776529947, "StateBufferConnector_ms": 0.00229604316480232, "ViewRequirementAgentConnector_ms": 0.06044777956875888}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 1968.663, "learn_time_ms": 18.99, "learn_throughput": 17693.153, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-54", "timestamp": 1706194314, "time_this_iter_s": 1.9604754447937012, "time_total_s": 64.90162396430969, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce90c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823638ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 64.90162396430969, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.866666666666666, "ram_util_percent": 11.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.870624472642355e+16, "policy_entropy": 355.31011962890625, "var_gnorm": 22.665058135986328, "vf_loss": 4687109554176.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8743019104003906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 34, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753105.403893075, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379846708017053, "mean_inference_ms": 5.224639821046429, "mean_action_processing_ms": 0.1455896615925555, "mean_env_wait_ms": 0.2568040862286231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236349666819853, "StateBufferConnector_ms": 0.0022965319016400505, "ViewRequirementAgentConnector_ms": 0.0605155439937816}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753105.403893075, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379846708017053, "mean_inference_ms": 5.224639821046429, "mean_action_processing_ms": 0.1455896615925555, "mean_env_wait_ms": 0.2568040862286231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236349666819853, "StateBufferConnector_ms": 0.0022965319016400505, "ViewRequirementAgentConnector_ms": 0.0605155439937816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 1968.003, "learn_time_ms": 18.998, "learn_throughput": 17686.469, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-56", "timestamp": 1706194316, "time_this_iter_s": 1.9534204006195068, "time_total_s": 66.8550443649292, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3b50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363aef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.8550443649292, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 11.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4423289644515328.0, "policy_entropy": 346.1488037109375, "var_gnorm": 22.66536521911621, "vf_loss": 5369045188608.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.421306610107422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 35, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754185.940798929, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380326471324268, "mean_inference_ms": 5.2247000800532035, "mean_action_processing_ms": 0.14557460479623488, "mean_env_wait_ms": 0.25678691962179606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015249933515276228, "StateBufferConnector_ms": 0.002295630318777902, "ViewRequirementAgentConnector_ms": 0.06055218832833426}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754185.940798929, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380326471324268, "mean_inference_ms": 5.2247000800532035, "mean_action_processing_ms": 0.14557460479623488, "mean_env_wait_ms": 0.25678691962179606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015249933515276228, "StateBufferConnector_ms": 0.002295630318777902, "ViewRequirementAgentConnector_ms": 0.06055218832833426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 1969.0, "learn_time_ms": 19.043, "learn_throughput": 17643.866, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-51-58", "timestamp": 1706194318, "time_this_iter_s": 1.9698996543884277, "time_total_s": 68.82494401931763, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb8b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235904c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 68.82494401931763, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 11.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4607504021323776e+16, "policy_entropy": 336.6617736816406, "var_gnorm": 22.665645599365234, "vf_loss": 4650642702336.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.159046173095703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 36, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753801.0198328785, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153808412977898, "mean_inference_ms": 5.224757324864762, "mean_action_processing_ms": 0.14556077110273882, "mean_env_wait_ms": 0.25677045504510365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015221039454142252, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.06053977542453342}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753801.0198328785, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153808412977898, "mean_inference_ms": 5.224757324864762, "mean_action_processing_ms": 0.14556077110273882, "mean_env_wait_ms": 0.25677045504510365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015221039454142252, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.06053977542453342}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 1966.712, "learn_time_ms": 19.043, "learn_throughput": 17644.529, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-00", "timestamp": 1706194320, "time_this_iter_s": 1.9656462669372559, "time_total_s": 70.79059028625488, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce91870>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363be20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.79059028625488, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 11.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1134154565550080.0, "policy_entropy": 330.1533203125, "var_gnorm": 22.665904998779297, "vf_loss": 5007714287616.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 37, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753730.6250378686, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381465742836892, "mean_inference_ms": 5.224812920991356, "mean_action_processing_ms": 0.14554850072218414, "mean_env_wait_ms": 0.25675561902791005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015196284732303104, "StateBufferConnector_ms": 0.0022959064792942357, "ViewRequirementAgentConnector_ms": 0.06052674473942937}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753730.6250378686, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381465742836892, "mean_inference_ms": 5.224812920991356, "mean_action_processing_ms": 0.14554850072218414, "mean_env_wait_ms": 0.25675561902791005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015196284732303104, "StateBufferConnector_ms": 0.0022959064792942357, "ViewRequirementAgentConnector_ms": 0.06052674473942937}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 1967.09, "learn_time_ms": 19.114, "learn_throughput": 17578.744, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-02", "timestamp": 1706194322, "time_this_iter_s": 1.9678339958190918, "time_total_s": 72.75842428207397, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f13c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.75842428207397, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 11.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1640260094066688e+16, "policy_entropy": 324.7774658203125, "var_gnorm": 22.666141510009766, "vf_loss": 4425721577472.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 38, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752799.884918759, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382061908054495, "mean_inference_ms": 5.22486714660926, "mean_action_processing_ms": 0.14553682261445416, "mean_env_wait_ms": 0.2567412142800677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361058084588302, "StateBufferConnector_ms": 0.002292582863255551, "ViewRequirementAgentConnector_ms": 0.060511262793289985}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752799.884918759, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382061908054495, "mean_inference_ms": 5.22486714660926, "mean_action_processing_ms": 0.14553682261445416, "mean_env_wait_ms": 0.2567412142800677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361058084588302, "StateBufferConnector_ms": 0.002292582863255551, "ViewRequirementAgentConnector_ms": 0.060511262793289985}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 1966.217, "learn_time_ms": 19.122, "learn_throughput": 17571.051, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-04", "timestamp": 1706194324, "time_this_iter_s": 1.9656972885131836, "time_total_s": 74.72412157058716, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dd840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235915a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.72412157058716, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 11.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2501814427516928e+16, "policy_entropy": 314.64111328125, "var_gnorm": 22.66636085510254, "vf_loss": 4790845702144.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.00543212890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 39, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752731.8869336761, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538257324237335, "mean_inference_ms": 5.224900008779955, "mean_action_processing_ms": 0.14552562065669422, "mean_env_wait_ms": 0.2567280139204207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015395115583370894, "StateBufferConnector_ms": 0.002288818359375, "ViewRequirementAgentConnector_ms": 0.06054364717923678}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -752731.8869336761, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538257324237335, "mean_inference_ms": 5.224900008779955, "mean_action_processing_ms": 0.14552562065669422, "mean_env_wait_ms": 0.2567280139204207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015395115583370894, "StateBufferConnector_ms": 0.002288818359375, "ViewRequirementAgentConnector_ms": 0.06054364717923678}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 1965.177, "learn_time_ms": 19.17, "learn_throughput": 17527.563, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-06", "timestamp": 1706194326, "time_this_iter_s": 1.9559381008148193, "time_total_s": 76.68005967140198, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce86d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363b640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.68005967140198, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4310917193924608.0, "policy_entropy": 313.3370666503906, "var_gnorm": 22.66655921936035, "vf_loss": 5184019759104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 40, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753577.9388917839, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538302653551055, "mean_inference_ms": 5.224935322673749, "mean_action_processing_ms": 0.1455146593575392, "mean_env_wait_ms": 0.25671467078715926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358924865722656, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.06058812141418457}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -753577.9388917839, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538302653551055, "mean_inference_ms": 5.224935322673749, "mean_action_processing_ms": 0.1455146593575392, "mean_env_wait_ms": 0.25671467078715926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358924865722656, "StateBufferConnector_ms": 0.0022923946380615234, "ViewRequirementAgentConnector_ms": 0.06058812141418457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1965.003, "learn_time_ms": 19.119, "learn_throughput": 17573.965, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-08", "timestamp": 1706194328, "time_this_iter_s": 1.96610426902771, "time_total_s": 78.64616394042969, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 78.64616394042969, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4481664424083456.0, "policy_entropy": 309.0682373046875, "var_gnorm": 22.66674041748047, "vf_loss": 5403397062656.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.552436828613281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 41, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754321.9125300552, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538346864878048, "mean_inference_ms": 5.224946451805242, "mean_action_processing_ms": 0.14550318921575617, "mean_env_wait_ms": 0.2567017889957751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015311706356885956, "StateBufferConnector_ms": 0.002290562885563548, "ViewRequirementAgentConnector_ms": 0.06056878624892816}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -754321.9125300552, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538346864878048, "mean_inference_ms": 5.224946451805242, "mean_action_processing_ms": 0.14550318921575617, "mean_env_wait_ms": 0.2567017889957751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015311706356885956, "StateBufferConnector_ms": 0.002290562885563548, "ViewRequirementAgentConnector_ms": 0.06056878624892816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 1963.213, "learn_time_ms": 19.111, "learn_throughput": 17581.354, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-10", "timestamp": 1706194330, "time_this_iter_s": 1.9514405727386475, "time_total_s": 80.59760451316833, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363b7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.59760451316833, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.292896423005389e+16, "policy_entropy": 307.3231201171875, "var_gnorm": 22.66691017150879, "vf_loss": 5520613179392.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.314018249511719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 42, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755644.4774010153, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538387292338043, "mean_inference_ms": 5.224943963709684, "mean_action_processing_ms": 0.145491689265727, "mean_env_wait_ms": 0.25668791086576104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288307553245908, "StateBufferConnector_ms": 0.0022876830328078497, "ViewRequirementAgentConnector_ms": 0.0605713753473191}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -755644.4774010153, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538387292338043, "mean_inference_ms": 5.224943963709684, "mean_action_processing_ms": 0.145491689265727, "mean_env_wait_ms": 0.25668791086576104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288307553245908, "StateBufferConnector_ms": 0.0022876830328078497, "ViewRequirementAgentConnector_ms": 0.0605713753473191}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 1960.841, "learn_time_ms": 19.089, "learn_throughput": 17601.929, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-12", "timestamp": 1706194332, "time_this_iter_s": 1.9553053379058838, "time_total_s": 82.55290985107422, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9000>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 82.55290985107422, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 12.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.1588079735209984e+16, "policy_entropy": 302.1583251953125, "var_gnorm": 22.66706085205078, "vf_loss": 5507254845440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1948089599609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 43, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -756825.784268513, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538423957671823, "mean_inference_ms": 5.224953664720606, "mean_action_processing_ms": 0.1454801405535228, "mean_env_wait_ms": 0.256673679428512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015258234600688135, "StateBufferConnector_ms": 0.0022866005121275437, "ViewRequirementAgentConnector_ms": 0.06057772525521212}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -756825.784268513, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538423957671823, "mean_inference_ms": 5.224953664720606, "mean_action_processing_ms": 0.1454801405535228, "mean_env_wait_ms": 0.256673679428512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015258234600688135, "StateBufferConnector_ms": 0.0022866005121275437, "ViewRequirementAgentConnector_ms": 0.06057772525521212}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 1961.896, "learn_time_ms": 19.133, "learn_throughput": 17561.461, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-14", "timestamp": 1706194334, "time_this_iter_s": 1.9710397720336914, "time_total_s": 84.52394962310791, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1af760>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235915a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.52394962310791, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 12.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.039087720136704e+16, "policy_entropy": 299.2618713378906, "var_gnorm": 22.667198181152344, "vf_loss": 5335220748288.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 44, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757705.9117086534, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384578973111243, "mean_inference_ms": 5.224954629564064, "mean_action_processing_ms": 0.14546891206772808, "mean_env_wait_ms": 0.2566597330355598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015245784412730824, "StateBufferConnector_ms": 0.00228339975530451, "ViewRequirementAgentConnector_ms": 0.060639598152854225}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757705.9117086534, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384578973111243, "mean_inference_ms": 5.224954629564064, "mean_action_processing_ms": 0.14546891206772808, "mean_env_wait_ms": 0.2566597330355598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015245784412730824, "StateBufferConnector_ms": 0.00228339975530451, "ViewRequirementAgentConnector_ms": 0.060639598152854225}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 1962.464, "learn_time_ms": 19.128, "learn_throughput": 17565.839, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-16", "timestamp": 1706194336, "time_this_iter_s": 1.9591333866119385, "time_total_s": 86.48308300971985, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3b2b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235923b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 86.48308300971985, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8186237730947072.0, "policy_entropy": 293.68389892578125, "var_gnorm": 22.667325973510742, "vf_loss": 5093883641856.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.123283386230469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 45, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757770.051593673, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384890797046175, "mean_inference_ms": 5.224947017296624, "mean_action_processing_ms": 0.1454578441933569, "mean_env_wait_ms": 0.2566449681944238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239185757107206, "StateBufferConnector_ms": 0.0022819307115342882, "ViewRequirementAgentConnector_ms": 0.0606324937608507}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -757770.051593673, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384890797046175, "mean_inference_ms": 5.224947017296624, "mean_action_processing_ms": 0.1454578441933569, "mean_env_wait_ms": 0.2566449681944238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239185757107206, "StateBufferConnector_ms": 0.0022819307115342882, "ViewRequirementAgentConnector_ms": 0.0606324937608507}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 1961.204, "learn_time_ms": 19.066, "learn_throughput": 17622.95, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-18", "timestamp": 1706194338, "time_this_iter_s": 1.9573252201080322, "time_total_s": 88.44040822982788, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f16c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782363ab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.44040822982788, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 12.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2121277103865856e+16, "policy_entropy": 293.25421142578125, "var_gnorm": 22.667442321777344, "vf_loss": 5153067892736.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 46, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758433.4240994677, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385229788079252, "mean_inference_ms": 5.224949672342942, "mean_action_processing_ms": 0.1454476094737762, "mean_env_wait_ms": 0.2566323855363029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346900276515795, "StateBufferConnector_ms": 0.0022810438404912534, "ViewRequirementAgentConnector_ms": 0.06064487540203592}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758433.4240994677, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385229788079252, "mean_inference_ms": 5.224949672342942, "mean_action_processing_ms": 0.1454476094737762, "mean_env_wait_ms": 0.2566323855363029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346900276515795, "StateBufferConnector_ms": 0.0022810438404912534, "ViewRequirementAgentConnector_ms": 0.06064487540203592}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 1961.938, "learn_time_ms": 19.057, "learn_throughput": 17631.548, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-20", "timestamp": 1706194340, "time_this_iter_s": 1.9730076789855957, "time_total_s": 90.41341590881348, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f26b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235908b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.41341590881348, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 12.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9826432054198272.0, "policy_entropy": 289.9107360839844, "var_gnorm": 22.667551040649414, "vf_loss": 5217655455744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4928321838378906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 47, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759214.0196672517, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385465802152434, "mean_inference_ms": 5.224927862336892, "mean_action_processing_ms": 0.14543712603895095, "mean_env_wait_ms": 0.2566187751833435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0022812092557866525, "ViewRequirementAgentConnector_ms": 0.06062629375051945}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759214.0196672517, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385465802152434, "mean_inference_ms": 5.224927862336892, "mean_action_processing_ms": 0.14543712603895095, "mean_env_wait_ms": 0.2566187751833435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306472778320312, "StateBufferConnector_ms": 0.0022812092557866525, "ViewRequirementAgentConnector_ms": 0.06062629375051945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 1959.552, "learn_time_ms": 18.978, "learn_throughput": 17704.422, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-22", "timestamp": 1706194342, "time_this_iter_s": 1.9439947605133057, "time_total_s": 92.35741066932678, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c9c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823593520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 92.35741066932678, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.583006001967923e+16, "policy_entropy": 284.39495849609375, "var_gnorm": 22.667646408081055, "vf_loss": 4667866611712.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.291534423828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 48, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758979.2334576463, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153857096825287, "mean_inference_ms": 5.2249110345766745, "mean_action_processing_ms": 0.1454270323224542, "mean_env_wait_ms": 0.2566044865576975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015277167161305746, "StateBufferConnector_ms": 0.00228037436803182, "ViewRequirementAgentConnector_ms": 0.06064474582672119}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758979.2334576463, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153857096825287, "mean_inference_ms": 5.2249110345766745, "mean_action_processing_ms": 0.1454270323224542, "mean_env_wait_ms": 0.2566044865576975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015277167161305746, "StateBufferConnector_ms": 0.00228037436803182, "ViewRequirementAgentConnector_ms": 0.06064474582672119}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1959.616, "learn_time_ms": 18.983, "learn_throughput": 17699.908, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-24", "timestamp": 1706194344, "time_this_iter_s": 1.966362476348877, "time_total_s": 94.32377314567566, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dec80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235912d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.32377314567566, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 12.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4561803950424064.0, "policy_entropy": 284.3433532714844, "var_gnorm": 22.667736053466797, "vf_loss": 4689659691008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.409385681152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 49, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758409.13047093, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538595477286449, "mean_inference_ms": 5.224893905126313, "mean_action_processing_ms": 0.1454172540402532, "mean_env_wait_ms": 0.25659031401195875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287010037169164, "StateBufferConnector_ms": 0.0022786004202706473, "ViewRequirementAgentConnector_ms": 0.060637143193459024}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758409.13047093, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538595477286449, "mean_inference_ms": 5.224893905126313, "mean_action_processing_ms": 0.1454172540402532, "mean_env_wait_ms": 0.25659031401195875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287010037169164, "StateBufferConnector_ms": 0.0022786004202706473, "ViewRequirementAgentConnector_ms": 0.060637143193459024}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 1960.348, "learn_time_ms": 18.986, "learn_throughput": 17696.819, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-26", "timestamp": 1706194346, "time_this_iter_s": 1.9632737636566162, "time_total_s": 96.28704690933228, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823591750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 96.28704690933228, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9428244562444288.0, "policy_entropy": 279.0846862792969, "var_gnorm": 22.667814254760742, "vf_loss": 5182883627008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.421306610107422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 50, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758815.503558341, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386465759449844, "mean_inference_ms": 5.224894118267887, "mean_action_processing_ms": 0.1454084884260046, "mean_env_wait_ms": 0.25657782561560455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015286445617675781, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.06068706512451172}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758815.503558341, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386465759449844, "mean_inference_ms": 5.224894118267887, "mean_action_processing_ms": 0.1454084884260046, "mean_env_wait_ms": 0.25657782561560455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015286445617675781, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.06068706512451172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 1961.947, "learn_time_ms": 19.033, "learn_throughput": 17653.834, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-28", "timestamp": 1706194348, "time_this_iter_s": 1.9821045398712158, "time_total_s": 98.26915144920349, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823638f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98.26915144920349, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 13.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3966242578759680.0, "policy_entropy": 279.89056396484375, "var_gnorm": 22.667888641357422, "vf_loss": 4573320708096.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 51, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758454.0059610582, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386953128506894, "mean_inference_ms": 5.224888607575253, "mean_action_processing_ms": 0.14539997603232177, "mean_env_wait_ms": 0.25656521203087884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015277488558900123, "StateBufferConnector_ms": 0.0022804035859949447, "ViewRequirementAgentConnector_ms": 0.0606836057176777}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -758454.0059610582, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386953128506894, "mean_inference_ms": 5.224888607575253, "mean_action_processing_ms": 0.14539997603232177, "mean_env_wait_ms": 0.25656521203087884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015277488558900123, "StateBufferConnector_ms": 0.0022804035859949447, "ViewRequirementAgentConnector_ms": 0.0606836057176777}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 1962.712, "learn_time_ms": 19.084, "learn_throughput": 17606.063, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-30", "timestamp": 1706194350, "time_this_iter_s": 1.9591631889343262, "time_total_s": 100.22831463813782, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dfa60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823593490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 100.22831463813782, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 13.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6452204277858304.0, "policy_entropy": 277.3196105957031, "var_gnorm": 22.667953491210938, "vf_loss": 5331684425728.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2067298889160156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 52, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759215.4778484149, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387461359237, "mean_inference_ms": 5.224867475467328, "mean_action_processing_ms": 0.14539156606650633, "mean_env_wait_ms": 0.25655290882584053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320686193612905, "StateBufferConnector_ms": 0.002280106911292443, "ViewRequirementAgentConnector_ms": 0.06073163105891301}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759215.4778484149, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387461359237, "mean_inference_ms": 5.224867475467328, "mean_action_processing_ms": 0.14539156606650633, "mean_env_wait_ms": 0.25655290882584053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320686193612905, "StateBufferConnector_ms": 0.002280106911292443, "ViewRequirementAgentConnector_ms": 0.06073163105891301}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 1962.166, "learn_time_ms": 19.094, "learn_throughput": 17597.402, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-32", "timestamp": 1706194352, "time_this_iter_s": 1.9498875141143799, "time_total_s": 102.1782021522522, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f37c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823592830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 102.1782021522522, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 13.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.379055184950067e+16, "policy_entropy": 278.5462646484375, "var_gnorm": 22.668012619018555, "vf_loss": 5161584427008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.933906555175781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 53, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759614.6446553202, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388027133519092, "mean_inference_ms": 5.224853162283333, "mean_action_processing_ms": 0.14538399206944547, "mean_env_wait_ms": 0.25654183293559246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0153127706275796, "StateBufferConnector_ms": 0.0022793715854860703, "ViewRequirementAgentConnector_ms": 0.06079088966801481}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759614.6446553202, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388027133519092, "mean_inference_ms": 5.224853162283333, "mean_action_processing_ms": 0.14538399206944547, "mean_env_wait_ms": 0.25654183293559246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0153127706275796, "StateBufferConnector_ms": 0.0022793715854860703, "ViewRequirementAgentConnector_ms": 0.06079088966801481}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 1962.224, "learn_time_ms": 19.066, "learn_throughput": 17623.28, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-34", "timestamp": 1706194354, "time_this_iter_s": 1.9716291427612305, "time_total_s": 104.14983129501343, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c8f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 104.14983129501343, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 13.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4667634628952064.0, "policy_entropy": 275.8844299316406, "var_gnorm": 22.66806983947754, "vf_loss": 5268650852352.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4332275390625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 54, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760030.7310095653, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538858562936474, "mean_inference_ms": 5.224840967103858, "mean_action_processing_ms": 0.14537681645782952, "mean_env_wait_ms": 0.25653114483430434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302940651222511, "StateBufferConnector_ms": 0.0022786634939688222, "ViewRequirementAgentConnector_ms": 0.060795854639123986}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760030.7310095653, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538858562936474, "mean_inference_ms": 5.224840967103858, "mean_action_processing_ms": 0.14537681645782952, "mean_env_wait_ms": 0.25653114483430434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302940651222511, "StateBufferConnector_ms": 0.0022786634939688222, "ViewRequirementAgentConnector_ms": 0.060795854639123986}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 1962.917, "learn_time_ms": 19.04, "learn_throughput": 17647.047, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-36", "timestamp": 1706194356, "time_this_iter_s": 1.9660582542419434, "time_total_s": 106.11588954925537, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823592170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.11588954925537, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 13.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.69581683408896e+16, "policy_entropy": 275.52386474609375, "var_gnorm": 22.668121337890625, "vf_loss": 5297145905152.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.457069396972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 55, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760262.6161129423, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389191055921103, "mean_inference_ms": 5.22483323898671, "mean_action_processing_ms": 0.14537023119885506, "mean_env_wait_ms": 0.25652175771505625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015291300686922941, "StateBufferConnector_ms": 0.0022775476629083805, "ViewRequirementAgentConnector_ms": 0.06081797859885476}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760262.6161129423, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389191055921103, "mean_inference_ms": 5.22483323898671, "mean_action_processing_ms": 0.14537023119885506, "mean_env_wait_ms": 0.25652175771505625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015291300686922941, "StateBufferConnector_ms": 0.0022775476629083805, "ViewRequirementAgentConnector_ms": 0.06081797859885476}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 1964.244, "learn_time_ms": 19.074, "learn_throughput": 17616.055, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-38", "timestamp": 1706194358, "time_this_iter_s": 1.970611333847046, "time_total_s": 108.08650088310242, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235932e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 108.08650088310242, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 13.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5402958262960128.0, "policy_entropy": 273.4635925292969, "var_gnorm": 22.668163299560547, "vf_loss": 5199436972032.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.409385681152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 56, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760607.182437864, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389798787310952, "mean_inference_ms": 5.22482421914758, "mean_action_processing_ms": 0.14536381028560166, "mean_env_wait_ms": 0.25651240285023846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015297106334141322, "StateBufferConnector_ms": 0.0022764716829572406, "ViewRequirementAgentConnector_ms": 0.060824837003435404}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760607.182437864, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389798787310952, "mean_inference_ms": 5.22482421914758, "mean_action_processing_ms": 0.14536381028560166, "mean_env_wait_ms": 0.25651240285023846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015297106334141322, "StateBufferConnector_ms": 0.0022764716829572406, "ViewRequirementAgentConnector_ms": 0.060824837003435404}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1963.217, "learn_time_ms": 19.096, "learn_throughput": 17595.073, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-40", "timestamp": 1706194360, "time_this_iter_s": 1.9627649784088135, "time_total_s": 110.04926586151123, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d8670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 110.04926586151123, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 13.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4785395652886528.0, "policy_entropy": 271.5855712890625, "var_gnorm": 22.6682071685791, "vf_loss": 4771810377728.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 57, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760201.6218211554, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390331157803713, "mean_inference_ms": 5.224803279689404, "mean_action_processing_ms": 0.1453573206052918, "mean_env_wait_ms": 0.25650272318714445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015370887622498629, "StateBufferConnector_ms": 0.0022758517348975466, "ViewRequirementAgentConnector_ms": 0.060787117272092586}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760201.6218211554, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390331157803713, "mean_inference_ms": 5.224803279689404, "mean_action_processing_ms": 0.1453573206052918, "mean_env_wait_ms": 0.25650272318714445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015370887622498629, "StateBufferConnector_ms": 0.0022758517348975466, "ViewRequirementAgentConnector_ms": 0.060787117272092586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 1963.713, "learn_time_ms": 19.07, "learn_throughput": 17619.755, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-42", "timestamp": 1706194362, "time_this_iter_s": 1.9489710330963135, "time_total_s": 111.99823689460754, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f16f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 111.99823689460754, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 13.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4298647546101760.0, "policy_entropy": 275.1415710449219, "var_gnorm": 22.668243408203125, "vf_loss": 5066792632320.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0875205993652344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 58, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760353.0101275557, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539083991975159, "mean_inference_ms": 5.2247874540376475, "mean_action_processing_ms": 0.14535084718224736, "mean_env_wait_ms": 0.25649308648279123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015368132755674165, "StateBufferConnector_ms": 0.002276075297388537, "ViewRequirementAgentConnector_ms": 0.06084072178807752}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760353.0101275557, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539083991975159, "mean_inference_ms": 5.2247874540376475, "mean_action_processing_ms": 0.14535084718224736, "mean_env_wait_ms": 0.25649308648279123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015368132755674165, "StateBufferConnector_ms": 0.002276075297388537, "ViewRequirementAgentConnector_ms": 0.06084072178807752}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 1963.961, "learn_time_ms": 19.112, "learn_throughput": 17580.432, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-44", "timestamp": 1706194364, "time_this_iter_s": 1.9688224792480469, "time_total_s": 113.96705937385559, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c9b40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d8940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 113.96705937385559, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.183084175163392e+16, "policy_entropy": 270.10595703125, "var_gnorm": 22.66827964782715, "vf_loss": 4712651292672.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 59, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759933.3890008325, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539133488725515, "mean_inference_ms": 5.2247736356476375, "mean_action_processing_ms": 0.14534427808557218, "mean_env_wait_ms": 0.25648281984848664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334355629096597, "StateBufferConnector_ms": 0.0022746748843435515, "ViewRequirementAgentConnector_ms": 0.060825428720247945}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759933.3890008325, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539133488725515, "mean_inference_ms": 5.2247736356476375, "mean_action_processing_ms": 0.14534427808557218, "mean_env_wait_ms": 0.25648281984848664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334355629096597, "StateBufferConnector_ms": 0.0022746748843435515, "ViewRequirementAgentConnector_ms": 0.060825428720247945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 1964.112, "learn_time_ms": 19.115, "learn_throughput": 17578.086, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-46", "timestamp": 1706194366, "time_this_iter_s": 1.964810848236084, "time_total_s": 115.93187022209167, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d9750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 115.93187022209167, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8230119411810304.0, "policy_entropy": 268.3652038574219, "var_gnorm": 22.668310165405273, "vf_loss": 5291761991680.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.325939178466797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 60, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760504.4312442482, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391819652464017, "mean_inference_ms": 5.224761238002888, "mean_action_processing_ms": 0.14533779457862875, "mean_env_wait_ms": 0.2564723243502562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324751536051432, "StateBufferConnector_ms": 0.002274115880330404, "ViewRequirementAgentConnector_ms": 0.060836474100748696}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760504.4312442482, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391819652464017, "mean_inference_ms": 5.224761238002888, "mean_action_processing_ms": 0.14533779457862875, "mean_env_wait_ms": 0.2564723243502562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324751536051432, "StateBufferConnector_ms": 0.002274115880330404, "ViewRequirementAgentConnector_ms": 0.060836474100748696}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 1962.39, "learn_time_ms": 19.131, "learn_throughput": 17563.058, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-48", "timestamp": 1706194368, "time_this_iter_s": 1.9649202823638916, "time_total_s": 117.89679050445557, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823592200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 117.89679050445557, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 13.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1242608126918656.0, "policy_entropy": 267.26446533203125, "var_gnorm": 22.668338775634766, "vf_loss": 5637850267648.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 61, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761194.4414812771, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539231232419762, "mean_inference_ms": 5.224749881103461, "mean_action_processing_ms": 0.14533161451729446, "mean_env_wait_ms": 0.2564623376789462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302564277023565, "StateBufferConnector_ms": 0.0022739660544473616, "ViewRequirementAgentConnector_ms": 0.060824878880235016}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761194.4414812771, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539231232419762, "mean_inference_ms": 5.224749881103461, "mean_action_processing_ms": 0.14533161451729446, "mean_env_wait_ms": 0.2564623376789462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302564277023565, "StateBufferConnector_ms": 0.0022739660544473616, "ViewRequirementAgentConnector_ms": 0.060824878880235016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 1963.065, "learn_time_ms": 19.133, "learn_throughput": 17561.658, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-50", "timestamp": 1706194370, "time_this_iter_s": 1.9658923149108887, "time_total_s": 119.86268281936646, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d8280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 119.86268281936646, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 13.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4043478707208192.0, "policy_entropy": 270.9283447265625, "var_gnorm": 22.668365478515625, "vf_loss": 4941639319552.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7670135498046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 62, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761172.5351338021, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539279930505181, "mean_inference_ms": 5.224742597890453, "mean_action_processing_ms": 0.14532541152395576, "mean_env_wait_ms": 0.2564522764158987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288399111840033, "StateBufferConnector_ms": 0.002274205607752646, "ViewRequirementAgentConnector_ms": 0.06085557322348318}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761172.5351338021, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539279930505181, "mean_inference_ms": 5.224742597890453, "mean_action_processing_ms": 0.14532541152395576, "mean_env_wait_ms": 0.2564522764158987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288399111840033, "StateBufferConnector_ms": 0.002274205607752646, "ViewRequirementAgentConnector_ms": 0.06085557322348318}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 1964.904, "learn_time_ms": 19.139, "learn_throughput": 17555.773, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-52", "timestamp": 1706194372, "time_this_iter_s": 1.9683279991149902, "time_total_s": 121.83101081848145, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce738e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823592170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 121.83101081848145, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1302148050583552.0, "policy_entropy": 266.87371826171875, "var_gnorm": 22.66838836669922, "vf_loss": 4402458918912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 63, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760396.138840572, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393289271378974, "mean_inference_ms": 5.224733986063519, "mean_action_processing_ms": 0.14531909298649281, "mean_env_wait_ms": 0.2564424557717167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015273169865683904, "StateBufferConnector_ms": 0.0022733022296239458, "ViewRequirementAgentConnector_ms": 0.06092465113079737}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760396.138840572, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393289271378974, "mean_inference_ms": 5.224733986063519, "mean_action_processing_ms": 0.14531909298649281, "mean_env_wait_ms": 0.2564424557717167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015273169865683904, "StateBufferConnector_ms": 0.0022733022296239458, "ViewRequirementAgentConnector_ms": 0.06092465113079737}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 1963.932, "learn_time_ms": 19.149, "learn_throughput": 17547.051, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-54", "timestamp": 1706194374, "time_this_iter_s": 1.9619662761688232, "time_total_s": 123.79297709465027, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d8ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 123.79297709465027, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.06164075364352e+16, "policy_entropy": 265.25238037109375, "var_gnorm": 22.66840934753418, "vf_loss": 5410058665984.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 64, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760982.9515740343, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393772126842475, "mean_inference_ms": 5.224733106452937, "mean_action_processing_ms": 0.1453131555092405, "mean_env_wait_ms": 0.2564326453309509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278533101081848, "StateBufferConnector_ms": 0.0022724270820617676, "ViewRequirementAgentConnector_ms": 0.06091780960559845}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760982.9515740343, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393772126842475, "mean_inference_ms": 5.224733106452937, "mean_action_processing_ms": 0.1453131555092405, "mean_env_wait_ms": 0.2564326453309509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278533101081848, "StateBufferConnector_ms": 0.0022724270820617676, "ViewRequirementAgentConnector_ms": 0.06091780960559845}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1964.767, "learn_time_ms": 19.137, "learn_throughput": 17558.047, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-56", "timestamp": 1706194376, "time_this_iter_s": 1.9744598865509033, "time_total_s": 125.76743698120117, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d8940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 125.76743698120117, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2234167098015744e+16, "policy_entropy": 266.0755615234375, "var_gnorm": 22.668428421020508, "vf_loss": 4919396401152.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.100799560546875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 65, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761158.3098683245, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394215219692323, "mean_inference_ms": 5.224719425996932, "mean_action_processing_ms": 0.14530731496375782, "mean_env_wait_ms": 0.2564227449535949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015353056100698618, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06093722123366136}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761158.3098683245, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394215219692323, "mean_inference_ms": 5.224719425996932, "mean_action_processing_ms": 0.14530731496375782, "mean_env_wait_ms": 0.2564227449535949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015353056100698618, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06093722123366136}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 1962.204, "learn_time_ms": 19.094, "learn_throughput": 17597.446, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-52-58", "timestamp": 1706194378, "time_this_iter_s": 1.9450013637542725, "time_total_s": 127.71243834495544, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c8ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235da170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 127.71243834495544, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 14.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.907301560614912e+16, "policy_entropy": 265.092041015625, "var_gnorm": 22.668445587158203, "vf_loss": 4726263906304.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 66, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760985.0634550768, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394623918554406, "mean_inference_ms": 5.224702881491836, "mean_action_processing_ms": 0.14530156608266553, "mean_env_wait_ms": 0.2564128813476949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015363187500924774, "StateBufferConnector_ms": 0.002271478826349432, "ViewRequirementAgentConnector_ms": 0.06092859036994703}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760985.0634550768, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394623918554406, "mean_inference_ms": 5.224702881491836, "mean_action_processing_ms": 0.14530156608266553, "mean_env_wait_ms": 0.2564128813476949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015363187500924774, "StateBufferConnector_ms": 0.002271478826349432, "ViewRequirementAgentConnector_ms": 0.06092859036994703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 1961.745, "learn_time_ms": 19.048, "learn_throughput": 17639.228, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-00", "timestamp": 1706194380, "time_this_iter_s": 1.958214521408081, "time_total_s": 129.67065286636353, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823590820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 129.67065286636353, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 14.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.329603200765133e+16, "policy_entropy": 261.8504333496094, "var_gnorm": 22.668460845947266, "vf_loss": 5043092193280.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.123283386230469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 67, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761004.8259703877, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539503540686571, "mean_inference_ms": 5.224687718721014, "mean_action_processing_ms": 0.1452959363540893, "mean_env_wait_ms": 0.25640290159505075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534027839774516, "StateBufferConnector_ms": 0.0022703142308477145, "ViewRequirementAgentConnector_ms": 0.06093267184584888}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -761004.8259703877, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539503540686571, "mean_inference_ms": 5.224687718721014, "mean_action_processing_ms": 0.1452959363540893, "mean_env_wait_ms": 0.25640290159505075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01534027839774516, "StateBufferConnector_ms": 0.0022703142308477145, "ViewRequirementAgentConnector_ms": 0.06093267184584888}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 1963.344, "learn_time_ms": 19.096, "learn_throughput": 17595.051, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-02", "timestamp": 1706194382, "time_this_iter_s": 1.9649970531463623, "time_total_s": 131.6356499195099, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1f30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d97e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 131.6356499195099, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2539344921362432.0, "policy_entropy": 264.327880859375, "var_gnorm": 22.668476104736328, "vf_loss": 4584808382464.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.814697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 68, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760679.5829435145, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395437818010183, "mean_inference_ms": 5.2246764238758985, "mean_action_processing_ms": 0.14529040255334563, "mean_env_wait_ms": 0.2563928153520874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355909571928136, "StateBufferConnector_ms": 0.0022702357348273784, "ViewRequirementAgentConnector_ms": 0.06093873697168687}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760679.5829435145, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395437818010183, "mean_inference_ms": 5.2246764238758985, "mean_action_processing_ms": 0.14529040255334563, "mean_env_wait_ms": 0.2563928153520874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355909571928136, "StateBufferConnector_ms": 0.0022702357348273784, "ViewRequirementAgentConnector_ms": 0.06093873697168687}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 1963.352, "learn_time_ms": 19.079, "learn_throughput": 17611.3, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-04", "timestamp": 1706194384, "time_this_iter_s": 1.9689671993255615, "time_total_s": 133.60461711883545, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea380>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235db0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 133.60461711883545, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7565767700578304e+16, "policy_entropy": 266.6983642578125, "var_gnorm": 22.668489456176758, "vf_loss": 5091687923712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4928321838378906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 69, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760773.4926975738, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395806184146457, "mean_inference_ms": 5.2246599942492775, "mean_action_processing_ms": 0.14528466338898757, "mean_env_wait_ms": 0.25638266043374386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532720482867697, "StateBufferConnector_ms": 0.0022680863090183425, "ViewRequirementAgentConnector_ms": 0.06092700405397277}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760773.4926975738, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395806184146457, "mean_inference_ms": 5.2246599942492775, "mean_action_processing_ms": 0.14528466338898757, "mean_env_wait_ms": 0.25638266043374386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532720482867697, "StateBufferConnector_ms": 0.0022680863090183425, "ViewRequirementAgentConnector_ms": 0.06092700405397277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 1962.272, "learn_time_ms": 19.062, "learn_throughput": 17626.432, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-06", "timestamp": 1706194386, "time_this_iter_s": 1.9540374279022217, "time_total_s": 135.55865454673767, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f18d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d9750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 135.55865454673767, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 14.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6893581696434176e+16, "policy_entropy": 266.60443115234375, "var_gnorm": 22.668500900268555, "vf_loss": 4753732403200.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 70, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760508.5028206762, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539613951027343, "mean_inference_ms": 5.2246386712317685, "mean_action_processing_ms": 0.14527883367967676, "mean_env_wait_ms": 0.25637244010380744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310219355991908, "StateBufferConnector_ms": 0.0022670200892857145, "ViewRequirementAgentConnector_ms": 0.0609203747340611}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760508.5028206762, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539613951027343, "mean_inference_ms": 5.2246386712317685, "mean_action_processing_ms": 0.14527883367967676, "mean_env_wait_ms": 0.25637244010380744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310219355991908, "StateBufferConnector_ms": 0.0022670200892857145, "ViewRequirementAgentConnector_ms": 0.0609203747340611}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 1961.139, "learn_time_ms": 19.015, "learn_throughput": 17670.103, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-08", "timestamp": 1706194388, "time_this_iter_s": 1.9536149501800537, "time_total_s": 137.51226949691772, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1ca020>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235da200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 137.51226949691772, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 14.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6858480803643392.0, "policy_entropy": 264.5229187011719, "var_gnorm": 22.66851234436035, "vf_loss": 5051072905216.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.349781036376953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 71, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760450.4521388632, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396458424915424, "mean_inference_ms": 5.224613081049891, "mean_action_processing_ms": 0.1452728892714241, "mean_env_wait_ms": 0.2563621716451603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015292704944879236, "StateBufferConnector_ms": 0.00226531230228048, "ViewRequirementAgentConnector_ms": 0.060920648171868125}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760450.4521388632, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396458424915424, "mean_inference_ms": 5.224613081049891, "mean_action_processing_ms": 0.1452728892714241, "mean_env_wait_ms": 0.2563621716451603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015292704944879236, "StateBufferConnector_ms": 0.00226531230228048, "ViewRequirementAgentConnector_ms": 0.060920648171868125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 1960.005, "learn_time_ms": 18.997, "learn_throughput": 17687.224, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-10", "timestamp": 1706194390, "time_this_iter_s": 1.9545855522155762, "time_total_s": 139.4668550491333, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb9a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7839f793f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.4668550491333, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 14.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7499878607290368e+16, "policy_entropy": 262.5733337402344, "var_gnorm": 22.668521881103516, "vf_loss": 4354612920320.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 72, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759790.9357015967, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539674387426847, "mean_inference_ms": 5.2245836217500266, "mean_action_processing_ms": 0.14526690705029535, "mean_env_wait_ms": 0.25635161565266895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532402303483751, "StateBufferConnector_ms": 0.0022659699122111, "ViewRequirementAgentConnector_ms": 0.06093945768144396}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759790.9357015967, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539674387426847, "mean_inference_ms": 5.2245836217500266, "mean_action_processing_ms": 0.14526690705029535, "mean_env_wait_ms": 0.25635161565266895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532402303483751, "StateBufferConnector_ms": 0.0022659699122111, "ViewRequirementAgentConnector_ms": 0.06093945768144396}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1958.656, "learn_time_ms": 19.091, "learn_throughput": 17599.885, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-12", "timestamp": 1706194392, "time_this_iter_s": 1.954845905303955, "time_total_s": 141.42170095443726, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f37f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d83a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 141.42170095443726, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 14.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.98651901116416e+16, "policy_entropy": 264.3542175292969, "var_gnorm": 22.668529510498047, "vf_loss": 4478683578368.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 73, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759297.1348592076, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397018869450912, "mean_inference_ms": 5.224551836877739, "mean_action_processing_ms": 0.14526096116074635, "mean_env_wait_ms": 0.25634122682727606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015391715585368953, "StateBufferConnector_ms": 0.0022653031022581336, "ViewRequirementAgentConnector_ms": 0.06094697403581175}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759297.1348592076, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397018869450912, "mean_inference_ms": 5.224551836877739, "mean_action_processing_ms": 0.14526096116074635, "mean_env_wait_ms": 0.25634122682727606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015391715585368953, "StateBufferConnector_ms": 0.0022653031022581336, "ViewRequirementAgentConnector_ms": 0.06094697403581175}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 1958.185, "learn_time_ms": 19.068, "learn_throughput": 17621.606, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-14", "timestamp": 1706194394, "time_this_iter_s": 1.9572770595550537, "time_total_s": 143.3789780139923, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8de3b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235db0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 143.3789780139923, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 15.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0596071138852864e+16, "policy_entropy": 263.9713439941406, "var_gnorm": 22.66853904724121, "vf_loss": 5271022731264.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.170967102050781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 74, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759495.2971250857, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539730599696633, "mean_inference_ms": 5.224521523510436, "mean_action_processing_ms": 0.14525540195697526, "mean_env_wait_ms": 0.25633125198371093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379609288396063, "StateBufferConnector_ms": 0.002265943063272012, "ViewRequirementAgentConnector_ms": 0.0609462325637405}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759495.2971250857, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539730599696633, "mean_inference_ms": 5.224521523510436, "mean_action_processing_ms": 0.14525540195697526, "mean_env_wait_ms": 0.25633125198371093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379609288396063, "StateBufferConnector_ms": 0.002265943063272012, "ViewRequirementAgentConnector_ms": 0.0609462325637405}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 1957.292, "learn_time_ms": 19.061, "learn_throughput": 17627.755, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-16", "timestamp": 1706194396, "time_this_iter_s": 1.9655356407165527, "time_total_s": 145.34451365470886, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3bd90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dbeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 145.34451365470886, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 15.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.106905280996966e+16, "policy_entropy": 264.4674377441406, "var_gnorm": 22.66854476928711, "vf_loss": 4697168543744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6597251892089844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 75, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759207.9902573302, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539757182556589, "mean_inference_ms": 5.224487852241356, "mean_action_processing_ms": 0.1452500575379704, "mean_env_wait_ms": 0.2563212670240493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015363693237304688, "StateBufferConnector_ms": 0.0022687911987304688, "ViewRequirementAgentConnector_ms": 0.060943603515625}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759207.9902573302, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539757182556589, "mean_inference_ms": 5.224487852241356, "mean_action_processing_ms": 0.1452500575379704, "mean_env_wait_ms": 0.2563212670240493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015363693237304688, "StateBufferConnector_ms": 0.0022687911987304688, "ViewRequirementAgentConnector_ms": 0.060943603515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1958.288, "learn_time_ms": 19.073, "learn_throughput": 17616.451, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-18", "timestamp": 1706194398, "time_this_iter_s": 1.9549965858459473, "time_total_s": 147.2995102405548, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f30a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dadd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 147.2995102405548, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 15.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.593388843401216e+16, "policy_entropy": 262.0554504394531, "var_gnorm": 22.66855239868164, "vf_loss": 4857911050240.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 76, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759257.7820599595, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397847315548133, "mean_inference_ms": 5.224458745539142, "mean_action_processing_ms": 0.1452448288806988, "mean_env_wait_ms": 0.25631162667711077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352901659513774, "StateBufferConnector_ms": 0.0022684272966886822, "ViewRequirementAgentConnector_ms": 0.06096833630612022}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759257.7820599595, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397847315548133, "mean_inference_ms": 5.224458745539142, "mean_action_processing_ms": 0.1452448288806988, "mean_env_wait_ms": 0.25631162667711077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352901659513774, "StateBufferConnector_ms": 0.0022684272966886822, "ViewRequirementAgentConnector_ms": 0.06096833630612022}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 1959.574, "learn_time_ms": 19.108, "learn_throughput": 17584.688, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-20", "timestamp": 1706194400, "time_this_iter_s": 1.9710850715637207, "time_total_s": 149.27059531211853, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235936d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 149.27059531211853, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 15.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.21474251538432e+16, "policy_entropy": 265.86273193359375, "var_gnorm": 22.66855812072754, "vf_loss": 5070429093888.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 77, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759389.5204258327, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398096598778802, "mean_inference_ms": 5.22442902172552, "mean_action_processing_ms": 0.14523952398407203, "mean_env_wait_ms": 0.2563017128556872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015343938555036272, "StateBufferConnector_ms": 0.0022686921156846083, "ViewRequirementAgentConnector_ms": 0.06096610775241604}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759389.5204258327, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398096598778802, "mean_inference_ms": 5.22442902172552, "mean_action_processing_ms": 0.14523952398407203, "mean_env_wait_ms": 0.2563017128556872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015343938555036272, "StateBufferConnector_ms": 0.0022686921156846083, "ViewRequirementAgentConnector_ms": 0.06096610775241604}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 1958.971, "learn_time_ms": 19.105, "learn_throughput": 17587.278, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-22", "timestamp": 1706194402, "time_this_iter_s": 1.958977460861206, "time_total_s": 151.22957277297974, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1af760>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823591a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 151.22957277297974, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 15.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.835880068743168e+16, "policy_entropy": 264.62249755859375, "var_gnorm": 22.668561935424805, "vf_loss": 5553454579712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2782554626464844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 78, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759966.0772053673, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398337679648963, "mean_inference_ms": 5.224398022741694, "mean_action_processing_ms": 0.14523435116103964, "mean_env_wait_ms": 0.25629169453720924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328786312005458, "StateBufferConnector_ms": 0.0022686444796048678, "ViewRequirementAgentConnector_ms": 0.06096638165987455}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759966.0772053673, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398337679648963, "mean_inference_ms": 5.224398022741694, "mean_action_processing_ms": 0.14523435116103964, "mean_env_wait_ms": 0.25629169453720924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328786312005458, "StateBufferConnector_ms": 0.0022686444796048678, "ViewRequirementAgentConnector_ms": 0.06096638165987455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 1957.978, "learn_time_ms": 19.131, "learn_throughput": 17563.452, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-24", "timestamp": 1706194404, "time_this_iter_s": 1.9590578079223633, "time_total_s": 153.1886305809021, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2dd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d83a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 153.1886305809021, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 15.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.7527287213654016e+16, "policy_entropy": 262.3120422363281, "var_gnorm": 22.668567657470703, "vf_loss": 4727388504064.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 79, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759972.7221141148, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398533646624593, "mean_inference_ms": 5.224353433439982, "mean_action_processing_ms": 0.1452289594161228, "mean_env_wait_ms": 0.25628113670872527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320958970468255, "StateBufferConnector_ms": 0.002267692662492583, "ViewRequirementAgentConnector_ms": 0.06096453606327878}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759972.7221141148, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398533646624593, "mean_inference_ms": 5.224353433439982, "mean_action_processing_ms": 0.1452289594161228, "mean_env_wait_ms": 0.25628113670872527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320958970468255, "StateBufferConnector_ms": 0.002267692662492583, "ViewRequirementAgentConnector_ms": 0.06096453606327878}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 1955.586, "learn_time_ms": 19.124, "learn_throughput": 17569.802, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-26", "timestamp": 1706194406, "time_this_iter_s": 1.9301338195800781, "time_total_s": 155.11876440048218, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dbc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 155.11876440048218, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 15.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.994690428449587e+16, "policy_entropy": 261.43939208984375, "var_gnorm": 22.66857147216797, "vf_loss": 5069044449280.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1113624572753906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 80, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759993.2784927783, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398726379475242, "mean_inference_ms": 5.22430897775272, "mean_action_processing_ms": 0.14522371793348557, "mean_env_wait_ms": 0.25627079815818876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531153917312622, "StateBufferConnector_ms": 0.0022670626640319824, "ViewRequirementAgentConnector_ms": 0.060986876487731934}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759993.2784927783, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398726379475242, "mean_inference_ms": 5.22430897775272, "mean_action_processing_ms": 0.14522371793348557, "mean_env_wait_ms": 0.25627079815818876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531153917312622, "StateBufferConnector_ms": 0.0022670626640319824, "ViewRequirementAgentConnector_ms": 0.060986876487731934}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1956.335, "learn_time_ms": 19.164, "learn_throughput": 17532.643, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-28", "timestamp": 1706194408, "time_this_iter_s": 1.9611434936523438, "time_total_s": 157.07990789413452, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 157.07990789413452, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 15.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.749542823650918e+16, "policy_entropy": 263.2395935058594, "var_gnorm": 22.668575286865234, "vf_loss": 5227554013184.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2067298889160156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 81, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760297.8861831366, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398948044620547, "mean_inference_ms": 5.224263763300911, "mean_action_processing_ms": 0.14521879023712958, "mean_env_wait_ms": 0.2562609586595187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015319718254937066, "StateBufferConnector_ms": 0.0022676255967881945, "ViewRequirementAgentConnector_ms": 0.06104957910231602}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760297.8861831366, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398948044620547, "mean_inference_ms": 5.224263763300911, "mean_action_processing_ms": 0.14521879023712958, "mean_env_wait_ms": 0.2562609586595187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015319718254937066, "StateBufferConnector_ms": 0.0022676255967881945, "ViewRequirementAgentConnector_ms": 0.06104957910231602}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 1956.94, "learn_time_ms": 19.158, "learn_throughput": 17538.666, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-30", "timestamp": 1706194410, "time_this_iter_s": 1.9606707096099854, "time_total_s": 159.0405786037445, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8de5f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 159.0405786037445, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 15.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.943622946829107e+16, "policy_entropy": 263.279052734375, "var_gnorm": 22.668581008911133, "vf_loss": 4473293373440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 82, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759871.720818072, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399160407796028, "mean_inference_ms": 5.224212816340729, "mean_action_processing_ms": 0.14521402068957343, "mean_env_wait_ms": 0.2562513391320455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015301239199754669, "StateBufferConnector_ms": 0.0022675932907476656, "ViewRequirementAgentConnector_ms": 0.061041262091659915}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759871.720818072, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399160407796028, "mean_inference_ms": 5.224212816340729, "mean_action_processing_ms": 0.14521402068957343, "mean_env_wait_ms": 0.2562513391320455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015301239199754669, "StateBufferConnector_ms": 0.0022675932907476656, "ViewRequirementAgentConnector_ms": 0.061041262091659915}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 1956.172, "learn_time_ms": 19.036, "learn_throughput": 17651.203, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-32", "timestamp": 1706194412, "time_this_iter_s": 1.947204828262329, "time_total_s": 160.98778343200684, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 160.98778343200684, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 15.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.401978955903795e+16, "policy_entropy": 262.9896545410156, "var_gnorm": 22.668582916259766, "vf_loss": 4533949825024.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 83, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759660.8967196787, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399369233250448, "mean_inference_ms": 5.224159515669486, "mean_action_processing_ms": 0.14520925744365373, "mean_env_wait_ms": 0.2562418039719106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015297567988016519, "StateBufferConnector_ms": 0.00226813626576619, "ViewRequirementAgentConnector_ms": 0.06107652043721762}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759660.8967196787, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399369233250448, "mean_inference_ms": 5.224159515669486, "mean_action_processing_ms": 0.14520925744365373, "mean_env_wait_ms": 0.2562418039719106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015297567988016519, "StateBufferConnector_ms": 0.00226813626576619, "ViewRequirementAgentConnector_ms": 0.06107652043721762}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 1955.872, "learn_time_ms": 19.091, "learn_throughput": 17599.577, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-34", "timestamp": 1706194414, "time_this_iter_s": 1.9542791843414307, "time_total_s": 162.94206261634827, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceabc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 162.94206261634827, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 15.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.098382160402842e+16, "policy_entropy": 264.1615295410156, "var_gnorm": 22.6685848236084, "vf_loss": 5279650938880.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4332275390625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 84, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760061.8831611885, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539954077160951, "mean_inference_ms": 5.2241013043138285, "mean_action_processing_ms": 0.14520427546279932, "mean_env_wait_ms": 0.25623183524558335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355291820707776, "StateBufferConnector_ms": 0.0022672471545991443, "ViewRequirementAgentConnector_ms": 0.06108397529238746}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760061.8831611885, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539954077160951, "mean_inference_ms": 5.2241013043138285, "mean_action_processing_ms": 0.14520427546279932, "mean_env_wait_ms": 0.25623183524558335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355291820707776, "StateBufferConnector_ms": 0.0022672471545991443, "ViewRequirementAgentConnector_ms": 0.06108397529238746}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 1953.805, "learn_time_ms": 19.111, "learn_throughput": 17581.354, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-36", "timestamp": 1706194416, "time_this_iter_s": 1.9449148178100586, "time_total_s": 164.88697743415833, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823591a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 164.88697743415833, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.45, "ram_util_percent": 15.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.871276233929523e+16, "policy_entropy": 265.26416015625, "var_gnorm": 22.668588638305664, "vf_loss": 5199835430912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 85, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760262.1280608097, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399728040686306, "mean_inference_ms": 5.224044430271917, "mean_action_processing_ms": 0.14519944030228285, "mean_env_wait_ms": 0.2562222072478891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535191255457261, "StateBufferConnector_ms": 0.0022689033957088694, "ViewRequirementAgentConnector_ms": 0.06111593807444853}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760262.1280608097, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399728040686306, "mean_inference_ms": 5.224044430271917, "mean_action_processing_ms": 0.14519944030228285, "mean_env_wait_ms": 0.2562222072478891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535191255457261, "StateBufferConnector_ms": 0.0022689033957088694, "ViewRequirementAgentConnector_ms": 0.06111593807444853}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 1954.661, "learn_time_ms": 19.15, "learn_throughput": 17545.456, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-38", "timestamp": 1706194418, "time_this_iter_s": 1.9635803699493408, "time_total_s": 166.85055780410767, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1210>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 166.85055780410767, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.466666666666668, "ram_util_percent": 16.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7561206172745728.0, "policy_entropy": 260.99359130859375, "var_gnorm": 22.66859245300293, "vf_loss": 4770642788352.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.445148468017578e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 86, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760120.6948504015, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399939976536398, "mean_inference_ms": 5.224000926277964, "mean_action_processing_ms": 0.14519482943402717, "mean_env_wait_ms": 0.256212941533327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352770339610964, "StateBufferConnector_ms": 0.0022699666577716206, "ViewRequirementAgentConnector_ms": 0.06115963292676349}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760120.6948504015, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399939976536398, "mean_inference_ms": 5.224000926277964, "mean_action_processing_ms": 0.14519482943402717, "mean_env_wait_ms": 0.256212941533327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352770339610964, "StateBufferConnector_ms": 0.0022699666577716206, "ViewRequirementAgentConnector_ms": 0.06115963292676349}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 1956.929, "learn_time_ms": 19.146, "learn_throughput": 17548.974, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-40", "timestamp": 1706194420, "time_this_iter_s": 1.993804693222046, "time_total_s": 168.8443624973297, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dfaf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dbd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 168.8443624973297, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 16.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.457783465980723e+16, "policy_entropy": 261.6138000488281, "var_gnorm": 22.668594360351562, "vf_loss": 4559008694272.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 87, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759774.5521766432, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400167569514542, "mean_inference_ms": 5.22395831852455, "mean_action_processing_ms": 0.14519037811650687, "mean_env_wait_ms": 0.25620399077922246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535717098192237, "StateBufferConnector_ms": 0.0022710054770283318, "ViewRequirementAgentConnector_ms": 0.061199856900620735}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759774.5521766432, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400167569514542, "mean_inference_ms": 5.22395831852455, "mean_action_processing_ms": 0.14519037811650687, "mean_env_wait_ms": 0.25620399077922246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535717098192237, "StateBufferConnector_ms": 0.0022710054770283318, "ViewRequirementAgentConnector_ms": 0.061199856900620735}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 1957.424, "learn_time_ms": 19.186, "learn_throughput": 17512.795, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-42", "timestamp": 1706194422, "time_this_iter_s": 1.963942527770996, "time_total_s": 170.8083050251007, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2020>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 170.8083050251007, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.259305323547853e+16, "policy_entropy": 261.7713928222656, "var_gnorm": 22.668596267700195, "vf_loss": 4854165536768.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.361701965332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 88, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759565.9113145373, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540039144433675, "mean_inference_ms": 5.223913756605576, "mean_action_processing_ms": 0.14518590350959995, "mean_env_wait_ms": 0.2561950585569638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015357949516989967, "StateBufferConnector_ms": 0.0022701241753318095, "ViewRequirementAgentConnector_ms": 0.06121857599778609}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759565.9113145373, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540039144433675, "mean_inference_ms": 5.223913756605576, "mean_action_processing_ms": 0.14518590350959995, "mean_env_wait_ms": 0.2561950585569638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015357949516989967, "StateBufferConnector_ms": 0.0022701241753318095, "ViewRequirementAgentConnector_ms": 0.06121857599778609}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1956.972, "learn_time_ms": 19.146, "learn_throughput": 17548.93, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-44", "timestamp": 1706194424, "time_this_iter_s": 1.9545714855194092, "time_total_s": 172.76287651062012, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f16f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.76287651062012, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7590102175842304.0, "policy_entropy": 269.0011901855469, "var_gnorm": 22.668596267700195, "vf_loss": 5103096954880.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.647804260253906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 89, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759721.2607858683, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540060883644845, "mean_inference_ms": 5.223869880792909, "mean_action_processing_ms": 0.14518150089249357, "mean_env_wait_ms": 0.256186184002438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015350406089525544, "StateBufferConnector_ms": 0.0022703342223435305, "ViewRequirementAgentConnector_ms": 0.061230980948116}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759721.2607858683, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540060883644845, "mean_inference_ms": 5.223869880792909, "mean_action_processing_ms": 0.14518150089249357, "mean_env_wait_ms": 0.256186184002438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015350406089525544, "StateBufferConnector_ms": 0.0022703342223435305, "ViewRequirementAgentConnector_ms": 0.061230980948116}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 1960.096, "learn_time_ms": 19.13, "learn_throughput": 17564.284, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-46", "timestamp": 1706194426, "time_this_iter_s": 1.9613635540008545, "time_total_s": 174.72424006462097, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d6680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 174.72424006462097, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.884833863978189e+16, "policy_entropy": 262.88232421875, "var_gnorm": 22.668598175048828, "vf_loss": 5551625338880.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2782554626464844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 90, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760218.2990372512, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540083766265447, "mean_inference_ms": 5.223859906088022, "mean_action_processing_ms": 0.14517717988112136, "mean_env_wait_ms": 0.25617734810151543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015340646107991537, "StateBufferConnector_ms": 0.0022705396016438804, "ViewRequirementAgentConnector_ms": 0.06126721700032552}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760218.2990372512, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540083766265447, "mean_inference_ms": 5.223859906088022, "mean_action_processing_ms": 0.14517717988112136, "mean_env_wait_ms": 0.25617734810151543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015340646107991537, "StateBufferConnector_ms": 0.0022705396016438804, "ViewRequirementAgentConnector_ms": 0.06126721700032552}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 1969.241, "learn_time_ms": 19.133, "learn_throughput": 17561.658, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-48", "timestamp": 1706194428, "time_this_iter_s": 2.052631139755249, "time_total_s": 176.77687120437622, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dfb80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d6c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 176.77687120437622, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.4501524373504e+16, "policy_entropy": 261.3507080078125, "var_gnorm": 22.66860008239746, "vf_loss": 5088488194048.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 91, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760401.5555622502, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401058119034955, "mean_inference_ms": 5.223851632501171, "mean_action_processing_ms": 0.1451730143117553, "mean_env_wait_ms": 0.2561685442864507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015329790639353323, "StateBufferConnector_ms": 0.0022712644639905992, "ViewRequirementAgentConnector_ms": 0.061264404883751504}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760401.5555622502, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401058119034955, "mean_inference_ms": 5.223851632501171, "mean_action_processing_ms": 0.1451730143117553, "mean_env_wait_ms": 0.2561685442864507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015329790639353323, "StateBufferConnector_ms": 0.0022712644639905992, "ViewRequirementAgentConnector_ms": 0.061264404883751504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 1969.917, "learn_time_ms": 19.117, "learn_throughput": 17575.828, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-50", "timestamp": 1706194430, "time_this_iter_s": 1.9674043655395508, "time_total_s": 178.74427556991577, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce82b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 178.74427556991577, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 16.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6634514365284352.0, "policy_entropy": 260.64556884765625, "var_gnorm": 22.668601989746094, "vf_loss": 4469579317248.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.898143768310547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 92, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760032.0035796587, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540128164974041, "mean_inference_ms": 5.2238449846852415, "mean_action_processing_ms": 0.1451690428332158, "mean_env_wait_ms": 0.2561597115356607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015396138896112856, "StateBufferConnector_ms": 0.002271455267201299, "ViewRequirementAgentConnector_ms": 0.06129041962001635}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760032.0035796587, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540128164974041, "mean_inference_ms": 5.2238449846852415, "mean_action_processing_ms": 0.1451690428332158, "mean_env_wait_ms": 0.2561597115356607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015396138896112856, "StateBufferConnector_ms": 0.002271455267201299, "ViewRequirementAgentConnector_ms": 0.06129041962001635}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 1971.985, "learn_time_ms": 19.154, "learn_throughput": 17542.049, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-52", "timestamp": 1706194432, "time_this_iter_s": 1.9679231643676758, "time_total_s": 180.71219873428345, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d77f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 180.71219873428345, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 16.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0535923070533632e+16, "policy_entropy": 264.6582336425781, "var_gnorm": 22.668603897094727, "vf_loss": 4883995951104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1828880310058594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 93, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760018.1040710973, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401498594764, "mean_inference_ms": 5.223837211113941, "mean_action_processing_ms": 0.14516529636074219, "mean_env_wait_ms": 0.2561510743499746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015392098375546035, "StateBufferConnector_ms": 0.0022706165108629453, "ViewRequirementAgentConnector_ms": 0.06131587489958732}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760018.1040710973, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401498594764, "mean_inference_ms": 5.223837211113941, "mean_action_processing_ms": 0.14516529636074219, "mean_env_wait_ms": 0.2561510743499746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015392098375546035, "StateBufferConnector_ms": 0.0022706165108629453, "ViewRequirementAgentConnector_ms": 0.06131587489958732}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 1972.616, "learn_time_ms": 19.132, "learn_throughput": 17562.599, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-54", "timestamp": 1706194434, "time_this_iter_s": 1.960606336593628, "time_total_s": 182.67280507087708, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccead40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 182.67280507087708, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 16.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.730384021028864e+16, "policy_entropy": 264.30487060546875, "var_gnorm": 22.668603897094727, "vf_loss": 4994428305408.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.230571746826172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 94, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759997.8395485204, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540169661825698, "mean_inference_ms": 5.223824559470618, "mean_action_processing_ms": 0.1451613953010572, "mean_env_wait_ms": 0.2561424560472893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373686526684052, "StateBufferConnector_ms": 0.0022705565107629653, "ViewRequirementAgentConnector_ms": 0.06131466398847864}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -759997.8395485204, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540169661825698, "mean_inference_ms": 5.223824559470618, "mean_action_processing_ms": 0.1451613953010572, "mean_env_wait_ms": 0.2561424560472893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373686526684052, "StateBufferConnector_ms": 0.0022705565107629653, "ViewRequirementAgentConnector_ms": 0.06131466398847864}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 1972.805, "learn_time_ms": 19.088, "learn_throughput": 17603.029, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-56", "timestamp": 1706194436, "time_this_iter_s": 1.946814775466919, "time_total_s": 184.619619846344, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d7c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 184.619619846344, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5712938400743424.0, "policy_entropy": 259.81854248046875, "var_gnorm": 22.668603897094727, "vf_loss": 5370874429440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.230571746826172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 95, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760306.1386221274, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401864185712721, "mean_inference_ms": 5.223804165863246, "mean_action_processing_ms": 0.1451573718234651, "mean_env_wait_ms": 0.2561335326373757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359928733424136, "StateBufferConnector_ms": 0.002269242939196135, "ViewRequirementAgentConnector_ms": 0.06132251337954873}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760306.1386221274, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401864185712721, "mean_inference_ms": 5.223804165863246, "mean_action_processing_ms": 0.1451573718234651, "mean_env_wait_ms": 0.2561335326373757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359928733424136, "StateBufferConnector_ms": 0.002269242939196135, "ViewRequirementAgentConnector_ms": 0.06132251337954873}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 1970.106, "learn_time_ms": 19.075, "learn_throughput": 17614.888, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-53-58", "timestamp": 1706194438, "time_this_iter_s": 1.9366493225097656, "time_total_s": 186.55626916885376, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f7823430a60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823448940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 186.55626916885376, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.79575250976768e+16, "policy_entropy": 262.95880126953125, "var_gnorm": 22.668603897094727, "vf_loss": 4904067792896.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 96, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760251.6905481761, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402023886582641, "mean_inference_ms": 5.223784103251918, "mean_action_processing_ms": 0.14515351830135878, "mean_env_wait_ms": 0.25612454934847584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015356640021006266, "StateBufferConnector_ms": 0.0022689501444498696, "ViewRequirementAgentConnector_ms": 0.06133566300074259}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760251.6905481761, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402023886582641, "mean_inference_ms": 5.223784103251918, "mean_action_processing_ms": 0.14515351830135878, "mean_env_wait_ms": 0.25612454934847584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015356640021006266, "StateBufferConnector_ms": 0.0022689501444498696, "ViewRequirementAgentConnector_ms": 0.06133566300074259}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1966.997, "learn_time_ms": 19.099, "learn_throughput": 17592.415, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-00", "timestamp": 1706194440, "time_this_iter_s": 1.962742567062378, "time_total_s": 188.51901173591614, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d6320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 188.51901173591614, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.563491040834355e+16, "policy_entropy": 264.3869934082031, "var_gnorm": 22.66860580444336, "vf_loss": 5498753515520.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 97, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760612.1220370925, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402177976470668, "mean_inference_ms": 5.223763311384486, "mean_action_processing_ms": 0.14514969009277667, "mean_env_wait_ms": 0.25611535935689933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339163160815681, "StateBufferConnector_ms": 0.002268417594359093, "ViewRequirementAgentConnector_ms": 0.06132912390010873}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760612.1220370925, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402177976470668, "mean_inference_ms": 5.223763311384486, "mean_action_processing_ms": 0.14514969009277667, "mean_env_wait_ms": 0.25611535935689933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339163160815681, "StateBufferConnector_ms": 0.002268417594359093, "ViewRequirementAgentConnector_ms": 0.06132912390010873}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 1966.459, "learn_time_ms": 19.092, "learn_throughput": 17598.632, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-02", "timestamp": 1706194442, "time_this_iter_s": 1.9586210250854492, "time_total_s": 190.4776327610016, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823448ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 190.4776327610016, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 17.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.211563728319283e+16, "policy_entropy": 261.14154052734375, "var_gnorm": 22.668607711791992, "vf_loss": 5063980351488.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4332275390625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 98, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760731.4965480741, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402347804065153, "mean_inference_ms": 5.223746521676843, "mean_action_processing_ms": 0.14514615408072912, "mean_env_wait_ms": 0.2561065476411834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336396742840203, "StateBufferConnector_ms": 0.002268139196901905, "ViewRequirementAgentConnector_ms": 0.06133609888504962}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760731.4965480741, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402347804065153, "mean_inference_ms": 5.223746521676843, "mean_action_processing_ms": 0.14514615408072912, "mean_env_wait_ms": 0.2561065476411834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336396742840203, "StateBufferConnector_ms": 0.002268139196901905, "ViewRequirementAgentConnector_ms": 0.06133609888504962}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 1968.745, "learn_time_ms": 19.151, "learn_throughput": 17544.604, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-04", "timestamp": 1706194444, "time_this_iter_s": 1.9774763584136963, "time_total_s": 192.45510911941528, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb5b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5e10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 192.45510911941528, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 17.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.349937832453734e+16, "policy_entropy": 263.1044921875, "var_gnorm": 22.668607711791992, "vf_loss": 4980406222848.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.100799560546875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 99, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760909.063389007, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402541571665854, "mean_inference_ms": 5.223734571143894, "mean_action_processing_ms": 0.14514301491899645, "mean_env_wait_ms": 0.25609821591711734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335853653724748, "StateBufferConnector_ms": 0.0022690705578736585, "ViewRequirementAgentConnector_ms": 0.061349916939783575}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760909.063389007, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402541571665854, "mean_inference_ms": 5.223734571143894, "mean_action_processing_ms": 0.14514301491899645, "mean_env_wait_ms": 0.25609821591711734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335853653724748, "StateBufferConnector_ms": 0.0022690705578736585, "ViewRequirementAgentConnector_ms": 0.061349916939783575}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 1970.76, "learn_time_ms": 19.191, "learn_throughput": 17508.465, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-06", "timestamp": 1706194446, "time_this_iter_s": 1.9815702438354492, "time_total_s": 194.43667936325073, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823448b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 194.43667936325073, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0234194101796864e+16, "policy_entropy": 263.323974609375, "var_gnorm": 22.668607711791992, "vf_loss": 4722012454912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.933906555175781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 100, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760712.5584857579, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402739535159995, "mean_inference_ms": 5.223723895344775, "mean_action_processing_ms": 0.14514002088540778, "mean_env_wait_ms": 0.2560901999785774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359878540039062, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.061368465423583984}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -1011863.0442888482, "episode_reward_mean": -760712.5584857579, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1011863.0442888482, -820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402739535159995, "mean_inference_ms": 5.223723895344775, "mean_action_processing_ms": 0.14514002088540778, "mean_env_wait_ms": 0.2560901999785774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359878540039062, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.061368465423583984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1962.346, "learn_time_ms": 19.198, "learn_throughput": 17501.812, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-08", "timestamp": 1706194448, "time_this_iter_s": 1.9685308933258057, "time_total_s": 196.40521025657654, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f16c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d9750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 196.40521025657654, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.121023080503706e+16, "policy_entropy": 262.8304443359375, "var_gnorm": 22.668609619140625, "vf_loss": 5162686480384.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.159046173095703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 101, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -913770.2361822752, "episode_reward_mean": -758197.8026178005, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400259945197164, "mean_inference_ms": 5.223794990477034, "mean_action_processing_ms": 0.14511393392278454, "mean_env_wait_ms": 0.2560290969844196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361547470092773, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.06136965751647949}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -913770.2361822752, "episode_reward_mean": -758197.8026178005, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-820620.1443493125, -913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400259945197164, "mean_inference_ms": 5.223794990477034, "mean_action_processing_ms": 0.14511393392278454, "mean_env_wait_ms": 0.2560290969844196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361547470092773, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.06136965751647949}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 1963.718, "learn_time_ms": 19.276, "learn_throughput": 17431.305, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-10", "timestamp": 1706194450, "time_this_iter_s": 1.9811863899230957, "time_total_s": 198.38639664649963, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceba90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 198.38639664649963, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 17.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.5341166312423424e+16, "policy_entropy": 262.215576171875, "var_gnorm": 22.668609619140625, "vf_loss": 5075712868352.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 102, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -913770.2361822752, "episode_reward_mean": -757707.6389515082, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398238662691527, "mean_inference_ms": 5.22373452608534, "mean_action_processing_ms": 0.1450850629628816, "mean_env_wait_ms": 0.25597943201607803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538228988647461, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.061437129974365234}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -913770.2361822752, "episode_reward_mean": -757707.6389515082, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-913770.2361822752, -870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398238662691527, "mean_inference_ms": 5.22373452608534, "mean_action_processing_ms": 0.1450850629628816, "mean_env_wait_ms": 0.25597943201607803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538228988647461, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.061437129974365234}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 1964.114, "learn_time_ms": 19.348, "learn_throughput": 17366.392, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-12", "timestamp": 1706194452, "time_this_iter_s": 1.971898078918457, "time_total_s": 200.3582947254181, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1ad1e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d7400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 200.3582947254181, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 17.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.600536984728371e+16, "policy_entropy": 262.71673583984375, "var_gnorm": 22.668609619140625, "vf_loss": 5371490992128.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 103, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -881348.1327847885, "episode_reward_mean": -756587.3539774342, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396210615585038, "mean_inference_ms": 5.223611584900839, "mean_action_processing_ms": 0.14505411657592263, "mean_env_wait_ms": 0.25591950973446936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015353202819824219, "StateBufferConnector_ms": 0.00226593017578125, "ViewRequirementAgentConnector_ms": 0.06145668029785156}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -881348.1327847885, "episode_reward_mean": -756587.3539774342, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-870790.3114457676, -881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396210615585038, "mean_inference_ms": 5.223611584900839, "mean_action_processing_ms": 0.14505411657592263, "mean_env_wait_ms": 0.25591950973446936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015353202819824219, "StateBufferConnector_ms": 0.00226593017578125, "ViewRequirementAgentConnector_ms": 0.06145668029785156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 1966.5, "learn_time_ms": 19.383, "learn_throughput": 17334.947, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-14", "timestamp": 1706194454, "time_this_iter_s": 1.9845292568206787, "time_total_s": 202.34282398223877, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea110>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dae60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.34282398223877, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 17.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1479308342132736e+16, "policy_entropy": 267.235107421875, "var_gnorm": 22.668611526489258, "vf_loss": 5193397698560.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1948089599609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 104, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -881348.1327847885, "episode_reward_mean": -755532.7782534141, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539560472767392, "mean_inference_ms": 5.223546282186942, "mean_action_processing_ms": 0.14503311953062728, "mean_env_wait_ms": 0.2558842074430469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361785888671875, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06148123741149902}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -881348.1327847885, "episode_reward_mean": -755532.7782534141, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-881348.1327847885, -758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539560472767392, "mean_inference_ms": 5.223546282186942, "mean_action_processing_ms": 0.14503311953062728, "mean_env_wait_ms": 0.2558842074430469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015361785888671875, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06148123741149902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1967.924, "learn_time_ms": 19.616, "learn_throughput": 17128.763, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-16", "timestamp": 1706194456, "time_this_iter_s": 1.9610767364501953, "time_total_s": 204.30390071868896, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 204.30390071868896, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 17.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.753331117785088e+16, "policy_entropy": 262.7960510253906, "var_gnorm": 22.668611526489258, "vf_loss": 5128921284608.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 105, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754487.5728572343, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395813521018373, "mean_inference_ms": 5.223550373019515, "mean_action_processing_ms": 0.14502017113267388, "mean_env_wait_ms": 0.25586175467439015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015385150909423828, "StateBufferConnector_ms": 0.002265453338623047, "ViewRequirementAgentConnector_ms": 0.0615231990814209}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754487.5728572343, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758279.7272651849, -744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395813521018373, "mean_inference_ms": 5.223550373019515, "mean_action_processing_ms": 0.14502017113267388, "mean_env_wait_ms": 0.25586175467439015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015385150909423828, "StateBufferConnector_ms": 0.002265453338623047, "ViewRequirementAgentConnector_ms": 0.0615231990814209}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 1972.119, "learn_time_ms": 19.634, "learn_throughput": 17113.475, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-18", "timestamp": 1706194458, "time_this_iter_s": 1.9786005020141602, "time_total_s": 206.28250122070312, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceba90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 206.28250122070312, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.828283423804621e+16, "policy_entropy": 259.2197265625, "var_gnorm": 22.668611526489258, "vf_loss": 4395996020736.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9458274841308594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 106, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754135.5408001861, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396453225787812, "mean_inference_ms": 5.223608794371124, "mean_action_processing_ms": 0.14501161776083707, "mean_env_wait_ms": 0.25584597008341525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015401124954223633, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06155204772949219}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754135.5408001861, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-744954.7440784589, -717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15396453225787812, "mean_inference_ms": 5.223608794371124, "mean_action_processing_ms": 0.14501161776083707, "mean_env_wait_ms": 0.25584597008341525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015401124954223633, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06155204772949219}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 1975.766, "learn_time_ms": 19.644, "learn_throughput": 17104.191, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-20", "timestamp": 1706194460, "time_this_iter_s": 1.9992272853851318, "time_total_s": 208.28172850608826, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1ca6e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 208.28172850608826, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3804670472486912.0, "policy_entropy": 261.3922424316406, "var_gnorm": 22.668611526489258, "vf_loss": 5188362960896.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.445148468017578e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 107, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754571.1137588669, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397204421374625, "mean_inference_ms": 5.223639591408219, "mean_action_processing_ms": 0.1450033697972094, "mean_env_wait_ms": 0.25583024834940266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417337417602539, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06156349182128906}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -809869.6371103827, "episode_reward_mean": -754571.1137588669, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-717262.044544897, -717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397204421374625, "mean_inference_ms": 5.223639591408219, "mean_action_processing_ms": 0.1450033697972094, "mean_env_wait_ms": 0.25583024834940266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015417337417602539, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06156349182128906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 1979.084, "learn_time_ms": 19.657, "learn_throughput": 17092.989, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-22", "timestamp": 1706194462, "time_this_iter_s": 1.991802453994751, "time_total_s": 210.273530960083, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344a170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 210.273530960083, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 17.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1169586439258112e+16, "policy_entropy": 262.83489990234375, "var_gnorm": 22.668611526489258, "vf_loss": 6009862488064.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.457069396972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 108, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -830547.836005254, "episode_reward_mean": -755703.9716734705, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539802679084245, "mean_inference_ms": 5.223651002920122, "mean_action_processing_ms": 0.14499525256084778, "mean_env_wait_ms": 0.25581602724364677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433549880981445, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06161832809448242}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -830547.836005254, "episode_reward_mean": -755703.9716734705, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-717434.2757489405, -657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539802679084245, "mean_inference_ms": 5.223651002920122, "mean_action_processing_ms": 0.14499525256084778, "mean_env_wait_ms": 0.25581602724364677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433549880981445, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06161832809448242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 1979.162, "learn_time_ms": 19.61, "learn_throughput": 17134.178, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-24", "timestamp": 1706194464, "time_this_iter_s": 1.9782583713531494, "time_total_s": 212.25178933143616, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1ca230>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 212.25178933143616, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 18.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.757919431347405e+16, "policy_entropy": 258.9568786621094, "var_gnorm": 22.66861343383789, "vf_loss": 5046787375104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.600120544433594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 109, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -657996.5570036542, "episode_reward_min": -830547.836005254, "episode_reward_mean": -756211.8681438762, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399011505182547, "mean_inference_ms": 5.223706902013617, "mean_action_processing_ms": 0.14498918684303758, "mean_env_wait_ms": 0.2558028573572199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015451192855834961, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06165719032287598}}, "episode_reward_max": -657996.5570036542, "episode_reward_min": -830547.836005254, "episode_reward_mean": -756211.8681438762, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-657996.5570036542, -690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399011505182547, "mean_inference_ms": 5.223706902013617, "mean_action_processing_ms": 0.14498918684303758, "mean_env_wait_ms": 0.2558028573572199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015451192855834961, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06165719032287598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 1977.913, "learn_time_ms": 19.579, "learn_throughput": 17160.863, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-26", "timestamp": 1706194466, "time_this_iter_s": 1.9690706729888916, "time_total_s": 214.22086000442505, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce94b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823448ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 214.22086000442505, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 18.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.341115001608602e+16, "policy_entropy": 258.9775390625, "var_gnorm": 22.66861343383789, "vf_loss": 5018113540096.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 110, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -757210.4144276727, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399894058697952, "mean_inference_ms": 5.223726276574326, "mean_action_processing_ms": 0.14498276851586206, "mean_env_wait_ms": 0.25578864017792535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544642448425293, "StateBufferConnector_ms": 0.002263784408569336, "ViewRequirementAgentConnector_ms": 0.061673879623413086}}, "episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -757210.4144276727, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-690499.0597333153, -733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399894058697952, "mean_inference_ms": 5.223726276574326, "mean_action_processing_ms": 0.14498276851586206, "mean_env_wait_ms": 0.25578864017792535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544642448425293, "StateBufferConnector_ms": 0.002263784408569336, "ViewRequirementAgentConnector_ms": 0.061673879623413086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 1977.321, "learn_time_ms": 19.531, "learn_throughput": 17202.99, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-28", "timestamp": 1706194468, "time_this_iter_s": 1.962585210800171, "time_total_s": 216.18344521522522, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344a950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 216.18344521522522, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 18.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.685332766058086e+16, "policy_entropy": 264.3959045410156, "var_gnorm": 22.66861343383789, "vf_loss": 5263846801408.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6835670471191406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 111, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -758154.8866236809, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540073106691292, "mean_inference_ms": 5.223714575702522, "mean_action_processing_ms": 0.14497628374672378, "mean_env_wait_ms": 0.2557756141297444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462398529052734, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.061693668365478516}}, "episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -758154.8866236809, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-733867.7866249959, -712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540073106691292, "mean_inference_ms": 5.223714575702522, "mean_action_processing_ms": 0.14497628374672378, "mean_env_wait_ms": 0.2557756141297444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015462398529052734, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.061693668365478516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 1976.156, "learn_time_ms": 19.454, "learn_throughput": 17271.553, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-30", "timestamp": 1706194470, "time_this_iter_s": 1.9695370197296143, "time_total_s": 218.15298223495483, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccebc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d7010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 218.15298223495483, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.106980013427917e+16, "policy_entropy": 262.37060546875, "var_gnorm": 22.66861343383789, "vf_loss": 5665753923584.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 112, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -758873.0907727316, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401906128628198, "mean_inference_ms": 5.223764189187625, "mean_action_processing_ms": 0.14497262241744008, "mean_env_wait_ms": 0.255766187115146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015480279922485352, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.06172060966491699}}, "episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -758873.0907727316, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-712260.3248305488, -680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401906128628198, "mean_inference_ms": 5.223764189187625, "mean_action_processing_ms": 0.14497262241744008, "mean_env_wait_ms": 0.255766187115146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015480279922485352, "StateBufferConnector_ms": 0.0022661685943603516, "ViewRequirementAgentConnector_ms": 0.06172060966491699}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1974.981, "learn_time_ms": 19.348, "learn_throughput": 17366.541, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-32", "timestamp": 1706194472, "time_this_iter_s": 1.9601550102233887, "time_total_s": 220.11313724517822, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c8f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 220.11313724517822, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 18.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2544360373551104e+16, "policy_entropy": 255.1915283203125, "var_gnorm": 22.66861343383789, "vf_loss": 4821913436160.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.528594970703125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 113, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -759274.1080511629, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15403088326588243, "mean_inference_ms": 5.223819045954894, "mean_action_processing_ms": 0.14496935237226619, "mean_env_wait_ms": 0.2557565437716885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01548147201538086, "StateBufferConnector_ms": 0.002266407012939453, "ViewRequirementAgentConnector_ms": 0.061739444732666016}}, "episode_reward_max": -680339.7400313132, "episode_reward_min": -830547.836005254, "episode_reward_mean": -759274.1080511629, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-680339.7400313132, -704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15403088326588243, "mean_inference_ms": 5.223819045954894, "mean_action_processing_ms": 0.14496935237226619, "mean_env_wait_ms": 0.2557565437716885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01548147201538086, "StateBufferConnector_ms": 0.002266407012939453, "ViewRequirementAgentConnector_ms": 0.061739444732666016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 1974.342, "learn_time_ms": 19.313, "learn_throughput": 17397.929, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-34", "timestamp": 1706194474, "time_this_iter_s": 1.9781320095062256, "time_total_s": 222.09126925468445, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344b250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 222.09126925468445, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 18.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5406272367099904.0, "policy_entropy": 263.464111328125, "var_gnorm": 22.66861343383789, "vf_loss": 4822895427584.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.504753112792969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 114, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -759983.9356956295, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540431416559995, "mean_inference_ms": 5.223874468112114, "mean_action_processing_ms": 0.14496713590004842, "mean_env_wait_ms": 0.25574958293173167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489816665649414, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.061756134033203125}}, "episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -759983.9356956295, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-704693.375427921, -725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540431416559995, "mean_inference_ms": 5.223874468112114, "mean_action_processing_ms": 0.14496713590004842, "mean_env_wait_ms": 0.25574958293173167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489816665649414, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.061756134033203125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 1975.027, "learn_time_ms": 19.118, "learn_throughput": 17575.061, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-36", "timestamp": 1706194476, "time_this_iter_s": 1.9679193496704102, "time_total_s": 224.05918860435486, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dacb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 224.05918860435486, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.466666666666666, "ram_util_percent": 18.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.043350233173197e+16, "policy_entropy": 259.5469970703125, "var_gnorm": 22.66861343383789, "vf_loss": 4548167467008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9577484130859375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 115, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -760376.3510837487, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15405459816832784, "mean_inference_ms": 5.223890082631621, "mean_action_processing_ms": 0.14496482083511736, "mean_env_wait_ms": 0.2557428715836007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433788299560547, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.061774492263793945}}, "episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -760376.3510837487, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-725974.5045716387, -691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15405459816832784, "mean_inference_ms": 5.223890082631621, "mean_action_processing_ms": 0.14496482083511736, "mean_env_wait_ms": 0.2557428715836007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015433788299560547, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.061774492263793945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 1974.42, "learn_time_ms": 19.238, "learn_throughput": 17465.264, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-38", "timestamp": 1706194478, "time_this_iter_s": 1.972508430480957, "time_total_s": 226.03169703483582, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 226.03169703483582, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1263102909677568e+16, "policy_entropy": 262.2744445800781, "var_gnorm": 22.66861343383789, "vf_loss": 5510550519808.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.218650817871094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 116, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761076.9572922282, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406632793866523, "mean_inference_ms": 5.2239027581804445, "mean_action_processing_ms": 0.1449625157245061, "mean_env_wait_ms": 0.2557369633287785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445232391357422, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06182217597961426}}, "episode_reward_max": -691380.4530079147, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761076.9572922282, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-691380.4530079147, -697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406632793866523, "mean_inference_ms": 5.2239027581804445, "mean_action_processing_ms": 0.1449625157245061, "mean_env_wait_ms": 0.2557369633287785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445232391357422, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06182217597961426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 1971.045, "learn_time_ms": 19.214, "learn_throughput": 17487.326, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-40", "timestamp": 1706194480, "time_this_iter_s": 1.9654879570007324, "time_total_s": 227.99718499183655, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1060>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344b9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 227.99718499183655, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 18.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8064957518184448.0, "policy_entropy": 259.5557861328125, "var_gnorm": 22.66861343383789, "vf_loss": 4749625131008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7670135498046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 117, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -691488.4021961623, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761599.3376480547, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540782212661909, "mean_inference_ms": 5.223942708090725, "mean_action_processing_ms": 0.14496052636910706, "mean_env_wait_ms": 0.2557318322297074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015457391738891602, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.061852216720581055}}, "episode_reward_max": -691488.4021961623, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761599.3376480547, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-697171.9603005153, -691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540782212661909, "mean_inference_ms": 5.223942708090725, "mean_action_processing_ms": 0.14496052636910706, "mean_env_wait_ms": 0.2557318322297074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015457391738891602, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.061852216720581055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 1969.297, "learn_time_ms": 19.132, "learn_throughput": 17562.227, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-42", "timestamp": 1706194482, "time_this_iter_s": 1.9743037223815918, "time_total_s": 229.97148871421814, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce98a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234480d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 229.97148871421814, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 18.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.5016907018993664e+16, "policy_entropy": 264.84326171875, "var_gnorm": 22.66861343383789, "vf_loss": 5096490926080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.647804260253906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 118, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -691488.4021961623, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762281.1729024136, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408967351836814, "mean_inference_ms": 5.22396195467113, "mean_action_processing_ms": 0.1449581912768057, "mean_env_wait_ms": 0.2557251764321714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015455245971679688, "StateBufferConnector_ms": 0.0022656917572021484, "ViewRequirementAgentConnector_ms": 0.06185460090637207}}, "episode_reward_max": -691488.4021961623, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762281.1729024136, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-691488.4021961623, -725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408967351836814, "mean_inference_ms": 5.22396195467113, "mean_action_processing_ms": 0.1449581912768057, "mean_env_wait_ms": 0.2557251764321714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015455245971679688, "StateBufferConnector_ms": 0.0022656917572021484, "ViewRequirementAgentConnector_ms": 0.06185460090637207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 1969.032, "learn_time_ms": 19.129, "learn_throughput": 17565.182, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-44", "timestamp": 1706194484, "time_this_iter_s": 1.975595235824585, "time_total_s": 231.94708395004272, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c97b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344af80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 231.94708395004272, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0239804402827264e+16, "policy_entropy": 261.902587890625, "var_gnorm": 22.66861343383789, "vf_loss": 5125086117888.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.647804260253906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 119, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762983.6968512189, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410152532785787, "mean_inference_ms": 5.223979571301073, "mean_action_processing_ms": 0.14495587356625347, "mean_env_wait_ms": 0.25571842856402777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015467166900634766, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06187796592712402}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762983.6968512189, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-725522.9945578594, -726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410152532785787, "mean_inference_ms": 5.223979571301073, "mean_action_processing_ms": 0.14495587356625347, "mean_env_wait_ms": 0.25571842856402777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015467166900634766, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.06187796592712402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 1966.632, "learn_time_ms": 19.148, "learn_throughput": 17547.881, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-46", "timestamp": 1706194486, "time_this_iter_s": 1.9450817108154297, "time_total_s": 233.89216566085815, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344bf40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.89216566085815, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 18.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7366857828859904.0, "policy_entropy": 259.3472595214844, "var_gnorm": 22.66861343383789, "vf_loss": 4869383520256.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 120, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763188.0564448993, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541140301440425, "mean_inference_ms": 5.224007337251367, "mean_action_processing_ms": 0.14495426207908615, "mean_env_wait_ms": 0.2557132754412353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015478849411010742, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06189322471618652}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763188.0564448993, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726878.1394908063, -747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541140301440425, "mean_inference_ms": 5.224007337251367, "mean_action_processing_ms": 0.14495426207908615, "mean_env_wait_ms": 0.2557132754412353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015478849411010742, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.06189322471618652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1967.208, "learn_time_ms": 19.212, "learn_throughput": 17488.628, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-48", "timestamp": 1706194488, "time_this_iter_s": 1.968324899673462, "time_total_s": 235.86049056053162, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3b730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344b640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 235.86049056053162, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 19.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2894349738180608.0, "policy_entropy": 264.1629943847656, "var_gnorm": 22.66861343383789, "vf_loss": 5018522484736.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5881996154785156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 121, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763746.0842944491, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412648409227309, "mean_inference_ms": 5.22401951883809, "mean_action_processing_ms": 0.14495253533515445, "mean_env_wait_ms": 0.2557080480464756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491247177124023, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.061911821365356445}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763746.0842944491, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747379.1678418485, -787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412648409227309, "mean_inference_ms": 5.22401951883809, "mean_action_processing_ms": 0.14495253533515445, "mean_env_wait_ms": 0.2557080480464756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491247177124023, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.061911821365356445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 1967.752, "learn_time_ms": 19.294, "learn_throughput": 17415.042, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-50", "timestamp": 1706194490, "time_this_iter_s": 1.9750657081604004, "time_total_s": 237.83555626869202, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceabc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d5cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 237.83555626869202, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 19.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3681699925786624e+16, "policy_entropy": 260.3211364746094, "var_gnorm": 22.66861343383789, "vf_loss": 4750616559616.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5881996154785156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 122, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763674.0356981924, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413805968455796, "mean_inference_ms": 5.224033298058106, "mean_action_processing_ms": 0.14495085696030954, "mean_env_wait_ms": 0.2557038812711056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015501737594604492, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.06190943717956543}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763674.0356981924, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-787242.3665880805, -724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413805968455796, "mean_inference_ms": 5.224033298058106, "mean_action_processing_ms": 0.14495085696030954, "mean_env_wait_ms": 0.2557038812711056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015501737594604492, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.06190943717956543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 1968.135, "learn_time_ms": 19.368, "learn_throughput": 17347.985, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-52", "timestamp": 1706194492, "time_this_iter_s": 1.9639465808868408, "time_total_s": 239.79950284957886, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823488700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 239.79950284957886, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 19.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.125940576052838e+16, "policy_entropy": 258.93426513671875, "var_gnorm": 22.66861343383789, "vf_loss": 5073509285888.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.325939178466797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 123, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763367.513197035, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15414966741953534, "mean_inference_ms": 5.22406646199637, "mean_action_processing_ms": 0.14494978880804532, "mean_env_wait_ms": 0.2557011282066001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015487194061279297, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.06193256378173828}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763367.513197035, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-724281.9139334534, -735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15414966741953534, "mean_inference_ms": 5.22406646199637, "mean_action_processing_ms": 0.14494978880804532, "mean_env_wait_ms": 0.2557011282066001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015487194061279297, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.06193256378173828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 1969.332, "learn_time_ms": 19.379, "learn_throughput": 17337.954, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-54", "timestamp": 1706194494, "time_this_iter_s": 1.990086555480957, "time_total_s": 241.78958940505981, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea5c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344ab00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 241.78958940505981, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 19.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.609810115638067e+16, "policy_entropy": 262.04095458984375, "var_gnorm": 22.66861343383789, "vf_loss": 4652941705216.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 124, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763516.5338014971, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15416134091867661, "mean_inference_ms": 5.2241072321042745, "mean_action_processing_ms": 0.14494893450374455, "mean_env_wait_ms": 0.25569816513108395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0155029296875, "StateBufferConnector_ms": 0.002269268035888672, "ViewRequirementAgentConnector_ms": 0.06194138526916504}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763516.5338014971, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-735512.1054644075, -736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15416134091867661, "mean_inference_ms": 5.2241072321042745, "mean_action_processing_ms": 0.14494893450374455, "mean_env_wait_ms": 0.25569816513108395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0155029296875, "StateBufferConnector_ms": 0.002269268035888672, "ViewRequirementAgentConnector_ms": 0.06194138526916504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 1970.204, "learn_time_ms": 19.39, "learn_throughput": 17328.404, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-56", "timestamp": 1706194496, "time_this_iter_s": 1.976621389389038, "time_total_s": 243.76621079444885, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823488430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.76621079444885, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 19.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.157681216107315e+16, "policy_entropy": 261.17138671875, "var_gnorm": 22.66861343383789, "vf_loss": 5047127638016.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763784.4237118266, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417289386385521, "mean_inference_ms": 5.224152637869402, "mean_action_processing_ms": 0.1449486628122206, "mean_env_wait_ms": 0.25569673859201314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015496015548706055, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06194663047790527}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763784.4237118266, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736244.9429466974, -752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417289386385521, "mean_inference_ms": 5.224152637869402, "mean_action_processing_ms": 0.1449486628122206, "mean_env_wait_ms": 0.25569673859201314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015496015548706055, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06194663047790527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1970.433, "learn_time_ms": 19.28, "learn_throughput": 17427.77, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-54-58", "timestamp": 1706194498, "time_this_iter_s": 1.9747858047485352, "time_total_s": 245.7409965991974, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f33d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823488ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 245.7409965991974, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 19.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.404497848500224e+16, "policy_entropy": 262.81475830078125, "var_gnorm": 22.66861343383789, "vf_loss": 4980295598080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 126, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764092.4572282499, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15418155428926747, "mean_inference_ms": 5.224182874392419, "mean_action_processing_ms": 0.14494870603232404, "mean_env_wait_ms": 0.25569049161652907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015473127365112305, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06194424629211426}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764092.4572282499, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-752326.3402158449, -728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15418155428926747, "mean_inference_ms": 5.224182874392419, "mean_action_processing_ms": 0.14494870603232404, "mean_env_wait_ms": 0.25569049161652907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015473127365112305, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06194424629211426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 1973.082, "learn_time_ms": 19.362, "learn_throughput": 17353.945, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-00", "timestamp": 1706194500, "time_this_iter_s": 1.9919524192810059, "time_total_s": 247.7329490184784, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234495a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 247.7329490184784, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 19.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2897892289150976e+16, "policy_entropy": 263.4585266113281, "var_gnorm": 22.66861343383789, "vf_loss": 5087509348352.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.1948089599609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 127, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764306.794070455, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541892898057725, "mean_inference_ms": 5.224226038321288, "mean_action_processing_ms": 0.14494874541389094, "mean_env_wait_ms": 0.25568365313850155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015463829040527344, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06194615364074707}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764306.794070455, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-728832.577086521, -727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541892898057725, "mean_inference_ms": 5.224226038321288, "mean_action_processing_ms": 0.14494874541389094, "mean_env_wait_ms": 0.25568365313850155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015463829040527344, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06194615364074707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 1976.973, "learn_time_ms": 19.443, "learn_throughput": 17281.104, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-02", "timestamp": 1706194502, "time_this_iter_s": 2.013227701187134, "time_total_s": 249.74617671966553, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823488820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 249.74617671966553, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 19.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.30787383296e+16, "policy_entropy": 266.2012634277344, "var_gnorm": 22.66861343383789, "vf_loss": 4979810107392.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 128, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764718.709744403, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541965200593884, "mean_inference_ms": 5.224268327542484, "mean_action_processing_ms": 0.14494865116994624, "mean_env_wait_ms": 0.2556762221417183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015485763549804688, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.0621495246887207}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764718.709744403, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-727418.0999159499, -774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541965200593884, "mean_inference_ms": 5.224268327542484, "mean_action_processing_ms": 0.14494865116994624, "mean_env_wait_ms": 0.2556762221417183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015485763549804688, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.0621495246887207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1979.796, "learn_time_ms": 19.472, "learn_throughput": 17255.248, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-04", "timestamp": 1706194504, "time_this_iter_s": 2.0038421154022217, "time_total_s": 251.75001883506775, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9ff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 251.75001883506775, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 19.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4973131357749248.0, "policy_entropy": 259.30474853515625, "var_gnorm": 22.66861343383789, "vf_loss": 4996674879488.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.135204315185547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 129, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765117.8465336435, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15420342641383708, "mean_inference_ms": 5.224317018667235, "mean_action_processing_ms": 0.1449487524205219, "mean_env_wait_ms": 0.2556688337133041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015478134155273438, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.06214022636413574}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765117.8465336435, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-774444.6258065158, -758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15420342641383708, "mean_inference_ms": 5.224317018667235, "mean_action_processing_ms": 0.1449487524205219, "mean_env_wait_ms": 0.2556688337133041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015478134155273438, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.06214022636413574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 1985.461, "learn_time_ms": 19.46, "learn_throughput": 17265.839, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-06", "timestamp": 1706194506, "time_this_iter_s": 2.0017290115356445, "time_total_s": 253.7517478466034, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9c00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344aef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 253.7517478466034, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 19.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.5856551650525184e+16, "policy_entropy": 262.4501953125, "var_gnorm": 22.66861343383789, "vf_loss": 5100733464576.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.8848648071289062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 130, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764951.8703640949, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542099772237773, "mean_inference_ms": 5.224362089710589, "mean_action_processing_ms": 0.14494916223509677, "mean_env_wait_ms": 0.2556619945870958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015490055084228516, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.0621647834777832}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764951.8703640949, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758874.7003253334, -762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542099772237773, "mean_inference_ms": 5.224362089710589, "mean_action_processing_ms": 0.14494916223509677, "mean_env_wait_ms": 0.2556619945870958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015490055084228516, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.0621647834777832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 1985.092, "learn_time_ms": 19.378, "learn_throughput": 17338.957, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-08", "timestamp": 1706194508, "time_this_iter_s": 1.9646592140197754, "time_total_s": 255.71640706062317, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea560>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235dacb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 255.71640706062317, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 19.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.771278552137728e+16, "policy_entropy": 263.1095886230469, "var_gnorm": 22.66861343383789, "vf_loss": 5503219400704.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 131, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765486.436934976, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421658127850776, "mean_inference_ms": 5.224399656443066, "mean_action_processing_ms": 0.1449499972427463, "mean_env_wait_ms": 0.25565554313991756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489578247070312, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.06216263771057129}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765486.436934976, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-762962.7958304988, -747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421658127850776, "mean_inference_ms": 5.224399656443066, "mean_action_processing_ms": 0.1449499972427463, "mean_env_wait_ms": 0.25565554313991756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015489578247070312, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.06216263771057129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 1983.247, "learn_time_ms": 19.292, "learn_throughput": 17416.161, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-10", "timestamp": 1706194510, "time_this_iter_s": 1.9565317630767822, "time_total_s": 257.67293882369995, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234891b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 257.67293882369995, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 20.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.938751727901082e+16, "policy_entropy": 264.7706604003906, "var_gnorm": 22.66861343383789, "vf_loss": 5509286461440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.123283386230469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 132, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765914.0688093859, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422226115410514, "mean_inference_ms": 5.224427326802331, "mean_action_processing_ms": 0.14495097469386953, "mean_env_wait_ms": 0.2556475701993363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015505790710449219, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.06216788291931152}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765914.0688093859, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747411.3206470252, -748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422226115410514, "mean_inference_ms": 5.224427326802331, "mean_action_processing_ms": 0.14495097469386953, "mean_env_wait_ms": 0.2556475701993363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015505790710449219, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.06216788291931152}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 1984.117, "learn_time_ms": 19.543, "learn_throughput": 17192.685, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-12", "timestamp": 1706194512, "time_this_iter_s": 1.9726805686950684, "time_total_s": 259.645619392395, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8de0b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d7400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 259.645619392395, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 20.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.904511120362701e+16, "policy_entropy": 258.5963439941406, "var_gnorm": 22.66861343383789, "vf_loss": 4768077447168.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.5180320739746094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 133, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765939.0344413228, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422774948856507, "mean_inference_ms": 5.224455590717135, "mean_action_processing_ms": 0.1449522496942541, "mean_env_wait_ms": 0.25564027424462255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015504837036132812, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06218767166137695}}, "episode_reward_max": -712259.5686603062, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765939.0344413228, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-748256.8172972525, -790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422774948856507, "mean_inference_ms": 5.224455590717135, "mean_action_processing_ms": 0.1449522496942541, "mean_env_wait_ms": 0.25564027424462255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015504837036132812, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06218767166137695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 1980.543, "learn_time_ms": 19.622, "learn_throughput": 17123.602, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-14", "timestamp": 1706194514, "time_this_iter_s": 1.9543631076812744, "time_total_s": 261.5999825000763, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce97b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 261.5999825000763, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 20.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.133165999534899e+16, "policy_entropy": 260.521240234375, "var_gnorm": 22.66861343383789, "vf_loss": 4425688023040.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 134, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765552.4108146534, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423389736539794, "mean_inference_ms": 5.224498298179172, "mean_action_processing_ms": 0.14495399323755037, "mean_env_wait_ms": 0.25563389651111806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015503168106079102, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06216549873352051}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765552.4108146534, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-790924.195597968, -740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423389736539794, "mean_inference_ms": 5.224498298179172, "mean_action_processing_ms": 0.14495399323755037, "mean_env_wait_ms": 0.25563389651111806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015503168106079102, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06216549873352051}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 1982.134, "learn_time_ms": 19.637, "learn_throughput": 17110.276, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-16", "timestamp": 1706194516, "time_this_iter_s": 1.9925642013549805, "time_total_s": 263.5925467014313, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3af0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348a170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 263.5925467014313, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.941239372958925e+16, "policy_entropy": 261.6020202636719, "var_gnorm": 22.66861343383789, "vf_loss": 4689721032704.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 135, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765149.6612434281, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423956634673502, "mean_inference_ms": 5.224539913216269, "mean_action_processing_ms": 0.144955486600122, "mean_env_wait_ms": 0.25562778629035676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015609264373779297, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.062196969985961914}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765149.6612434281, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-740328.7860211082, -751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423956634673502, "mean_inference_ms": 5.224539913216269, "mean_action_processing_ms": 0.144955486600122, "mean_env_wait_ms": 0.25562778629035676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015609264373779297, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.062196969985961914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 1982.258, "learn_time_ms": 19.57, "learn_throughput": 17169.498, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-18", "timestamp": 1706194518, "time_this_iter_s": 1.976041555404663, "time_total_s": 265.56858825683594, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c9030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344af80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 265.56858825683594, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.405153018504806e+16, "policy_entropy": 264.5122985839844, "var_gnorm": 22.66861343383789, "vf_loss": 5537584381952.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 136, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765762.9616313674, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542449811856642, "mean_inference_ms": 5.224581439251275, "mean_action_processing_ms": 0.14495680419349966, "mean_env_wait_ms": 0.25562166187500274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619516372680664, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.062203168869018555}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765762.9616313674, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-751196.4124175111, -718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542449811856642, "mean_inference_ms": 5.224581439251275, "mean_action_processing_ms": 0.14495680419349966, "mean_env_wait_ms": 0.25562166187500274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619516372680664, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.062203168869018555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1979.717, "learn_time_ms": 19.506, "learn_throughput": 17225.363, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-20", "timestamp": 1706194520, "time_this_iter_s": 1.9665467739105225, "time_total_s": 267.53513503074646, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce92d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 267.53513503074646, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.075777935015936e+16, "policy_entropy": 264.3175354003906, "var_gnorm": 22.66861343383789, "vf_loss": 5046688284672.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 137, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765932.1293198476, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15424991797095106, "mean_inference_ms": 5.224621899633714, "mean_action_processing_ms": 0.1449579107183745, "mean_env_wait_ms": 0.25561552310636054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015624761581420898, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06224489212036133}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765932.1293198476, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-718362.5005117075, -750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15424991797095106, "mean_inference_ms": 5.224621899633714, "mean_action_processing_ms": 0.1449579107183745, "mean_env_wait_ms": 0.25561552310636054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015624761581420898, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06224489212036133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 1975.03, "learn_time_ms": 19.48, "learn_throughput": 17248.384, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-22", "timestamp": 1706194522, "time_this_iter_s": 1.9663724899291992, "time_total_s": 269.50150752067566, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9060>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823449900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 269.50150752067566, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.24733350445056e+16, "policy_entropy": 261.369140625, "var_gnorm": 22.66861343383789, "vf_loss": 4626608816128.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 138, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766130.7970676781, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15425487294206588, "mean_inference_ms": 5.2246613707028144, "mean_action_processing_ms": 0.14495907918936612, "mean_env_wait_ms": 0.2556095007059531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619993209838867, "StateBufferConnector_ms": 0.002269268035888672, "ViewRequirementAgentConnector_ms": 0.06225466728210449}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766130.7970676781, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-750147.9635005237, -786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15425487294206588, "mean_inference_ms": 5.2246613707028144, "mean_action_processing_ms": 0.14495907918936612, "mean_env_wait_ms": 0.2556095007059531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619993209838867, "StateBufferConnector_ms": 0.002269268035888672, "ViewRequirementAgentConnector_ms": 0.06225466728210449}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 1971.169, "learn_time_ms": 19.433, "learn_throughput": 17289.733, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-24", "timestamp": 1706194524, "time_this_iter_s": 1.9652197360992432, "time_total_s": 271.4667272567749, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceab90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 271.4667272567749, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 20.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.239542703036826e+16, "policy_entropy": 266.500732421875, "var_gnorm": 22.66861343383789, "vf_loss": 5342294441984.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 139, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766512.1048124636, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426021495004474, "mean_inference_ms": 5.224709062485058, "mean_action_processing_ms": 0.1449604437279266, "mean_env_wait_ms": 0.25560348847595643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015595436096191406, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.06226491928100586}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766512.1048124636, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-786573.9652579932, -784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426021495004474, "mean_inference_ms": 5.224709062485058, "mean_action_processing_ms": 0.1449604437279266, "mean_env_wait_ms": 0.25560348847595643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015595436096191406, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.06226491928100586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 1968.367, "learn_time_ms": 19.423, "learn_throughput": 17299.432, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-26", "timestamp": 1706194526, "time_this_iter_s": 1.973738193511963, "time_total_s": 273.44046545028687, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9780>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344ad40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 273.44046545028687, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7328851126386688.0, "policy_entropy": 261.03936767578125, "var_gnorm": 22.66861343383789, "vf_loss": 4918241918976.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 140, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766190.9307318702, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426575420621835, "mean_inference_ms": 5.2247560672930256, "mean_action_processing_ms": 0.14496204634664944, "mean_env_wait_ms": 0.25559803780240314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601158142089844, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.0622408390045166}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -766190.9307318702, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-784080.8580609021, -809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426575420621835, "mean_inference_ms": 5.2247560672930256, "mean_action_processing_ms": 0.14496204634664944, "mean_env_wait_ms": 0.25559803780240314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601158142089844, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.0622408390045166}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 1969.374, "learn_time_ms": 19.587, "learn_throughput": 17154.116, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-28", "timestamp": 1706194528, "time_this_iter_s": 1.9746780395507812, "time_total_s": 275.41514348983765, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348a680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 275.41514348983765, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.83494365684695e+16, "policy_entropy": 260.6841125488281, "var_gnorm": 22.66861343383789, "vf_loss": 4922673725440.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.184246063232422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 141, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765951.8738096121, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427139092438347, "mean_inference_ms": 5.224812482256306, "mean_action_processing_ms": 0.14496424015792406, "mean_env_wait_ms": 0.255592830662697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619277954101562, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.062259674072265625}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765951.8738096121, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-809869.6371103827, -806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427139092438347, "mean_inference_ms": 5.224812482256306, "mean_action_processing_ms": 0.14496424015792406, "mean_env_wait_ms": 0.255592830662697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015619277954101562, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.062259674072265625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 1970.75, "learn_time_ms": 19.626, "learn_throughput": 17119.795, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-30", "timestamp": 1706194530, "time_this_iter_s": 1.9703011512756348, "time_total_s": 277.3854446411133, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1ca080>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782344aa70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 277.3854446411133, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 20.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.609856446772019e+16, "policy_entropy": 259.18414306640625, "var_gnorm": 22.66861343383789, "vf_loss": 4643712663552.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 142, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765216.8711430463, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427720704079737, "mean_inference_ms": 5.224875824669341, "mean_action_processing_ms": 0.14496674443886162, "mean_env_wait_ms": 0.255588502532719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015630245208740234, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06229352951049805}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765216.8711430463, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-806440.6727034153, -795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427720704079737, "mean_inference_ms": 5.224875824669341, "mean_action_processing_ms": 0.14496674443886162, "mean_env_wait_ms": 0.255588502532719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015630245208740234, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06229352951049805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 1971.049, "learn_time_ms": 19.341, "learn_throughput": 17372.45, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-32", "timestamp": 1706194532, "time_this_iter_s": 1.9756686687469482, "time_total_s": 279.36111330986023, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 279.36111330986023, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 20.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9041314179973120.0, "policy_entropy": 265.8086853027344, "var_gnorm": 22.66861343383789, "vf_loss": 4994871328768.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.325939178466797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 143, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764939.2114578683, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15428328682178674, "mean_inference_ms": 5.224939237214726, "mean_action_processing_ms": 0.14496969345857863, "mean_env_wait_ms": 0.255584930541585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563715934753418, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06230306625366211}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764939.2114578683, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-795551.3916346929, -760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15428328682178674, "mean_inference_ms": 5.224939237214726, "mean_action_processing_ms": 0.14496969345857863, "mean_env_wait_ms": 0.255584930541585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563715934753418, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06230306625366211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 1975.197, "learn_time_ms": 19.259, "learn_throughput": 17446.302, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "done": false, "episodes_total": 143, "training_iteration": 143, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-34", "timestamp": 1706194534, "time_this_iter_s": 1.9958090782165527, "time_total_s": 281.3569223880768, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348b640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 281.3569223880768, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.799788920032461e+16, "policy_entropy": 261.17236328125, "var_gnorm": 22.66861343383789, "vf_loss": 4915922993152.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 144, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764474.012875449, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542894340069963, "mean_inference_ms": 5.225006777789243, "mean_action_processing_ms": 0.14497272318178642, "mean_env_wait_ms": 0.25558155240492036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01562666893005371, "StateBufferConnector_ms": 0.0022733211517333984, "ViewRequirementAgentConnector_ms": 0.062270164489746094}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764474.012875449, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-760592.2065345276, -788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542894340069963, "mean_inference_ms": 5.225006777789243, "mean_action_processing_ms": 0.14497272318178642, "mean_env_wait_ms": 0.25558155240492036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01562666893005371, "StateBufferConnector_ms": 0.0022733211517333984, "ViewRequirementAgentConnector_ms": 0.062270164489746094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1972.938, "learn_time_ms": 19.26, "learn_throughput": 17445.806, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 144, "training_iteration": 144, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-36", "timestamp": 1706194536, "time_this_iter_s": 1.969973087310791, "time_total_s": 283.3268954753876, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb3d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 283.3268954753876, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 21.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.194621827579904e+16, "policy_entropy": 266.098388671875, "var_gnorm": 22.66861343383789, "vf_loss": 5432358731776.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.24249267578125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 145, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764738.416833182, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542957243118228, "mean_inference_ms": 5.225079857413857, "mean_action_processing_ms": 0.14497603889824393, "mean_env_wait_ms": 0.2555790168097112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015627384185791016, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06227421760559082}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764738.416833182, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-788285.1868602333, -795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542957243118228, "mean_inference_ms": 5.225079857413857, "mean_action_processing_ms": 0.14497603889824393, "mean_env_wait_ms": 0.2555790168097112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015627384185791016, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06227421760559082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48720, "timers": {"training_iteration_time_ms": 1973.081, "learn_time_ms": 19.277, "learn_throughput": 17429.731, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "done": false, "episodes_total": 145, "training_iteration": 145, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-38", "timestamp": 1706194538, "time_this_iter_s": 1.9774537086486816, "time_total_s": 285.30434918403625, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce94b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348a830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 285.30434918403625, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.8648340249903104e+16, "policy_entropy": 263.2578125, "var_gnorm": 22.66861343383789, "vf_loss": 5252429905920.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 146, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764788.9663536571, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15430189002739525, "mean_inference_ms": 5.225150696830175, "mean_action_processing_ms": 0.14497928113952416, "mean_env_wait_ms": 0.2555759297195674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015633583068847656, "StateBufferConnector_ms": 0.0022749900817871094, "ViewRequirementAgentConnector_ms": 0.06226801872253418}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764788.9663536571, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-795121.4157853187, -747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15430189002739525, "mean_inference_ms": 5.225150696830175, "mean_action_processing_ms": 0.14497928113952416, "mean_env_wait_ms": 0.2555759297195674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015633583068847656, "StateBufferConnector_ms": 0.0022749900817871094, "ViewRequirementAgentConnector_ms": 0.06226801872253418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49056, "timers": {"training_iteration_time_ms": 1974.482, "learn_time_ms": 19.282, "learn_throughput": 17425.615, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "done": false, "episodes_total": 146, "training_iteration": 146, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-40", "timestamp": 1706194540, "time_this_iter_s": 1.980567216873169, "time_total_s": 287.2849164009094, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9300>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 287.2849164009094, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.710933777619354e+16, "policy_entropy": 260.6634521484375, "var_gnorm": 22.66861343383789, "vf_loss": 5116904079360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3020973205566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 147, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764594.4222594996, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15430842082762056, "mean_inference_ms": 5.225230469433601, "mean_action_processing_ms": 0.14498282454549738, "mean_env_wait_ms": 0.255573477166531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015645980834960938, "StateBufferConnector_ms": 0.002274751663208008, "ViewRequirementAgentConnector_ms": 0.06229996681213379}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764594.4222594996, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747944.281606189, -731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15430842082762056, "mean_inference_ms": 5.225230469433601, "mean_action_processing_ms": 0.14498282454549738, "mean_env_wait_ms": 0.255573477166531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015645980834960938, "StateBufferConnector_ms": 0.002274751663208008, "ViewRequirementAgentConnector_ms": 0.06229996681213379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49392, "timers": {"training_iteration_time_ms": 1973.326, "learn_time_ms": 19.337, "learn_throughput": 17376.134, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "done": false, "episodes_total": 147, "training_iteration": 147, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-42", "timestamp": 1706194542, "time_this_iter_s": 1.954803228378296, "time_total_s": 289.2397196292877, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cbac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348b400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 289.2397196292877, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.76503562968105e+16, "policy_entropy": 263.77288818359375, "var_gnorm": 22.66861343383789, "vf_loss": 5384707244032.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.230571746826172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 148, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765158.2056153485, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543149636271047, "mean_inference_ms": 5.225311450229242, "mean_action_processing_ms": 0.14498649750392953, "mean_env_wait_ms": 0.25557163009459943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01565718650817871, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.062320709228515625}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765158.2056153485, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-731044.1871085431, -778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543149636271047, "mean_inference_ms": 5.225311450229242, "mean_action_processing_ms": 0.14498649750392953, "mean_env_wait_ms": 0.25557163009459943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01565718650817871, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.062320709228515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49728, "timers": {"training_iteration_time_ms": 1975.266, "learn_time_ms": 19.394, "learn_throughput": 17325.272, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "done": false, "episodes_total": 148, "training_iteration": 148, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-44", "timestamp": 1706194544, "time_this_iter_s": 1.9846251010894775, "time_total_s": 291.2243447303772, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceadd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348ac20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 291.2243447303772, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.920914674207949e+16, "policy_entropy": 263.67816162109375, "var_gnorm": 22.66861343383789, "vf_loss": 4904602042368.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 149, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765435.2131430838, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15432200550237316, "mean_inference_ms": 5.225395073646435, "mean_action_processing_ms": 0.14499031276250487, "mean_env_wait_ms": 0.2555705681666304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015672683715820312, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06236577033996582}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765435.2131430838, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-778727.7848414764, -740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15432200550237316, "mean_inference_ms": 5.225395073646435, "mean_action_processing_ms": 0.14499031276250487, "mean_env_wait_ms": 0.2555705681666304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015672683715820312, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06236577033996582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50064, "timers": {"training_iteration_time_ms": 1976.354, "learn_time_ms": 19.428, "learn_throughput": 17294.677, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "done": false, "episodes_total": 149, "training_iteration": 149, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-46", "timestamp": 1706194546, "time_this_iter_s": 1.9845929145812988, "time_total_s": 293.2089376449585, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8dcc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 293.2089376449585, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.253798047219712e+16, "policy_entropy": 263.9773254394531, "var_gnorm": 22.66861343383789, "vf_loss": 4717293862912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4928321838378906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 150, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765081.1368778134, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543278485248826, "mean_inference_ms": 5.225473539223845, "mean_action_processing_ms": 0.1449939017505311, "mean_env_wait_ms": 0.2555692955947536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015674114227294922, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06235170364379883}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765081.1368778134, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-740379.1260969206, -798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543278485248826, "mean_inference_ms": 5.225473539223845, "mean_action_processing_ms": 0.1449939017505311, "mean_env_wait_ms": 0.2555692955947536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015674114227294922, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06235170364379883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 1977.545, "learn_time_ms": 19.299, "learn_throughput": 17410.481, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 150, "training_iteration": 150, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-48", "timestamp": 1706194548, "time_this_iter_s": 1.9866113662719727, "time_total_s": 295.19554901123047, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce704f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 295.19554901123047, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.262551889326899e+16, "policy_entropy": 264.56622314453125, "var_gnorm": 22.66861343383789, "vf_loss": 5227537760256.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 151, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765612.1993229717, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543338007440566, "mean_inference_ms": 5.22555780679459, "mean_action_processing_ms": 0.14499765163002487, "mean_env_wait_ms": 0.2555684860287026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015676021575927734, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06239676475524902}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -765612.1993229717, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-798050.5441036077, -780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543338007440566, "mean_inference_ms": 5.22555780679459, "mean_action_processing_ms": 0.14499765163002487, "mean_env_wait_ms": 0.2555684860287026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015676021575927734, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06239676475524902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50736, "timers": {"training_iteration_time_ms": 1978.959, "learn_time_ms": 19.312, "learn_throughput": 17398.444, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "done": false, "episodes_total": 151, "training_iteration": 151, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-50", "timestamp": 1706194550, "time_this_iter_s": 1.9844231605529785, "time_total_s": 297.17997217178345, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9d50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 297.17997217178345, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 21.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.411315812564992e+16, "policy_entropy": 259.1727294921875, "var_gnorm": 22.66861343383789, "vf_loss": 4418484305920.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2319297790527344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 152, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764909.7312985368, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15433961593655363, "mean_inference_ms": 5.225651350238062, "mean_action_processing_ms": 0.14500164123021841, "mean_env_wait_ms": 0.25556780277316404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015650510787963867, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062395334243774414}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764909.7312985368, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-780371.3186143942, -782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15433961593655363, "mean_inference_ms": 5.225651350238062, "mean_action_processing_ms": 0.14500164123021841, "mean_env_wait_ms": 0.25556780277316404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015650510787963867, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062395334243774414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1979.066, "learn_time_ms": 19.556, "learn_throughput": 17181.681, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "done": false, "episodes_total": 152, "training_iteration": 152, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-52", "timestamp": 1706194552, "time_this_iter_s": 1.9767472743988037, "time_total_s": 299.15671944618225, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2ce0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 299.15671944618225, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 21.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.271748460793037e+16, "policy_entropy": 261.4252014160156, "var_gnorm": 22.66861343383789, "vf_loss": 4734497849344.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.921985626220703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 153, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764603.3417055303, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15434491513758797, "mean_inference_ms": 5.225737491443895, "mean_action_processing_ms": 0.1450052437754865, "mean_env_wait_ms": 0.2555664316547065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563882827758789, "StateBufferConnector_ms": 0.0022771358489990234, "ViewRequirementAgentConnector_ms": 0.062361955642700195}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764603.3417055303, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-782083.3077845601, -772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15434491513758797, "mean_inference_ms": 5.225737491443895, "mean_action_processing_ms": 0.1450052437754865, "mean_env_wait_ms": 0.2555664316547065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563882827758789, "StateBufferConnector_ms": 0.0022771358489990234, "ViewRequirementAgentConnector_ms": 0.062361955642700195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51408, "timers": {"training_iteration_time_ms": 1974.34, "learn_time_ms": 20.048, "learn_throughput": 16759.359, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "done": false, "episodes_total": 153, "training_iteration": 153, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-54", "timestamp": 1706194554, "time_this_iter_s": 1.9485645294189453, "time_total_s": 301.1052839756012, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348b910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 301.1052839756012, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 21.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.887806543822848e+16, "policy_entropy": 265.28253173828125, "var_gnorm": 22.66861343383789, "vf_loss": 5072994959360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 154, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764528.9456340653, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15435017717466534, "mean_inference_ms": 5.225825607461982, "mean_action_processing_ms": 0.14500884435392397, "mean_env_wait_ms": 0.25556524322257984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564478874206543, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.06237936019897461}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764528.9456340653, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-772784.411695304, -779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15435017717466534, "mean_inference_ms": 5.225825607461982, "mean_action_processing_ms": 0.14500884435392397, "mean_env_wait_ms": 0.25556524322257984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564478874206543, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.06237936019897461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51744, "timers": {"training_iteration_time_ms": 1975.712, "learn_time_ms": 20.033, "learn_throughput": 16772.663, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "done": false, "episodes_total": 154, "training_iteration": 154, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-56", "timestamp": 1706194556, "time_this_iter_s": 1.9836859703063965, "time_total_s": 303.0889699459076, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccebe80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 303.0889699459076, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3945154293465088e+16, "policy_entropy": 263.2353515625, "var_gnorm": 22.66861343383789, "vf_loss": 4847423193088.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 155, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764441.1278722627, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543551360045009, "mean_inference_ms": 5.22591435470501, "mean_action_processing_ms": 0.14501232271344247, "mean_env_wait_ms": 0.2555636187507881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563286781311035, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.062380313873291016}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764441.1278722627, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-779558.3303085567, -737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543551360045009, "mean_inference_ms": 5.22591435470501, "mean_action_processing_ms": 0.14501232271344247, "mean_env_wait_ms": 0.2555636187507881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01563286781311035, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.062380313873291016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52080, "timers": {"training_iteration_time_ms": 1976.331, "learn_time_ms": 20.052, "learn_throughput": 16756.231, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "done": false, "episodes_total": 155, "training_iteration": 155, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-55-58", "timestamp": 1706194558, "time_this_iter_s": 1.9836814403533936, "time_total_s": 305.072651386261, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce8670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348a290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 305.072651386261, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 22.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.62129093820416e+16, "policy_entropy": 261.99139404296875, "var_gnorm": 22.66861343383789, "vf_loss": 4734089428992.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3974647521972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 156, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764059.1495369603, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15435995627905805, "mean_inference_ms": 5.226002862673098, "mean_action_processing_ms": 0.1450158642463854, "mean_env_wait_ms": 0.25556218396087954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015636920928955078, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062426090240478516}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764059.1495369603, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-737490.2272854742, -768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15435995627905805, "mean_inference_ms": 5.226002862673098, "mean_action_processing_ms": 0.1450158642463854, "mean_env_wait_ms": 0.25556218396087954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015636920928955078, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062426090240478516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52416, "timers": {"training_iteration_time_ms": 1974.477, "learn_time_ms": 20.003, "learn_throughput": 16797.893, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "done": false, "episodes_total": 156, "training_iteration": 156, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-00", "timestamp": 1706194560, "time_this_iter_s": 1.9620184898376465, "time_total_s": 307.03466987609863, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 307.03466987609863, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 22.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.833553992921907e+16, "policy_entropy": 257.56719970703125, "var_gnorm": 22.66861343383789, "vf_loss": 4460216582144.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.349781036376953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 157, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763935.3549905865, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154364981669585, "mean_inference_ms": 5.226096276518417, "mean_action_processing_ms": 0.1450194893941159, "mean_env_wait_ms": 0.25556085795693884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564955711364746, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.062456607818603516}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763935.3549905865, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-768982.1435923743, -735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154364981669585, "mean_inference_ms": 5.226096276518417, "mean_action_processing_ms": 0.1450194893941159, "mean_env_wait_ms": 0.25556085795693884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01564955711364746, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.062456607818603516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52752, "timers": {"training_iteration_time_ms": 1974.427, "learn_time_ms": 19.913, "learn_throughput": 16873.536, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "done": false, "episodes_total": 157, "training_iteration": 157, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-02", "timestamp": 1706194562, "time_this_iter_s": 1.9543025493621826, "time_total_s": 308.9889724254608, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb7c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 308.9889724254608, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.061759270787482e+16, "policy_entropy": 265.14068603515625, "var_gnorm": 22.66861343383789, "vf_loss": 5129499574272.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.695487976074219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 158, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764023.2754883933, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15437001940939768, "mean_inference_ms": 5.2261884092705495, "mean_action_processing_ms": 0.14502328431630196, "mean_env_wait_ms": 0.2555597878464837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01568150520324707, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.06243014335632324}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764023.2754883933, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-735595.3636508844, -794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15437001940939768, "mean_inference_ms": 5.2261884092705495, "mean_action_processing_ms": 0.14502328431630196, "mean_env_wait_ms": 0.2555597878464837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01568150520324707, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.06243014335632324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53088, "timers": {"training_iteration_time_ms": 1973.451, "learn_time_ms": 19.842, "learn_throughput": 16933.386, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "done": false, "episodes_total": 158, "training_iteration": 158, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-04", "timestamp": 1706194564, "time_this_iter_s": 1.9748358726501465, "time_total_s": 310.96380829811096, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 310.96380829811096, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 22.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4758452794425344e+16, "policy_entropy": 261.6228942871094, "var_gnorm": 22.66861343383789, "vf_loss": 4636447080448.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.993511199951172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 159, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764035.4684810642, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543749725830135, "mean_inference_ms": 5.226275938969978, "mean_action_processing_ms": 0.14502721862015086, "mean_env_wait_ms": 0.25555908268126687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569223403930664, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.06243634223937988}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764035.4684810642, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-794195.9236057809, -802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543749725830135, "mean_inference_ms": 5.226275938969978, "mean_action_processing_ms": 0.14502721862015086, "mean_env_wait_ms": 0.25555908268126687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569223403930664, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.06243634223937988}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53424, "timers": {"training_iteration_time_ms": 1969.551, "learn_time_ms": 19.762, "learn_throughput": 17002.109, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "done": false, "episodes_total": 159, "training_iteration": 159, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-06", "timestamp": 1706194566, "time_this_iter_s": 1.9455833435058594, "time_total_s": 312.9093916416168, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f28c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 312.9093916416168, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.239729159130317e+16, "policy_entropy": 263.88037109375, "var_gnorm": 22.66861343383789, "vf_loss": 5650311544832.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 160, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764362.3083146757, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15437978821311335, "mean_inference_ms": 5.2263622459079295, "mean_action_processing_ms": 0.14503119347431012, "mean_env_wait_ms": 0.25555849465259145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015679121017456055, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.0624089241027832}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764362.3083146757, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-802595.0557030151, -759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15437978821311335, "mean_inference_ms": 5.2263622459079295, "mean_action_processing_ms": 0.14503119347431012, "mean_env_wait_ms": 0.25555849465259145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015679121017456055, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.0624089241027832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1967.119, "learn_time_ms": 19.764, "learn_throughput": 17000.448, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 160, "training_iteration": 160, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-08", "timestamp": 1706194568, "time_this_iter_s": 1.9623017311096191, "time_total_s": 314.87169337272644, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 314.87169337272644, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1663028789444608e+16, "policy_entropy": 263.82177734375, "var_gnorm": 22.66861343383789, "vf_loss": 4550647873536.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 161, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763644.1949376843, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543843744594028, "mean_inference_ms": 5.226445942010169, "mean_action_processing_ms": 0.14503506086396395, "mean_env_wait_ms": 0.25555761481589384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015695571899414062, "StateBufferConnector_ms": 0.0022766590118408203, "ViewRequirementAgentConnector_ms": 0.06241965293884277}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763644.1949376843, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-759836.2479378297, -712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543843744594028, "mean_inference_ms": 5.226445942010169, "mean_action_processing_ms": 0.14503506086396395, "mean_env_wait_ms": 0.25555761481589384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015695571899414062, "StateBufferConnector_ms": 0.0022766590118408203, "ViewRequirementAgentConnector_ms": 0.06241965293884277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 1964.083, "learn_time_ms": 19.762, "learn_throughput": 17002.212, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 161, "training_iteration": 161, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-10", "timestamp": 1706194570, "time_this_iter_s": 1.954073190689087, "time_total_s": 316.8257665634155, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f7823430820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823486d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 316.8257665634155, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 22.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.019129463865344e+16, "policy_entropy": 263.07171630859375, "var_gnorm": 22.66861343383789, "vf_loss": 4901585813504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6716461181640625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 162, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763639.5901160404, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15438887705926607, "mean_inference_ms": 5.2265285533397, "mean_action_processing_ms": 0.14503913250524092, "mean_env_wait_ms": 0.2555570614917387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015694379806518555, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06239724159240723}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763639.5901160404, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-712259.5686603062, -797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15438887705926607, "mean_inference_ms": 5.2265285533397, "mean_action_processing_ms": 0.14503913250524092, "mean_env_wait_ms": 0.2555570614917387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015694379806518555, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06239724159240723}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54432, "timers": {"training_iteration_time_ms": 1963.931, "learn_time_ms": 19.553, "learn_throughput": 17183.839, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "done": false, "episodes_total": 162, "training_iteration": 162, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-12", "timestamp": 1706194572, "time_this_iter_s": 1.9751782417297363, "time_total_s": 318.80094480514526, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 318.80094480514526, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.4084823953833984e+16, "policy_entropy": 257.71868896484375, "var_gnorm": 22.66861343383789, "vf_loss": 5088212942848.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 163, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764275.9246931468, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15439328209590827, "mean_inference_ms": 5.226609481414141, "mean_action_processing_ms": 0.1450434271334075, "mean_env_wait_ms": 0.25555645769190677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01571035385131836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062354326248168945}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -764275.9246931468, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-797952.153782143, -772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15439328209590827, "mean_inference_ms": 5.226609481414141, "mean_action_processing_ms": 0.1450434271334075, "mean_env_wait_ms": 0.25555645769190677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01571035385131836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062354326248168945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54768, "timers": {"training_iteration_time_ms": 1964.289, "learn_time_ms": 19.004, "learn_throughput": 17680.722, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "done": false, "episodes_total": 163, "training_iteration": 163, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-14", "timestamp": 1706194574, "time_this_iter_s": 1.952162504196167, "time_total_s": 320.75310730934143, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea410>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823486cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 320.75310730934143, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.95, "ram_util_percent": 22.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.307351404701286e+16, "policy_entropy": 263.1402893066406, "var_gnorm": 22.66861343383789, "vf_loss": 4590043922432.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 164, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763560.0282566531, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543975237834062, "mean_inference_ms": 5.2266841881083765, "mean_action_processing_ms": 0.14504756607854968, "mean_env_wait_ms": 0.2555558309645717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015705347061157227, "StateBufferConnector_ms": 0.0022783279418945312, "ViewRequirementAgentConnector_ms": 0.06235098838806152}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763560.0282566531, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-772381.2407028951, -749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1543975237834062, "mean_inference_ms": 5.2266841881083765, "mean_action_processing_ms": 0.14504756607854968, "mean_env_wait_ms": 0.2555558309645717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015705347061157227, "StateBufferConnector_ms": 0.0022783279418945312, "ViewRequirementAgentConnector_ms": 0.06235098838806152}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55104, "timers": {"training_iteration_time_ms": 1961.672, "learn_time_ms": 19.005, "learn_throughput": 17679.635, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "done": false, "episodes_total": 164, "training_iteration": 164, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-16", "timestamp": 1706194576, "time_this_iter_s": 1.9575097560882568, "time_total_s": 322.7106170654297, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3b310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 322.7106170654297, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.091505648500736e+16, "policy_entropy": 265.0279235839844, "var_gnorm": 22.66861343383789, "vf_loss": 4288488407040.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2438507080078125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 165, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762949.2857549445, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544017761642989, "mean_inference_ms": 5.226762410852679, "mean_action_processing_ms": 0.14505163248860659, "mean_env_wait_ms": 0.25555507166956576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015715837478637695, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.0623321533203125}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762949.2857549445, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-749724.0465939711, -762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544017761642989, "mean_inference_ms": 5.226762410852679, "mean_action_processing_ms": 0.14505163248860659, "mean_env_wait_ms": 0.25555507166956576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015715837478637695, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.0623321533203125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 1956.973, "learn_time_ms": 18.962, "learn_throughput": 17720.094, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 165, "training_iteration": 165, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-18", "timestamp": 1706194578, "time_this_iter_s": 1.936645269393921, "time_total_s": 324.6472623348236, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c87f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348ac20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 324.6472623348236, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.131451128119296e+16, "policy_entropy": 261.93011474609375, "var_gnorm": 22.66861343383789, "vf_loss": 5535628263424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 166, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763416.3398753129, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15440602961008282, "mean_inference_ms": 5.2268415819991105, "mean_action_processing_ms": 0.14505563736854984, "mean_env_wait_ms": 0.25555436839086737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569080352783203, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.062317609786987305}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763416.3398753129, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-762309.151980911, -738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15440602961008282, "mean_inference_ms": 5.2268415819991105, "mean_action_processing_ms": 0.14505563736854984, "mean_env_wait_ms": 0.25555436839086737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569080352783203, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.062317609786987305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55776, "timers": {"training_iteration_time_ms": 1956.61, "learn_time_ms": 18.986, "learn_throughput": 17697.596, "synch_weights_time_ms": 0.168}, "counters": {"num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "done": false, "episodes_total": 166, "training_iteration": 166, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-20", "timestamp": 1706194580, "time_this_iter_s": 1.9583814144134521, "time_total_s": 326.60564374923706, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 326.60564374923706, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 23.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.946014088101888e+16, "policy_entropy": 260.66204833984375, "var_gnorm": 22.66861343383789, "vf_loss": 4596911570944.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.088878631591797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 167, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763139.1272488773, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441008901852984, "mean_inference_ms": 5.226918770016628, "mean_action_processing_ms": 0.14505965503333326, "mean_env_wait_ms": 0.2555537925759471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015692710876464844, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.062314510345458984}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763139.1272488773, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-738888.3001430004, -767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441008901852984, "mean_inference_ms": 5.226918770016628, "mean_action_processing_ms": 0.14505965503333326, "mean_env_wait_ms": 0.2555537925759471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015692710876464844, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.062314510345458984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56112, "timers": {"training_iteration_time_ms": 1956.946, "learn_time_ms": 18.983, "learn_throughput": 17700.175, "synch_weights_time_ms": 0.168}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "done": false, "episodes_total": 167, "training_iteration": 167, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-22", "timestamp": 1706194582, "time_this_iter_s": 1.9576725959777832, "time_total_s": 328.56331634521484, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f10f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 328.56331634521484, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 23.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2068238682816512.0, "policy_entropy": 259.5531005859375, "var_gnorm": 22.66861343383789, "vf_loss": 5096231403520.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3855438232421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 168, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763510.8917773024, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441406547450026, "mean_inference_ms": 5.226991521462642, "mean_action_processing_ms": 0.14506370932887067, "mean_env_wait_ms": 0.2555533837425792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015675067901611328, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062308311462402344}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763510.8917773024, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-767159.3559736141, -742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441406547450026, "mean_inference_ms": 5.226991521462642, "mean_action_processing_ms": 0.14506370932887067, "mean_env_wait_ms": 0.2555533837425792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015675067901611328, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062308311462402344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1954.831, "learn_time_ms": 18.957, "learn_throughput": 17724.484, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "done": false, "episodes_total": 168, "training_iteration": 168, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-24", "timestamp": 1706194584, "time_this_iter_s": 1.953690767288208, "time_total_s": 330.51700711250305, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823486cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 330.51700711250305, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.476237733730714e+16, "policy_entropy": 264.3741455078125, "var_gnorm": 22.66861343383789, "vf_loss": 4886839164928.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 169, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763363.9030389467, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441809130373568, "mean_inference_ms": 5.227065422564878, "mean_action_processing_ms": 0.14506797755859588, "mean_env_wait_ms": 0.25555299578899876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015690088272094727, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06230449676513672}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763363.9030389467, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-742224.2013147341, -756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441809130373568, "mean_inference_ms": 5.227065422564878, "mean_action_processing_ms": 0.14506797755859588, "mean_env_wait_ms": 0.25555299578899876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015690088272094727, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06230449676513672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56784, "timers": {"training_iteration_time_ms": 1955.222, "learn_time_ms": 18.96, "learn_throughput": 17721.431, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "done": false, "episodes_total": 169, "training_iteration": 169, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-26", "timestamp": 1706194586, "time_this_iter_s": 1.9495017528533936, "time_total_s": 332.46650886535645, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f1180>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 332.46650886535645, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 23.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8404136454258688.0, "policy_entropy": 262.8226318359375, "var_gnorm": 22.66861343383789, "vf_loss": 5093524504576.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6597251892089844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 170, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763680.0498768868, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15442227561998426, "mean_inference_ms": 5.227141993697456, "mean_action_processing_ms": 0.14507243588271662, "mean_env_wait_ms": 0.25555281332578184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015697956085205078, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.06232333183288574}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763680.0498768868, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-756386.904411955, -712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15442227561998426, "mean_inference_ms": 5.227141993697456, "mean_action_processing_ms": 0.14507243588271662, "mean_env_wait_ms": 0.25555281332578184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015697956085205078, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.06232333183288574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57120, "timers": {"training_iteration_time_ms": 1955.026, "learn_time_ms": 18.947, "learn_throughput": 17733.963, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "done": false, "episodes_total": 170, "training_iteration": 170, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-28", "timestamp": 1706194588, "time_this_iter_s": 1.9603583812713623, "time_total_s": 334.4268672466278, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccebc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234851b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 334.4268672466278, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2317981237313536e+16, "policy_entropy": 259.2507019042969, "var_gnorm": 22.66861343383789, "vf_loss": 4699774255104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 171, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763550.3693171985, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544264461104556, "mean_inference_ms": 5.227220834403695, "mean_action_processing_ms": 0.14507705896367498, "mean_env_wait_ms": 0.2555528367597805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015714645385742188, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.06232047080993652}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763550.3693171985, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-712965.2686556855, -723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544264461104556, "mean_inference_ms": 5.227220834403695, "mean_action_processing_ms": 0.14507705896367498, "mean_env_wait_ms": 0.2555528367597805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015714645385742188, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.06232047080993652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57456, "timers": {"training_iteration_time_ms": 1955.519, "learn_time_ms": 18.881, "learn_throughput": 17795.725, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "done": false, "episodes_total": 171, "training_iteration": 171, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-30", "timestamp": 1706194590, "time_this_iter_s": 1.9590017795562744, "time_total_s": 336.3858690261841, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce39030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f782348b880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 336.3858690261841, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 23.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2861952803995648e+16, "policy_entropy": 264.8332214355469, "var_gnorm": 22.66861343383789, "vf_loss": 4757073166336.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.540515899658203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 172, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "sampler_results": {"episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763953.1184385846, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544308820305156, "mean_inference_ms": 5.227304650958265, "mean_action_processing_ms": 0.14508187959430888, "mean_env_wait_ms": 0.25555341920465496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015686750411987305, "StateBufferConnector_ms": 0.0022809505462646484, "ViewRequirementAgentConnector_ms": 0.06231951713562012}}, "episode_reward_max": -709594.4546302803, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763953.1184385846, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-723743.4742071937, -773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544308820305156, "mean_inference_ms": 5.227304650958265, "mean_action_processing_ms": 0.14508187959430888, "mean_env_wait_ms": 0.25555341920465496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015686750411987305, "StateBufferConnector_ms": 0.0022809505462646484, "ViewRequirementAgentConnector_ms": 0.06231951713562012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57792, "timers": {"training_iteration_time_ms": 1955.889, "learn_time_ms": 18.91, "learn_throughput": 17768.71, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "done": false, "episodes_total": 172, "training_iteration": 172, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-32", "timestamp": 1706194592, "time_this_iter_s": 1.978907823562622, "time_total_s": 338.3647768497467, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c9390>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 338.3647768497467, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 23.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6460932725145600.0, "policy_entropy": 258.54437255859375, "var_gnorm": 22.66861343383789, "vf_loss": 4151138582528.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 173, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763697.0948593115, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544354155999126, "mean_inference_ms": 5.22739315906924, "mean_action_processing_ms": 0.1450868671985785, "mean_env_wait_ms": 0.25555427269669445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015683650970458984, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.06230616569519043}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763697.0948593115, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-773961.1425341858, -737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544354155999126, "mean_inference_ms": 5.22739315906924, "mean_action_processing_ms": 0.1450868671985785, "mean_env_wait_ms": 0.25555427269669445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015683650970458984, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.06230616569519043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58128, "timers": {"training_iteration_time_ms": 1958.976, "learn_time_ms": 18.966, "learn_throughput": 17716.307, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "done": false, "episodes_total": 173, "training_iteration": 173, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-34", "timestamp": 1706194594, "time_this_iter_s": 1.9830403327941895, "time_total_s": 340.3478171825409, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea200>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823487be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 340.3478171825409, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 23.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3618043406057472.0, "policy_entropy": 262.54266357421875, "var_gnorm": 22.66861343383789, "vf_loss": 4470213181440.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 174, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763115.6299915243, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544397550069042, "mean_inference_ms": 5.2274888112782785, "mean_action_processing_ms": 0.14509160247264039, "mean_env_wait_ms": 0.2555548990695834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015709877014160156, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.06232619285583496}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763115.6299915243, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-737947.2820434301, -762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544397550069042, "mean_inference_ms": 5.2274888112782785, "mean_action_processing_ms": 0.14509160247264039, "mean_env_wait_ms": 0.2555548990695834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015709877014160156, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.06232619285583496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58464, "timers": {"training_iteration_time_ms": 1964.249, "learn_time_ms": 18.999, "learn_throughput": 17685.004, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "done": false, "episodes_total": 174, "training_iteration": 174, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-36", "timestamp": 1706194596, "time_this_iter_s": 2.0102381706237793, "time_total_s": 342.3580553531647, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f2ce0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234879a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 342.3580553531647, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.80841436987392e+16, "policy_entropy": 264.48712158203125, "var_gnorm": 22.66861343383789, "vf_loss": 5059680141312.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.421306610107422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 175, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763264.7555943966, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15444417532009794, "mean_inference_ms": 5.227585839104325, "mean_action_processing_ms": 0.14509624495022233, "mean_env_wait_ms": 0.25555564400631786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015709400177001953, "StateBufferConnector_ms": 0.0022809505462646484, "ViewRequirementAgentConnector_ms": 0.06233787536621094}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763264.7555943966, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-762992.1672571551, -769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15444417532009794, "mean_inference_ms": 5.227585839104325, "mean_action_processing_ms": 0.14509624495022233, "mean_env_wait_ms": 0.25555564400631786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015709400177001953, "StateBufferConnector_ms": 0.0022809505462646484, "ViewRequirementAgentConnector_ms": 0.06233787536621094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 1966.197, "learn_time_ms": 19.042, "learn_throughput": 17645.125, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 175, "training_iteration": 175, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-38", "timestamp": 1706194598, "time_this_iter_s": 1.9561748504638672, "time_total_s": 344.31423020362854, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823487490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 344.31423020362854, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 23.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7348310012592128.0, "policy_entropy": 261.359130859375, "var_gnorm": 22.66861343383789, "vf_loss": 4572472410112.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.910064697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 176, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762940.0203848236, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15444853056295035, "mean_inference_ms": 5.227680556941075, "mean_action_processing_ms": 0.14510097887449497, "mean_env_wait_ms": 0.25555646563878387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015718460083007812, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232595443725586}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762940.0203848236, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-769401.6362322003, -804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15444853056295035, "mean_inference_ms": 5.227680556941075, "mean_action_processing_ms": 0.14510097887449497, "mean_env_wait_ms": 0.25555646563878387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015718460083007812, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232595443725586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1967.521, "learn_time_ms": 19.029, "learn_throughput": 17657.24, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "done": false, "episodes_total": 176, "training_iteration": 176, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-40", "timestamp": 1706194600, "time_this_iter_s": 1.971635103225708, "time_total_s": 346.28586530685425, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea5c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234875b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 346.28586530685425, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 23.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4166352621273088.0, "policy_entropy": 262.908935546875, "var_gnorm": 22.66861343383789, "vf_loss": 4958925094912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.4809112548828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 177, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762929.9385986577, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15445307873430078, "mean_inference_ms": 5.227779775921896, "mean_action_processing_ms": 0.1451059690808436, "mean_env_wait_ms": 0.2555577475285583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01572108268737793, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.06234240531921387}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762929.9385986577, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-804360.9492295318, -760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15445307873430078, "mean_inference_ms": 5.227779775921896, "mean_action_processing_ms": 0.1451059690808436, "mean_env_wait_ms": 0.2555577475285583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01572108268737793, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.06234240531921387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59472, "timers": {"training_iteration_time_ms": 1970.665, "learn_time_ms": 19.074, "learn_throughput": 17615.328, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "done": false, "episodes_total": 177, "training_iteration": 177, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-42", "timestamp": 1706194602, "time_this_iter_s": 1.9890892505645752, "time_total_s": 348.2749545574188, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f0400>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78235d4280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 348.2749545574188, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 23.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.627681662048666e+16, "policy_entropy": 264.9302978515625, "var_gnorm": 22.66861343383789, "vf_loss": 5494665641984.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.421306610107422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 178, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762911.0512742891, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544576410192068, "mean_inference_ms": 5.227880346281496, "mean_action_processing_ms": 0.14511095642303606, "mean_env_wait_ms": 0.25555935427671356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723228454589844, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232810020446777}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762911.0512742891, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-760491.0249964203, -761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544576410192068, "mean_inference_ms": 5.227880346281496, "mean_action_processing_ms": 0.14511095642303606, "mean_env_wait_ms": 0.25555935427671356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723228454589844, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232810020446777}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59808, "timers": {"training_iteration_time_ms": 1971.972, "learn_time_ms": 19.186, "learn_throughput": 17512.947, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "done": false, "episodes_total": 178, "training_iteration": 178, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-44", "timestamp": 1706194604, "time_this_iter_s": 1.966764211654663, "time_total_s": 350.2417187690735, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceba30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823487c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 350.2417187690735, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.389285609557197e+16, "policy_entropy": 260.9358825683594, "var_gnorm": 22.66861343383789, "vf_loss": 4386087239680.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 179, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762564.8820883636, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544625216275888, "mean_inference_ms": 5.227991520151519, "mean_action_processing_ms": 0.1451161673572049, "mean_env_wait_ms": 0.2555614587470151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015726566314697266, "StateBufferConnector_ms": 0.0022804737091064453, "ViewRequirementAgentConnector_ms": 0.062351226806640625}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762564.8820883636, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-761617.2324071894, -784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544625216275888, "mean_inference_ms": 5.227991520151519, "mean_action_processing_ms": 0.1451161673572049, "mean_env_wait_ms": 0.2555614587470151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015726566314697266, "StateBufferConnector_ms": 0.0022804737091064453, "ViewRequirementAgentConnector_ms": 0.062351226806640625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60144, "timers": {"training_iteration_time_ms": 1973.202, "learn_time_ms": 19.239, "learn_throughput": 17464.074, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "done": false, "episodes_total": 179, "training_iteration": 179, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-46", "timestamp": 1706194606, "time_this_iter_s": 1.9617764949798584, "time_total_s": 352.20349526405334, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1cb790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b40d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 352.20349526405334, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 24.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.626998573105152e+16, "policy_entropy": 261.7717590332031, "var_gnorm": 22.66861343383789, "vf_loss": 4517427937280.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 180, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762284.1788875929, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15446737465982296, "mean_inference_ms": 5.22810417003322, "mean_action_processing_ms": 0.14512141176845328, "mean_env_wait_ms": 0.2555636686281702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015715837478637695, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232047080993652}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762284.1788875929, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-784666.5014117939, -725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15446737465982296, "mean_inference_ms": 5.22810417003322, "mean_action_processing_ms": 0.14512141176845328, "mean_env_wait_ms": 0.2555636686281702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015715837478637695, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06232047080993652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60480, "timers": {"training_iteration_time_ms": 1975.246, "learn_time_ms": 20.102, "learn_throughput": 16715.012, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "done": false, "episodes_total": 180, "training_iteration": 180, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-48", "timestamp": 1706194608, "time_this_iter_s": 1.980839490890503, "time_total_s": 354.18433475494385, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce70670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 354.18433475494385, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 24.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.900908154067354e+16, "policy_entropy": 265.177490234375, "var_gnorm": 22.66861343383789, "vf_loss": 5856940785664.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.361701965332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 181, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762673.321191906, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15447188553757973, "mean_inference_ms": 5.228217548575116, "mean_action_processing_ms": 0.14512647621314864, "mean_env_wait_ms": 0.255565471224437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569676399230957, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.062273502349853516}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762673.321191906, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-725352.3262478412, -742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15447188553757973, "mean_inference_ms": 5.228217548575116, "mean_action_processing_ms": 0.14512647621314864, "mean_env_wait_ms": 0.255565471224437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569676399230957, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.062273502349853516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60816, "timers": {"training_iteration_time_ms": 1975.449, "learn_time_ms": 20.167, "learn_throughput": 16660.73, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "done": false, "episodes_total": 181, "training_iteration": 181, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-50", "timestamp": 1706194610, "time_this_iter_s": 1.9610378742218018, "time_total_s": 356.14537262916565, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9270>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 356.14537262916565, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 24.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6331729908334592.0, "policy_entropy": 266.58209228515625, "var_gnorm": 22.66861343383789, "vf_loss": 5001650372608.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.112720489501953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 182, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763140.2852434126, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154476450781395, "mean_inference_ms": 5.228336071225841, "mean_action_processing_ms": 0.14513148878888793, "mean_env_wait_ms": 0.25556720143222916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0157010555267334, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.06228756904602051}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763140.2852434126, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-742373.3206514207, -793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154476450781395, "mean_inference_ms": 5.228336071225841, "mean_action_processing_ms": 0.14513148878888793, "mean_env_wait_ms": 0.25556720143222916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0157010555267334, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.06228756904602051}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61152, "timers": {"training_iteration_time_ms": 1973.909, "learn_time_ms": 20.059, "learn_throughput": 16750.873, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "done": false, "episodes_total": 182, "training_iteration": 182, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-52", "timestamp": 1706194612, "time_this_iter_s": 1.9635183811187744, "time_total_s": 358.1088910102844, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceabc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b5510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 358.1088910102844, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 24.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3320040602271744e+16, "policy_entropy": 260.37335205078125, "var_gnorm": 22.66861343383789, "vf_loss": 4910692171776.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 183, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763383.8286445673, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448096561394145, "mean_inference_ms": 5.228458282157231, "mean_action_processing_ms": 0.14513659586527708, "mean_env_wait_ms": 0.2555690341840303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569366455078125, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.06225752830505371}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763383.8286445673, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-793343.7578065026, -777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448096561394145, "mean_inference_ms": 5.228458282157231, "mean_action_processing_ms": 0.14513659586527708, "mean_env_wait_ms": 0.2555690341840303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01569366455078125, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.06225752830505371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61488, "timers": {"training_iteration_time_ms": 1972.742, "learn_time_ms": 20.048, "learn_throughput": 16759.618, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "done": false, "episodes_total": 183, "training_iteration": 183, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-54", "timestamp": 1706194614, "time_this_iter_s": 1.9713680744171143, "time_total_s": 360.08025908470154, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce97b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823489fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 360.08025908470154, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 24.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.077870415826125e+16, "policy_entropy": 260.32415771484375, "var_gnorm": 22.66861343383789, "vf_loss": 4908878659584.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.516674041748047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 184, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763101.4729533611, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448569706471849, "mean_inference_ms": 5.228583046099913, "mean_action_processing_ms": 0.1451418941858387, "mean_env_wait_ms": 0.2555712476660956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015707015991210938, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.06225442886352539}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763101.4729533611, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-777082.6996289982, -748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448569706471849, "mean_inference_ms": 5.228583046099913, "mean_action_processing_ms": 0.1451418941858387, "mean_env_wait_ms": 0.2555712476660956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015707015991210938, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.06225442886352539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1966.629, "learn_time_ms": 20.014, "learn_throughput": 16788.568, "synch_weights_time_ms": 0.173}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "done": false, "episodes_total": 184, "training_iteration": 184, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-56", "timestamp": 1706194616, "time_this_iter_s": 1.9490845203399658, "time_total_s": 362.0293436050415, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c8f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 362.0293436050415, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.197553142759424e+16, "policy_entropy": 262.85968017578125, "var_gnorm": 22.66861343383789, "vf_loss": 5176607375360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 185, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763138.6828250369, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449028350816266, "mean_inference_ms": 5.2287083568657975, "mean_action_processing_ms": 0.14514723553195638, "mean_env_wait_ms": 0.25557347327791047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723705291748047, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06224513053894043}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763138.6828250369, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-748098.8719657001, -730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449028350816266, "mean_inference_ms": 5.2287083568657975, "mean_action_processing_ms": 0.14514723553195638, "mean_env_wait_ms": 0.25557347327791047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723705291748047, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06224513053894043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62160, "timers": {"training_iteration_time_ms": 1968.199, "learn_time_ms": 20.021, "learn_throughput": 16782.79, "synch_weights_time_ms": 0.175}, "counters": {"num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "done": false, "episodes_total": 185, "training_iteration": 185, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-56-58", "timestamp": 1706194618, "time_this_iter_s": 1.971855640411377, "time_total_s": 364.0011992454529, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce72a70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823487490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 364.0011992454529, "timesteps_since_restore": 0, "iterations_since_restore": 185, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 24.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5152368668639232e+16, "policy_entropy": 260.48260498046875, "var_gnorm": 22.66861343383789, "vf_loss": 4643245522944.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.719329833984375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 186, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763012.7423971376, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449463530704516, "mean_inference_ms": 5.228825998515342, "mean_action_processing_ms": 0.14515248332520736, "mean_env_wait_ms": 0.25557562588234584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01570868492126465, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062215328216552734}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763012.7423971376, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-730006.2822334322, -741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15449463530704516, "mean_inference_ms": 5.228825998515342, "mean_action_processing_ms": 0.14515248332520736, "mean_env_wait_ms": 0.25557562588234584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01570868492126465, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.062215328216552734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62496, "timers": {"training_iteration_time_ms": 1969.517, "learn_time_ms": 20.066, "learn_throughput": 16744.683, "synch_weights_time_ms": 0.175}, "counters": {"num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "done": false, "episodes_total": 186, "training_iteration": 186, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-00", "timestamp": 1706194620, "time_this_iter_s": 1.9847853183746338, "time_total_s": 365.9859845638275, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce9060>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 365.9859845638275, "timesteps_since_restore": 0, "iterations_since_restore": 186, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.764192176570368e+16, "policy_entropy": 259.3269348144531, "var_gnorm": 22.66861343383789, "vf_loss": 4426503290880.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.612041473388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 187, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762980.876284471, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544988056031485, "mean_inference_ms": 5.228943461643087, "mean_action_processing_ms": 0.14515772982166983, "mean_env_wait_ms": 0.2555776990144734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0157015323638916, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.06220412254333496}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762980.876284471, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-741414.1563113296, -773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1544988056031485, "mean_inference_ms": 5.228943461643087, "mean_action_processing_ms": 0.14515772982166983, "mean_env_wait_ms": 0.2555776990144734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0157015323638916, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.06220412254333496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62832, "timers": {"training_iteration_time_ms": 1967.182, "learn_time_ms": 20.026, "learn_throughput": 16778.195, "synch_weights_time_ms": 0.174}, "counters": {"num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "done": false, "episodes_total": 187, "training_iteration": 187, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-02", "timestamp": 1706194622, "time_this_iter_s": 1.9658052921295166, "time_total_s": 367.95178985595703, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f783a1c9360>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 367.95178985595703, "timesteps_since_restore": 0, "iterations_since_restore": 187, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.703278427910963e+16, "policy_entropy": 260.72442626953125, "var_gnorm": 22.66861343383789, "vf_loss": 4844154257408.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 188, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763133.0640267967, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450305636401837, "mean_inference_ms": 5.229065340713558, "mean_action_processing_ms": 0.1451631900597129, "mean_env_wait_ms": 0.2555801439090005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015699148178100586, "StateBufferConnector_ms": 0.002279043197631836, "ViewRequirementAgentConnector_ms": 0.0621950626373291}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -763133.0640267967, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-773392.0142629928, -804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450305636401837, "mean_inference_ms": 5.229065340713558, "mean_action_processing_ms": 0.1451631900597129, "mean_env_wait_ms": 0.2555801439090005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015699148178100586, "StateBufferConnector_ms": 0.002279043197631836, "ViewRequirementAgentConnector_ms": 0.0621950626373291}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63168, "timers": {"training_iteration_time_ms": 1968.673, "learn_time_ms": 19.972, "learn_throughput": 16823.802, "synch_weights_time_ms": 0.174}, "counters": {"num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "done": false, "episodes_total": 188, "training_iteration": 188, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-04", "timestamp": 1706194624, "time_this_iter_s": 1.9816641807556152, "time_total_s": 369.93345403671265, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce92d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b6200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.93345403671265, "timesteps_since_restore": 0, "iterations_since_restore": 188, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 24.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3541515414470656e+16, "policy_entropy": 262.01483154296875, "var_gnorm": 22.66861343383789, "vf_loss": 4621254262784.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7789344787597656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 189, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762730.7008272824, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450733870037076, "mean_inference_ms": 5.229189759746691, "mean_action_processing_ms": 0.14516880019882022, "mean_env_wait_ms": 0.2555827753842205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015702486038208008, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06221628189086914}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762730.7008272824, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-804454.703410325, -776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450733870037076, "mean_inference_ms": 5.229189759746691, "mean_action_processing_ms": 0.14516880019882022, "mean_env_wait_ms": 0.2555827753842205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015702486038208008, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06221628189086914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63504, "timers": {"training_iteration_time_ms": 1970.787, "learn_time_ms": 19.964, "learn_throughput": 16830.513, "synch_weights_time_ms": 0.173}, "counters": {"num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "done": false, "episodes_total": 189, "training_iteration": 189, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-06", "timestamp": 1706194626, "time_this_iter_s": 1.9829351902008057, "time_total_s": 371.91638922691345, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce905b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823487880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 371.91638922691345, "timesteps_since_restore": 0, "iterations_since_restore": 189, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.605313472371098e+16, "policy_entropy": 264.4224548339844, "var_gnorm": 22.66861343383789, "vf_loss": 5075487948800.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.719329833984375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 190, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762451.7498761156, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15451156387948772, "mean_inference_ms": 5.229287385950388, "mean_action_processing_ms": 0.14517449956527517, "mean_env_wait_ms": 0.25558558392433833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015706539154052734, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06219744682312012}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762451.7498761156, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-776894.6428121683, -726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15451156387948772, "mean_inference_ms": 5.229287385950388, "mean_action_processing_ms": 0.14517449956527517, "mean_env_wait_ms": 0.25558558392433833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015706539154052734, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06219744682312012}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63840, "timers": {"training_iteration_time_ms": 1971.446, "learn_time_ms": 19.156, "learn_throughput": 17539.997, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "done": false, "episodes_total": 190, "training_iteration": 190, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-08", "timestamp": 1706194628, "time_this_iter_s": 1.9873807430267334, "time_total_s": 373.9037699699402, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b63b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 373.9037699699402, "timesteps_since_restore": 0, "iterations_since_restore": 190, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 25.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.122306229239808e+16, "policy_entropy": 263.06402587890625, "var_gnorm": 22.66861343383789, "vf_loss": 4514638725120.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.6835670471191406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 191, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761901.6095833549, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545159345749164, "mean_inference_ms": 5.229389360993452, "mean_action_processing_ms": 0.14518031570351805, "mean_env_wait_ms": 0.2555888026829701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015703439712524414, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062203168869018555}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761901.6095833549, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-726402.7731638253, -758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545159345749164, "mean_inference_ms": 5.229389360993452, "mean_action_processing_ms": 0.14518031570351805, "mean_env_wait_ms": 0.2555888026829701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015703439712524414, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.062203168869018555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64176, "timers": {"training_iteration_time_ms": 1976.156, "learn_time_ms": 19.168, "learn_throughput": 17529.503, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "done": false, "episodes_total": 191, "training_iteration": 191, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-10", "timestamp": 1706194630, "time_this_iter_s": 2.008124828338623, "time_total_s": 375.9118947982788, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccea560>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b5630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 375.9118947982788, "timesteps_since_restore": 0, "iterations_since_restore": 191, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 25.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.042019035316224e+16, "policy_entropy": 260.59332275390625, "var_gnorm": 22.66861343383789, "vf_loss": 5041647779840.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.361701965332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 192, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762360.0860045474, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15452032308612842, "mean_inference_ms": 5.229491019241911, "mean_action_processing_ms": 0.145186083168494, "mean_env_wait_ms": 0.2555923443678175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015706777572631836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06219053268432617}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762360.0860045474, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758739.3492834545, -758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15452032308612842, "mean_inference_ms": 5.229491019241911, "mean_action_processing_ms": 0.145186083168494, "mean_env_wait_ms": 0.2555923443678175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015706777572631836, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.06219053268432617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1977.397, "learn_time_ms": 19.206, "learn_throughput": 17494.468, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 192, "training_iteration": 192, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-12", "timestamp": 1706194632, "time_this_iter_s": 1.9759242534637451, "time_total_s": 377.88781905174255, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce38f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234869e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 377.88781905174255, "timesteps_since_restore": 0, "iterations_since_restore": 192, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 25.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.288260462562509e+16, "policy_entropy": 269.2208251953125, "var_gnorm": 22.66861343383789, "vf_loss": 4855771430912.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.9921531677246094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 193, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762325.8402683145, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545247483492577, "mean_inference_ms": 5.229595978700559, "mean_action_processing_ms": 0.1451918230073096, "mean_env_wait_ms": 0.25559601459490977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015700578689575195, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.06217598915100098}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762325.8402683145, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758113.2389488654, -789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545247483492577, "mean_inference_ms": 5.229595978700559, "mean_action_processing_ms": 0.1451918230073096, "mean_env_wait_ms": 0.25559601459490977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015700578689575195, "StateBufferConnector_ms": 0.002277851104736328, "ViewRequirementAgentConnector_ms": 0.06217598915100098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64848, "timers": {"training_iteration_time_ms": 1978.612, "learn_time_ms": 19.232, "learn_throughput": 17470.569, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "done": false, "episodes_total": 193, "training_iteration": 193, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-14", "timestamp": 1706194634, "time_this_iter_s": 1.9835145473480225, "time_total_s": 379.8713335990906, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cceb700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b6c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 379.8713335990906, "timesteps_since_restore": 0, "iterations_since_restore": 193, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 25.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.876022442052813e+16, "policy_entropy": 265.9665222167969, "var_gnorm": 22.66861343383789, "vf_loss": 5577887973376.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0875205993652344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 194, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762717.4485819483, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154529309727635, "mean_inference_ms": 5.229707681561977, "mean_action_processing_ms": 0.145197792904396, "mean_env_wait_ms": 0.25559996521353906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015718936920166016, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06218266487121582}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762717.4485819483, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-789286.2515411789, -755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154529309727635, "mean_inference_ms": 5.229707681561977, "mean_action_processing_ms": 0.145197792904396, "mean_env_wait_ms": 0.25559996521353906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015718936920166016, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.06218266487121582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65184, "timers": {"training_iteration_time_ms": 1981.877, "learn_time_ms": 19.216, "learn_throughput": 17485.135, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "done": false, "episodes_total": 194, "training_iteration": 194, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-16", "timestamp": 1706194636, "time_this_iter_s": 1.9817464351654053, "time_total_s": 381.853080034256, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce72590>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234851b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 381.853080034256, "timesteps_since_restore": 0, "iterations_since_restore": 194, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 25.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.729232753393664e+16, "policy_entropy": 261.1226501464844, "var_gnorm": 22.66861343383789, "vf_loss": 4984234573824.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.254413604736328e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 195, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762490.8365966289, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15453416637915002, "mean_inference_ms": 5.229827526443996, "mean_action_processing_ms": 0.14520403808377882, "mean_env_wait_ms": 0.2556045525229744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015734434127807617, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06220698356628418}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762490.8365966289, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-755079.1235228126, -795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15453416637915002, "mean_inference_ms": 5.229827526443996, "mean_action_processing_ms": 0.14520403808377882, "mean_env_wait_ms": 0.2556045525229744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015734434127807617, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06220698356628418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65520, "timers": {"training_iteration_time_ms": 1982.056, "learn_time_ms": 19.214, "learn_throughput": 17487.218, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "done": false, "episodes_total": 195, "training_iteration": 195, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-18", "timestamp": 1706194638, "time_this_iter_s": 1.9736347198486328, "time_total_s": 383.8267147541046, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b5a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 383.8267147541046, "timesteps_since_restore": 0, "iterations_since_restore": 195, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 25.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6891743177867264.0, "policy_entropy": 262.1588134765625, "var_gnorm": 22.66861343383789, "vf_loss": 5258680991744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 196, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762735.4361610061, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15453905704432258, "mean_inference_ms": 5.229949248439014, "mean_action_processing_ms": 0.14521021522312588, "mean_env_wait_ms": 0.2556093110974433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015727996826171875, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06219911575317383}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762735.4361610061, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-795213.5449730634, -772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15453905704432258, "mean_inference_ms": 5.229949248439014, "mean_action_processing_ms": 0.14521021522312588, "mean_env_wait_ms": 0.2556093110974433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015727996826171875, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.06219911575317383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65856, "timers": {"training_iteration_time_ms": 1981.495, "learn_time_ms": 19.162, "learn_throughput": 17534.868, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "done": false, "episodes_total": 196, "training_iteration": 196, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-20", "timestamp": 1706194640, "time_this_iter_s": 1.9791860580444336, "time_total_s": 385.80590081214905, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce39f60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823484a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 385.80590081214905, "timesteps_since_restore": 0, "iterations_since_restore": 196, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 25.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0936578020999168e+16, "policy_entropy": 264.2368469238281, "var_gnorm": 22.66861343383789, "vf_loss": 4775765606400.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.898143768310547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 197, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762314.5872872284, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15454394052961234, "mean_inference_ms": 5.230071446229024, "mean_action_processing_ms": 0.14521644234092507, "mean_env_wait_ms": 0.25561442316039745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01573944091796875, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06219959259033203}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762314.5872872284, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-772310.8241132871, -778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15454394052961234, "mean_inference_ms": 5.230071446229024, "mean_action_processing_ms": 0.14521644234092507, "mean_env_wait_ms": 0.25561442316039745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01573944091796875, "StateBufferConnector_ms": 0.002279996871948242, "ViewRequirementAgentConnector_ms": 0.06219959259033203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66192, "timers": {"training_iteration_time_ms": 1981.254, "learn_time_ms": 19.163, "learn_throughput": 17533.952, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "done": false, "episodes_total": 197, "training_iteration": 197, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-22", "timestamp": 1706194642, "time_this_iter_s": 1.9633402824401855, "time_total_s": 387.76924109458923, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799cce92a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 387.76924109458923, "timesteps_since_restore": 0, "iterations_since_restore": 197, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 25.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.1356177543593984e+16, "policy_entropy": 266.89239501953125, "var_gnorm": 22.66861343383789, "vf_loss": 5030305857536.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8743019104003906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 198, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762236.584685182, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15454865769379436, "mean_inference_ms": 5.230187749344709, "mean_action_processing_ms": 0.14522246855415444, "mean_env_wait_ms": 0.2556193087871654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015729188919067383, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.062186479568481445}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762236.584685182, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-778310.6138004393, -741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15454865769379436, "mean_inference_ms": 5.230187749344709, "mean_action_processing_ms": 0.14522246855415444, "mean_env_wait_ms": 0.2556193087871654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015729188919067383, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.062186479568481445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66528, "timers": {"training_iteration_time_ms": 1978.269, "learn_time_ms": 19.127, "learn_throughput": 17566.692, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "done": false, "episodes_total": 198, "training_iteration": 198, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-24", "timestamp": 1706194644, "time_this_iter_s": 1.9518194198608398, "time_total_s": 389.7210605144501, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ccebbb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f7823485240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 389.7210605144501, "timesteps_since_restore": 0, "iterations_since_restore": 198, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 25.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.666391827303629e+16, "policy_entropy": 265.2279968261719, "var_gnorm": 22.66861343383789, "vf_loss": 4587324440576.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.504753112792969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 199, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761804.2727854617, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639, -735079.4238284271], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545530445859931, "mean_inference_ms": 5.230298011893953, "mean_action_processing_ms": 0.145228131516657, "mean_env_wait_ms": 0.25562380341352187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015714406967163086, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.06216788291931152}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -761804.2727854617, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-741258.5730640938, -760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639, -735079.4238284271], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545530445859931, "mean_inference_ms": 5.230298011893953, "mean_action_processing_ms": 0.145228131516657, "mean_env_wait_ms": 0.25562380341352187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015714406967163086, "StateBufferConnector_ms": 0.0022788047790527344, "ViewRequirementAgentConnector_ms": 0.06216788291931152}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66864, "timers": {"training_iteration_time_ms": 1975.56, "learn_time_ms": 19.112, "learn_throughput": 17580.761, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "done": false, "episodes_total": 199, "training_iteration": 199, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-26", "timestamp": 1706194646, "time_this_iter_s": 1.9558830261230469, "time_total_s": 391.6769435405731, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799ce3a4d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 391.6769435405731, "timesteps_since_restore": 0, "iterations_since_restore": 199, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.69933613194281e+16, "policy_entropy": 261.23870849609375, "var_gnorm": 22.66861343383789, "vf_loss": 5275248492544.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 200, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762297.4822246663, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639, -735079.4238284271, -790579.5169845703], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154557332610172, "mean_inference_ms": 5.230407893459828, "mean_action_processing_ms": 0.145233743973885, "mean_env_wait_ms": 0.25562817974109037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0156857967376709, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.06214642524719238}}, "episode_reward_max": -698141.1162798526, "episode_reward_min": -830547.836005254, "episode_reward_mean": -762297.4822246663, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-760387.4574931158, -771603.777720091, -801741.7387748649, -765332.7390437475, -776827.5931668079, -723076.5215603526, -788512.0399465467, -830547.836005254, -768223.9227895328, -757851.1853833249, -784946.2793341188, -805688.2015300739, -752362.0526736806, -751322.5044779424, -743934.9142398521, -796035.1254195825, -743618.4885905541, -765355.4857364097, -761740.7970767008, -745958.9539258998, -782680.924445783, -740174.3082161985, -756590.1164723294, -739183.9743796597, -762301.0964973395, -767048.2945890378, -773760.0244363573, -770024.1444813374, -767331.7788400099, -757847.0088516317, -812331.3574134631, -805725.9832714788, -749907.8838407199, -709594.4546302803, -750649.2384754451, -801658.8248150526, -768113.1812655204, -738229.2752947692, -788278.7379790915, -754456.5571986448, -760175.1658350998, -736369.3704537923, -778674.7041856259, -749031.5333927517, -787032.6023078228, -793340.1389077451, -775667.0063695564, -804322.6171910826, -758744.9398821038, -743320.1583144089, -793485.3706127718, -727803.7416601051, -749732.359313735, -774643.7006380484, -764002.6355150458, -741360.4967783053, -725110.7726480977, -777774.1933730621, -736814.6629179775, -826879.9069669466, -730783.7180038838, -759375.7657734489, -775893.0263709242, -726362.5101327767, -711306.9905320341, -796429.4586307933, -734587.8893373443, -776064.75298551, -752460.4821380515, -773838.885108751, -743418.8484431293, -753240.1807942997, -698141.1162798526, -715814.6557554887, -752859.8423306674, -730518.6462998345, -768393.457615628, -802472.2167926825, -725874.1064038561, -733546.9123301142, -823580.7318431049, -772048.7313985116, -766727.6607668907, -765108.1886858916, -780803.6867965799, -735504.8291757584, -726819.6709667683, -756632.9305438928, -733155.694311556, -776559.6082936596, -721880.6135360837, -772250.415283077, -755314.7756601559, -797274.0703122636, -766625.0530092244, -779539.0799605361, -753128.6575953016, -764510.563908639, -735079.4238284271, -790579.5169845703], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154557332610172, "mean_inference_ms": 5.230407893459828, "mean_action_processing_ms": 0.145233743973885, "mean_env_wait_ms": 0.25562817974109037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0156857967376709, "StateBufferConnector_ms": 0.0022776126861572266, "ViewRequirementAgentConnector_ms": 0.06214642524719238}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 67200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1974.095, "learn_time_ms": 19.081, "learn_throughput": 17608.747, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": true, "episodes_total": 200, "training_iteration": 200, "trial_id": "1d65c_00000", "experiment_id": "421b70bb4840442baba09335e14a90bf", "date": "2024-01-25_14-57-28", "timestamp": 1706194648, "time_this_iter_s": 1.972721815109253, "time_total_s": 393.6496653556824, "pid": 12997, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7f799c8f3490>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f78234b7910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 393.6496653556824, "timesteps_since_restore": 0, "iterations_since_restore": 200, "warmup_time": 3.194891929626465, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 25.96666666666667}}
