{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1527852288.0, "policy_entropy": 4295.3291015625, "var_gnorm": 22.627458572387695, "vf_loss": 23511215112192.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": 0.0, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -1661292.0442888488, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1661292.0442888488, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15690277167526834, "mean_inference_ms": 5.265827348748725, "mean_action_processing_ms": 0.1484470480627405, "mean_env_wait_ms": 0.26715332393476443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014758110046386719, "StateBufferConnector_ms": 0.002384185791015625, "ViewRequirementAgentConnector_ms": 0.06096363067626953}}, "episode_reward_max": -1661292.0442888488, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1661292.0442888488, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15690277167526834, "mean_inference_ms": 5.265827348748725, "mean_action_processing_ms": 0.1484470480627405, "mean_env_wait_ms": 0.26715332393476443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014758110046386719, "StateBufferConnector_ms": 0.002384185791015625, "ViewRequirementAgentConnector_ms": 0.06096363067626953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2027.15, "learn_time_ms": 56.005, "learn_throughput": 5999.439, "synch_weights_time_ms": 0.229}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-49", "timestamp": 1706263489, "time_this_iter_s": 2.027391195297241, "time_total_s": 2.027391195297241, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e870a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.027391195297241, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.099999999999999, "ram_util_percent": 8.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1195777792.0, "policy_entropy": 4257.00439453125, "var_gnorm": 22.629060745239258, "vf_loss": 14645169487872.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.9073486328125e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1495502.8769188724, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15668987733243503, "mean_inference_ms": 5.263599832077054, "mean_action_processing_ms": 0.14843830345865916, "mean_env_wait_ms": 0.2668776231826693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544952392578125, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.05996227264404297}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1495502.8769188724, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15668987733243503, "mean_inference_ms": 5.263599832077054, "mean_action_processing_ms": 0.14843830345865916, "mean_env_wait_ms": 0.2668776231826693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544952392578125, "StateBufferConnector_ms": 0.0024557113647460938, "ViewRequirementAgentConnector_ms": 0.05996227264404297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 2003.505, "learn_time_ms": 37.392, "learn_throughput": 8985.874, "synch_weights_time_ms": 0.184}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-51", "timestamp": 1706263491, "time_this_iter_s": 1.9800829887390137, "time_total_s": 4.007474184036255, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd944bd120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 4.007474184036255, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 8.733333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1317936256.0, "policy_entropy": 4091.661376953125, "var_gnorm": 22.630638122558594, "vf_loss": 18869880094720.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.5762786865234375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1492832.5956486177, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15648620752729614, "mean_inference_ms": 5.259716132004715, "mean_action_processing_ms": 0.14821266604673625, "mean_env_wait_ms": 0.26650434685058905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01529852549235026, "StateBufferConnector_ms": 0.0024398167928059897, "ViewRequirementAgentConnector_ms": 0.05946159362792969}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1492832.5956486177, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15648620752729614, "mean_inference_ms": 5.259716132004715, "mean_action_processing_ms": 0.14821266604673625, "mean_env_wait_ms": 0.26650434685058905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01529852549235026, "StateBufferConnector_ms": 0.0024398167928059897, "ViewRequirementAgentConnector_ms": 0.05946159362792969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 1992.438, "learn_time_ms": 31.204, "learn_throughput": 10767.746, "synch_weights_time_ms": 0.171}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-53", "timestamp": 1706263493, "time_this_iter_s": 1.9705426692962646, "time_total_s": 5.9780168533325195, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21d80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7c97250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 5.9780168533325195, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 8.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1115812608.0, "policy_entropy": 3645.994140625, "var_gnorm": 22.63355827331543, "vf_loss": 17440992919552.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.7220458984375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1471212.8671229798, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1559662632836929, "mean_inference_ms": 5.254552547804229, "mean_action_processing_ms": 0.1477747436098772, "mean_env_wait_ms": 0.26572180506605647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793872833251953, "StateBufferConnector_ms": 0.002366304397583008, "ViewRequirementAgentConnector_ms": 0.05872845649719238}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1471212.8671229798, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1559662632836929, "mean_inference_ms": 5.254552547804229, "mean_action_processing_ms": 0.1477747436098772, "mean_env_wait_ms": 0.26572180506605647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793872833251953, "StateBufferConnector_ms": 0.002366304397583008, "ViewRequirementAgentConnector_ms": 0.05872845649719238}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 1982.673, "learn_time_ms": 28.118, "learn_throughput": 11949.837, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-55", "timestamp": 1706263495, "time_this_iter_s": 1.9536197185516357, "time_total_s": 7.931636571884155, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94741420>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943272e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.931636571884155, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 8.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -961373120.0, "policy_entropy": 3253.71533203125, "var_gnorm": 22.635581970214844, "vf_loss": 16066807857152.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -7.3909759521484375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1450822.0475347564, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15544410705654654, "mean_inference_ms": 5.249731509019925, "mean_action_processing_ms": 0.14737902535331132, "mean_env_wait_ms": 0.2650236312690553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014519691467285156, "StateBufferConnector_ms": 0.00232696533203125, "ViewRequirementAgentConnector_ms": 0.05809307098388672}}, "episode_reward_max": -1329713.7095488962, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1450822.0475347564, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15544410705654654, "mean_inference_ms": 5.249731509019925, "mean_action_processing_ms": 0.14737902535331132, "mean_env_wait_ms": 0.2650236312690553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014519691467285156, "StateBufferConnector_ms": 0.00232696533203125, "ViewRequirementAgentConnector_ms": 0.05809307098388672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1976.579, "learn_time_ms": 26.209, "learn_throughput": 12820.247, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-57", "timestamp": 1706263497, "time_this_iter_s": 1.9524641036987305, "time_total_s": 9.884100675582886, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94327f40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.884100675582886, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 9.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -793330880.0, "policy_entropy": 2950.011962890625, "var_gnorm": 22.636241912841797, "vf_loss": 12372410368000.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.1086463928222656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -1214044.3328933395, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1411359.0950945204, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550432884804914, "mean_inference_ms": 5.245644464092394, "mean_action_processing_ms": 0.14703257840356967, "mean_env_wait_ms": 0.26443078859889385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014416376749674479, "StateBufferConnector_ms": 0.002304712931315104, "ViewRequirementAgentConnector_ms": 0.058150291442871094}}, "episode_reward_max": -1214044.3328933395, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1411359.0950945204, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550432884804914, "mean_inference_ms": 5.245644464092394, "mean_action_processing_ms": 0.14703257840356967, "mean_env_wait_ms": 0.26443078859889385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014416376749674479, "StateBufferConnector_ms": 0.002304712931315104, "ViewRequirementAgentConnector_ms": 0.058150291442871094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1972.87, "learn_time_ms": 25.003, "learn_throughput": 13438.261, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-04-59", "timestamp": 1706263499, "time_this_iter_s": 1.954575538635254, "time_total_s": 11.83867621421814, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c218a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94326440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.83867621421814, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 9.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -751675776.0, "policy_entropy": 2641.9619140625, "var_gnorm": 22.638240814208984, "vf_loss": 12203178590208.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3828277587890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -1210629.2963005574, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1382683.4095525257, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15474309318945925, "mean_inference_ms": 5.242480706366228, "mean_action_processing_ms": 0.14674848339945196, "mean_env_wait_ms": 0.26393929359715373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014322144644601005, "StateBufferConnector_ms": 0.0023092542375837055, "ViewRequirementAgentConnector_ms": 0.058453423636300225}}, "episode_reward_max": -1210629.2963005574, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1382683.4095525257, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15474309318945925, "mean_inference_ms": 5.242480706366228, "mean_action_processing_ms": 0.14674848339945196, "mean_env_wait_ms": 0.26393929359715373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014322144644601005, "StateBufferConnector_ms": 0.0023092542375837055, "ViewRequirementAgentConnector_ms": 0.058453423636300225}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1971.023, "learn_time_ms": 24.16, "learn_throughput": 13907.22, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-01", "timestamp": 1706263501, "time_this_iter_s": 1.960212230682373, "time_total_s": 13.798888444900513, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.798888444900513, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.05, "ram_util_percent": 9.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1032408576.0, "policy_entropy": 2326.89453125, "var_gnorm": 22.641206741333008, "vf_loss": 11834562183168.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.5139579772949219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -1172441.5105270534, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1356403.1721743415, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448039811436282, "mean_inference_ms": 5.24025920961167, "mean_action_processing_ms": 0.14652027959999903, "mean_env_wait_ms": 0.2635397390342057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014194846153259277, "StateBufferConnector_ms": 0.002306699752807617, "ViewRequirementAgentConnector_ms": 0.05817115306854248}}, "episode_reward_max": -1172441.5105270534, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1356403.1721743415, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15448039811436282, "mean_inference_ms": 5.24025920961167, "mean_action_processing_ms": 0.14652027959999903, "mean_env_wait_ms": 0.2635397390342057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014194846153259277, "StateBufferConnector_ms": 0.002306699752807617, "ViewRequirementAgentConnector_ms": 0.05817115306854248}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1970.399, "learn_time_ms": 23.467, "learn_throughput": 14318.267, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-03", "timestamp": 1706263503, "time_this_iter_s": 1.9663012027740479, "time_total_s": 15.76518964767456, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434d120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.76518964767456, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 9.266666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -78022197248.0, "policy_entropy": 2075.43359375, "var_gnorm": 22.64348793029785, "vf_loss": 11922470600704.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5497207641601562e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -1172441.5105270534, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1337236.4882577069, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423558931316098, "mean_inference_ms": 5.237984258536555, "mean_action_processing_ms": 0.14630423997137232, "mean_env_wait_ms": 0.2631628275966822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415146721733941, "StateBufferConnector_ms": 0.0022967656453450522, "ViewRequirementAgentConnector_ms": 0.05829864078097873}}, "episode_reward_max": -1172441.5105270534, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1337236.4882577069, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15423558931316098, "mean_inference_ms": 5.237984258536555, "mean_action_processing_ms": 0.14630423997137232, "mean_env_wait_ms": 0.2631628275966822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415146721733941, "StateBufferConnector_ms": 0.0022967656453450522, "ViewRequirementAgentConnector_ms": 0.05829864078097873}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1967.737, "learn_time_ms": 22.996, "learn_throughput": 14610.966, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-05", "timestamp": 1706263505, "time_this_iter_s": 1.946702480316162, "time_total_s": 17.711892127990723, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22dd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94325120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.711892127990723, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -94303420416.0, "policy_entropy": 1896.7462158203125, "var_gnorm": 22.644824981689453, "vf_loss": 10792430731264.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8715858459472656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313321.0235169563, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402361100507322, "mean_inference_ms": 5.236062494987456, "mean_action_processing_ms": 0.14611980410808184, "mean_env_wait_ms": 0.2628532519578282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014116764068603516, "StateBufferConnector_ms": 0.0022840499877929688, "ViewRequirementAgentConnector_ms": 0.058274269104003906}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313321.0235169563, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402361100507322, "mean_inference_ms": 5.236062494987456, "mean_action_processing_ms": 0.14611980410808184, "mean_env_wait_ms": 0.2628532519578282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014116764068603516, "StateBufferConnector_ms": 0.0022840499877929688, "ViewRequirementAgentConnector_ms": 0.058274269104003906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1966.788, "learn_time_ms": 22.579, "learn_throughput": 14880.894, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-07", "timestamp": 1706263507, "time_this_iter_s": 1.958524465560913, "time_total_s": 19.670416593551636, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca110>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.670416593551636, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 9.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -59148861440.0, "policy_entropy": 1783.0108642578125, "var_gnorm": 22.645530700683594, "vf_loss": 11277576437760.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.6927719116210938e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1298406.9605977833, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538376297917201, "mean_inference_ms": 5.2347395160890065, "mean_action_processing_ms": 0.14596729970759267, "mean_env_wait_ms": 0.26258495474603266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014638900756835938, "StateBufferConnector_ms": 0.002271478826349432, "ViewRequirementAgentConnector_ms": 0.0580917705189098}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1298406.9605977833, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538376297917201, "mean_inference_ms": 5.2347395160890065, "mean_action_processing_ms": 0.14596729970759267, "mean_env_wait_ms": 0.26258495474603266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014638900756835938, "StateBufferConnector_ms": 0.002271478826349432, "ViewRequirementAgentConnector_ms": 0.0580917705189098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1961.208, "learn_time_ms": 18.86, "learn_throughput": 17815.161, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-09", "timestamp": 1706263509, "time_this_iter_s": 1.9716155529022217, "time_total_s": 21.642032146453857, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434da20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.642032146453857, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 9.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -23543926784.0, "policy_entropy": 1717.48291015625, "var_gnorm": 22.64568328857422, "vf_loss": 12691135528960.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.800060272216797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290870.9938073666, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15368288076899275, "mean_inference_ms": 5.233898925077297, "mean_action_processing_ms": 0.1458479497853232, "mean_env_wait_ms": 0.26237291502157384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014563401540120443, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.058078765869140625}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290870.9938073666, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15368288076899275, "mean_inference_ms": 5.233898925077297, "mean_action_processing_ms": 0.1458479497853232, "mean_env_wait_ms": 0.26237291502157384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014563401540120443, "StateBufferConnector_ms": 0.002276897430419922, "ViewRequirementAgentConnector_ms": 0.058078765869140625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1960.913, "learn_time_ms": 18.871, "learn_throughput": 17805.145, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-11", "timestamp": 1706263511, "time_this_iter_s": 1.9772002696990967, "time_total_s": 23.619232416152954, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7c96710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.619232416152954, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 9.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9282168832.0, "policy_entropy": 1710.3486328125, "var_gnorm": 22.645477294921875, "vf_loss": 12528049455104.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.6570091247558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1285147.6500212548, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15352583270253184, "mean_inference_ms": 5.232964368877924, "mean_action_processing_ms": 0.14573158797448102, "mean_env_wait_ms": 0.2621707810079286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014488513653094951, "StateBufferConnector_ms": 0.0022869843703049878, "ViewRequirementAgentConnector_ms": 0.057954054612379804}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1285147.6500212548, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15352583270253184, "mean_inference_ms": 5.232964368877924, "mean_action_processing_ms": 0.14573158797448102, "mean_env_wait_ms": 0.2621707810079286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014488513653094951, "StateBufferConnector_ms": 0.0022869843703049878, "ViewRequirementAgentConnector_ms": 0.057954054612379804}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1958.681, "learn_time_ms": 18.87, "learn_throughput": 17805.708, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-13", "timestamp": 1706263513, "time_this_iter_s": 1.9482696056365967, "time_total_s": 25.56750202178955, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c239a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.56750202178955, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 9.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6635334144.0, "policy_entropy": 1699.5489501953125, "var_gnorm": 22.645599365234375, "vf_loss": 11322494287872.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8477439880371094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275235.569510572, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15338620730883154, "mean_inference_ms": 5.23214684281658, "mean_action_processing_ms": 0.14562540049442685, "mean_env_wait_ms": 0.26198149500547996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01442091805594308, "StateBufferConnector_ms": 0.002288818359375, "ViewRequirementAgentConnector_ms": 0.05791357585362026}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275235.569510572, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15338620730883154, "mean_inference_ms": 5.23214684281658, "mean_action_processing_ms": 0.14562540049442685, "mean_env_wait_ms": 0.26198149500547996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01442091805594308, "StateBufferConnector_ms": 0.002288818359375, "ViewRequirementAgentConnector_ms": 0.05791357585362026}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1959.382, "learn_time_ms": 18.886, "learn_throughput": 17790.782, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-15", "timestamp": 1706263515, "time_this_iter_s": 1.9606812000274658, "time_total_s": 27.528183221817017, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434e200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.528183221817017, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 9.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2751945984.0, "policy_entropy": 1710.85986328125, "var_gnorm": 22.645706176757812, "vf_loss": 12294568280064.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.8715858459472656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269718.649328734, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15326244595387745, "mean_inference_ms": 5.2313721930627946, "mean_action_processing_ms": 0.14553122276197844, "mean_env_wait_ms": 0.261818134393044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014352798461914062, "StateBufferConnector_ms": 0.0022824605305989585, "ViewRequirementAgentConnector_ms": 0.05785306294759115}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269718.649328734, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15326244595387745, "mean_inference_ms": 5.2313721930627946, "mean_action_processing_ms": 0.14553122276197844, "mean_env_wait_ms": 0.261818134393044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014352798461914062, "StateBufferConnector_ms": 0.0022824605305989585, "ViewRequirementAgentConnector_ms": 0.05785306294759115}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1959.89, "learn_time_ms": 18.878, "learn_throughput": 17798.242, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-17", "timestamp": 1706263517, "time_this_iter_s": 1.9575726985931396, "time_total_s": 29.485755920410156, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efee7e84550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.485755920410156, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.966666666666666, "ram_util_percent": 9.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -601608896.0, "policy_entropy": 1735.9669189453125, "var_gnorm": 22.645999908447266, "vf_loss": 12449438760960.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.609325408935547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265136.6818201193, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153152215347105, "mean_inference_ms": 5.23074933035023, "mean_action_processing_ms": 0.1454452893856979, "mean_env_wait_ms": 0.2616713374488894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014431774616241455, "StateBufferConnector_ms": 0.002281367778778076, "ViewRequirementAgentConnector_ms": 0.057984888553619385}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265136.6818201193, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153152215347105, "mean_inference_ms": 5.23074933035023, "mean_action_processing_ms": 0.1454452893856979, "mean_env_wait_ms": 0.2616713374488894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014431774616241455, "StateBufferConnector_ms": 0.002281367778778076, "ViewRequirementAgentConnector_ms": 0.057984888553619385}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1961.133, "learn_time_ms": 18.895, "learn_throughput": 17782.387, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-19", "timestamp": 1706263519, "time_this_iter_s": 1.967031717300415, "time_total_s": 31.45278763771057, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434d630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.45278763771057, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 9.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -809574848.0, "policy_entropy": 1720.098876953125, "var_gnorm": 22.646629333496094, "vf_loss": 10679238000640.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8477439880371094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257250.188134863, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305710326486235, "mean_inference_ms": 5.23026459155624, "mean_action_processing_ms": 0.145370959698933, "mean_env_wait_ms": 0.26154802004315075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014394872328814338, "StateBufferConnector_ms": 0.002283208510454963, "ViewRequirementAgentConnector_ms": 0.05803388707778033}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257250.188134863, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305710326486235, "mean_inference_ms": 5.23026459155624, "mean_action_processing_ms": 0.145370959698933, "mean_env_wait_ms": 0.26154802004315075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014394872328814338, "StateBufferConnector_ms": 0.002283208510454963, "ViewRequirementAgentConnector_ms": 0.05803388707778033}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1962.192, "learn_time_ms": 18.912, "learn_throughput": 17766.358, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-21", "timestamp": 1706263521, "time_this_iter_s": 1.9708354473114014, "time_total_s": 33.42362308502197, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d14e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434ec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.42362308502197, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 10.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1093133568.0, "policy_entropy": 1754.51611328125, "var_gnorm": 22.647104263305664, "vf_loss": 11656350400512.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.6689300537109375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251242.326908252, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529675543928242, "mean_inference_ms": 5.229825005850982, "mean_action_processing_ms": 0.14530232856208544, "mean_env_wait_ms": 0.26143261201624146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014409754011366103, "StateBufferConnector_ms": 0.002284844716389974, "ViewRequirementAgentConnector_ms": 0.05800591574774848}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251242.326908252, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529675543928242, "mean_inference_ms": 5.229825005850982, "mean_action_processing_ms": 0.14530232856208544, "mean_env_wait_ms": 0.26143261201624146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014409754011366103, "StateBufferConnector_ms": 0.002284844716389974, "ViewRequirementAgentConnector_ms": 0.05800591574774848}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1961.68, "learn_time_ms": 18.949, "learn_throughput": 17731.687, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-23", "timestamp": 1706263523, "time_this_iter_s": 1.9611976146697998, "time_total_s": 35.38482069969177, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca890>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434cb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.38482069969177, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.149999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -886367872.0, "policy_entropy": 1812.3306884765625, "var_gnorm": 22.647518157958984, "vf_loss": 11190117859328.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5616416931152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1245885.6982179594, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288505046985906, "mean_inference_ms": 5.229423020736883, "mean_action_processing_ms": 0.14523960048854367, "mean_env_wait_ms": 0.26132637788529395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014720465007581209, "StateBufferConnector_ms": 0.0022800345169870476, "ViewRequirementAgentConnector_ms": 0.05809382388466283}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1245885.6982179594, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15288505046985906, "mean_inference_ms": 5.229423020736883, "mean_action_processing_ms": 0.14523960048854367, "mean_env_wait_ms": 0.26132637788529395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014720465007581209, "StateBufferConnector_ms": 0.0022800345169870476, "ViewRequirementAgentConnector_ms": 0.05809382388466283}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1963.182, "learn_time_ms": 18.93, "learn_throughput": 17749.933, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-25", "timestamp": 1706263525, "time_this_iter_s": 1.9617481231689453, "time_total_s": 37.34656882286072, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434dea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.34656882286072, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 10.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -577988992.0, "policy_entropy": 1839.7159423828125, "var_gnorm": 22.64811134338379, "vf_loss": 13880793235456.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.430511474609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1247862.1716218563, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281215044828625, "mean_inference_ms": 5.229090597137601, "mean_action_processing_ms": 0.14518578814597585, "mean_env_wait_ms": 0.26123382537752937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01468658447265625, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.05807161331176758}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1247862.1716218563, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15281215044828625, "mean_inference_ms": 5.229090597137601, "mean_action_processing_ms": 0.14518578814597585, "mean_env_wait_ms": 0.26123382537752937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01468658447265625, "StateBufferConnector_ms": 0.0022780895233154297, "ViewRequirementAgentConnector_ms": 0.05807161331176758}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1964.153, "learn_time_ms": 18.937, "learn_throughput": 17743.051, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-27", "timestamp": 1706263527, "time_this_iter_s": 1.9682645797729492, "time_total_s": 39.31483340263367, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d02e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.31483340263367, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 10.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -585232960.0, "policy_entropy": 1858.71484375, "var_gnorm": 22.649166107177734, "vf_loss": 13983455117312.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.4901161193847656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249868.674060632, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274401329891382, "mean_inference_ms": 5.228868094679911, "mean_action_processing_ms": 0.14513608496835614, "mean_env_wait_ms": 0.2611483933588872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014708155677432106, "StateBufferConnector_ms": 0.002277465093703497, "ViewRequirementAgentConnector_ms": 0.058117366972423735}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249868.674060632, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274401329891382, "mean_inference_ms": 5.228868094679911, "mean_action_processing_ms": 0.14513608496835614, "mean_env_wait_ms": 0.2611483933588872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014708155677432106, "StateBufferConnector_ms": 0.002277465093703497, "ViewRequirementAgentConnector_ms": 0.058117366972423735}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1964.432, "learn_time_ms": 18.943, "learn_throughput": 17737.378, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-29", "timestamp": 1706263529, "time_this_iter_s": 1.9744393825531006, "time_total_s": 41.28927278518677, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943245e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.28927278518677, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -612146944.0, "policy_entropy": 1870.4163818359375, "var_gnorm": 22.650800704956055, "vf_loss": 15403162009600.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.2636184692382812e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253431.135231456, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15268754030636125, "mean_inference_ms": 5.2286739216608815, "mean_action_processing_ms": 0.14509176021133954, "mean_env_wait_ms": 0.26107128367494625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01476244492964311, "StateBufferConnector_ms": 0.002289902080189098, "ViewRequirementAgentConnector_ms": 0.05841146815906872}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253431.135231456, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15268754030636125, "mean_inference_ms": 5.2286739216608815, "mean_action_processing_ms": 0.14509176021133954, "mean_env_wait_ms": 0.26107128367494625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01476244492964311, "StateBufferConnector_ms": 0.002289902080189098, "ViewRequirementAgentConnector_ms": 0.05841146815906872}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1963.392, "learn_time_ms": 18.971, "learn_throughput": 17711.164, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-31", "timestamp": 1706263531, "time_this_iter_s": 1.9668211936950684, "time_total_s": 43.256093978881836, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434eb90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.256093978881836, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 10.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -670279808.0, "policy_entropy": 1905.4466552734375, "var_gnorm": 22.651954650878906, "vf_loss": 16262030688256.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3828277587890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1259357.9252038067, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15264312100864005, "mean_inference_ms": 5.228639553825783, "mean_action_processing_ms": 0.14505433827533779, "mean_env_wait_ms": 0.26101018556081135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014735304790994396, "StateBufferConnector_ms": 0.0022846719493036685, "ViewRequirementAgentConnector_ms": 0.05838456361190132}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1259357.9252038067, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15264312100864005, "mean_inference_ms": 5.228639553825783, "mean_action_processing_ms": 0.14505433827533779, "mean_env_wait_ms": 0.26101018556081135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014735304790994396, "StateBufferConnector_ms": 0.0022846719493036685, "ViewRequirementAgentConnector_ms": 0.05838456361190132}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1967.883, "learn_time_ms": 18.987, "learn_throughput": 17696.463, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-33", "timestamp": 1706263533, "time_this_iter_s": 1.9932115077972412, "time_total_s": 45.24930548667908, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94324430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.24930548667908, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -664128512.0, "policy_entropy": 1948.1771240234375, "var_gnorm": 22.652315139770508, "vf_loss": 15193780256768.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.4543533325195312e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262672.3651337523, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260543879997004, "mean_inference_ms": 5.22864546735047, "mean_action_processing_ms": 0.14502137519538122, "mean_env_wait_ms": 0.26095547016352844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014895200729370117, "StateBufferConnector_ms": 0.0022798776626586914, "ViewRequirementAgentConnector_ms": 0.05844732125600179}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262672.3651337523, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260543879997004, "mean_inference_ms": 5.22864546735047, "mean_action_processing_ms": 0.14502137519538122, "mean_env_wait_ms": 0.26095547016352844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014895200729370117, "StateBufferConnector_ms": 0.0022798776626586914, "ViewRequirementAgentConnector_ms": 0.05844732125600179}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1969.221, "learn_time_ms": 19.002, "learn_throughput": 17682.142, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-35", "timestamp": 1706263535, "time_this_iter_s": 1.9740619659423828, "time_total_s": 47.22336745262146, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd947414b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.22336745262146, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 10.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -606101568.0, "policy_entropy": 1957.9801025390625, "var_gnorm": 22.652509689331055, "vf_loss": 15211951030272.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.5974044799804688e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1266638.8047904624, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15257659888311198, "mean_inference_ms": 5.228689917184911, "mean_action_processing_ms": 0.14499347828623738, "mean_env_wait_ms": 0.2609108074938997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014872550964355469, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.05847644805908203}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1266638.8047904624, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15257659888311198, "mean_inference_ms": 5.228689917184911, "mean_action_processing_ms": 0.14499347828623738, "mean_env_wait_ms": 0.2609108074938997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014872550964355469, "StateBufferConnector_ms": 0.0022792816162109375, "ViewRequirementAgentConnector_ms": 0.05847644805908203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1971.168, "learn_time_ms": 19.049, "learn_throughput": 17638.478, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-37", "timestamp": 1706263537, "time_this_iter_s": 1.9770762920379639, "time_total_s": 49.200443744659424, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9090>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434e320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.200443744659424, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.25, "ram_util_percent": 10.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -733942720.0, "policy_entropy": 1981.5985107421875, "var_gnorm": 22.65322494506836, "vf_loss": 15814558220288.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3470649719238281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269936.4623390527, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15255117219273162, "mean_inference_ms": 5.228766363215057, "mean_action_processing_ms": 0.14496686797530553, "mean_env_wait_ms": 0.2608683698951138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014843390538142277, "StateBufferConnector_ms": 0.002278731419489934, "ViewRequirementAgentConnector_ms": 0.0584712395301232}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269936.4623390527, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15255117219273162, "mean_inference_ms": 5.228766363215057, "mean_action_processing_ms": 0.14496686797530553, "mean_env_wait_ms": 0.2608683698951138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014843390538142277, "StateBufferConnector_ms": 0.002278731419489934, "ViewRequirementAgentConnector_ms": 0.0584712395301232}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1971.924, "learn_time_ms": 19.073, "learn_throughput": 17616.209, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-39", "timestamp": 1706263539, "time_this_iter_s": 1.9746124744415283, "time_total_s": 51.17505621910095, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c210f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434ef80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.17505621910095, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 10.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -812460864.0, "policy_entropy": 1950.9263916015625, "var_gnorm": 22.65424919128418, "vf_loss": 14269022208000.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.537799835205078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1271371.8353748068, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252987287557704, "mean_inference_ms": 5.228803895077918, "mean_action_processing_ms": 0.1449435648210031, "mean_env_wait_ms": 0.2608265142114133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014819922270598236, "StateBufferConnector_ms": 0.0022755728827582467, "ViewRequirementAgentConnector_ms": 0.058537059360080294}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1271371.8353748068, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252987287557704, "mean_inference_ms": 5.228803895077918, "mean_action_processing_ms": 0.1449435648210031, "mean_env_wait_ms": 0.2608265142114133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014819922270598236, "StateBufferConnector_ms": 0.0022755728827582467, "ViewRequirementAgentConnector_ms": 0.058537059360080294}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1970.747, "learn_time_ms": 19.067, "learn_throughput": 17621.936, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-41", "timestamp": 1706263541, "time_this_iter_s": 1.9591107368469238, "time_total_s": 53.134166955947876, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434e950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.134166955947876, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 10.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1319708544.0, "policy_entropy": 1870.767333984375, "var_gnorm": 22.655649185180664, "vf_loss": 13118421860352.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.4901161193847656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269424.6425853225, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15251033131992228, "mean_inference_ms": 5.228810017437892, "mean_action_processing_ms": 0.1449209812921656, "mean_env_wait_ms": 0.26078475813218654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014775991439819336, "StateBufferConnector_ms": 0.002273491450718471, "ViewRequirementAgentConnector_ms": 0.05855390003749302}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269424.6425853225, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15251033131992228, "mean_inference_ms": 5.228810017437892, "mean_action_processing_ms": 0.1449209812921656, "mean_env_wait_ms": 0.26078475813218654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014775991439819336, "StateBufferConnector_ms": 0.002273491450718471, "ViewRequirementAgentConnector_ms": 0.05855390003749302}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1970.435, "learn_time_ms": 19.089, "learn_throughput": 17601.314, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-43", "timestamp": 1706263543, "time_this_iter_s": 1.9581327438354492, "time_total_s": 55.092299699783325, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94326dd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 55.092299699783325, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1341191552.0, "policy_entropy": 1851.3951416015625, "var_gnorm": 22.65660285949707, "vf_loss": 11278181466112.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.5974044799804688e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265563.0358394855, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15249239297589015, "mean_inference_ms": 5.2288435060275456, "mean_action_processing_ms": 0.14490037554302854, "mean_env_wait_ms": 0.26074667776503263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014839501216493804, "StateBufferConnector_ms": 0.002269087166621767, "ViewRequirementAgentConnector_ms": 0.058512852109711744}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265563.0358394855, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15249239297589015, "mean_inference_ms": 5.2288435060275456, "mean_action_processing_ms": 0.14490037554302854, "mean_env_wait_ms": 0.26074667776503263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014839501216493804, "StateBufferConnector_ms": 0.002269087166621767, "ViewRequirementAgentConnector_ms": 0.058512852109711744}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1971.698, "learn_time_ms": 19.089, "learn_throughput": 17601.446, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-45", "timestamp": 1706263545, "time_this_iter_s": 1.974390983581543, "time_total_s": 57.06669068336487, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23eb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94388af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 57.06669068336487, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 11.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4521666048.0, "policy_entropy": 1781.7548828125, "var_gnorm": 22.657859802246094, "vf_loss": 13128486092800.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5139579772949219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 30, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1264234.6466582115, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247759412660722, "mean_inference_ms": 5.228866906866739, "mean_action_processing_ms": 0.144881185301822, "mean_env_wait_ms": 0.26071214356907235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0150299072265625, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.05857070287068685}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1264234.6466582115, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247759412660722, "mean_inference_ms": 5.228866906866739, "mean_action_processing_ms": 0.144881185301822, "mean_env_wait_ms": 0.26071214356907235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0150299072265625, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.05857070287068685}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 1971.342, "learn_time_ms": 19.082, "learn_throughput": 17608.659, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-47", "timestamp": 1706263547, "time_this_iter_s": 1.9646871089935303, "time_total_s": 59.0313777923584, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434dab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 59.0313777923584, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333333, "ram_util_percent": 11.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2847096320.0, "policy_entropy": 1773.02294921875, "var_gnorm": 22.658687591552734, "vf_loss": 12127654903808.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.609325408935547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 31, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261710.7645125668, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246311750493124, "mean_inference_ms": 5.228867190702088, "mean_action_processing_ms": 0.1448621745921756, "mean_env_wait_ms": 0.2606775599934367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979608597293977, "StateBufferConnector_ms": 0.0022718983311806958, "ViewRequirementAgentConnector_ms": 0.05858175216182586}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261710.7645125668, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15246311750493124, "mean_inference_ms": 5.228867190702088, "mean_action_processing_ms": 0.1448621745921756, "mean_env_wait_ms": 0.2606775599934367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979608597293977, "StateBufferConnector_ms": 0.0022718983311806958, "ViewRequirementAgentConnector_ms": 0.05858175216182586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 1969.673, "learn_time_ms": 19.063, "learn_throughput": 17626.058, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-49", "timestamp": 1706263549, "time_this_iter_s": 1.957777500152588, "time_total_s": 60.989155292510986, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccbb50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94388790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 60.989155292510986, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 11.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6465237504.0, "policy_entropy": 1709.794189453125, "var_gnorm": 22.65976333618164, "vf_loss": 13289721430016.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.6570091247558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 32, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261101.7997890054, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244850973591415, "mean_inference_ms": 5.22882254331432, "mean_action_processing_ms": 0.1448425398074185, "mean_env_wait_ms": 0.2606414856110353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149458646774292, "StateBufferConnector_ms": 0.002271682024002075, "ViewRequirementAgentConnector_ms": 0.0585898756980896}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1261101.7997890054, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244850973591415, "mean_inference_ms": 5.22882254331432, "mean_action_processing_ms": 0.1448425398074185, "mean_env_wait_ms": 0.2606414856110353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0149458646774292, "StateBufferConnector_ms": 0.002271682024002075, "ViewRequirementAgentConnector_ms": 0.0585898756980896}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1967.856, "learn_time_ms": 19.074, "learn_throughput": 17615.174, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-51", "timestamp": 1706263551, "time_this_iter_s": 1.9486579895019531, "time_total_s": 62.93781328201294, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 62.93781328201294, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 11.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -457198305280.0, "policy_entropy": 1594.847900390625, "var_gnorm": 22.661226272583008, "vf_loss": 12704806862848.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.704692840576172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 33, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1259567.52175814, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524367057850515, "mean_inference_ms": 5.228767262677267, "mean_action_processing_ms": 0.14482490044122007, "mean_env_wait_ms": 0.2606085400428734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014920668168501421, "StateBufferConnector_ms": 0.0022707563458066998, "ViewRequirementAgentConnector_ms": 0.0586155689123905}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1259567.52175814, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524367057850515, "mean_inference_ms": 5.228767262677267, "mean_action_processing_ms": 0.14482490044122007, "mean_env_wait_ms": 0.2606085400428734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014920668168501421, "StateBufferConnector_ms": 0.0022707563458066998, "ViewRequirementAgentConnector_ms": 0.0586155689123905}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 1964.746, "learn_time_ms": 19.091, "learn_throughput": 17599.643, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-53", "timestamp": 1706263553, "time_this_iter_s": 1.9621281623840332, "time_total_s": 64.89994144439697, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21ea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94389000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 64.89994144439697, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333334, "ram_util_percent": 11.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -610275491840.0, "policy_entropy": 1549.011962890625, "var_gnorm": 22.662160873413086, "vf_loss": 11770459586560.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.7523765563964844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 34, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257085.836181064, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242864378519133, "mean_inference_ms": 5.228740563934335, "mean_action_processing_ms": 0.1448095150275617, "mean_env_wait_ms": 0.26058108356159765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014893447651582606, "StateBufferConnector_ms": 0.002267781425924862, "ViewRequirementAgentConnector_ms": 0.05865868400124943}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257085.836181064, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15242864378519133, "mean_inference_ms": 5.228740563934335, "mean_action_processing_ms": 0.1448095150275617, "mean_env_wait_ms": 0.26058108356159765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014893447651582606, "StateBufferConnector_ms": 0.002267781425924862, "ViewRequirementAgentConnector_ms": 0.05865868400124943}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 1965.203, "learn_time_ms": 19.109, "learn_throughput": 17582.911, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-55", "timestamp": 1706263555, "time_this_iter_s": 1.9786925315856934, "time_total_s": 66.87863397598267, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21ff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.87863397598267, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 11.566666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -816542384128.0, "policy_entropy": 1550.7205810546875, "var_gnorm": 22.662525177001953, "vf_loss": 13155465953280.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.633167266845703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 35, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1256576.010143768, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524228213992631, "mean_inference_ms": 5.228718923968725, "mean_action_processing_ms": 0.1447945491731427, "mean_env_wait_ms": 0.2605593318463095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014863695417131697, "StateBufferConnector_ms": 0.0022670200892857145, "ViewRequirementAgentConnector_ms": 0.05863325936453683}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1256576.010143768, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524228213992631, "mean_inference_ms": 5.228718923968725, "mean_action_processing_ms": 0.1447945491731427, "mean_env_wait_ms": 0.2605593318463095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014863695417131697, "StateBufferConnector_ms": 0.0022670200892857145, "ViewRequirementAgentConnector_ms": 0.05863325936453683}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 1964.422, "learn_time_ms": 19.094, "learn_throughput": 17597.314, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-57", "timestamp": 1706263557, "time_this_iter_s": 1.9692816734313965, "time_total_s": 68.84791564941406, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94389900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 68.84791564941406, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 11.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -700674408448.0, "policy_entropy": 1603.0374755859375, "var_gnorm": 22.6624813079834, "vf_loss": 12796797386752.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3709068298339844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 36, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1255481.1629937761, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241708192859652, "mean_inference_ms": 5.228686997447339, "mean_action_processing_ms": 0.14477948523289821, "mean_env_wait_ms": 0.2605369745705657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014824337429470487, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05861123402913412}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1255481.1629937761, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241708192859652, "mean_inference_ms": 5.228686997447339, "mean_action_processing_ms": 0.14477948523289821, "mean_env_wait_ms": 0.2605369745705657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014824337429470487, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05861123402913412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 1962.893, "learn_time_ms": 19.031, "learn_throughput": 17655.05, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-05-59", "timestamp": 1706263559, "time_this_iter_s": 1.9593572616577148, "time_total_s": 70.80727291107178, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecc730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434e440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.80727291107178, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 11.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -576321617920.0, "policy_entropy": 1593.827880859375, "var_gnorm": 22.662900924682617, "vf_loss": 12083955499008.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.6450881958007812e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 37, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253288.3306466513, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241093738207473, "mean_inference_ms": 5.228623352043513, "mean_action_processing_ms": 0.1447639825233675, "mean_env_wait_ms": 0.2605144822261689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014784529402449325, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05860844173946896}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1253288.3306466513, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15241093738207473, "mean_inference_ms": 5.228623352043513, "mean_action_processing_ms": 0.1447639825233675, "mean_env_wait_ms": 0.2605144822261689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014784529402449325, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05860844173946896}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 1961.894, "learn_time_ms": 19.043, "learn_throughput": 17644.595, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-01", "timestamp": 1706263561, "time_this_iter_s": 1.9491186141967773, "time_total_s": 72.75639152526855, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94389000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.75639152526855, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.95, "ram_util_percent": 11.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -918686597120.0, "policy_entropy": 1630.4615478515625, "var_gnorm": 22.662899017333984, "vf_loss": 11567286452224.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.5139579772949219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 38, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250735.1580989067, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240672844170555, "mean_inference_ms": 5.228617702761823, "mean_action_processing_ms": 0.14475060651911137, "mean_env_wait_ms": 0.260497474405965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951981996235094, "StateBufferConnector_ms": 0.0022630942495245683, "ViewRequirementAgentConnector_ms": 0.05860265932585064}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250735.1580989067, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240672844170555, "mean_inference_ms": 5.228617702761823, "mean_action_processing_ms": 0.14475060651911137, "mean_env_wait_ms": 0.260497474405965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951981996235094, "StateBufferConnector_ms": 0.0022630942495245683, "ViewRequirementAgentConnector_ms": 0.05860265932585064}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 1965.669, "learn_time_ms": 19.073, "learn_throughput": 17616.539, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-03", "timestamp": 1706263563, "time_this_iter_s": 1.99586820602417, "time_total_s": 74.75225973129272, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438a830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.75225973129272, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7901883904.0, "policy_entropy": 1707.739501953125, "var_gnorm": 22.662614822387695, "vf_loss": 12511401213952.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.7642974853515625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 39, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249605.3506619483, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240462310933856, "mean_inference_ms": 5.228624694375805, "mean_action_processing_ms": 0.14473878760218228, "mean_env_wait_ms": 0.26048208486397106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951290228427986, "StateBufferConnector_ms": 0.0022637538420848357, "ViewRequirementAgentConnector_ms": 0.05860267541347406}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249605.3506619483, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240462310933856, "mean_inference_ms": 5.228624694375805, "mean_action_processing_ms": 0.14473878760218228, "mean_env_wait_ms": 0.26048208486397106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014951290228427986, "StateBufferConnector_ms": 0.0022637538420848357, "ViewRequirementAgentConnector_ms": 0.05860267541347406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 1965.657, "learn_time_ms": 19.086, "learn_throughput": 17604.106, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-05", "timestamp": 1706263565, "time_this_iter_s": 1.974311351776123, "time_total_s": 76.72657108306885, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438a7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.72657108306885, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -144710991872.0, "policy_entropy": 1828.18896484375, "var_gnorm": 22.662166595458984, "vf_loss": 13071019933696.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.2755393981933594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 40, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249419.543349528, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240340663689653, "mean_inference_ms": 5.228638725790833, "mean_action_processing_ms": 0.14472839357688444, "mean_env_wait_ms": 0.26046908312271444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494288444519043, "StateBufferConnector_ms": 0.0022590160369873047, "ViewRequirementAgentConnector_ms": 0.05857586860656738}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249419.543349528, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240340663689653, "mean_inference_ms": 5.228638725790833, "mean_action_processing_ms": 0.14472839357688444, "mean_env_wait_ms": 0.26046908312271444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01494288444519043, "StateBufferConnector_ms": 0.0022590160369873047, "ViewRequirementAgentConnector_ms": 0.05857586860656738}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1966.418, "learn_time_ms": 19.133, "learn_throughput": 17561.417, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-07", "timestamp": 1706263567, "time_this_iter_s": 1.9723503589630127, "time_total_s": 78.69892144203186, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc96f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438acb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 78.69892144203186, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 12.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2841148928.0, "policy_entropy": 1880.4755859375, "var_gnorm": 22.662086486816406, "vf_loss": 13775493136384.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.430511474609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 41, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249494.8803039677, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240276945225764, "mean_inference_ms": 5.22864652851012, "mean_action_processing_ms": 0.14471813579875514, "mean_env_wait_ms": 0.26045725003094994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014975594311225705, "StateBufferConnector_ms": 0.0022591614141696838, "ViewRequirementAgentConnector_ms": 0.05857770035906536}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1249494.8803039677, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240276945225764, "mean_inference_ms": 5.22864652851012, "mean_action_processing_ms": 0.14471813579875514, "mean_env_wait_ms": 0.26045725003094994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014975594311225705, "StateBufferConnector_ms": 0.0022591614141696838, "ViewRequirementAgentConnector_ms": 0.05857770035906536}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 1966.98, "learn_time_ms": 19.141, "learn_throughput": 17553.805, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-09", "timestamp": 1706263569, "time_this_iter_s": 1.9633944034576416, "time_total_s": 80.6623158454895, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccaf50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94324a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.6623158454895, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 12.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -14284792832.0, "policy_entropy": 1974.421142578125, "var_gnorm": 22.661911010742188, "vf_loss": 14653935583232.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.3828277587890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 42, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251139.0796805103, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240129171046185, "mean_inference_ms": 5.2286369965606285, "mean_action_processing_ms": 0.14470723139386732, "mean_env_wait_ms": 0.2604440421892799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014977795737130302, "StateBufferConnector_ms": 0.0022581645420619418, "ViewRequirementAgentConnector_ms": 0.05861180169241769}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251139.0796805103, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240129171046185, "mean_inference_ms": 5.2286369965606285, "mean_action_processing_ms": 0.14470723139386732, "mean_env_wait_ms": 0.2604440421892799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014977795737130302, "StateBufferConnector_ms": 0.0022581645420619418, "ViewRequirementAgentConnector_ms": 0.05861180169241769}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 1967.557, "learn_time_ms": 19.163, "learn_throughput": 17533.799, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-11", "timestamp": 1706263571, "time_this_iter_s": 1.9544506072998047, "time_total_s": 82.6167664527893, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21390>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94388820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 82.6167664527893, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2133173248.0, "policy_entropy": 2104.025634765625, "var_gnorm": 22.661624908447266, "vf_loss": 12910579417088.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.3113021850585938e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 43, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250827.4222855323, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524016069685824, "mean_inference_ms": 5.2286760815875075, "mean_action_processing_ms": 0.1446980288089626, "mean_env_wait_ms": 0.2604325020161813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014975459076637445, "StateBufferConnector_ms": 0.0022577684979106106, "ViewRequirementAgentConnector_ms": 0.05861603936483694}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250827.4222855323, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524016069685824, "mean_inference_ms": 5.2286760815875075, "mean_action_processing_ms": 0.1446980288089626, "mean_env_wait_ms": 0.2604325020161813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014975459076637445, "StateBufferConnector_ms": 0.0022577684979106106, "ViewRequirementAgentConnector_ms": 0.05861603936483694}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 1971.219, "learn_time_ms": 19.176, "learn_throughput": 17522.049, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-13", "timestamp": 1706263573, "time_this_iter_s": 1.9988162517547607, "time_total_s": 84.61558270454407, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94388700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.61558270454407, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 12.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1352822912.0, "policy_entropy": 2175.445068359375, "var_gnorm": 22.661575317382812, "vf_loss": 14210283077632.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.2755393981933594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 44, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251477.0336086086, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240230476027694, "mean_inference_ms": 5.228699925351254, "mean_action_processing_ms": 0.14468939213739873, "mean_env_wait_ms": 0.2604209832547428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014943968166004528, "StateBufferConnector_ms": 0.002257932316173207, "ViewRequirementAgentConnector_ms": 0.05864284255287864}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251477.0336086086, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15240230476027694, "mean_inference_ms": 5.228699925351254, "mean_action_processing_ms": 0.14468939213739873, "mean_env_wait_ms": 0.2604209832547428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014943968166004528, "StateBufferConnector_ms": 0.002257932316173207, "ViewRequirementAgentConnector_ms": 0.05864284255287864}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 1969.168, "learn_time_ms": 19.146, "learn_throughput": 17549.236, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-15", "timestamp": 1706263575, "time_this_iter_s": 1.9581842422485352, "time_total_s": 86.5737669467926, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20a60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438b9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 86.5737669467926, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 12.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -955920704.0, "policy_entropy": 2228.7587890625, "var_gnorm": 22.66122817993164, "vf_loss": 13536910639104.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0132789611816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 45, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251260.1896731833, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524043419900359, "mean_inference_ms": 5.228738524331323, "mean_action_processing_ms": 0.14468148396510577, "mean_env_wait_ms": 0.2604109141929912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014928711785210503, "StateBufferConnector_ms": 0.002258088853624132, "ViewRequirementAgentConnector_ms": 0.05867375267876519}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251260.1896731833, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524043419900359, "mean_inference_ms": 5.228738524331323, "mean_action_processing_ms": 0.14468148396510577, "mean_env_wait_ms": 0.2604109141929912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014928711785210503, "StateBufferConnector_ms": 0.002258088853624132, "ViewRequirementAgentConnector_ms": 0.05867375267876519}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 1970.214, "learn_time_ms": 19.216, "learn_throughput": 17485.829, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-17", "timestamp": 1706263577, "time_this_iter_s": 1.9798176288604736, "time_total_s": 88.55358457565308, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438b880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.55358457565308, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1143223936.0, "policy_entropy": 2324.072021484375, "var_gnorm": 22.660648345947266, "vf_loss": 12534838984704.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.2993812561035156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 46, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250408.7987421788, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524062666179706, "mean_inference_ms": 5.2287714983260845, "mean_action_processing_ms": 0.144673244216499, "mean_env_wait_ms": 0.26039989968733374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042139136272928, "StateBufferConnector_ms": 0.0022566836813221807, "ViewRequirementAgentConnector_ms": 0.05865926327912704}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1250408.7987421788, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524062666179706, "mean_inference_ms": 5.2287714983260845, "mean_action_processing_ms": 0.144673244216499, "mean_env_wait_ms": 0.26039989968733374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015042139136272928, "StateBufferConnector_ms": 0.0022566836813221807, "ViewRequirementAgentConnector_ms": 0.05865926327912704}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 1970.571, "learn_time_ms": 19.269, "learn_throughput": 17436.977, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-19", "timestamp": 1706263579, "time_this_iter_s": 1.9629461765289307, "time_total_s": 90.516530752182, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.516530752182, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 12.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -749374528.0, "policy_entropy": 2451.024169921875, "var_gnorm": 22.660131454467773, "vf_loss": 14120712667136.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0728836059570312e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 47, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251794.7993152225, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524157882810515, "mean_inference_ms": 5.2289616048145735, "mean_action_processing_ms": 0.14467182394935738, "mean_env_wait_ms": 0.26040050296445405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015104070622870263, "StateBufferConnector_ms": 0.002263454680747174, "ViewRequirementAgentConnector_ms": 0.05899997467690326}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1251794.7993152225, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524157882810515, "mean_inference_ms": 5.2289616048145735, "mean_action_processing_ms": 0.14467182394935738, "mean_env_wait_ms": 0.26040050296445405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015104070622870263, "StateBufferConnector_ms": 0.002263454680747174, "ViewRequirementAgentConnector_ms": 0.05899997467690326}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 1986.161, "learn_time_ms": 19.365, "learn_throughput": 17351.189, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-21", "timestamp": 1706263581, "time_this_iter_s": 2.1051025390625, "time_total_s": 92.6216332912445, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2140>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 92.6216332912445, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 10.4, "ram_util_percent": 12.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -804280064.0, "policy_entropy": 2525.930419921875, "var_gnorm": 22.65987777709961, "vf_loss": 15921767776256.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.2636184692382812e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 48, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1254532.0292995798, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243136378126887, "mean_inference_ms": 5.2292621282138665, "mean_action_processing_ms": 0.14467528673638666, "mean_env_wait_ms": 0.2604110124625913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082955360412598, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05900909503300985}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1254532.0292995798, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15243136378126887, "mean_inference_ms": 5.2292621282138665, "mean_action_processing_ms": 0.14467528673638666, "mean_env_wait_ms": 0.2604110124625913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082955360412598, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.05900909503300985}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1994.4, "learn_time_ms": 19.331, "learn_throughput": 17381.685, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-23", "timestamp": 1706263583, "time_this_iter_s": 2.0783047676086426, "time_total_s": 94.69993805885315, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c210f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.69993805885315, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 9.366666666666665, "ram_util_percent": 12.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -848499520.0, "policy_entropy": 2628.905029296875, "var_gnorm": 22.659610748291016, "vf_loss": 17866703241216.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.225440979003906e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 49, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257771.775188442, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244576863916814, "mean_inference_ms": 5.229546046495424, "mean_action_processing_ms": 0.14467808682257557, "mean_env_wait_ms": 0.2604207585523392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015114764777981505, "StateBufferConnector_ms": 0.002264489932936065, "ViewRequirementAgentConnector_ms": 0.059013950581453284}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1257771.775188442, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15244576863916814, "mean_inference_ms": 5.229546046495424, "mean_action_processing_ms": 0.14467808682257557, "mean_env_wait_ms": 0.2604207585523392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015114764777981505, "StateBufferConnector_ms": 0.002264489932936065, "ViewRequirementAgentConnector_ms": 0.059013950581453284}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 1993.702, "learn_time_ms": 19.317, "learn_throughput": 17393.741, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-25", "timestamp": 1706263585, "time_this_iter_s": 1.967350721359253, "time_total_s": 96.6672887802124, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434e440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 96.6672887802124, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 13.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -861760320.0, "policy_entropy": 2706.952880859375, "var_gnorm": 22.659282684326172, "vf_loss": 18656685719552.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -8.344650268554688e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 50, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262018.8404512352, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245932139603202, "mean_inference_ms": 5.229812221463611, "mean_action_processing_ms": 0.1446806488243082, "mean_env_wait_ms": 0.26042959722028786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015105247497558594, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05901765823364258}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1262018.8404512352, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15245932139603202, "mean_inference_ms": 5.229812221463611, "mean_action_processing_ms": 0.1446806488243082, "mean_env_wait_ms": 0.26042959722028786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015105247497558594, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05901765823364258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 1993.042, "learn_time_ms": 19.287, "learn_throughput": 17421.479, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-27", "timestamp": 1706263587, "time_this_iter_s": 1.965780258178711, "time_total_s": 98.63306903839111, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21c90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9434f7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98.63306903839111, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 13.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -888697792.0, "policy_entropy": 2796.96435546875, "var_gnorm": 22.659160614013672, "vf_loss": 17392113549312.0}, "grad_gnorm": 39.99999237060547, "vf_explained_var": -8.344650268554688e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 51, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265372.0182721158, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247188391558159, "mean_inference_ms": 5.2300589408172335, "mean_action_processing_ms": 0.14468217375668177, "mean_env_wait_ms": 0.26043718191196524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103583242378983, "StateBufferConnector_ms": 0.0022631065518248315, "ViewRequirementAgentConnector_ms": 0.059020285512886794}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1265372.0182721158, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15247188391558159, "mean_inference_ms": 5.2300589408172335, "mean_action_processing_ms": 0.14468217375668177, "mean_env_wait_ms": 0.26043718191196524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015103583242378983, "StateBufferConnector_ms": 0.0022631065518248315, "ViewRequirementAgentConnector_ms": 0.059020285512886794}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 1992.869, "learn_time_ms": 19.293, "learn_throughput": 17415.688, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-29", "timestamp": 1706263589, "time_this_iter_s": 1.9617085456848145, "time_total_s": 100.59477758407593, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438ab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 100.59477758407593, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 13.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -936742656.0, "policy_entropy": 2882.95361328125, "var_gnorm": 22.65927505493164, "vf_loss": 18855512506368.0}, "grad_gnorm": 40.0, "vf_explained_var": -7.748603820800781e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 52, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269668.8080609585, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524837463265757, "mean_inference_ms": 5.230302624903496, "mean_action_processing_ms": 0.14468325639473825, "mean_env_wait_ms": 0.2604441865135158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087311084453877, "StateBufferConnector_ms": 0.0022613085233248197, "ViewRequirementAgentConnector_ms": 0.05901455879211426}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1269668.8080609585, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1524837463265757, "mean_inference_ms": 5.230302624903496, "mean_action_processing_ms": 0.14468325639473825, "mean_env_wait_ms": 0.2604441865135158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015087311084453877, "StateBufferConnector_ms": 0.0022613085233248197, "ViewRequirementAgentConnector_ms": 0.05901455879211426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 1995.092, "learn_time_ms": 19.251, "learn_throughput": 17453.973, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-31", "timestamp": 1706263591, "time_this_iter_s": 1.9767022132873535, "time_total_s": 102.57147979736328, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20fa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438a0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 102.57147979736328, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 13.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -972565696.0, "policy_entropy": 2987.760009765625, "var_gnorm": 22.659503936767578, "vf_loss": 18640973856768.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.821487426757812e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 53, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1273871.2151595724, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15249579136806762, "mean_inference_ms": 5.230540041578809, "mean_action_processing_ms": 0.14468432876232454, "mean_env_wait_ms": 0.2604514646083006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015058157578954156, "StateBufferConnector_ms": 0.0022618275768352004, "ViewRequirementAgentConnector_ms": 0.059008148481261055}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1273871.2151595724, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15249579136806762, "mean_inference_ms": 5.230540041578809, "mean_action_processing_ms": 0.14468432876232454, "mean_env_wait_ms": 0.2604514646083006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015058157578954156, "StateBufferConnector_ms": 0.0022618275768352004, "ViewRequirementAgentConnector_ms": 0.059008148481261055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 1992.783, "learn_time_ms": 19.233, "learn_throughput": 17469.681, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-33", "timestamp": 1706263593, "time_this_iter_s": 1.9757344722747803, "time_total_s": 104.54721426963806, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccada0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b09d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 104.54721426963806, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 13.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -969293696.0, "policy_entropy": 3031.82373046875, "var_gnorm": 22.659652709960938, "vf_loss": 18329641156608.0}, "grad_gnorm": 40.0, "vf_explained_var": -7.987022399902344e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 54, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277369.4972437848, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15250749470802982, "mean_inference_ms": 5.230778202423671, "mean_action_processing_ms": 0.1446850881068461, "mean_env_wait_ms": 0.26045906175076006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503008383291739, "StateBufferConnector_ms": 0.0022601198267053675, "ViewRequirementAgentConnector_ms": 0.05899976800989221}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277369.4972437848, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15250749470802982, "mean_inference_ms": 5.230778202423671, "mean_action_processing_ms": 0.1446850881068461, "mean_env_wait_ms": 0.26045906175076006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503008383291739, "StateBufferConnector_ms": 0.0022601198267053675, "ViewRequirementAgentConnector_ms": 0.05899976800989221}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 1995.097, "learn_time_ms": 19.211, "learn_throughput": 17489.605, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-35", "timestamp": 1706263595, "time_this_iter_s": 1.9813241958618164, "time_total_s": 106.52853846549988, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438a950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.52853846549988, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 13.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1029820544.0, "policy_entropy": 3040.125244140625, "var_gnorm": 22.659832000732422, "vf_loss": 20652448808960.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -7.152557373046875e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 55, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1282029.4527534095, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252159026410372, "mean_inference_ms": 5.231056696603329, "mean_action_processing_ms": 0.14468810810012175, "mean_env_wait_ms": 0.2604702557186116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015025572343306108, "StateBufferConnector_ms": 0.0022623755715110087, "ViewRequirementAgentConnector_ms": 0.05911133506081321}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1282029.4527534095, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252159026410372, "mean_inference_ms": 5.231056696603329, "mean_action_processing_ms": 0.14468810810012175, "mean_env_wait_ms": 0.2604702557186116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015025572343306108, "StateBufferConnector_ms": 0.0022623755715110087, "ViewRequirementAgentConnector_ms": 0.05911133506081321}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 2000.206, "learn_time_ms": 19.139, "learn_throughput": 17555.882, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-37", "timestamp": 1706263597, "time_this_iter_s": 2.0308940410614014, "time_total_s": 108.55943250656128, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b0a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 108.55943250656128, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.566666666666667, "ram_util_percent": 13.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1015030656.0, "policy_entropy": 3069.943115234375, "var_gnorm": 22.6600341796875, "vf_loss": 20153974652928.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -7.3909759521484375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 56, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1286609.2957956109, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525360790053032, "mean_inference_ms": 5.231337566614633, "mean_action_processing_ms": 0.14469138094149692, "mean_env_wait_ms": 0.2604816879462464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01502079623086112, "StateBufferConnector_ms": 0.002261570521763393, "ViewRequirementAgentConnector_ms": 0.059123124395098}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1286609.2957956109, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525360790053032, "mean_inference_ms": 5.231337566614633, "mean_action_processing_ms": 0.14469138094149692, "mean_env_wait_ms": 0.2604816879462464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01502079623086112, "StateBufferConnector_ms": 0.002261570521763393, "ViewRequirementAgentConnector_ms": 0.059123124395098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 2002.717, "learn_time_ms": 19.111, "learn_throughput": 17581.485, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-39", "timestamp": 1706263599, "time_this_iter_s": 1.9880781173706055, "time_total_s": 110.54751062393188, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccaa40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b1750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 110.54751062393188, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.7, "ram_util_percent": 13.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1034737920.0, "policy_entropy": 3119.108154296875, "var_gnorm": 22.660526275634766, "vf_loss": 19816513536000.0}, "grad_gnorm": 39.99999237060547, "vf_explained_var": -7.271766662597656e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 57, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290259.0497605256, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15255276147881502, "mean_inference_ms": 5.2316426188120815, "mean_action_processing_ms": 0.14469664284255554, "mean_env_wait_ms": 0.2604965669593277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015119084140710663, "StateBufferConnector_ms": 0.002262048554002193, "ViewRequirementAgentConnector_ms": 0.0591345000685307}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290259.0497605256, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15255276147881502, "mean_inference_ms": 5.2316426188120815, "mean_action_processing_ms": 0.14469664284255554, "mean_env_wait_ms": 0.2604965669593277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015119084140710663, "StateBufferConnector_ms": 0.002262048554002193, "ViewRequirementAgentConnector_ms": 0.0591345000685307}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 1994.203, "learn_time_ms": 18.966, "learn_throughput": 17715.461, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-41", "timestamp": 1706263601, "time_this_iter_s": 2.0199134349823, "time_total_s": 112.56742405891418, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21e10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438b880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 112.56742405891418, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 8.066666666666666, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1005979904.0, "policy_entropy": 3147.2861328125, "var_gnorm": 22.660810470581055, "vf_loss": 18809721192448.0}, "grad_gnorm": 40.0, "vf_explained_var": -6.198883056640625e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 58, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293667.6894556638, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525715254565539, "mean_inference_ms": 5.231986200861961, "mean_action_processing_ms": 0.14470368440321502, "mean_env_wait_ms": 0.2605146077067769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015119026447164601, "StateBufferConnector_ms": 0.002264154368433459, "ViewRequirementAgentConnector_ms": 0.059165214670115505}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293667.6894556638, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1525715254565539, "mean_inference_ms": 5.231986200861961, "mean_action_processing_ms": 0.14470368440321502, "mean_env_wait_ms": 0.2605146077067769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015119026447164601, "StateBufferConnector_ms": 0.002264154368433459, "ViewRequirementAgentConnector_ms": 0.059165214670115505}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 1990.272, "learn_time_ms": 18.941, "learn_throughput": 17738.874, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-43", "timestamp": 1706263603, "time_this_iter_s": 2.038999080657959, "time_total_s": 114.60642313957214, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b0af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 114.60642313957214, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -960169216.0, "policy_entropy": 3144.956787109375, "var_gnorm": 22.66098403930664, "vf_loss": 16860774924288.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -6.67572021484375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 59, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295444.9911466, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15258975075177822, "mean_inference_ms": 5.2323191264132145, "mean_action_processing_ms": 0.14471035242286917, "mean_env_wait_ms": 0.26053152083295456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015116546113612288, "StateBufferConnector_ms": 0.002262551905745167, "ViewRequirementAgentConnector_ms": 0.059183169219453456}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295444.9911466, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15258975075177822, "mean_inference_ms": 5.2323191264132145, "mean_action_processing_ms": 0.14471035242286917, "mean_env_wait_ms": 0.26053152083295456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015116546113612288, "StateBufferConnector_ms": 0.002262551905745167, "ViewRequirementAgentConnector_ms": 0.059183169219453456}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 1991.089, "learn_time_ms": 18.92, "learn_throughput": 17758.679, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-45", "timestamp": 1706263605, "time_this_iter_s": 1.9755675792694092, "time_total_s": 116.58199071884155, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b2680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 116.58199071884155, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 13.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1024918016.0, "policy_entropy": 3155.42333984375, "var_gnorm": 22.66132164001465, "vf_loss": 19738809860096.0}, "grad_gnorm": 40.0, "vf_explained_var": -6.9141387939453125e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 60, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1299430.758710453, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260799227917762, "mean_inference_ms": 5.232648012493581, "mean_action_processing_ms": 0.144717039158165, "mean_env_wait_ms": 0.26054917162629054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101432800292969, "StateBufferConnector_ms": 0.0022629896799723306, "ViewRequirementAgentConnector_ms": 0.05917032559712728}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1299430.758710453, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15260799227917762, "mean_inference_ms": 5.232648012493581, "mean_action_processing_ms": 0.144717039158165, "mean_env_wait_ms": 0.26054917162629054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015101432800292969, "StateBufferConnector_ms": 0.0022629896799723306, "ViewRequirementAgentConnector_ms": 0.05917032559712728}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 1993.166, "learn_time_ms": 18.931, "learn_throughput": 17748.279, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-48", "timestamp": 1706263608, "time_this_iter_s": 1.9865944385528564, "time_total_s": 118.56858515739441, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21e10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b29e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 118.56858515739441, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 13.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1042892352.0, "policy_entropy": 3188.189697265625, "var_gnorm": 22.661333084106445, "vf_loss": 19693970653184.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -6.4373016357421875e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 61, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1302454.8763625573, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526255325483235, "mean_inference_ms": 5.232962024526711, "mean_action_processing_ms": 0.1447233589302646, "mean_env_wait_ms": 0.2605656073911844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015081733953757365, "StateBufferConnector_ms": 0.0022618497004274463, "ViewRequirementAgentConnector_ms": 0.0591895619376761}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1302454.8763625573, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526255325483235, "mean_inference_ms": 5.232962024526711, "mean_action_processing_ms": 0.1447233589302646, "mean_env_wait_ms": 0.2605656073911844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015081733953757365, "StateBufferConnector_ms": 0.0022618497004274463, "ViewRequirementAgentConnector_ms": 0.0591895619376761}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 1993.9, "learn_time_ms": 18.936, "learn_throughput": 17744.369, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-49", "timestamp": 1706263609, "time_this_iter_s": 1.9690542221069336, "time_total_s": 120.53763937950134, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 120.53763937950134, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1057200448.0, "policy_entropy": 3224.401123046875, "var_gnorm": 22.661724090576172, "vf_loss": 19855921119232.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -6.794929504394531e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 62, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1305753.2097430346, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15264155524406087, "mean_inference_ms": 5.233252761388477, "mean_action_processing_ms": 0.14472886866015056, "mean_env_wait_ms": 0.26058083752497707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015090742418842932, "StateBufferConnector_ms": 0.0022607464944162676, "ViewRequirementAgentConnector_ms": 0.05921702231130292}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1305753.2097430346, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15264155524406087, "mean_inference_ms": 5.233252761388477, "mean_action_processing_ms": 0.14472886866015056, "mean_env_wait_ms": 0.26058083752497707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015090742418842932, "StateBufferConnector_ms": 0.0022607464944162676, "ViewRequirementAgentConnector_ms": 0.05921702231130292}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 1991.835, "learn_time_ms": 18.989, "learn_throughput": 17694.174, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-51", "timestamp": 1706263611, "time_this_iter_s": 1.9560799598693848, "time_total_s": 122.49371933937073, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1060>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b30a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 122.49371933937073, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 14.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -942352512.0, "policy_entropy": 3229.78515625, "var_gnorm": 22.662721633911133, "vf_loss": 16011543707648.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.106231689453125e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 63, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1306822.1735963246, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526573447625406, "mean_inference_ms": 5.233538121896755, "mean_action_processing_ms": 0.14473399234102577, "mean_env_wait_ms": 0.2605956225547345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083191886780754, "StateBufferConnector_ms": 0.0022592998686290925, "ViewRequirementAgentConnector_ms": 0.059230365450420076}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1306822.1735963246, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1526573447625406, "mean_inference_ms": 5.233538121896755, "mean_action_processing_ms": 0.14473399234102577, "mean_env_wait_ms": 0.2605956225547345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015083191886780754, "StateBufferConnector_ms": 0.0022592998686290925, "ViewRequirementAgentConnector_ms": 0.059230365450420076}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 1992.291, "learn_time_ms": 18.978, "learn_throughput": 17705.111, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-53", "timestamp": 1706263613, "time_this_iter_s": 1.9803247451782227, "time_total_s": 124.47404408454895, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c228f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b2f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 124.47404408454895, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 14.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1040685504.0, "policy_entropy": 3235.2744140625, "var_gnorm": 22.66368293762207, "vf_loss": 19353269436416.0}, "grad_gnorm": 40.0, "vf_explained_var": -7.152557373046875e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 64, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1309947.5067024692, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15267341371960458, "mean_inference_ms": 5.233837154934301, "mean_action_processing_ms": 0.14473952907056603, "mean_env_wait_ms": 0.26061154555575006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015070289373397827, "StateBufferConnector_ms": 0.0022586435079574585, "ViewRequirementAgentConnector_ms": 0.05923546850681305}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1309947.5067024692, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15267341371960458, "mean_inference_ms": 5.233837154934301, "mean_action_processing_ms": 0.14473952907056603, "mean_env_wait_ms": 0.26061154555575006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015070289373397827, "StateBufferConnector_ms": 0.0022586435079574585, "ViewRequirementAgentConnector_ms": 0.05923546850681305}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1995.219, "learn_time_ms": 19.014, "learn_throughput": 17670.746, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-56", "timestamp": 1706263616, "time_this_iter_s": 2.0106303691864014, "time_total_s": 126.48467445373535, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b2680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 126.48467445373535, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.466666666666668, "ram_util_percent": 14.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -996133888.0, "policy_entropy": 3246.075439453125, "var_gnorm": 22.664945602416992, "vf_loss": 17376349257728.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.463859558105469e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 65, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1312114.941354588, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15269177131420583, "mean_inference_ms": 5.234165164452954, "mean_action_processing_ms": 0.14474695824798386, "mean_env_wait_ms": 0.2606305419757889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015183228712815505, "StateBufferConnector_ms": 0.0022620421189528247, "ViewRequirementAgentConnector_ms": 0.059284063485952526}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1312114.941354588, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15269177131420583, "mean_inference_ms": 5.234165164452954, "mean_action_processing_ms": 0.14474695824798386, "mean_env_wait_ms": 0.2606305419757889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015183228712815505, "StateBufferConnector_ms": 0.0022620421189528247, "ViewRequirementAgentConnector_ms": 0.059284063485952526}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 1996.346, "learn_time_ms": 19.042, "learn_throughput": 17645.523, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-06-58", "timestamp": 1706263618, "time_this_iter_s": 2.0422043800354004, "time_total_s": 128.52687883377075, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438a0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 128.52687883377075, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 8.833333333333334, "ram_util_percent": 14.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -949586944.0, "policy_entropy": 3259.41015625, "var_gnorm": 22.66646385192871, "vf_loss": 16112063348736.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.940696716308594e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 66, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313169.0792478137, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15271065743866502, "mean_inference_ms": 5.234496066889306, "mean_action_processing_ms": 0.14475490378006975, "mean_env_wait_ms": 0.26065074388254783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015162337910045277, "StateBufferConnector_ms": 0.0022617253390225496, "ViewRequirementAgentConnector_ms": 0.05927736108953303}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1313169.0792478137, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15271065743866502, "mean_inference_ms": 5.234496066889306, "mean_action_processing_ms": 0.14475490378006975, "mean_env_wait_ms": 0.26065074388254783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015162337910045277, "StateBufferConnector_ms": 0.0022617253390225496, "ViewRequirementAgentConnector_ms": 0.05927736108953303}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 1997.615, "learn_time_ms": 19.026, "learn_throughput": 17660.493, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-00", "timestamp": 1706263620, "time_this_iter_s": 2.000802755355835, "time_total_s": 130.5276815891266, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21600>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b1240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 130.5276815891266, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 8.033333333333333, "ram_util_percent": 14.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -888374720.0, "policy_entropy": 3317.36181640625, "var_gnorm": 22.668411254882812, "vf_loss": 13753287442432.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -8.344650268554688e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 67, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1312505.0988663333, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15272825886205882, "mean_inference_ms": 5.234800480951481, "mean_action_processing_ms": 0.1447618357363191, "mean_env_wait_ms": 0.26066865003624895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015180858213510087, "StateBufferConnector_ms": 0.0022628414097116954, "ViewRequirementAgentConnector_ms": 0.059318898329094275}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1312505.0988663333, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15272825886205882, "mean_inference_ms": 5.234800480951481, "mean_action_processing_ms": 0.1447618357363191, "mean_env_wait_ms": 0.26066865003624895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015180858213510087, "StateBufferConnector_ms": 0.0022628414097116954, "ViewRequirementAgentConnector_ms": 0.059318898329094275}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 1990.43, "learn_time_ms": 19.136, "learn_throughput": 17558.747, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-02", "timestamp": 1706263622, "time_this_iter_s": 1.9481215476989746, "time_total_s": 132.47580313682556, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20ca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b1bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 132.47580313682556, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 14.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -871459648.0, "policy_entropy": 3383.10791015625, "var_gnorm": 22.669885635375977, "vf_loss": 12527018704896.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.0132789611816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 68, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1311066.0157564199, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527473546228047, "mean_inference_ms": 5.235127155295252, "mean_action_processing_ms": 0.14476998480875136, "mean_env_wait_ms": 0.2606888064707158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015201288111069623, "StateBufferConnector_ms": 0.002271287581499885, "ViewRequirementAgentConnector_ms": 0.05934343618505141}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1311066.0157564199, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1527473546228047, "mean_inference_ms": 5.235127155295252, "mean_action_processing_ms": 0.14476998480875136, "mean_env_wait_ms": 0.2606888064707158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015201288111069623, "StateBufferConnector_ms": 0.002271287581499885, "ViewRequirementAgentConnector_ms": 0.05934343618505141}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 1990.071, "learn_time_ms": 19.186, "learn_throughput": 17512.904, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-04", "timestamp": 1706263624, "time_this_iter_s": 2.035468339920044, "time_total_s": 134.5112714767456, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23eb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b3880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 134.5112714767456, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.8, "ram_util_percent": 14.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -887675328.0, "policy_entropy": 3441.2177734375, "var_gnorm": 22.671770095825195, "vf_loss": 12449759625216.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.049041748046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 69, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1309281.4763449659, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15276702792924027, "mean_inference_ms": 5.235465094885287, "mean_action_processing_ms": 0.14477888788654564, "mean_env_wait_ms": 0.2607103904136888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015206613402435745, "StateBufferConnector_ms": 0.0022711961165718412, "ViewRequirementAgentConnector_ms": 0.05939490553261577}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1309281.4763449659, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15276702792924027, "mean_inference_ms": 5.235465094885287, "mean_action_processing_ms": 0.14477888788654564, "mean_env_wait_ms": 0.2607103904136888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015206613402435745, "StateBufferConnector_ms": 0.0022711961165718412, "ViewRequirementAgentConnector_ms": 0.05939490553261577}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 1994.248, "learn_time_ms": 19.195, "learn_throughput": 17504.855, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-06", "timestamp": 1706263626, "time_this_iter_s": 2.0173678398132324, "time_total_s": 136.52863931655884, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18910>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b36d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 136.52863931655884, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 14.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -869865344.0, "policy_entropy": 3481.085205078125, "var_gnorm": 22.67433738708496, "vf_loss": 11516707340288.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.1801719665527344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 70, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1307292.6833924057, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15278810071424126, "mean_inference_ms": 5.235820561927577, "mean_action_processing_ms": 0.14478920445416488, "mean_env_wait_ms": 0.2607342103544849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015244483947753906, "StateBufferConnector_ms": 0.0022758756365094867, "ViewRequirementAgentConnector_ms": 0.05959068025861468}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1307292.6833924057, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15278810071424126, "mean_inference_ms": 5.235820561927577, "mean_action_processing_ms": 0.14478920445416488, "mean_env_wait_ms": 0.2607342103544849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015244483947753906, "StateBufferConnector_ms": 0.0022758756365094867, "ViewRequirementAgentConnector_ms": 0.05959068025861468}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 1999.055, "learn_time_ms": 19.27, "learn_throughput": 17436.718, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-08", "timestamp": 1706263628, "time_this_iter_s": 2.0347249507904053, "time_total_s": 138.56336426734924, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21cf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b31c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 138.56336426734924, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 8.700000000000001, "ram_util_percent": 14.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -930222656.0, "policy_entropy": 3537.203857421875, "var_gnorm": 22.676176071166992, "vf_loss": 12969681354752.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.2159347534179688e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 71, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1306128.290992519, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280813732348034, "mean_inference_ms": 5.236159118187419, "mean_action_processing_ms": 0.14479879356347375, "mean_env_wait_ms": 0.260756743029383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015244685428243287, "StateBufferConnector_ms": 0.0022733715218557437, "ViewRequirementAgentConnector_ms": 0.05960027936478736}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1306128.290992519, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15280813732348034, "mean_inference_ms": 5.236159118187419, "mean_action_processing_ms": 0.14479879356347375, "mean_env_wait_ms": 0.260756743029383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015244685428243287, "StateBufferConnector_ms": 0.0022733715218557437, "ViewRequirementAgentConnector_ms": 0.05960027936478736}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 1998.579, "learn_time_ms": 19.248, "learn_throughput": 17455.962, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-10", "timestamp": 1706263630, "time_this_iter_s": 1.9643378257751465, "time_total_s": 140.5277020931244, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 140.5277020931244, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.566666666666666, "ram_util_percent": 15.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -899022528.0, "policy_entropy": 3609.353759765625, "var_gnorm": 22.677356719970703, "vf_loss": 11741675126784.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.2516975402832031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 72, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1304161.717992704, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528272916020622, "mean_inference_ms": 5.236478699386423, "mean_action_processing_ms": 0.14480771911688442, "mean_env_wait_ms": 0.260777888958636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015243887901306152, "StateBufferConnector_ms": 0.0022749106089274087, "ViewRequirementAgentConnector_ms": 0.05965497758653429}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1304161.717992704, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528272916020622, "mean_inference_ms": 5.236478699386423, "mean_action_processing_ms": 0.14480771911688442, "mean_env_wait_ms": 0.260777888958636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015243887901306152, "StateBufferConnector_ms": 0.0022749106089274087, "ViewRequirementAgentConnector_ms": 0.05965497758653429}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1998.919, "learn_time_ms": 19.197, "learn_throughput": 17503.181, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-12", "timestamp": 1706263632, "time_this_iter_s": 1.9594900608062744, "time_total_s": 142.48719215393066, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b2b00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 142.48719215393066, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 15.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -890252928.0, "policy_entropy": 3693.57373046875, "var_gnorm": 22.677837371826172, "vf_loss": 11018591797248.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.4543533325195312e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 73, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1301934.0194175062, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528455680020183, "mean_inference_ms": 5.236780654034296, "mean_action_processing_ms": 0.14481595240870798, "mean_env_wait_ms": 0.26079769799532454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015309412185459921, "StateBufferConnector_ms": 0.002275427726850118, "ViewRequirementAgentConnector_ms": 0.059675190546741225}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1301934.0194175062, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528455680020183, "mean_inference_ms": 5.236780654034296, "mean_action_processing_ms": 0.14481595240870798, "mean_env_wait_ms": 0.26079769799532454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015309412185459921, "StateBufferConnector_ms": 0.002275427726850118, "ViewRequirementAgentConnector_ms": 0.059675190546741225}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 1996.823, "learn_time_ms": 19.169, "learn_throughput": 17528.217, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-14", "timestamp": 1706263634, "time_this_iter_s": 1.9593980312347412, "time_total_s": 144.4465901851654, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22c20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 144.4465901851654, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 15.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1000685248.0, "policy_entropy": 3763.598876953125, "var_gnorm": 22.679059982299805, "vf_loss": 13791184027648.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.0848045349121094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 74, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1301179.0967410295, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286279734019645, "mean_inference_ms": 5.23705962190549, "mean_action_processing_ms": 0.14482359654313506, "mean_env_wait_ms": 0.2608162981785708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152823087331411, "StateBufferConnector_ms": 0.002273353370460304, "ViewRequirementAgentConnector_ms": 0.05966263848382074}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1301179.0967410295, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15286279734019645, "mean_inference_ms": 5.23705962190549, "mean_action_processing_ms": 0.14482359654313506, "mean_env_wait_ms": 0.2608162981785708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152823087331411, "StateBufferConnector_ms": 0.002273353370460304, "ViewRequirementAgentConnector_ms": 0.05966263848382074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 1990.498, "learn_time_ms": 19.096, "learn_throughput": 17595.688, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-16", "timestamp": 1706263636, "time_this_iter_s": 1.947399377822876, "time_total_s": 146.39398956298828, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21d20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b30a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 146.39398956298828, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 15.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -956626432.0, "policy_entropy": 3808.3017578125, "var_gnorm": 22.681072235107422, "vf_loss": 11719753596928.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.4185905456542969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 75, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1299488.6982924705, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528796864414645, "mean_inference_ms": 5.237330425291243, "mean_action_processing_ms": 0.144831017874733, "mean_env_wait_ms": 0.26083428285685367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295982360839844, "StateBufferConnector_ms": 0.0022751490275065103, "ViewRequirementAgentConnector_ms": 0.059729576110839844}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1299488.6982924705, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1528796864414645, "mean_inference_ms": 5.237330425291243, "mean_action_processing_ms": 0.144831017874733, "mean_env_wait_ms": 0.26083428285685367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295982360839844, "StateBufferConnector_ms": 0.0022751490275065103, "ViewRequirementAgentConnector_ms": 0.059729576110839844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1983.931, "learn_time_ms": 19.114, "learn_throughput": 17578.349, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-18", "timestamp": 1706263638, "time_this_iter_s": 1.9765443801879883, "time_total_s": 148.37053394317627, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e91b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 148.37053394317627, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.233333333333333, "ram_util_percent": 15.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -949859968.0, "policy_entropy": 3830.98681640625, "var_gnorm": 22.683704376220703, "vf_loss": 11612018704384.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.7762184143066406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 76, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297898.71400603, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15289595462123562, "mean_inference_ms": 5.237588522599364, "mean_action_processing_ms": 0.14483813859376068, "mean_env_wait_ms": 0.26085136150742894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295806683992086, "StateBufferConnector_ms": 0.0022747014698229337, "ViewRequirementAgentConnector_ms": 0.05972197181300113}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297898.71400603, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15289595462123562, "mean_inference_ms": 5.237588522599364, "mean_action_processing_ms": 0.14483813859376068, "mean_env_wait_ms": 0.26085136150742894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015295806683992086, "StateBufferConnector_ms": 0.0022747014698229337, "ViewRequirementAgentConnector_ms": 0.05972197181300113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 1980.348, "learn_time_ms": 19.081, "learn_throughput": 17609.143, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-20", "timestamp": 1706263640, "time_this_iter_s": 1.9650189876556396, "time_total_s": 150.3355529308319, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b39a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 150.3355529308319, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 15.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1023408896.0, "policy_entropy": 3836.037353515625, "var_gnorm": 22.68682098388672, "vf_loss": 13038960771072.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.4424324035644531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 77, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297143.724250497, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529118239896473, "mean_inference_ms": 5.23783567338293, "mean_action_processing_ms": 0.14484505832063727, "mean_env_wait_ms": 0.26086783399499774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290371783368, "StateBufferConnector_ms": 0.0022751944405691965, "ViewRequirementAgentConnector_ms": 0.05977091851172509}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297143.724250497, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529118239896473, "mean_inference_ms": 5.23783567338293, "mean_action_processing_ms": 0.14484505832063727, "mean_env_wait_ms": 0.26086783399499774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290371783368, "StateBufferConnector_ms": 0.0022751944405691965, "ViewRequirementAgentConnector_ms": 0.05977091851172509}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 1982.411, "learn_time_ms": 18.979, "learn_throughput": 17703.888, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-22", "timestamp": 1706263642, "time_this_iter_s": 1.9687609672546387, "time_total_s": 152.30431389808655, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca050>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 152.30431389808655, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 15.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1091121536.0, "policy_entropy": 3862.460205078125, "var_gnorm": 22.68895149230957, "vf_loss": 14208060096512.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.3947486877441406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 78, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297040.4940491104, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292718414513792, "mean_inference_ms": 5.238075207987915, "mean_action_processing_ms": 0.14485183627393175, "mean_env_wait_ms": 0.26088370733864014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267042013315054, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.059780096396421775}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1297040.4940491104, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15292718414513792, "mean_inference_ms": 5.238075207987915, "mean_action_processing_ms": 0.14485183627393175, "mean_env_wait_ms": 0.26088370733864014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267042013315054, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.059780096396421775}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 1976.274, "learn_time_ms": 18.91, "learn_throughput": 17768.06, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-24", "timestamp": 1706263644, "time_this_iter_s": 1.9741199016571045, "time_total_s": 154.27843379974365, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca9e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b3910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 154.27843379974365, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 15.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1048041600.0, "policy_entropy": 3869.63916015625, "var_gnorm": 22.691679000854492, "vf_loss": 12083878952960.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.6570091247558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 79, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295915.0214878363, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529417012394823, "mean_inference_ms": 5.238295801781932, "mean_action_processing_ms": 0.14485791098698897, "mean_env_wait_ms": 0.2608979427319986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015253960331784019, "StateBufferConnector_ms": 0.00227101241485982, "ViewRequirementAgentConnector_ms": 0.05978360960755167}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1295915.0214878363, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529417012394823, "mean_inference_ms": 5.238295801781932, "mean_action_processing_ms": 0.14485791098698897, "mean_env_wait_ms": 0.2608979427319986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015253960331784019, "StateBufferConnector_ms": 0.00227101241485982, "ViewRequirementAgentConnector_ms": 0.05978360960755167}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 1969.105, "learn_time_ms": 18.918, "learn_throughput": 17760.559, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-26", "timestamp": 1706263646, "time_this_iter_s": 1.9456813335418701, "time_total_s": 156.22411513328552, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22860>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e93f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 156.22411513328552, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 15.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1028201600.0, "policy_entropy": 3895.81787109375, "var_gnorm": 22.693355560302734, "vf_loss": 11670956015616.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.3589859008789062e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 80, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1294159.0054519055, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15295554216088747, "mean_inference_ms": 5.238506578367764, "mean_action_processing_ms": 0.14486360100962786, "mean_env_wait_ms": 0.26091144743353933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015285313129425049, "StateBufferConnector_ms": 0.0022742152214050293, "ViewRequirementAgentConnector_ms": 0.05993247032165527}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1294159.0054519055, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15295554216088747, "mean_inference_ms": 5.238506578367764, "mean_action_processing_ms": 0.14486360100962786, "mean_env_wait_ms": 0.26091144743353933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015285313129425049, "StateBufferConnector_ms": 0.0022742152214050293, "ViewRequirementAgentConnector_ms": 0.05993247032165527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1962.21, "learn_time_ms": 18.83, "learn_throughput": 17843.989, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-28", "timestamp": 1706263648, "time_this_iter_s": 1.965717077255249, "time_total_s": 158.18983221054077, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1afe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 158.18983221054077, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 15.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1126256768.0, "policy_entropy": 3899.107666015625, "var_gnorm": 22.695703506469727, "vf_loss": 12957535698944.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.430511474609375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 81, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293564.3654398704, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529690558135668, "mean_inference_ms": 5.238715148619576, "mean_action_processing_ms": 0.14486899093912498, "mean_env_wait_ms": 0.2609242726782716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015272034539116753, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.05993136653193721}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1293564.3654398704, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529690558135668, "mean_inference_ms": 5.238715148619576, "mean_action_processing_ms": 0.14486899093912498, "mean_env_wait_ms": 0.2609242726782716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015272034539116753, "StateBufferConnector_ms": 0.002272923787434896, "ViewRequirementAgentConnector_ms": 0.05993136653193721}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 1964.033, "learn_time_ms": 18.882, "learn_throughput": 17794.669, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-30", "timestamp": 1706263650, "time_this_iter_s": 1.9825973510742188, "time_total_s": 160.172429561615, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20c40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9438bbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 160.172429561615, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 16.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1206917632.0, "policy_entropy": 3882.205078125, "var_gnorm": 22.69874382019043, "vf_loss": 12292945084416.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8715858459472656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 82, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292423.1427084508, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529821341559587, "mean_inference_ms": 5.238915991915444, "mean_action_processing_ms": 0.1448740645750472, "mean_env_wait_ms": 0.2609365938031827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015280304885492093, "StateBufferConnector_ms": 0.002273408378042826, "ViewRequirementAgentConnector_ms": 0.05999163883488353}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1292423.1427084508, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529821341559587, "mean_inference_ms": 5.238915991915444, "mean_action_processing_ms": 0.1448740645750472, "mean_env_wait_ms": 0.2609365938031827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015280304885492093, "StateBufferConnector_ms": 0.002273408378042826, "ViewRequirementAgentConnector_ms": 0.05999163883488353}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 1965.091, "learn_time_ms": 18.892, "learn_throughput": 17785.349, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-32", "timestamp": 1706263652, "time_this_iter_s": 1.9701001644134521, "time_total_s": 162.14252972602844, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc8cd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 162.14252972602844, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3149910272.0, "policy_entropy": 3848.3662109375, "var_gnorm": 22.70250129699707, "vf_loss": 11035040808960.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.9669532775878906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 83, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290720.7196461884, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15299477319101362, "mean_inference_ms": 5.2391085552295875, "mean_action_processing_ms": 0.1448788824508146, "mean_env_wait_ms": 0.2609480948229902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015283492674310523, "StateBufferConnector_ms": 0.00227301953786827, "ViewRequirementAgentConnector_ms": 0.060019722904067443}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290720.7196461884, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15299477319101362, "mean_inference_ms": 5.2391085552295875, "mean_action_processing_ms": 0.1448788824508146, "mean_env_wait_ms": 0.2609480948229902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015283492674310523, "StateBufferConnector_ms": 0.00227301953786827, "ViewRequirementAgentConnector_ms": 0.060019722904067443}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 1965.844, "learn_time_ms": 18.903, "learn_throughput": 17774.828, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-34", "timestamp": 1706263654, "time_this_iter_s": 1.9668924808502197, "time_total_s": 164.10942220687866, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18e50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b3640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 164.10942220687866, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 16.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7992877568.0, "policy_entropy": 3802.96630859375, "var_gnorm": 22.707000732421875, "vf_loss": 13175837687808.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.6450881958007812e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 84, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290122.5940405582, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300746929164136, "mean_inference_ms": 5.239306707295678, "mean_action_processing_ms": 0.1448838990053723, "mean_env_wait_ms": 0.2609596448470945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334572110857283, "StateBufferConnector_ms": 0.002273491450718471, "ViewRequirementAgentConnector_ms": 0.05999377795628139}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1290122.5940405582, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15300746929164136, "mean_inference_ms": 5.239306707295678, "mean_action_processing_ms": 0.1448838990053723, "mean_env_wait_ms": 0.2609596448470945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334572110857283, "StateBufferConnector_ms": 0.002273491450718471, "ViewRequirementAgentConnector_ms": 0.05999377795628139}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 1971.422, "learn_time_ms": 18.942, "learn_throughput": 17738.227, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-36", "timestamp": 1706263656, "time_this_iter_s": 2.0032246112823486, "time_total_s": 166.112646818161, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 166.112646818161, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 7.466666666666666, "ram_util_percent": 16.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -15342929920.0, "policy_entropy": 3802.2431640625, "var_gnorm": 22.710126876831055, "vf_loss": 13393756946432.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.800060272216797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 85, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1289486.208987325, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15301986937311673, "mean_inference_ms": 5.239499525378888, "mean_action_processing_ms": 0.14488850941373013, "mean_env_wait_ms": 0.26097057124296624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331436606014477, "StateBufferConnector_ms": 0.00227507422952091, "ViewRequirementAgentConnector_ms": 0.060024261474609375}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1289486.208987325, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15301986937311673, "mean_inference_ms": 5.239499525378888, "mean_action_processing_ms": 0.14488850941373013, "mean_env_wait_ms": 0.26097057124296624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331436606014477, "StateBufferConnector_ms": 0.00227507422952091, "ViewRequirementAgentConnector_ms": 0.060024261474609375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 1971.224, "learn_time_ms": 18.986, "learn_throughput": 17697.641, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-38", "timestamp": 1706263658, "time_this_iter_s": 1.9746284484863281, "time_total_s": 168.08727526664734, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1bbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 168.08727526664734, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 16.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -20051621888.0, "policy_entropy": 3840.01611328125, "var_gnorm": 22.712032318115234, "vf_loss": 12287458934784.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -1.9073486328125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 86, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1288492.9369035403, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15303198945559707, "mean_inference_ms": 5.239701252316792, "mean_action_processing_ms": 0.1448928463291148, "mean_env_wait_ms": 0.26098095527506665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323106632676236, "StateBufferConnector_ms": 0.0022752340449843297, "ViewRequirementAgentConnector_ms": 0.060019936672476834}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1288492.9369035403, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15303198945559707, "mean_inference_ms": 5.239701252316792, "mean_action_processing_ms": 0.1448928463291148, "mean_env_wait_ms": 0.26098095527506665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323106632676236, "StateBufferConnector_ms": 0.0022752340449843297, "ViewRequirementAgentConnector_ms": 0.060019936672476834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 1975.72, "learn_time_ms": 19.11, "learn_throughput": 17582.582, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-40", "timestamp": 1706263660, "time_this_iter_s": 2.0099730491638184, "time_total_s": 170.09724831581116, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22a70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ea8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 170.09724831581116, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 16.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -28870567936.0, "policy_entropy": 3814.540771484375, "var_gnorm": 22.714778900146484, "vf_loss": 12237520502784.0}, "grad_gnorm": 40.0, "vf_explained_var": -2.0265579223632812e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 87, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1287302.2914808267, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530438840951878, "mean_inference_ms": 5.23989987832204, "mean_action_processing_ms": 0.14489701051834594, "mean_env_wait_ms": 0.26099098915549607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324833749354571, "StateBufferConnector_ms": 0.002275116142185255, "ViewRequirementAgentConnector_ms": 0.06003571652818}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1287302.2914808267, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530438840951878, "mean_inference_ms": 5.23989987832204, "mean_action_processing_ms": 0.14489701051834594, "mean_env_wait_ms": 0.26099098915549607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324833749354571, "StateBufferConnector_ms": 0.002275116142185255, "ViewRequirementAgentConnector_ms": 0.06003571652818}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 1976.972, "learn_time_ms": 19.152, "learn_throughput": 17544.233, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-42", "timestamp": 1706263662, "time_this_iter_s": 1.9813032150268555, "time_total_s": 172.078551530838, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c204c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b3ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 172.078551530838, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -233825501184.0, "policy_entropy": 3714.85888671875, "var_gnorm": 22.7177734375, "vf_loss": 12140121423872.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -1.9669532775878906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 88, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1286002.330472658, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305561631609732, "mean_inference_ms": 5.240099576152201, "mean_action_processing_ms": 0.1449011660085526, "mean_env_wait_ms": 0.2610009865770008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310265801169655, "StateBufferConnector_ms": 0.0022750009189952502, "ViewRequirementAgentConnector_ms": 0.06002431566065008}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1286002.330472658, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15305561631609732, "mean_inference_ms": 5.240099576152201, "mean_action_processing_ms": 0.1449011660085526, "mean_env_wait_ms": 0.2610009865770008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310265801169655, "StateBufferConnector_ms": 0.0022750009189952502, "ViewRequirementAgentConnector_ms": 0.06002431566065008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1978.865, "learn_time_ms": 19.179, "learn_throughput": 17519.522, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-44", "timestamp": 1706263664, "time_this_iter_s": 1.9930500984191895, "time_total_s": 174.0716016292572, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 174.0716016292572, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 16.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2134775431168.0, "policy_entropy": 3597.884765625, "var_gnorm": 22.72177505493164, "vf_loss": 12133081284608.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -2.1457672119140625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 89, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284958.731592734, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153066828550292, "mean_inference_ms": 5.240291569047813, "mean_action_processing_ms": 0.1449048743961745, "mean_env_wait_ms": 0.26101033537449425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302722373705231, "StateBufferConnector_ms": 0.002275691943222217, "ViewRequirementAgentConnector_ms": 0.06002951204107049}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284958.731592734, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153066828550292, "mean_inference_ms": 5.240291569047813, "mean_action_processing_ms": 0.1449048743961745, "mean_env_wait_ms": 0.26101033537449425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302722373705231, "StateBufferConnector_ms": 0.002275691943222217, "ViewRequirementAgentConnector_ms": 0.06002951204107049}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 1980.946, "learn_time_ms": 19.205, "learn_throughput": 17495.424, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-46", "timestamp": 1706263666, "time_this_iter_s": 1.9665369987487793, "time_total_s": 176.03813862800598, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943eb9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 176.03813862800598, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 16.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -35368019689472.0, "policy_entropy": 3374.57861328125, "var_gnorm": 22.724079132080078, "vf_loss": 13334552248320.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -2.1696090698242188e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 90, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284345.8565443833, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15307772421854654, "mean_inference_ms": 5.240515861752405, "mean_action_processing_ms": 0.1449084842274953, "mean_env_wait_ms": 0.26101931623124863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322367350260416, "StateBufferConnector_ms": 0.002278486887613932, "ViewRequirementAgentConnector_ms": 0.0601090325249566}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1284345.8565443833, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15307772421854654, "mean_inference_ms": 5.240515861752405, "mean_action_processing_ms": 0.1449084842274953, "mean_env_wait_ms": 0.26101931623124863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322367350260416, "StateBufferConnector_ms": 0.002278486887613932, "ViewRequirementAgentConnector_ms": 0.0601090325249566}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 1992.013, "learn_time_ms": 19.219, "learn_throughput": 17482.922, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-48", "timestamp": 1706263668, "time_this_iter_s": 2.0764312744140625, "time_total_s": 178.11456990242004, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 178.11456990242004, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1206350281441280.0, "policy_entropy": 3139.519775390625, "var_gnorm": 22.727611541748047, "vf_loss": 12278240903168.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.6226043701171875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 91, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1283293.4261063086, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530882407621074, "mean_inference_ms": 5.240731487407123, "mean_action_processing_ms": 0.14491200115904204, "mean_env_wait_ms": 0.261027671767229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531040275489891, "StateBufferConnector_ms": 0.0022770284296392083, "ViewRequirementAgentConnector_ms": 0.06008593590704949}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1283293.4261063086, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530882407621074, "mean_inference_ms": 5.240731487407123, "mean_action_processing_ms": 0.14491200115904204, "mean_env_wait_ms": 0.261027671767229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531040275489891, "StateBufferConnector_ms": 0.0022770284296392083, "ViewRequirementAgentConnector_ms": 0.06008593590704949}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 1990.396, "learn_time_ms": 19.187, "learn_throughput": 17511.838, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-50", "timestamp": 1706263670, "time_this_iter_s": 1.9664576053619385, "time_total_s": 180.08102750778198, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ebeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 180.08102750778198, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333332, "ram_util_percent": 16.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.187031706861568e+16, "policy_entropy": 2921.176025390625, "var_gnorm": 22.731182098388672, "vf_loss": 11284577779712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0875205993652344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 92, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1281906.1915540702, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309847897177462, "mean_inference_ms": 5.24094051607434, "mean_action_processing_ms": 0.14491532196099716, "mean_env_wait_ms": 0.26103558741909083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398730402407438, "StateBufferConnector_ms": 0.0022779340329377546, "ViewRequirementAgentConnector_ms": 0.06009029305499533}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1281906.1915540702, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309847897177462, "mean_inference_ms": 5.24094051607434, "mean_action_processing_ms": 0.14491532196099716, "mean_env_wait_ms": 0.26103558741909083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015398730402407438, "StateBufferConnector_ms": 0.0022779340329377546, "ViewRequirementAgentConnector_ms": 0.06009029305499533}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 1990.659, "learn_time_ms": 19.26, "learn_throughput": 17445.525, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-52", "timestamp": 1706263672, "time_this_iter_s": 1.9727704524993896, "time_total_s": 182.05379796028137, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ebd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 182.05379796028137, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 16.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.995843720501002e+17, "policy_entropy": 2714.25439453125, "var_gnorm": 22.734718322753906, "vf_loss": 12034889482240.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.753734588623047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 93, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1281071.6858765248, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15310834904202045, "mean_inference_ms": 5.2411435457455235, "mean_action_processing_ms": 0.1449185433699165, "mean_env_wait_ms": 0.26104316195606164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380818356749832, "StateBufferConnector_ms": 0.0022760001561974966, "ViewRequirementAgentConnector_ms": 0.06008712194299185}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1281071.6858765248, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15310834904202045, "mean_inference_ms": 5.2411435457455235, "mean_action_processing_ms": 0.1449185433699165, "mean_env_wait_ms": 0.26104316195606164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380818356749832, "StateBufferConnector_ms": 0.0022760001561974966, "ViewRequirementAgentConnector_ms": 0.06008712194299185}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 1991.25, "learn_time_ms": 19.255, "learn_throughput": 17449.91, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-54", "timestamp": 1706263674, "time_this_iter_s": 1.9728364944458008, "time_total_s": 184.02663445472717, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19a50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943b23b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 184.02663445472717, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 16.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.932838087537197e+19, "policy_entropy": 2521.717041015625, "var_gnorm": 22.738168716430664, "vf_loss": 12005683494912.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.586841583251953e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 94, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1279803.028964459, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311772498520285, "mean_inference_ms": 5.2413355666716726, "mean_action_processing_ms": 0.1449214744925538, "mean_env_wait_ms": 0.26105006126686786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371150158821269, "StateBufferConnector_ms": 0.002275121972915974, "ViewRequirementAgentConnector_ms": 0.06008401830145653}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1279803.028964459, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311772498520285, "mean_inference_ms": 5.2413355666716726, "mean_action_processing_ms": 0.1449214744925538, "mean_env_wait_ms": 0.26105006126686786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371150158821269, "StateBufferConnector_ms": 0.002275121972915974, "ViewRequirementAgentConnector_ms": 0.06008401830145653}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 1986.553, "learn_time_ms": 19.35, "learn_throughput": 17364.615, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-56", "timestamp": 1706263676, "time_this_iter_s": 1.956251859664917, "time_total_s": 185.9828863143921, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 185.9828863143921, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 16.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2086573323155564e+20, "policy_entropy": 2342.623046875, "var_gnorm": 22.741497039794922, "vf_loss": 12207878307840.0}, "grad_gnorm": 0.0, "vf_explained_var": -2.765655517578125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 95, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1278899.637896394, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15312673611352373, "mean_inference_ms": 5.2415239903985045, "mean_action_processing_ms": 0.14492427998908777, "mean_env_wait_ms": 0.26105668139905874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360932601125617, "StateBufferConnector_ms": 0.002273760343852796, "ViewRequirementAgentConnector_ms": 0.060095787048339844}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1278899.637896394, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15312673611352373, "mean_inference_ms": 5.2415239903985045, "mean_action_processing_ms": 0.14492427998908777, "mean_env_wait_ms": 0.26105668139905874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360932601125617, "StateBufferConnector_ms": 0.002273760343852796, "ViewRequirementAgentConnector_ms": 0.060095787048339844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 1987.033, "learn_time_ms": 19.385, "learn_throughput": 17332.794, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-07-58", "timestamp": 1706263678, "time_this_iter_s": 1.979569673538208, "time_total_s": 187.9624559879303, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 187.9624559879303, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 16.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.5486535877148436e+20, "policy_entropy": 2171.655029296875, "var_gnorm": 22.744674682617188, "vf_loss": 12189624696832.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.2901763916015625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 96, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277889.147216139, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15313544678483515, "mean_inference_ms": 5.241706661523774, "mean_action_processing_ms": 0.14492692599118082, "mean_env_wait_ms": 0.2610627915445975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535266637802124, "StateBufferConnector_ms": 0.0022741655508677163, "ViewRequirementAgentConnector_ms": 0.0600866973400116}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277889.147216139, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15313544678483515, "mean_inference_ms": 5.241706661523774, "mean_action_processing_ms": 0.14492692599118082, "mean_env_wait_ms": 0.2610627915445975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01535266637802124, "StateBufferConnector_ms": 0.0022741655508677163, "ViewRequirementAgentConnector_ms": 0.0600866973400116}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1983.107, "learn_time_ms": 19.321, "learn_throughput": 17390.221, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-00", "timestamp": 1706263680, "time_this_iter_s": 1.9707472324371338, "time_total_s": 189.93320322036743, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccab30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ebc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 189.93320322036743, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 16.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5407990890637117e+22, "policy_entropy": 2013.47509765625, "var_gnorm": 22.74768829345703, "vf_loss": 13740836651008.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.0994415283203125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 97, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277676.581235115, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314398540596763, "mean_inference_ms": 5.241883250992917, "mean_action_processing_ms": 0.1449296173762563, "mean_env_wait_ms": 0.26106883172315654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372345128010228, "StateBufferConnector_ms": 0.002274070818399646, "ViewRequirementAgentConnector_ms": 0.06008811832703266}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1277676.581235115, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314398540596763, "mean_inference_ms": 5.241883250992917, "mean_action_processing_ms": 0.1449296173762563, "mean_env_wait_ms": 0.26106883172315654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015372345128010228, "StateBufferConnector_ms": 0.002274070818399646, "ViewRequirementAgentConnector_ms": 0.06008811832703266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 1982.085, "learn_time_ms": 19.275, "learn_throughput": 17431.779, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-02", "timestamp": 1706263682, "time_this_iter_s": 1.9710755348205566, "time_total_s": 191.904278755188, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22aa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 191.904278755188, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 17.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2667225811225327e+23, "policy_entropy": 1870.2587890625, "var_gnorm": 22.750526428222656, "vf_loss": 12189163323392.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.123283386230469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 98, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1276797.7348802665, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15315255605400818, "mean_inference_ms": 5.242060914364394, "mean_action_processing_ms": 0.14493252288013153, "mean_env_wait_ms": 0.26107497198589397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015370213255590322, "StateBufferConnector_ms": 0.002274221303511639, "ViewRequirementAgentConnector_ms": 0.060090240167111765}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1276797.7348802665, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15315255605400818, "mean_inference_ms": 5.242060914364394, "mean_action_processing_ms": 0.14493252288013153, "mean_env_wait_ms": 0.26107497198589397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015370213255590322, "StateBufferConnector_ms": 0.002274221303511639, "ViewRequirementAgentConnector_ms": 0.060090240167111765}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 1982.328, "learn_time_ms": 19.29, "learn_throughput": 17418.034, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-04", "timestamp": 1706263684, "time_this_iter_s": 1.995492696762085, "time_total_s": 193.89977145195007, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94211cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 193.89977145195007, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 17.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4292834185597597e+24, "policy_entropy": 1735.241943359375, "var_gnorm": 22.753189086914062, "vf_loss": 11884760662016.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.3392181396484375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 99, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275931.8816030829, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316100536533528, "mean_inference_ms": 5.242235220569174, "mean_action_processing_ms": 0.14493545456596055, "mean_env_wait_ms": 0.26108093544622957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366679490214646, "StateBufferConnector_ms": 0.0022748504022155145, "ViewRequirementAgentConnector_ms": 0.06008268606783164}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1275931.8816030829, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316100536533528, "mean_inference_ms": 5.242235220569174, "mean_action_processing_ms": 0.14493545456596055, "mean_env_wait_ms": 0.26108093544622957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015366679490214646, "StateBufferConnector_ms": 0.0022748504022155145, "ViewRequirementAgentConnector_ms": 0.06008268606783164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 1983.608, "learn_time_ms": 19.284, "learn_throughput": 17423.525, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-06", "timestamp": 1706263686, "time_this_iter_s": 1.979356050491333, "time_total_s": 195.8791275024414, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20eb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 195.8791275024414, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 17.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.421493471577219e+24, "policy_entropy": 1608.66455078125, "var_gnorm": 22.75566864013672, "vf_loss": 11701387788288.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.921985626220703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 100, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274849.0915963734, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316915161112366, "mean_inference_ms": 5.242401510980875, "mean_action_processing_ms": 0.14493822974000184, "mean_env_wait_ms": 0.2610864218527808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359878540039062, "StateBufferConnector_ms": 0.002274751663208008, "ViewRequirementAgentConnector_ms": 0.06010270118713379}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1661292.0442888488, "episode_reward_mean": -1274849.0915963734, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1661292.0442888488, -1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316915161112366, "mean_inference_ms": 5.242401510980875, "mean_action_processing_ms": 0.14493822974000184, "mean_env_wait_ms": 0.2610864218527808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015359878540039062, "StateBufferConnector_ms": 0.002274751663208008, "ViewRequirementAgentConnector_ms": 0.06010270118713379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1972.043, "learn_time_ms": 19.266, "learn_throughput": 17440.257, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-08", "timestamp": 1706263688, "time_this_iter_s": 1.9607689380645752, "time_total_s": 197.83989644050598, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 197.83989644050598, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5602932902466743e+25, "policy_entropy": 1493.1964111328125, "var_gnorm": 22.757978439331055, "vf_loss": 14308687740928.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 101, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1270862.772726398, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314003512185478, "mean_inference_ms": 5.242331740971529, "mean_action_processing_ms": 0.14490594253812086, "mean_env_wait_ms": 0.2610312308865863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360355377197266, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06008267402648926}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1270862.772726398, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1329713.7095488962, -1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314003512185478, "mean_inference_ms": 5.242331740971529, "mean_action_processing_ms": 0.14490594253812086, "mean_env_wait_ms": 0.2610312308865863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360355377197266, "StateBufferConnector_ms": 0.0022745132446289062, "ViewRequirementAgentConnector_ms": 0.06008267402648926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 1973.231, "learn_time_ms": 19.274, "learn_throughput": 17432.469, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-10", "timestamp": 1706263690, "time_this_iter_s": 1.978346347808838, "time_total_s": 199.81824278831482, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee80900d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 199.81824278831482, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 17.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.9500319300985886e+26, "policy_entropy": 1389.0087890625, "var_gnorm": 22.760114669799805, "vf_loss": 12761399558144.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.170967102050781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 102, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1269570.5562276144, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311519074152588, "mean_inference_ms": 5.242304416625155, "mean_action_processing_ms": 0.1448737806164622, "mean_env_wait_ms": 0.2609815288580154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339136123657227, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06010627746582031}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1269570.5562276144, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1487492.033108109, -1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15311519074152588, "mean_inference_ms": 5.242304416625155, "mean_action_processing_ms": 0.1448737806164622, "mean_env_wait_ms": 0.2609815288580154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339136123657227, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06010627746582031}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 1973.007, "learn_time_ms": 19.178, "learn_throughput": 17520.285, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-12", "timestamp": 1706263692, "time_this_iter_s": 1.9705326557159424, "time_total_s": 201.78877544403076, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94211090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 201.78877544403076, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 17.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.069722732061292e+26, "policy_entropy": 1291.1353759765625, "var_gnorm": 22.7620906829834, "vf_loss": 14135542677504.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3974647521972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 103, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1267521.685785298, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309443652493196, "mean_inference_ms": 5.242369803643405, "mean_action_processing_ms": 0.14484835085410705, "mean_env_wait_ms": 0.2609403382440226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015351533889770508, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06011056900024414}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1267521.685785298, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1406353.6815460655, -1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309443652493196, "mean_inference_ms": 5.242369803643405, "mean_action_processing_ms": 0.14484835085410705, "mean_env_wait_ms": 0.2609403382440226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015351533889770508, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06011056900024414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 1973.095, "learn_time_ms": 19.233, "learn_throughput": 17469.897, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-14", "timestamp": 1706263694, "time_this_iter_s": 1.9737606048583984, "time_total_s": 203.76253604888916, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c210f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ea9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 203.76253604888916, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 17.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2513195135173276e+27, "policy_entropy": 1198.6470947265625, "var_gnorm": 22.763912200927734, "vf_loss": 12457722511360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.266334533691406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 104, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265455.0614559306, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530904490560845, "mean_inference_ms": 5.242566168545056, "mean_action_processing_ms": 0.14483594493806062, "mean_env_wait_ms": 0.2609229994777935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015369176864624023, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.060155630111694336}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265455.0614559306, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1369258.7691818627, -1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1530904490560845, "mean_inference_ms": 5.242566168545056, "mean_action_processing_ms": 0.14483594493806062, "mean_env_wait_ms": 0.2609229994777935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015369176864624023, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.060155630111694336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1977.329, "learn_time_ms": 20.459, "learn_throughput": 16422.72, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-16", "timestamp": 1706263696, "time_this_iter_s": 1.998617172241211, "time_total_s": 205.76115322113037, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc87f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94211480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 205.76115322113037, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 17.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.528823945920157e+28, "policy_entropy": 1119.8048095703125, "var_gnorm": 22.765586853027344, "vf_loss": 12170927538176.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.088878631591797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 105, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263676.1462683803, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309700655635425, "mean_inference_ms": 5.242852503624331, "mean_action_processing_ms": 0.14483042310049613, "mean_env_wait_ms": 0.26091729810542225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015382766723632812, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06020045280456543}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263676.1462683803, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1214044.3328933395, -1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15309700655635425, "mean_inference_ms": 5.242852503624331, "mean_action_processing_ms": 0.14483042310049613, "mean_env_wait_ms": 0.26091729810542225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015382766723632812, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06020045280456543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 1978.734, "learn_time_ms": 20.391, "learn_throughput": 16477.714, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-18", "timestamp": 1706263698, "time_this_iter_s": 1.993473768234253, "time_total_s": 207.75462698936462, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c203d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 207.75462698936462, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 17.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0073668424083456e+28, "policy_entropy": 1045.7855224609375, "var_gnorm": 22.76712417602539, "vf_loss": 10824869478400.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 106, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1262662.982981257, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531066887066145, "mean_inference_ms": 5.243190531187987, "mean_action_processing_ms": 0.1448299084623675, "mean_env_wait_ms": 0.2609191048598748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015377998352050781, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.06019163131713867}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1262662.982981257, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1210629.2963005574, -1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531066887066145, "mean_inference_ms": 5.243190531187987, "mean_action_processing_ms": 0.1448299084623675, "mean_env_wait_ms": 0.2609191048598748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015377998352050781, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.06019163131713867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 1979.15, "learn_time_ms": 20.346, "learn_throughput": 16513.917, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-20", "timestamp": 1706263700, "time_this_iter_s": 1.974909782409668, "time_total_s": 209.7295367717743, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecd9f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 209.7295367717743, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.099999999999999, "ram_util_percent": 17.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.33507919307534e+29, "policy_entropy": 978.962890625, "var_gnorm": 22.768531799316406, "vf_loss": 12803983278080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 107, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1262819.107680246, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531171045691223, "mean_inference_ms": 5.243540390972361, "mean_action_processing_ms": 0.14483173629134133, "mean_env_wait_ms": 0.2609252706870882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379667282104492, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06017923355102539}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1262819.107680246, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172441.5105270534, -1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531171045691223, "mean_inference_ms": 5.243540390972361, "mean_action_processing_ms": 0.14483173629134133, "mean_env_wait_ms": 0.2609252706870882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379667282104492, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06017923355102539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 1977.647, "learn_time_ms": 20.372, "learn_throughput": 16493.392, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-22", "timestamp": 1706263702, "time_this_iter_s": 1.9560644626617432, "time_total_s": 211.68560123443604, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca890>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 211.68560123443604, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 17.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.520794800416257e+29, "policy_entropy": 915.4042358398438, "var_gnorm": 22.769821166992188, "vf_loss": 13690466205696.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 108, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263669.471583115, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531305489035368, "mean_inference_ms": 5.243878756251097, "mean_action_processing_ms": 0.14483471566168044, "mean_env_wait_ms": 0.26093383542795395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015402078628540039, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06021428108215332}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263669.471583115, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1183903.016924629, -1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531305489035368, "mean_inference_ms": 5.243878756251097, "mean_action_processing_ms": 0.14483471566168044, "mean_env_wait_ms": 0.26093383542795395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015402078628540039, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06021428108215332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 1976.095, "learn_time_ms": 20.387, "learn_throughput": 16481.414, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-24", "timestamp": 1706263704, "time_this_iter_s": 1.9799790382385254, "time_total_s": 213.66558027267456, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212ef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 213.66558027267456, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 17.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.68298046534017e+29, "policy_entropy": 861.0606689453125, "var_gnorm": 22.770998001098633, "vf_loss": 11023576727552.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8743019104003906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 109, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263181.3959276602, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314784058956551, "mean_inference_ms": 5.244266298950851, "mean_action_processing_ms": 0.14484112640391822, "mean_env_wait_ms": 0.2609483059025582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015406608581542969, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06022357940673828}}, "episode_reward_max": -1098081.840850202, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263181.3959276602, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1098081.840850202, -1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15314784058956551, "mean_inference_ms": 5.244266298950851, "mean_action_processing_ms": 0.14484112640391822, "mean_env_wait_ms": 0.2609483059025582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015406608581542969, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06022357940673828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 1975.934, "learn_time_ms": 20.336, "learn_throughput": 16522.397, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-26", "timestamp": 1706263706, "time_this_iter_s": 1.977745532989502, "time_total_s": 215.64332580566406, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 215.64332580566406, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.187528799748106e+31, "policy_entropy": 807.29052734375, "var_gnorm": 22.772075653076172, "vf_loss": 11936791003136.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 110, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264042.6730980568, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316662691050673, "mean_inference_ms": 5.244660956231258, "mean_action_processing_ms": 0.14484867496580947, "mean_env_wait_ms": 0.2609633916624426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015422821044921875, "StateBufferConnector_ms": 0.0022737979888916016, "ViewRequirementAgentConnector_ms": 0.06023859977722168}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264042.6730980568, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1149266.3314060534, -1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15316662691050673, "mean_inference_ms": 5.244660956231258, "mean_action_processing_ms": 0.14484867496580947, "mean_env_wait_ms": 0.2609633916624426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015422821044921875, "StateBufferConnector_ms": 0.0022737979888916016, "ViewRequirementAgentConnector_ms": 0.06023859977722168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 1976.421, "learn_time_ms": 20.382, "learn_throughput": 16485.25, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-28", "timestamp": 1706263708, "time_this_iter_s": 1.9656286239624023, "time_total_s": 217.60895442962646, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19900>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 217.60895442962646, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0977515505318843e+31, "policy_entropy": 759.5838623046875, "var_gnorm": 22.773056030273438, "vf_loss": 12471035232256.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9696693420410156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 111, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264537.800940351, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531870156232001, "mean_inference_ms": 5.245031811455736, "mean_action_processing_ms": 0.14485663252503803, "mean_env_wait_ms": 0.2609805373640669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01543569564819336, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.060274600982666016}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264537.800940351, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1207975.359112783, -1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1531870156232001, "mean_inference_ms": 5.245031811455736, "mean_action_processing_ms": 0.14485663252503803, "mean_env_wait_ms": 0.2609805373640669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01543569564819336, "StateBufferConnector_ms": 0.0022754669189453125, "ViewRequirementAgentConnector_ms": 0.060274600982666016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 1978.072, "learn_time_ms": 20.406, "learn_throughput": 16465.354, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-30", "timestamp": 1706263710, "time_this_iter_s": 1.9948625564575195, "time_total_s": 219.60381698608398, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c235e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212a70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 219.60381698608398, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.65, "ram_util_percent": 18.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.19323006356205e+31, "policy_entropy": 719.7094116210938, "var_gnorm": 22.773948669433594, "vf_loss": 12275208421376.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.910064697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 112, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264224.5263417242, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15320740862392954, "mean_inference_ms": 5.245376339902739, "mean_action_processing_ms": 0.14486369236661806, "mean_env_wait_ms": 0.2609963684603611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450477600097656, "StateBufferConnector_ms": 0.0022759437561035156, "ViewRequirementAgentConnector_ms": 0.060305118560791016}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264224.5263417242, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1216467.5245879143, -1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15320740862392954, "mean_inference_ms": 5.245376339902739, "mean_action_processing_ms": 0.14486369236661806, "mean_env_wait_ms": 0.2609963684603611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450477600097656, "StateBufferConnector_ms": 0.0022759437561035156, "ViewRequirementAgentConnector_ms": 0.060305118560791016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1980.801, "learn_time_ms": 20.434, "learn_throughput": 16443.204, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-32", "timestamp": 1706263712, "time_this_iter_s": 1.9978272914886475, "time_total_s": 221.60164427757263, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c210c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 221.60164427757263, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0546426098013446e+32, "policy_entropy": 680.7984619140625, "var_gnorm": 22.774765014648438, "vf_loss": 11980954927104.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.921985626220703e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 113, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263751.2306293976, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15323114322640977, "mean_inference_ms": 5.245750629180085, "mean_action_processing_ms": 0.14487267186860942, "mean_env_wait_ms": 0.26101493098118084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452861785888672, "StateBufferConnector_ms": 0.0022742748260498047, "ViewRequirementAgentConnector_ms": 0.060318708419799805}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263751.2306293976, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1146378.5228716936, -1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15323114322640977, "mean_inference_ms": 5.245750629180085, "mean_action_processing_ms": 0.14487267186860942, "mean_env_wait_ms": 0.26101493098118084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452861785888672, "StateBufferConnector_ms": 0.0022742748260498047, "ViewRequirementAgentConnector_ms": 0.060318708419799805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 1981.398, "learn_time_ms": 20.422, "learn_throughput": 16452.936, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-34", "timestamp": 1706263714, "time_this_iter_s": 1.9797396659851074, "time_total_s": 223.58138394355774, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccada0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942139a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 223.58138394355774, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 18.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6678957007814635e+31, "policy_entropy": 640.0582885742188, "var_gnorm": 22.775503158569336, "vf_loss": 12645217337344.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 114, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264354.0719152708, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15325552952320648, "mean_inference_ms": 5.2461268994894805, "mean_action_processing_ms": 0.1448825265568115, "mean_env_wait_ms": 0.2610355919221503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015461444854736328, "StateBufferConnector_ms": 0.002273082733154297, "ViewRequirementAgentConnector_ms": 0.060338735580444336}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264354.0719152708, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1192481.7667830035, -1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15325552952320648, "mean_inference_ms": 5.2461268994894805, "mean_action_processing_ms": 0.1448825265568115, "mean_env_wait_ms": 0.2610355919221503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015461444854736328, "StateBufferConnector_ms": 0.002273082733154297, "ViewRequirementAgentConnector_ms": 0.060338735580444336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 1979.159, "learn_time_ms": 19.138, "learn_throughput": 17556.888, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-36", "timestamp": 1706263716, "time_this_iter_s": 1.9762051105499268, "time_total_s": 225.55758905410767, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94741e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94213880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 225.55758905410767, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 18.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7925764427958517e+32, "policy_entropy": 611.6337890625, "var_gnorm": 22.77617835998535, "vf_loss": 12682061152256.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1365623474121094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 115, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264800.8093251379, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15328009742093976, "mean_inference_ms": 5.24650765612917, "mean_action_processing_ms": 0.1448924813945741, "mean_env_wait_ms": 0.2610556809862195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01546025276184082, "StateBufferConnector_ms": 0.0022742748260498047, "ViewRequirementAgentConnector_ms": 0.060353755950927734}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264800.8093251379, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1196407.1691908962, -1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15328009742093976, "mean_inference_ms": 5.24650765612917, "mean_action_processing_ms": 0.1448924813945741, "mean_env_wait_ms": 0.2610556809862195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01546025276184082, "StateBufferConnector_ms": 0.0022742748260498047, "ViewRequirementAgentConnector_ms": 0.060353755950927734}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 1975.185, "learn_time_ms": 19.13, "learn_throughput": 17564.306, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-38", "timestamp": 1706263718, "time_this_iter_s": 1.9537184238433838, "time_total_s": 227.51130747795105, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21ea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943eadd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 227.51130747795105, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 18.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.930066938103508e+32, "policy_entropy": 587.0631103515625, "var_gnorm": 22.77678871154785, "vf_loss": 12860324315136.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.552436828613281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 116, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265112.8926414559, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15330481321314038, "mean_inference_ms": 5.246879305856204, "mean_action_processing_ms": 0.14490295243190432, "mean_env_wait_ms": 0.2610761586283737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015444040298461914, "StateBufferConnector_ms": 0.002273082733154297, "ViewRequirementAgentConnector_ms": 0.06034517288208008}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265112.8926414559, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1131066.2891707662, -1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15330481321314038, "mean_inference_ms": 5.246879305856204, "mean_action_processing_ms": 0.14490295243190432, "mean_env_wait_ms": 0.2610761586283737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015444040298461914, "StateBufferConnector_ms": 0.002273082733154297, "ViewRequirementAgentConnector_ms": 0.06034517288208008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 1975.182, "learn_time_ms": 19.156, "learn_throughput": 17540.565, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-40", "timestamp": 1706263720, "time_this_iter_s": 1.9748897552490234, "time_total_s": 229.48619723320007, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425caf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 229.48619723320007, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 18.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.070907307180304e+31, "policy_entropy": 556.238525390625, "var_gnorm": 22.777345657348633, "vf_loss": 11017400614912.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.814697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 117, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264997.3818907628, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533290456775107, "mean_inference_ms": 5.247236045756615, "mean_action_processing_ms": 0.14491309836367028, "mean_env_wait_ms": 0.26109551036902157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439033508300781, "StateBufferConnector_ms": 0.0022726058959960938, "ViewRequirementAgentConnector_ms": 0.06034207344055176}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264997.3818907628, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1149108.6860558619, -1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533290456775107, "mean_inference_ms": 5.247236045756615, "mean_action_processing_ms": 0.14491309836367028, "mean_env_wait_ms": 0.26109551036902157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439033508300781, "StateBufferConnector_ms": 0.0022726058959960938, "ViewRequirementAgentConnector_ms": 0.06034207344055176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 1975.74, "learn_time_ms": 19.156, "learn_throughput": 17540.521, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-42", "timestamp": 1706263722, "time_this_iter_s": 1.9616658687591553, "time_total_s": 231.44786310195923, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 231.44786310195923, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 18.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3559183556518605e+33, "policy_entropy": 534.6076049804688, "var_gnorm": 22.777849197387695, "vf_loss": 13146370605056.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 118, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265630.922753361, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533541463141438, "mean_inference_ms": 5.247590220337887, "mean_action_processing_ms": 0.1449236070682269, "mean_env_wait_ms": 0.2611157604771692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445709228515625, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06040239334106445}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265630.922753361, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1149466.381792696, -1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533541463141438, "mean_inference_ms": 5.247590220337887, "mean_action_processing_ms": 0.1449236070682269, "mean_env_wait_ms": 0.2611157604771692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015445709228515625, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06040239334106445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 1973.764, "learn_time_ms": 19.127, "learn_throughput": 17566.649, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-44", "timestamp": 1706263724, "time_this_iter_s": 1.960216760635376, "time_total_s": 233.4080798625946, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425c790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 233.4080798625946, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 18.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.894376739914648e+30, "policy_entropy": 515.279541015625, "var_gnorm": 22.778305053710938, "vf_loss": 12128371081216.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 119, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265885.8566375202, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533795712462946, "mean_inference_ms": 5.2479439415208216, "mean_action_processing_ms": 0.14493435397698884, "mean_env_wait_ms": 0.2611363580522954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022737979888916016, "ViewRequirementAgentConnector_ms": 0.06040763854980469}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1265885.8566375202, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1285415.1662958986, -1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533795712462946, "mean_inference_ms": 5.2479439415208216, "mean_action_processing_ms": 0.14493435397698884, "mean_env_wait_ms": 0.2611363580522954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022737979888916016, "ViewRequirementAgentConnector_ms": 0.06040763854980469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 1972.74, "learn_time_ms": 19.136, "learn_throughput": 17558.726, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-46", "timestamp": 1706263726, "time_this_iter_s": 1.9675190448760986, "time_total_s": 235.3755989074707, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425d990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 235.3755989074707, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333333, "ram_util_percent": 18.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7201922704744028e+33, "policy_entropy": 491.1751403808594, "var_gnorm": 22.77872085571289, "vf_loss": 11358945935360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9458274841308594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 120, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264361.0370359037, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534045327127557, "mean_inference_ms": 5.248288128137533, "mean_action_processing_ms": 0.14494436212471037, "mean_env_wait_ms": 0.2611559897620149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022735595703125, "ViewRequirementAgentConnector_ms": 0.06044888496398926}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1264361.0370359037, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1289998.722836144, -1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534045327127557, "mean_inference_ms": 5.248288128137533, "mean_action_processing_ms": 0.14494436212471037, "mean_env_wait_ms": 0.2611559897620149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022735595703125, "ViewRequirementAgentConnector_ms": 0.06044888496398926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1972.161, "learn_time_ms": 19.125, "learn_throughput": 17568.62, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-48", "timestamp": 1706263728, "time_this_iter_s": 1.9598534107208252, "time_total_s": 237.33545231819153, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94213c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 237.33545231819153, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 19.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.260597702305229e+32, "policy_entropy": 475.13458251953125, "var_gnorm": 22.779096603393555, "vf_loss": 11150481686528.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.100799560546875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 121, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263070.1348002078, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15342991773994133, "mean_inference_ms": 5.248616494492785, "mean_action_processing_ms": 0.14495467655008548, "mean_env_wait_ms": 0.2611761638366018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01547694206237793, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.0604557991027832}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1263070.1348002078, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1328242.8198187596, -1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15342991773994133, "mean_inference_ms": 5.248616494492785, "mean_action_processing_ms": 0.14495467655008548, "mean_env_wait_ms": 0.2611761638366018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01547694206237793, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.0604557991027832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 1970.746, "learn_time_ms": 19.091, "learn_throughput": 17599.973, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-50", "timestamp": 1706263730, "time_this_iter_s": 1.9807062149047852, "time_total_s": 239.3161585330963, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8090b20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425d3f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 239.3161585330963, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 19.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5332705974400412e+33, "policy_entropy": 456.81793212890625, "var_gnorm": 22.779438018798828, "vf_loss": 12079553576960.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1484832763671875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 122, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1261538.339796369, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534540086645628, "mean_inference_ms": 5.248942644821577, "mean_action_processing_ms": 0.1449647337411777, "mean_env_wait_ms": 0.2611960665163353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015474081039428711, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.060396432876586914}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1261538.339796369, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1389747.3045955207, -1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534540086645628, "mean_inference_ms": 5.248942644821577, "mean_action_processing_ms": 0.1449647337411777, "mean_env_wait_ms": 0.2611960665163353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015474081039428711, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.060396432876586914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 1968.444, "learn_time_ms": 19.117, "learn_throughput": 17576.113, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-52", "timestamp": 1706263732, "time_this_iter_s": 1.9748342037200928, "time_total_s": 241.2909927368164, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee8091210>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943e9c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 241.2909927368164, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.466996444089253e+32, "policy_entropy": 445.73724365234375, "var_gnorm": 22.779748916625977, "vf_loss": 12838262276096.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 123, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1259637.008031479, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15347634223379925, "mean_inference_ms": 5.249233271614105, "mean_action_processing_ms": 0.14497401084057898, "mean_env_wait_ms": 0.26121371572155294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484809875488281, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06042885780334473}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1259637.008031479, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1338904.4835224987, -1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15347634223379925, "mean_inference_ms": 5.249233271614105, "mean_action_processing_ms": 0.14497401084057898, "mean_env_wait_ms": 0.26121371572155294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015484809875488281, "StateBufferConnector_ms": 0.0022706985473632812, "ViewRequirementAgentConnector_ms": 0.06042885780334473}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 1967.03, "learn_time_ms": 19.146, "learn_throughput": 17549.477, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-54", "timestamp": 1706263734, "time_this_iter_s": 1.9655835628509521, "time_total_s": 243.25657629966736, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425c790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.25657629966736, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.066666666666666, "ram_util_percent": 19.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.440479904288877e+34, "policy_entropy": 432.13018798828125, "var_gnorm": 22.780029296875, "vf_loss": 11543606460416.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.673004150390625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 124, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1257847.0405402405, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15349787478151147, "mean_inference_ms": 5.249513993039236, "mean_action_processing_ms": 0.14498289757238605, "mean_env_wait_ms": 0.2612307700098134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022699832916259766, "ViewRequirementAgentConnector_ms": 0.06043267250061035}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1257847.0405402405, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1361833.3565515045, -1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15349787478151147, "mean_inference_ms": 5.249513993039236, "mean_action_processing_ms": 0.14498289757238605, "mean_env_wait_ms": 0.2612307700098134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453577041625977, "StateBufferConnector_ms": 0.0022699832916259766, "ViewRequirementAgentConnector_ms": 0.06043267250061035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 1966.558, "learn_time_ms": 19.117, "learn_throughput": 17575.74, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-56", "timestamp": 1706263736, "time_this_iter_s": 1.9714903831481934, "time_total_s": 245.22806668281555, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425d360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 245.22806668281555, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 19.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.869275841980492e+33, "policy_entropy": 422.29168701171875, "var_gnorm": 22.78028106689453, "vf_loss": 11974460047360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.409385681152344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1255831.702795624, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535178649199287, "mean_inference_ms": 5.24978371062075, "mean_action_processing_ms": 0.14499111494729594, "mean_env_wait_ms": 0.26124613761582693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452384948730469, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.060426950454711914}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1255831.702795624, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352377.9010538121, -1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535178649199287, "mean_inference_ms": 5.24978371062075, "mean_action_processing_ms": 0.14499111494729594, "mean_env_wait_ms": 0.26124613761582693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452384948730469, "StateBufferConnector_ms": 0.0022690296173095703, "ViewRequirementAgentConnector_ms": 0.060426950454711914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1968.201, "learn_time_ms": 19.09, "learn_throughput": 17600.434, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-08-58", "timestamp": 1706263738, "time_this_iter_s": 1.9701743125915527, "time_total_s": 247.1982409954071, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9f60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425df30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 247.1982409954071, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 19.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.933518408817106e+33, "policy_entropy": 407.5494384765625, "var_gnorm": 22.78050994873047, "vf_loss": 13403596783616.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.601478576660156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 126, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254558.957160495, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15353754459684912, "mean_inference_ms": 5.250045423432364, "mean_action_processing_ms": 0.14499961268950018, "mean_env_wait_ms": 0.26126187649081706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015458822250366211, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.060439109802246094}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254558.957160495, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1308691.5343044074, -1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15353754459684912, "mean_inference_ms": 5.250045423432364, "mean_action_processing_ms": 0.14499961268950018, "mean_env_wait_ms": 0.26126187649081706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015458822250366211, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.060439109802246094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 1969.062, "learn_time_ms": 19.172, "learn_throughput": 17525.579, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-00", "timestamp": 1706263740, "time_this_iter_s": 1.9834821224212646, "time_total_s": 249.18172311782837, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb1c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 249.18172311782837, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 19.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.460352121421944e+32, "policy_entropy": 396.25823974609375, "var_gnorm": 22.780717849731445, "vf_loss": 12932573298688.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5881996154785156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 127, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253807.4845096462, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15355664485243556, "mean_inference_ms": 5.250323812333307, "mean_action_processing_ms": 0.14500784173449793, "mean_env_wait_ms": 0.2612783668347642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015457391738891602, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.06043100357055664}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253807.4845096462, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1216850.4372692462, -1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15355664485243556, "mean_inference_ms": 5.250323812333307, "mean_action_processing_ms": 0.14500784173449793, "mean_env_wait_ms": 0.2612783668347642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015457391738891602, "StateBufferConnector_ms": 0.002269744873046875, "ViewRequirementAgentConnector_ms": 0.06043100357055664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 1973.952, "learn_time_ms": 19.138, "learn_throughput": 17557.019, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-02", "timestamp": 1706263742, "time_this_iter_s": 2.010550022125244, "time_total_s": 251.1922731399536, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21600>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425cee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 251.1922731399536, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 19.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.579405837339119e+33, "policy_entropy": 387.06085205078125, "var_gnorm": 22.780906677246094, "vf_loss": 12293182062592.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.933906555175781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 128, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253785.8815995741, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15357569646223695, "mean_inference_ms": 5.250611388703383, "mean_action_processing_ms": 0.1450163624103717, "mean_env_wait_ms": 0.2612956325602517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015468120574951172, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06043887138366699}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253785.8815995741, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1157438.046956045, -1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15357569646223695, "mean_inference_ms": 5.250611388703383, "mean_action_processing_ms": 0.1450163624103717, "mean_env_wait_ms": 0.2612956325602517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015468120574951172, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06043887138366699}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1976.165, "learn_time_ms": 19.132, "learn_throughput": 17562.073, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-04", "timestamp": 1706263744, "time_this_iter_s": 1.9823424816131592, "time_total_s": 253.17461562156677, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425f1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 253.17461562156677, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 19.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.7505642617416745e+33, "policy_entropy": 384.03680419921875, "var_gnorm": 22.78107452392578, "vf_loss": 12837063753728.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 129, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254348.6961387612, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535945356871711, "mean_inference_ms": 5.250892003480273, "mean_action_processing_ms": 0.14502466842850098, "mean_env_wait_ms": 0.2613123085038357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439271926879883, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06045365333557129}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254348.6961387612, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1225711.3604012635, -1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535945356871711, "mean_inference_ms": 5.250892003480273, "mean_action_processing_ms": 0.14502466842850098, "mean_env_wait_ms": 0.2613123085038357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015439271926879883, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06045365333557129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 1977.379, "learn_time_ms": 19.153, "learn_throughput": 17542.552, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-06", "timestamp": 1706263746, "time_this_iter_s": 1.9796462059020996, "time_total_s": 255.15426182746887, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c210f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425d360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 255.15426182746887, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 19.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.9131643644422263e+33, "policy_entropy": 372.30303955078125, "var_gnorm": 22.78122901916504, "vf_loss": 12051238879232.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.731250762939453e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 130, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253777.0105592462, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15361268432878142, "mean_inference_ms": 5.251173462087226, "mean_action_processing_ms": 0.14503290178502368, "mean_env_wait_ms": 0.26132854497689795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430927276611328, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.0604398250579834}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253777.0105592462, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1185994.3001432233, -1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15361268432878142, "mean_inference_ms": 5.251173462087226, "mean_action_processing_ms": 0.14503290178502368, "mean_env_wait_ms": 0.26132854497689795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430927276611328, "StateBufferConnector_ms": 0.0022704601287841797, "ViewRequirementAgentConnector_ms": 0.0604398250579834}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 1978.371, "learn_time_ms": 19.153, "learn_throughput": 17542.617, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-08", "timestamp": 1706263748, "time_this_iter_s": 1.969794750213623, "time_total_s": 257.1240565776825, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0c10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425f5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 257.1240565776825, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 19.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0080152484153146e+34, "policy_entropy": 364.2802734375, "var_gnorm": 22.781370162963867, "vf_loss": 12437868773376.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 131, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254099.6737795516, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15363118811781987, "mean_inference_ms": 5.251463895636773, "mean_action_processing_ms": 0.14504153749395668, "mean_env_wait_ms": 0.2613456774090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01545262336730957, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.0604555606842041}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254099.6737795516, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1242223.893358615, -1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15363118811781987, "mean_inference_ms": 5.251463895636773, "mean_action_processing_ms": 0.14504153749395668, "mean_env_wait_ms": 0.2613456774090955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01545262336730957, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.0604555606842041}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 1979.254, "learn_time_ms": 19.184, "learn_throughput": 17515.015, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-10", "timestamp": 1706263750, "time_this_iter_s": 1.9895603656768799, "time_total_s": 259.1136169433594, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21930>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943eb9a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 259.1136169433594, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.35, "ram_util_percent": 19.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.937170807169058e+32, "policy_entropy": 359.69091796875, "var_gnorm": 22.781494140625, "vf_loss": 13635659235328.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 132, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254172.4179994527, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536499209594374, "mean_inference_ms": 5.251766405662355, "mean_action_processing_ms": 0.1450507396540378, "mean_env_wait_ms": 0.261363899090299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450239181518555, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06046462059020996}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254172.4179994527, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1210470.6247704488, -1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536499209594374, "mean_inference_ms": 5.251766405662355, "mean_action_processing_ms": 0.1450507396540378, "mean_env_wait_ms": 0.261363899090299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450239181518555, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06046462059020996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 1978.372, "learn_time_ms": 19.09, "learn_throughput": 17600.39, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-12", "timestamp": 1706263752, "time_this_iter_s": 1.9659924507141113, "time_total_s": 261.0796093940735, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccae00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425f7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 261.0796093940735, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 20.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7285327367465832e+33, "policy_entropy": 356.2495422363281, "var_gnorm": 22.7816104888916, "vf_loss": 13544810610688.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.3511390686035156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 133, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254426.261448026, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15366793739566695, "mean_inference_ms": 5.252069789321929, "mean_action_processing_ms": 0.14505960092375067, "mean_env_wait_ms": 0.26138165293284044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450477600097656, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06046104431152344}}, "episode_reward_max": -1112728.0041810006, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1254426.261448026, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1175190.21213755, -1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15366793739566695, "mean_inference_ms": 5.252069789321929, "mean_action_processing_ms": 0.14505960092375067, "mean_env_wait_ms": 0.26138165293284044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450477600097656, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06046104431152344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 1977.827, "learn_time_ms": 19.028, "learn_throughput": 17657.838, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-14", "timestamp": 1706263754, "time_this_iter_s": 1.9601495265960693, "time_total_s": 263.03975892066956, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c214b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ea3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 263.03975892066956, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666666, "ram_util_percent": 20.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3066873261909944e+33, "policy_entropy": 353.2969970703125, "var_gnorm": 22.78171157836914, "vf_loss": 10586550173696.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.303455352783203e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 134, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253681.9924636735, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15368479619341166, "mean_inference_ms": 5.252362832450245, "mean_action_processing_ms": 0.1450679964232974, "mean_env_wait_ms": 0.2613979801062565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015451192855834961, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06046438217163086}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1253681.9924636735, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1239241.9248757053, -1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15368479619341166, "mean_inference_ms": 5.252362832450245, "mean_action_processing_ms": 0.1450679964232974, "mean_env_wait_ms": 0.2613979801062565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015451192855834961, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.06046438217163086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 1977.522, "learn_time_ms": 19.105, "learn_throughput": 17587.343, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-16", "timestamp": 1706263756, "time_this_iter_s": 1.9684548377990723, "time_total_s": 265.0082137584686, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc8a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425e8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 265.0082137584686, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 20.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.393357260358807e+32, "policy_entropy": 348.35760498046875, "var_gnorm": 22.78180503845215, "vf_loss": 10847937101824.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.506111145019531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 135, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252794.9075493654, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15370086887614354, "mean_inference_ms": 5.252651424757385, "mean_action_processing_ms": 0.14507649351379695, "mean_env_wait_ms": 0.2614126737634047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450716018676758, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.060486793518066406}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252794.9075493654, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1217161.5127440647, -1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15370086887614354, "mean_inference_ms": 5.252651424757385, "mean_action_processing_ms": 0.14507649351379695, "mean_env_wait_ms": 0.2614126737634047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015450716018676758, "StateBufferConnector_ms": 0.002270936965942383, "ViewRequirementAgentConnector_ms": 0.060486793518066406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 1976.579, "learn_time_ms": 19.096, "learn_throughput": 17595.71, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-18", "timestamp": 1706263758, "time_this_iter_s": 1.9607126712799072, "time_total_s": 266.96892642974854, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca830>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94211fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 266.96892642974854, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.159448511952925e+33, "policy_entropy": 344.051513671875, "var_gnorm": 22.78188705444336, "vf_loss": 12656777887744.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.00543212890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 136, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252805.2921174797, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371716649657458, "mean_inference_ms": 5.252946197237469, "mean_action_processing_ms": 0.14508545220580182, "mean_env_wait_ms": 0.2614280885870647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453100204467773, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06049394607543945}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252805.2921174797, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1174346.366150157, -1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371716649657458, "mean_inference_ms": 5.252946197237469, "mean_action_processing_ms": 0.14508545220580182, "mean_env_wait_ms": 0.2614280885870647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015453100204467773, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06049394607543945}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1977.034, "learn_time_ms": 19.021, "learn_throughput": 17664.743, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-20", "timestamp": 1706263760, "time_this_iter_s": 1.988011121749878, "time_total_s": 268.9569375514984, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c221d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425eef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 268.9569375514984, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.966666666666666, "ram_util_percent": 20.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.157246194605946e+33, "policy_entropy": 340.9410705566406, "var_gnorm": 22.781967163085938, "vf_loss": 11822066302976.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.279613494873047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 137, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252816.6107874191, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373368864580061, "mean_inference_ms": 5.253252356789189, "mean_action_processing_ms": 0.1450949021150168, "mean_env_wait_ms": 0.2614440473646554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015486478805541992, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.0605006217956543}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252816.6107874191, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1156267.7738323566, -1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373368864580061, "mean_inference_ms": 5.253252356789189, "mean_action_processing_ms": 0.1450949021150168, "mean_env_wait_ms": 0.2614440473646554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015486478805541992, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.0605006217956543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 1973.222, "learn_time_ms": 19.008, "learn_throughput": 17676.73, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-22", "timestamp": 1706263762, "time_this_iter_s": 1.972445011138916, "time_total_s": 270.92938256263733, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2980>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942700d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 270.92938256263733, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.550000000000001, "ram_util_percent": 20.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2284126980005351e+33, "policy_entropy": 337.7346496582031, "var_gnorm": 22.782033920288086, "vf_loss": 11062730555392.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.398822784423828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 138, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252642.0496459582, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374967788762883, "mean_inference_ms": 5.253536629504894, "mean_action_processing_ms": 0.1451039535717788, "mean_env_wait_ms": 0.2614584074321909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015474796295166016, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06050539016723633}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252642.0496459582, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1206672.6680575314, -1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374967788762883, "mean_inference_ms": 5.253536629504894, "mean_action_processing_ms": 0.1451039535717788, "mean_env_wait_ms": 0.2614584074321909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015474796295166016, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06050539016723633}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 1972.254, "learn_time_ms": 18.985, "learn_throughput": 17698.374, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-24", "timestamp": 1706263764, "time_this_iter_s": 1.9726665019989014, "time_total_s": 272.90204906463623, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425e9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 272.90204906463623, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 20.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.525805785977514e+33, "policy_entropy": 332.2177734375, "var_gnorm": 22.7820987701416, "vf_loss": 12027007336448.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 139, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252448.9538566002, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537646740000534, "mean_inference_ms": 5.253809862735334, "mean_action_processing_ms": 0.14511251391975583, "mean_env_wait_ms": 0.2614720544454812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01546931266784668, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06052827835083008}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1252448.9538566002, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1242173.0581651295, -1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537646740000534, "mean_inference_ms": 5.253809862735334, "mean_action_processing_ms": 0.14511251391975583, "mean_env_wait_ms": 0.2614720544454812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01546931266784668, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06052827835083008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 1968.707, "learn_time_ms": 18.986, "learn_throughput": 17697.13, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-26", "timestamp": 1706263766, "time_this_iter_s": 1.9441592693328857, "time_total_s": 274.8462083339691, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc96f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94270040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 274.8462083339691, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 20.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.856928213651034e+33, "policy_entropy": 330.5802307128906, "var_gnorm": 22.78215217590332, "vf_loss": 10627658547200.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.792213439941406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 140, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1251162.3300479706, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377921068953604, "mean_inference_ms": 5.254076224223744, "mean_action_processing_ms": 0.1451207421172197, "mean_env_wait_ms": 0.26148503857499206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01545858383178711, "StateBufferConnector_ms": 0.0022728443145751953, "ViewRequirementAgentConnector_ms": 0.060523033142089844}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1251162.3300479706, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1252508.358481558, -1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377921068953604, "mean_inference_ms": 5.254076224223744, "mean_action_processing_ms": 0.1451207421172197, "mean_env_wait_ms": 0.26148503857499206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01545858383178711, "StateBufferConnector_ms": 0.0022728443145751953, "ViewRequirementAgentConnector_ms": 0.060523033142089844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 1967.556, "learn_time_ms": 19.015, "learn_throughput": 17670.236, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-28", "timestamp": 1706263768, "time_this_iter_s": 1.9582898616790771, "time_total_s": 276.8044981956482, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94212f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 276.8044981956482, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.43561256956528e+33, "policy_entropy": 326.3568115234375, "var_gnorm": 22.782203674316406, "vf_loss": 11826968395776.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.8995018005371094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 141, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1250372.2427638185, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379346572074504, "mean_inference_ms": 5.254340289041719, "mean_action_processing_ms": 0.14512902379853693, "mean_env_wait_ms": 0.2614974358928099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015429019927978516, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.060524940490722656}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1250372.2427638185, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1318551.2541187552, -1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379346572074504, "mean_inference_ms": 5.254340289041719, "mean_action_processing_ms": 0.14512902379853693, "mean_env_wait_ms": 0.2614974358928099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015429019927978516, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.060524940490722656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 1963.859, "learn_time_ms": 18.996, "learn_throughput": 17687.512, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-30", "timestamp": 1706263770, "time_this_iter_s": 1.9525716304779053, "time_total_s": 278.7570698261261, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c234c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9425f6d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 278.7570698261261, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 20.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.8693916502325996e+33, "policy_entropy": 327.8372802734375, "var_gnorm": 22.782251358032227, "vf_loss": 11541355167744.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 142, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1248806.7882687482, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380796754602089, "mean_inference_ms": 5.254610587750955, "mean_action_processing_ms": 0.14513777181786003, "mean_env_wait_ms": 0.2615104841734895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424251556396484, "StateBufferConnector_ms": 0.0022726058959960938, "ViewRequirementAgentConnector_ms": 0.06052851676940918}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1248806.7882687482, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1237737.811696465, -1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380796754602089, "mean_inference_ms": 5.254610587750955, "mean_action_processing_ms": 0.14513777181786003, "mean_env_wait_ms": 0.2615104841734895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015424251556396484, "StateBufferConnector_ms": 0.0022726058959960938, "ViewRequirementAgentConnector_ms": 0.06052851676940918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 1964.345, "learn_time_ms": 19.029, "learn_throughput": 17657.108, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-32", "timestamp": 1706263772, "time_this_iter_s": 1.970841407775879, "time_total_s": 280.727911233902, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22290>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942137f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 280.727911233902, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 20.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.432677579483184e+34, "policy_entropy": 322.603271484375, "var_gnorm": 22.782291412353516, "vf_loss": 11928612110336.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8623809814453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 143, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1248337.1061334163, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538215939939479, "mean_inference_ms": 5.254857034446692, "mean_action_processing_ms": 0.14514597713103938, "mean_env_wait_ms": 0.26152304736492804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415430068969727, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.06054854393005371}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1248337.1061334163, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1279410.3205008898, -1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538215939939479, "mean_inference_ms": 5.254857034446692, "mean_action_processing_ms": 0.14514597713103938, "mean_env_wait_ms": 0.26152304736492804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015415430068969727, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.06054854393005371}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 1964.35, "learn_time_ms": 19.003, "learn_throughput": 17681.232, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "done": false, "episodes_total": 143, "training_iteration": 143, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-34", "timestamp": 1706263774, "time_this_iter_s": 1.9602117538452148, "time_total_s": 282.6881229877472, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecdb10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94270dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 282.6881229877472, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 21.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.142361203573578e+33, "policy_entropy": 324.2503967285156, "var_gnorm": 22.78232765197754, "vf_loss": 12382857330688.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.707408905029297e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 144, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1247262.5109657163, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383484460673186, "mean_inference_ms": 5.255104815967929, "mean_action_processing_ms": 0.14515401024193741, "mean_env_wait_ms": 0.2615354252515123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01542043685913086, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06055569648742676}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1247262.5109657163, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1241719.0565144725, -1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383484460673186, "mean_inference_ms": 5.255104815967929, "mean_action_processing_ms": 0.14515401024193741, "mean_env_wait_ms": 0.2615354252515123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01542043685913086, "StateBufferConnector_ms": 0.002271890640258789, "ViewRequirementAgentConnector_ms": 0.06055569648742676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1962.599, "learn_time_ms": 18.952, "learn_throughput": 17728.832, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 144, "training_iteration": 144, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-36", "timestamp": 1706263776, "time_this_iter_s": 1.950958013534546, "time_total_s": 284.63908100128174, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94213d90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 284.63908100128174, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3471955096415005e+33, "policy_entropy": 318.4192199707031, "var_gnorm": 22.782363891601562, "vf_loss": 14029862993920.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.3974647521972656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 145, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1247303.9328082565, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384743270644952, "mean_inference_ms": 5.255344328591409, "mean_action_processing_ms": 0.14516187987041057, "mean_env_wait_ms": 0.26154732839342976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430688858032227, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06054520606994629}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1247303.9328082565, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1212096.2068469771, -1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384743270644952, "mean_inference_ms": 5.255344328591409, "mean_action_processing_ms": 0.14516187987041057, "mean_env_wait_ms": 0.26154732839342976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015430688858032227, "StateBufferConnector_ms": 0.0022716522216796875, "ViewRequirementAgentConnector_ms": 0.06054520606994629}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48720, "timers": {"training_iteration_time_ms": 1963.526, "learn_time_ms": 18.953, "learn_throughput": 17727.65, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "done": false, "episodes_total": 145, "training_iteration": 145, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-38", "timestamp": 1706263778, "time_this_iter_s": 1.9700050354003906, "time_total_s": 286.60908603668213, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942712d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 286.60908603668213, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 21.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.1069679119060257e+33, "policy_entropy": 320.91131591796875, "var_gnorm": 22.782394409179688, "vf_loss": 11347680034816.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1961669921875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 146, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1246780.7278593292, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385990240287944, "mean_inference_ms": 5.2555832232910085, "mean_action_processing_ms": 0.1451701028929286, "mean_env_wait_ms": 0.2615599369003914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544642448425293, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06054377555847168}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1246780.7278593292, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1315550.825675236, -1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385990240287944, "mean_inference_ms": 5.2555832232910085, "mean_action_processing_ms": 0.1451701028929286, "mean_env_wait_ms": 0.2615599369003914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01544642448425293, "StateBufferConnector_ms": 0.0022711753845214844, "ViewRequirementAgentConnector_ms": 0.06054377555847168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49056, "timers": {"training_iteration_time_ms": 1961.101, "learn_time_ms": 18.907, "learn_throughput": 17771.242, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "done": false, "episodes_total": 146, "training_iteration": 146, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-40", "timestamp": 1706263780, "time_this_iter_s": 1.9637451171875, "time_total_s": 288.57283115386963, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0cd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94272050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 288.57283115386963, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2256104859190633e+34, "policy_entropy": 319.92852783203125, "var_gnorm": 22.782421112060547, "vf_loss": 11435216207872.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.1961669921875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 147, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1245333.4541241925, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386870828976604, "mean_inference_ms": 5.255742493343836, "mean_action_processing_ms": 0.1451752645900982, "mean_env_wait_ms": 0.261567132468671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01540684700012207, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06038093566894531}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1245333.4541241925, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1383181.8385643582, -1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386870828976604, "mean_inference_ms": 5.255742493343836, "mean_action_processing_ms": 0.1451752645900982, "mean_env_wait_ms": 0.261567132468671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01540684700012207, "StateBufferConnector_ms": 0.002268552780151367, "ViewRequirementAgentConnector_ms": 0.06038093566894531}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49392, "timers": {"training_iteration_time_ms": 1958.805, "learn_time_ms": 18.922, "learn_throughput": 17756.978, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "done": false, "episodes_total": 147, "training_iteration": 147, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-42", "timestamp": 1706263782, "time_this_iter_s": 1.9494707584381104, "time_total_s": 290.52230191230774, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 290.52230191230774, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 21.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.079790310047536e+34, "policy_entropy": 316.9114990234375, "var_gnorm": 22.782445907592773, "vf_loss": 12784194551808.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.933906555175781e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 148, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1244017.447065211, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387409463138285, "mean_inference_ms": 5.255836591021782, "mean_action_processing_ms": 0.14517785527031943, "mean_env_wait_ms": 0.2615690713860184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407800674438477, "StateBufferConnector_ms": 0.0022668838500976562, "ViewRequirementAgentConnector_ms": 0.06040000915527344}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1244017.447065211, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1413279.5778538324, -1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387409463138285, "mean_inference_ms": 5.255836591021782, "mean_action_processing_ms": 0.14517785527031943, "mean_env_wait_ms": 0.2615690713860184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407800674438477, "StateBufferConnector_ms": 0.0022668838500976562, "ViewRequirementAgentConnector_ms": 0.06040000915527344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49728, "timers": {"training_iteration_time_ms": 1954.427, "learn_time_ms": 18.94, "learn_throughput": 17740.035, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "done": false, "episodes_total": 148, "training_iteration": 148, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-44", "timestamp": 1706263784, "time_this_iter_s": 1.9288842678070068, "time_total_s": 292.45118618011475, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7eccbb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94270e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 292.45118618011475, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 21.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.963158695684203e+34, "policy_entropy": 313.42669677734375, "var_gnorm": 22.782468795776367, "vf_loss": 11162713325568.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.279613494873047e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 149, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1241399.2627454451, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387966920848015, "mean_inference_ms": 5.255933176745231, "mean_action_processing_ms": 0.1451806307788483, "mean_env_wait_ms": 0.2615709791725752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015377998352050781, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06041264533996582}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1241399.2627454451, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1470125.0383281, -1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387966920848015, "mean_inference_ms": 5.255933176745231, "mean_action_processing_ms": 0.1451806307788483, "mean_env_wait_ms": 0.2615709791725752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015377998352050781, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06041264533996582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50064, "timers": {"training_iteration_time_ms": 1957.59, "learn_time_ms": 18.945, "learn_throughput": 17735.146, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "done": false, "episodes_total": 149, "training_iteration": 149, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-46", "timestamp": 1706263786, "time_this_iter_s": 1.9758272171020508, "time_total_s": 294.4270133972168, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94272cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 294.4270133972168, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.949999999999999, "ram_util_percent": 21.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.81361202285653e+33, "policy_entropy": 314.6463928222656, "var_gnorm": 22.782487869262695, "vf_loss": 11177510830080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.898143768310547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 150, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1238152.5069525116, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388517380071332, "mean_inference_ms": 5.256029632898143, "mean_action_processing_ms": 0.1451833928658374, "mean_env_wait_ms": 0.26157285759341814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015367269515991211, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.06040334701538086}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1238152.5069525116, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1433030.9093161465, -1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388517380071332, "mean_inference_ms": 5.256029632898143, "mean_action_processing_ms": 0.1451833928658374, "mean_env_wait_ms": 0.26157285759341814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015367269515991211, "StateBufferConnector_ms": 0.002267599105834961, "ViewRequirementAgentConnector_ms": 0.06040334701538086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 1957.313, "learn_time_ms": 18.846, "learn_throughput": 17828.842, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 150, "training_iteration": 150, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-48", "timestamp": 1706263788, "time_this_iter_s": 1.9554774761199951, "time_total_s": 296.3824908733368, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21900>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94327f40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 296.3824908733368, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.14837924448217e+33, "policy_entropy": 313.8652648925781, "var_gnorm": 22.782506942749023, "vf_loss": 13438674796544.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.184246063232422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 151, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1236384.8390542346, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389068447802454, "mean_inference_ms": 5.25612621694768, "mean_action_processing_ms": 0.1451865086270706, "mean_env_wait_ms": 0.261574976599709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355825424194336, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.06039237976074219}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1236384.8390542346, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1488805.0872919313, -1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389068447802454, "mean_inference_ms": 5.25612621694768, "mean_action_processing_ms": 0.1451865086270706, "mean_env_wait_ms": 0.261574976599709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355825424194336, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.06039237976074219}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50736, "timers": {"training_iteration_time_ms": 1957.007, "learn_time_ms": 18.813, "learn_throughput": 17859.66, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "done": false, "episodes_total": 151, "training_iteration": 151, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-50", "timestamp": 1706263790, "time_this_iter_s": 1.9495034217834473, "time_total_s": 298.33199429512024, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94271d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 298.33199429512024, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 21.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0153592039043712e+34, "policy_entropy": 315.36029052734375, "var_gnorm": 22.78252601623535, "vf_loss": 11516442050560.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.38690185546875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 152, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1233057.2136882062, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538963183091555, "mean_inference_ms": 5.256219279276796, "mean_action_processing_ms": 0.14518982098207447, "mean_env_wait_ms": 0.2615772022106425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362977981567383, "StateBufferConnector_ms": 0.0022683143615722656, "ViewRequirementAgentConnector_ms": 0.06041145324707031}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1233057.2136882062, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1492396.3842875138, -1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538963183091555, "mean_inference_ms": 5.256219279276796, "mean_action_processing_ms": 0.14518982098207447, "mean_env_wait_ms": 0.2615772022106425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015362977981567383, "StateBufferConnector_ms": 0.0022683143615722656, "ViewRequirementAgentConnector_ms": 0.06041145324707031}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1957.373, "learn_time_ms": 18.842, "learn_throughput": 17832.609, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "done": false, "episodes_total": 152, "training_iteration": 152, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-52", "timestamp": 1706263792, "time_this_iter_s": 1.9745030403137207, "time_total_s": 300.30649733543396, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d2350>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 300.30649733543396, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 21.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1336624076641841e+34, "policy_entropy": 314.3455810546875, "var_gnorm": 22.78253936767578, "vf_loss": 11798002532352.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.5418739318847656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 153, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1229917.410163789, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390155568430683, "mean_inference_ms": 5.256310082840811, "mean_action_processing_ms": 0.1451931362475669, "mean_env_wait_ms": 0.2615789981528852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378952026367188, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.060439109802246094}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1229917.410163789, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1462778.4477070486, -1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390155568430683, "mean_inference_ms": 5.256310082840811, "mean_action_processing_ms": 0.1451931362475669, "mean_env_wait_ms": 0.2615789981528852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378952026367188, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.060439109802246094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51408, "timers": {"training_iteration_time_ms": 1958.463, "learn_time_ms": 18.918, "learn_throughput": 17760.402, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "done": false, "episodes_total": 153, "training_iteration": 153, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-54", "timestamp": 1706263794, "time_this_iter_s": 1.971104621887207, "time_total_s": 302.27760195732117, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21f90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94271a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 302.27760195732117, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 21.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.720810229163491e+34, "policy_entropy": 311.28656005859375, "var_gnorm": 22.78255271911621, "vf_loss": 11648640221184.0}, "grad_gnorm": 0.0, "vf_explained_var": -5.054473876953125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 154, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1227017.6119547682, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390680486958475, "mean_inference_ms": 5.256396818122485, "mean_action_processing_ms": 0.14519661234852516, "mean_env_wait_ms": 0.2615805285387873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015393257141113281, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.060457468032836914}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1227017.6119547682, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1533667.050273132, -1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390680486958475, "mean_inference_ms": 5.256396818122485, "mean_action_processing_ms": 0.14519661234852516, "mean_env_wait_ms": 0.2615805285387873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015393257141113281, "StateBufferConnector_ms": 0.002270221710205078, "ViewRequirementAgentConnector_ms": 0.060457468032836914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51744, "timers": {"training_iteration_time_ms": 1961.52, "learn_time_ms": 18.892, "learn_throughput": 17785.596, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "done": false, "episodes_total": 154, "training_iteration": 154, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-56", "timestamp": 1706263796, "time_this_iter_s": 1.9814941883087158, "time_total_s": 304.2590961456299, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7ecce80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94271000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 304.2590961456299, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 21.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5570356728077135e+34, "policy_entropy": 311.0325927734375, "var_gnorm": 22.782567977905273, "vf_loss": 13555988430848.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8743019104003906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 155, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1224284.4432749983, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539104024301961, "mean_inference_ms": 5.256456076854618, "mean_action_processing_ms": 0.14519878773062106, "mean_env_wait_ms": 0.261579786152411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388250350952148, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06040191650390625}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1538500.6631166865, "episode_reward_mean": -1224284.4432749983, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1538500.6631166865, -1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539104024301961, "mean_inference_ms": 5.256456076854618, "mean_action_processing_ms": 0.14519878773062106, "mean_env_wait_ms": 0.261579786152411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388250350952148, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06040191650390625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52080, "timers": {"training_iteration_time_ms": 1961.62, "learn_time_ms": 18.885, "learn_throughput": 17791.838, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "done": false, "episodes_total": 155, "training_iteration": 155, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-09-58", "timestamp": 1706263798, "time_this_iter_s": 1.971036434173584, "time_total_s": 306.23013257980347, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1360>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 306.23013257980347, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 22.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3678369638135913e+34, "policy_entropy": 312.2286376953125, "var_gnorm": 22.782575607299805, "vf_loss": 12102794215424.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.8504600524902344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 156, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1220582.5544557916, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391339813585764, "mean_inference_ms": 5.25650678869129, "mean_action_processing_ms": 0.14520066239981522, "mean_env_wait_ms": 0.2615784735289402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015397787094116211, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06038808822631836}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1220582.5544557916, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1494645.271795747, -1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391339813585764, "mean_inference_ms": 5.25650678869129, "mean_action_processing_ms": 0.14520066239981522, "mean_env_wait_ms": 0.2615784735289402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015397787094116211, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06038808822631836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52416, "timers": {"training_iteration_time_ms": 1961.724, "learn_time_ms": 18.966, "learn_throughput": 17716.262, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "done": false, "episodes_total": 156, "training_iteration": 156, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-00", "timestamp": 1706263800, "time_this_iter_s": 1.964792013168335, "time_total_s": 308.1949245929718, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22ef0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942716c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 308.1949245929718, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 22.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1278825894147646e+34, "policy_entropy": 313.082275390625, "var_gnorm": 22.7825870513916, "vf_loss": 11156368392192.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.62396240234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 157, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1216969.2750284923, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391478009771115, "mean_inference_ms": 5.256537642369355, "mean_action_processing_ms": 0.14520130302823006, "mean_env_wait_ms": 0.2615749571816793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407800674438477, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.06039237976074219}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1216969.2750284923, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1487960.152078544, -1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391478009771115, "mean_inference_ms": 5.256537642369355, "mean_action_processing_ms": 0.14520130302823006, "mean_env_wait_ms": 0.2615749571816793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015407800674438477, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.06039237976074219}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52752, "timers": {"training_iteration_time_ms": 1963.976, "learn_time_ms": 18.968, "learn_throughput": 17714.392, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "done": false, "episodes_total": 157, "training_iteration": 157, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-02", "timestamp": 1706263802, "time_this_iter_s": 1.97200608253479, "time_total_s": 310.1669306755066, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f18220>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94210670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 310.1669306755066, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 22.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.595671327176273e+34, "policy_entropy": 308.3198547363281, "var_gnorm": 22.782596588134766, "vf_loss": 12739162406912.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.172325134277344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 158, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1214260.0914493941, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391447002564168, "mean_inference_ms": 5.256537731570119, "mean_action_processing_ms": 0.14520070694304466, "mean_env_wait_ms": 0.2615690122434478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015395879745483398, "StateBufferConnector_ms": 0.00226593017578125, "ViewRequirementAgentConnector_ms": 0.06036949157714844}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1214260.0914493941, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1398528.4892208956, -1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391447002564168, "mean_inference_ms": 5.256537731570119, "mean_action_processing_ms": 0.14520070694304466, "mean_env_wait_ms": 0.2615690122434478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015395879745483398, "StateBufferConnector_ms": 0.00226593017578125, "ViewRequirementAgentConnector_ms": 0.06036949157714844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53088, "timers": {"training_iteration_time_ms": 1967.081, "learn_time_ms": 18.965, "learn_throughput": 17716.507, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "done": false, "episodes_total": 158, "training_iteration": 158, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-04", "timestamp": 1706263804, "time_this_iter_s": 1.9599416255950928, "time_total_s": 312.1268723011017, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d22f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 312.1268723011017, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.326043032782625e+33, "policy_entropy": 311.84185791015625, "var_gnorm": 22.782604217529297, "vf_loss": 11019249254400.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.57763671875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 159, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1211501.1719368873, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539139089710503, "mean_inference_ms": 5.256532078860451, "mean_action_processing_ms": 0.14520009315017768, "mean_env_wait_ms": 0.26156301512887437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380144119262695, "StateBufferConnector_ms": 0.002265453338623047, "ViewRequirementAgentConnector_ms": 0.06034445762634277}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1534591.0449777895, "episode_reward_mean": -1211501.1719368873, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1534591.0449777895, -1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539139089710503, "mean_inference_ms": 5.256532078860451, "mean_action_processing_ms": 0.14520009315017768, "mean_env_wait_ms": 0.26156301512887437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015380144119262695, "StateBufferConnector_ms": 0.002265453338623047, "ViewRequirementAgentConnector_ms": 0.06034445762634277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53424, "timers": {"training_iteration_time_ms": 1963.915, "learn_time_ms": 18.963, "learn_throughput": 17718.557, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "done": false, "episodes_total": 159, "training_iteration": 159, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-06", "timestamp": 1706263806, "time_this_iter_s": 1.9441032409667969, "time_total_s": 314.0709755420685, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21a50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 314.0709755420685, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.4387242147295485e+34, "policy_entropy": 310.28851318359375, "var_gnorm": 22.782609939575195, "vf_loss": 13204617953280.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 160, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506951.5459521438, "episode_reward_mean": -1208692.691315279, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391281733335382, "mean_inference_ms": 5.256519894852834, "mean_action_processing_ms": 0.14519923477070892, "mean_env_wait_ms": 0.261556020700508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378475189208984, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06036043167114258}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506951.5459521438, "episode_reward_mean": -1208692.691315279, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1483901.935488811, -1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391281733335382, "mean_inference_ms": 5.256519894852834, "mean_action_processing_ms": 0.14519923477070892, "mean_env_wait_ms": 0.261556020700508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378475189208984, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.06036043167114258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1964.368, "learn_time_ms": 19.012, "learn_throughput": 17672.939, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 160, "training_iteration": 160, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-08", "timestamp": 1706263808, "time_this_iter_s": 1.9600248336791992, "time_total_s": 316.0310003757477, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc96f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 316.0310003757477, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 22.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.89729681936211e+33, "policy_entropy": 309.4154052734375, "var_gnorm": 22.782617568969727, "vf_loss": 11580654747648.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.458427429199219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 161, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506951.5459521438, "episode_reward_mean": -1205427.962382526, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539117881817667, "mean_inference_ms": 5.256511576792851, "mean_action_processing_ms": 0.1451984439506507, "mean_env_wait_ms": 0.261549425474855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538991928100586, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.060355424880981445}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506951.5459521438, "episode_reward_mean": -1205427.962382526, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1506951.5459521438, -1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539117881817667, "mean_inference_ms": 5.256511576792851, "mean_action_processing_ms": 0.1451984439506507, "mean_env_wait_ms": 0.261549425474855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538991928100586, "StateBufferConnector_ms": 0.0022666454315185547, "ViewRequirementAgentConnector_ms": 0.060355424880981445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 1967.669, "learn_time_ms": 19.078, "learn_throughput": 17611.652, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 161, "training_iteration": 161, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-10", "timestamp": 1706263810, "time_this_iter_s": 1.9824886322021484, "time_total_s": 318.01348900794983, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d0a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 318.01348900794983, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 22.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.014374214895023e+34, "policy_entropy": 307.843505859375, "var_gnorm": 22.782623291015625, "vf_loss": 11243000692736.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.410743713378906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 162, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506843.492389562, "episode_reward_mean": -1201915.1749425246, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391136479353684, "mean_inference_ms": 5.256513268091951, "mean_action_processing_ms": 0.1451980723430837, "mean_env_wait_ms": 0.2615434347034795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015385866165161133, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.060347795486450195}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506843.492389562, "episode_reward_mean": -1201915.1749425246, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1373097.9325003142, -1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391136479353684, "mean_inference_ms": 5.256513268091951, "mean_action_processing_ms": 0.1451980723430837, "mean_env_wait_ms": 0.2615434347034795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015385866165161133, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.060347795486450195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54432, "timers": {"training_iteration_time_ms": 1968.913, "learn_time_ms": 19.119, "learn_throughput": 17574.25, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "done": false, "episodes_total": 162, "training_iteration": 162, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-12", "timestamp": 1706263812, "time_this_iter_s": 1.986971378326416, "time_total_s": 320.00046038627625, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca170>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 320.00046038627625, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 22.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.7477188775399002e+34, "policy_entropy": 308.2165222167969, "var_gnorm": 22.782629013061523, "vf_loss": 12586435215360.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.826618194580078e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 163, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506843.492389562, "episode_reward_mean": -1200306.0665942105, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391082146772445, "mean_inference_ms": 5.256510876222267, "mean_action_processing_ms": 0.14519786132165996, "mean_env_wait_ms": 0.2615374872202181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386581420898438, "StateBufferConnector_ms": 0.0022687911987304688, "ViewRequirementAgentConnector_ms": 0.060350894927978516}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1506843.492389562, "episode_reward_mean": -1200306.0665942105, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1506843.492389562, -1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391082146772445, "mean_inference_ms": 5.256510876222267, "mean_action_processing_ms": 0.14519786132165996, "mean_env_wait_ms": 0.2615374872202181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386581420898438, "StateBufferConnector_ms": 0.0022687911987304688, "ViewRequirementAgentConnector_ms": 0.060350894927978516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54768, "timers": {"training_iteration_time_ms": 1968.535, "learn_time_ms": 19.144, "learn_throughput": 17550.832, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "done": false, "episodes_total": 163, "training_iteration": 163, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-14", "timestamp": 1706263814, "time_this_iter_s": 1.9673206806182861, "time_total_s": 321.96778106689453, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd943ebd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 321.96778106689453, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.0247522795834105e+33, "policy_entropy": 307.57275390625, "var_gnorm": 22.78263282775879, "vf_loss": 10781109256192.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.9577484130859375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 164, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1450830.7590901826, "episode_reward_mean": -1196383.9185420542, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390969464496995, "mean_inference_ms": 5.256492063593532, "mean_action_processing_ms": 0.14519721015839923, "mean_env_wait_ms": 0.26153029959904844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386104583740234, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06035423278808594}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1450830.7590901826, "episode_reward_mean": -1196383.9185420542, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1450830.7590901826, -1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390969464496995, "mean_inference_ms": 5.256492063593532, "mean_action_processing_ms": 0.14519721015839923, "mean_env_wait_ms": 0.26153029959904844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015386104583740234, "StateBufferConnector_ms": 0.0022695064544677734, "ViewRequirementAgentConnector_ms": 0.06035423278808594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55104, "timers": {"training_iteration_time_ms": 1966.585, "learn_time_ms": 19.155, "learn_throughput": 17540.674, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "done": false, "episodes_total": 164, "training_iteration": 164, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-16", "timestamp": 1706263816, "time_this_iter_s": 1.9620153903961182, "time_total_s": 323.92979645729065, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 323.92979645729065, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 22.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.751525665916139e+33, "policy_entropy": 308.02850341796875, "var_gnorm": 22.782636642456055, "vf_loss": 11382236905472.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.57763671875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 165, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1381688.0423074826, "episode_reward_mean": -1193414.9523582996, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390670677627846, "mean_inference_ms": 5.256445579281572, "mean_action_processing_ms": 0.14519519962506433, "mean_env_wait_ms": 0.26152066751352987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360116958618164, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.06031608581542969}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1381688.0423074826, "episode_reward_mean": -1193414.9523582996, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1381688.0423074826, -1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390670677627846, "mean_inference_ms": 5.256445579281572, "mean_action_processing_ms": 0.14519519962506433, "mean_env_wait_ms": 0.26152066751352987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015360116958618164, "StateBufferConnector_ms": 0.002267122268676758, "ViewRequirementAgentConnector_ms": 0.06031608581542969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 1965.326, "learn_time_ms": 19.223, "learn_throughput": 17479.345, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 165, "training_iteration": 165, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-18", "timestamp": 1706263818, "time_this_iter_s": 1.9584236145019531, "time_total_s": 325.8882200717926, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 325.8882200717926, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 22.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.417031542794575e+33, "policy_entropy": 308.24676513671875, "var_gnorm": 22.782642364501953, "vf_loss": 12376840601600.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.374980926513672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 166, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1191558.747118779, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390287755193266, "mean_inference_ms": 5.256388050066762, "mean_action_processing_ms": 0.14519263736584756, "mean_env_wait_ms": 0.2615098508188325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358448028564453, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06029963493347168}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1191558.747118779, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1268682.3936886366, -1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390287755193266, "mean_inference_ms": 5.256388050066762, "mean_action_processing_ms": 0.14519263736584756, "mean_env_wait_ms": 0.2615098508188325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015358448028564453, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06029963493347168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55776, "timers": {"training_iteration_time_ms": 1964.734, "learn_time_ms": 19.154, "learn_throughput": 17542.137, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "done": false, "episodes_total": 166, "training_iteration": 166, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-20", "timestamp": 1706263820, "time_this_iter_s": 1.9588990211486816, "time_total_s": 327.8471190929413, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19750>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942880d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 327.8471190929413, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 22.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.614579787010233e+33, "policy_entropy": 306.77752685546875, "var_gnorm": 22.782644271850586, "vf_loss": 12854796222464.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.886222839355469e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 167, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1190882.0198518822, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389941716970848, "mean_inference_ms": 5.256339672527849, "mean_action_processing_ms": 0.14519052141089567, "mean_env_wait_ms": 0.26150000947325386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015342235565185547, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06028437614440918}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1190882.0198518822, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1214647.44739222, -1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389941716970848, "mean_inference_ms": 5.256339672527849, "mean_action_processing_ms": 0.14519052141089567, "mean_env_wait_ms": 0.26150000947325386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015342235565185547, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.06028437614440918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56112, "timers": {"training_iteration_time_ms": 1963.663, "learn_time_ms": 19.144, "learn_throughput": 17551.334, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "done": false, "episodes_total": 167, "training_iteration": 167, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-22", "timestamp": 1706263822, "time_this_iter_s": 1.9612996578216553, "time_total_s": 329.80841875076294, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d15a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942892d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 329.80841875076294, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 23.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.724743822479664e+33, "policy_entropy": 308.28826904296875, "var_gnorm": 22.78264808654785, "vf_loss": 11468141494272.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 168, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1190429.6054134197, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389453622370014, "mean_inference_ms": 5.256267373682885, "mean_action_processing_ms": 0.14518737327209472, "mean_env_wait_ms": 0.2614881003823601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323162078857422, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.060302734375}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1190429.6054134197, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1187932.796366099, -1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389453622370014, "mean_inference_ms": 5.256267373682885, "mean_action_processing_ms": 0.14518737327209472, "mean_env_wait_ms": 0.2614881003823601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015323162078857422, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.060302734375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1963.46, "learn_time_ms": 19.182, "learn_throughput": 17516.038, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "done": false, "episodes_total": 168, "training_iteration": 168, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-24", "timestamp": 1706263824, "time_this_iter_s": 1.957911491394043, "time_total_s": 331.766330242157, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9b70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94271b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 331.766330242157, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 23.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1386001790988817e+34, "policy_entropy": 308.6838073730469, "var_gnorm": 22.782651901245117, "vf_loss": 11058030837760.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.3511390686035156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 169, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1189990.9205564505, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388884236163602, "mean_inference_ms": 5.256180105600658, "mean_action_processing_ms": 0.1451835572498873, "mean_env_wait_ms": 0.2614747330227538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313863754272461, "StateBufferConnector_ms": 0.0022618770599365234, "ViewRequirementAgentConnector_ms": 0.06026172637939453}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1189990.9205564505, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1170065.969665751, -1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388884236163602, "mean_inference_ms": 5.256180105600658, "mean_action_processing_ms": 0.1451835572498873, "mean_env_wait_ms": 0.2614747330227538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313863754272461, "StateBufferConnector_ms": 0.0022618770599365234, "ViewRequirementAgentConnector_ms": 0.06026172637939453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56784, "timers": {"training_iteration_time_ms": 1966.067, "learn_time_ms": 19.179, "learn_throughput": 17518.934, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "done": false, "episodes_total": 169, "training_iteration": 169, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-26", "timestamp": 1706263826, "time_this_iter_s": 1.9702162742614746, "time_total_s": 333.73654651641846, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 333.73654651641846, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 23.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0806593030366358e+34, "policy_entropy": 307.7154235839844, "var_gnorm": 22.782655715942383, "vf_loss": 11768759844864.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.981590270996094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 170, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "sampler_results": {"episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1189910.8047283555, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388175171773355, "mean_inference_ms": 5.25607549017762, "mean_action_processing_ms": 0.14517862505042678, "mean_env_wait_ms": 0.26145941473576173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015291452407836914, "StateBufferConnector_ms": 0.00225830078125, "ViewRequirementAgentConnector_ms": 0.06015491485595703}}, "episode_reward_max": -1100763.3137023128, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1189910.8047283555, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1224620.8230004422, -1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388175171773355, "mean_inference_ms": 5.25607549017762, "mean_action_processing_ms": 0.14517862505042678, "mean_env_wait_ms": 0.26145941473576173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015291452407836914, "StateBufferConnector_ms": 0.00225830078125, "ViewRequirementAgentConnector_ms": 0.06015491485595703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57120, "timers": {"training_iteration_time_ms": 1968.517, "learn_time_ms": 19.182, "learn_throughput": 17516.408, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "done": false, "episodes_total": 170, "training_iteration": 170, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-28", "timestamp": 1706263828, "time_this_iter_s": 1.9845187664031982, "time_total_s": 335.72106528282166, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 335.72106528282166, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.59150171643734e+32, "policy_entropy": 310.08929443359375, "var_gnorm": 22.782657623291016, "vf_loss": 10325376106496.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.7087669372558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 171, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "sampler_results": {"episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1188577.963885591, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538749984152136, "mean_inference_ms": 5.255979385965646, "mean_action_processing_ms": 0.14517413171123983, "mean_env_wait_ms": 0.2614446701711274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015293359756469727, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.0601651668548584}}, "episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1188577.963885591, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1164535.0350058363, -1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538749984152136, "mean_inference_ms": 5.255979385965646, "mean_action_processing_ms": 0.14517413171123983, "mean_env_wait_ms": 0.2614446701711274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015293359756469727, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.0601651668548584}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57456, "timers": {"training_iteration_time_ms": 1970.014, "learn_time_ms": 19.207, "learn_throughput": 17493.513, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "done": false, "episodes_total": 171, "training_iteration": 171, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-30", "timestamp": 1706263830, "time_this_iter_s": 1.9975006580352783, "time_total_s": 337.71856594085693, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22500>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94270c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 337.71856594085693, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.429129684249071e+34, "policy_entropy": 308.803955078125, "var_gnorm": 22.782657623291016, "vf_loss": 10977644904448.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 172, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "sampler_results": {"episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1188139.3289864722, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386858352476135, "mean_inference_ms": 5.255892140637521, "mean_action_processing_ms": 0.14517003207806334, "mean_env_wait_ms": 0.2614306318337352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312433242797852, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.06019926071166992}}, "episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1188139.3289864722, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1141539.7220032683, -1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386858352476135, "mean_inference_ms": 5.255892140637521, "mean_action_processing_ms": 0.14517003207806334, "mean_env_wait_ms": 0.2614306318337352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312433242797852, "StateBufferConnector_ms": 0.0022606849670410156, "ViewRequirementAgentConnector_ms": 0.06019926071166992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57792, "timers": {"training_iteration_time_ms": 1970.141, "learn_time_ms": 19.157, "learn_throughput": 17539.277, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "done": false, "episodes_total": 172, "training_iteration": 172, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-32", "timestamp": 1706263832, "time_this_iter_s": 1.988218069076538, "time_total_s": 339.7067840099335, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccaa40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 339.7067840099335, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 23.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.567407214216669e+32, "policy_entropy": 308.60736083984375, "var_gnorm": 22.78266143798828, "vf_loss": 10887381385216.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2557716369628906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 173, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "sampler_results": {"episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1187996.9322472808, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538624058142092, "mean_inference_ms": 5.255811724965773, "mean_action_processing_ms": 0.1451662784044779, "mean_env_wait_ms": 0.26141717263167225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015315532684326172, "StateBufferConnector_ms": 0.002260446548461914, "ViewRequirementAgentConnector_ms": 0.060190439224243164}}, "episode_reward_max": -1091336.73872396, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1187996.9322472808, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1246069.7413582427, -1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538624058142092, "mean_inference_ms": 5.255811724965773, "mean_action_processing_ms": 0.1451662784044779, "mean_env_wait_ms": 0.26141717263167225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015315532684326172, "StateBufferConnector_ms": 0.002260446548461914, "ViewRequirementAgentConnector_ms": 0.060190439224243164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58128, "timers": {"training_iteration_time_ms": 1971.106, "learn_time_ms": 19.103, "learn_throughput": 17588.595, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "done": false, "episodes_total": 173, "training_iteration": 173, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-34", "timestamp": 1706263834, "time_this_iter_s": 1.9769766330718994, "time_total_s": 341.68376064300537, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1450>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428a200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 341.68376064300537, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.888439894475518e+33, "policy_entropy": 311.2784423828125, "var_gnorm": 22.782663345336914, "vf_loss": 9975559618560.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.2319297790527344e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 174, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186176.0753099325, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385667879254641, "mean_inference_ms": 5.255752178122143, "mean_action_processing_ms": 0.14516283643237482, "mean_env_wait_ms": 0.26140425948043816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331745147705078, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.06019139289855957}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186176.0753099325, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1174399.2130991102, -1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385667879254641, "mean_inference_ms": 5.255752178122143, "mean_action_processing_ms": 0.14516283643237482, "mean_env_wait_ms": 0.26140425948043816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015331745147705078, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.06019139289855957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58464, "timers": {"training_iteration_time_ms": 1978.303, "learn_time_ms": 19.166, "learn_throughput": 17531.226, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "done": false, "episodes_total": 174, "training_iteration": 174, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-36", "timestamp": 1706263836, "time_this_iter_s": 2.0340099334716797, "time_total_s": 343.71777057647705, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb1c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942705e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 343.71777057647705, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.5585712954694006e+33, "policy_entropy": 303.9513244628906, "var_gnorm": 22.782665252685547, "vf_loss": 13625684131840.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.088878631591797e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 175, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186672.8622120812, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385083479658587, "mean_inference_ms": 5.255693836426006, "mean_action_processing_ms": 0.14515945716429973, "mean_env_wait_ms": 0.2613913644092167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335559844970703, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.06013607978820801}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186672.8622120812, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1178649.8925229923, -1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385083479658587, "mean_inference_ms": 5.255693836426006, "mean_action_processing_ms": 0.14515945716429973, "mean_env_wait_ms": 0.2613913644092167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335559844970703, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.06013607978820801}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 1980.316, "learn_time_ms": 19.096, "learn_throughput": 17594.875, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 175, "training_iteration": 175, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-38", "timestamp": 1706263838, "time_this_iter_s": 1.9785337448120117, "time_total_s": 345.69630432128906, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 345.69630432128906, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 23.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.23133884574276e+33, "policy_entropy": 309.6221618652344, "var_gnorm": 22.782665252685547, "vf_loss": 11621169627136.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.482269287109375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 176, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186490.1340593342, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384509855391537, "mean_inference_ms": 5.255637600310426, "mean_action_processing_ms": 0.14515618530746927, "mean_env_wait_ms": 0.2613787670840596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320301055908203, "StateBufferConnector_ms": 0.002262115478515625, "ViewRequirementAgentConnector_ms": 0.06013822555541992}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186490.1340593342, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1239764.5028299948, -1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384509855391537, "mean_inference_ms": 5.255637600310426, "mean_action_processing_ms": 0.14515618530746927, "mean_env_wait_ms": 0.2613787670840596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015320301055908203, "StateBufferConnector_ms": 0.002262115478515625, "ViewRequirementAgentConnector_ms": 0.06013822555541992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1980.664, "learn_time_ms": 19.141, "learn_throughput": 17554.001, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "done": false, "episodes_total": 176, "training_iteration": 176, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-40", "timestamp": 1706263840, "time_this_iter_s": 1.9623703956604004, "time_total_s": 347.65867471694946, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1510>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428aa70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 347.65867471694946, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 23.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.868295763812822e+33, "policy_entropy": 308.5104064941406, "var_gnorm": 22.782669067382812, "vf_loss": 12740257120256.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 177, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186281.7503413763, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383934049503895, "mean_inference_ms": 5.255583220091173, "mean_action_processing_ms": 0.14515295751352192, "mean_env_wait_ms": 0.26136623752306165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531076431274414, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.06012082099914551}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1289091.768542336, "episode_reward_mean": -1186281.7503413763, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1289091.768542336, -1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383934049503895, "mean_inference_ms": 5.255583220091173, "mean_action_processing_ms": 0.14515295751352192, "mean_env_wait_ms": 0.26136623752306165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01531076431274414, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.06012082099914551}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59472, "timers": {"training_iteration_time_ms": 1981.166, "learn_time_ms": 19.155, "learn_throughput": 17540.783, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "done": false, "episodes_total": 177, "training_iteration": 177, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-42", "timestamp": 1706263842, "time_this_iter_s": 1.9662902355194092, "time_total_s": 349.6249649524689, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c224d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428add0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 349.6249649524689, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4531108540977136e+34, "policy_entropy": 306.7846374511719, "var_gnorm": 22.782669067382812, "vf_loss": 12175484649472.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.184246063232422e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 178, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1185310.8015129769, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538335610721064, "mean_inference_ms": 5.255529319579977, "mean_action_processing_ms": 0.14514963615834783, "mean_env_wait_ms": 0.26135369755505616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328168869018555, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.06010580062866211}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1185310.8015129769, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1208128.161708443, -1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538335610721064, "mean_inference_ms": 5.255529319579977, "mean_action_processing_ms": 0.14514963615834783, "mean_env_wait_ms": 0.26135369755505616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328168869018555, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.06010580062866211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59808, "timers": {"training_iteration_time_ms": 1982.354, "learn_time_ms": 19.113, "learn_throughput": 17579.27, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "done": false, "episodes_total": 178, "training_iteration": 178, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-44", "timestamp": 1706263844, "time_this_iter_s": 1.9698116779327393, "time_total_s": 351.5947766304016, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc9bd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 351.5947766304016, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 23.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.131273140392749e+33, "policy_entropy": 305.59332275390625, "var_gnorm": 22.782669067382812, "vf_loss": 11060657520640.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.7087669372558594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 179, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1184701.8473826363, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382803710208168, "mean_inference_ms": 5.255482903951082, "mean_action_processing_ms": 0.14514668199775213, "mean_env_wait_ms": 0.2613418688238114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.060088157653808594}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1184701.8473826363, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1155433.7386133817, -1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382803710208168, "mean_inference_ms": 5.255482903951082, "mean_action_processing_ms": 0.14514668199775213, "mean_env_wait_ms": 0.2613418688238114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.0022652149200439453, "ViewRequirementAgentConnector_ms": 0.060088157653808594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60144, "timers": {"training_iteration_time_ms": 1980.945, "learn_time_ms": 19.106, "learn_throughput": 17586.531, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "done": false, "episodes_total": 179, "training_iteration": 179, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-46", "timestamp": 1706263846, "time_this_iter_s": 1.9561176300048828, "time_total_s": 353.5508942604065, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d1690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428b250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 353.5508942604065, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 24.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.076815704845616e+33, "policy_entropy": 308.61602783203125, "var_gnorm": 22.782670974731445, "vf_loss": 11180319965184.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.601478576660156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 180, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1184641.9309432681, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382276724022292, "mean_inference_ms": 5.255441187171088, "mean_action_processing_ms": 0.14514395277927652, "mean_env_wait_ms": 0.261330468146535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015314579010009766, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05996847152709961}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1282604.9888764431, "episode_reward_mean": -1184641.9309432681, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1245993.164477064, -1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382276724022292, "mean_inference_ms": 5.255441187171088, "mean_action_processing_ms": 0.14514395277927652, "mean_env_wait_ms": 0.261330468146535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015314579010009766, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05996847152709961}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60480, "timers": {"training_iteration_time_ms": 1980.834, "learn_time_ms": 19.102, "learn_throughput": 17589.517, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "done": false, "episodes_total": 180, "training_iteration": 180, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-48", "timestamp": 1706263848, "time_this_iter_s": 1.9834635257720947, "time_total_s": 355.5343577861786, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccb340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 355.5343577861786, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 24.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8729616846534604e+35, "policy_entropy": 305.6656799316406, "var_gnorm": 22.782670974731445, "vf_loss": 14257937711104.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.00543212890625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 181, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185012.5196790802, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381743055178718, "mean_inference_ms": 5.255398469586089, "mean_action_processing_ms": 0.1451413766266314, "mean_env_wait_ms": 0.26131939357356787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324592590332031, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.0599672794342041}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185012.5196790802, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1199984.1014634583, -1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381743055178718, "mean_inference_ms": 5.255398469586089, "mean_action_processing_ms": 0.1451413766266314, "mean_env_wait_ms": 0.26131939357356787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015324592590332031, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.0599672794342041}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60816, "timers": {"training_iteration_time_ms": 1979.476, "learn_time_ms": 19.069, "learn_throughput": 17620.085, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "done": false, "episodes_total": 181, "training_iteration": 181, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-50", "timestamp": 1706263850, "time_this_iter_s": 1.9839200973510742, "time_total_s": 357.51827788352966, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c21ff0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942888b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 357.51827788352966, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.550000000000001, "ram_util_percent": 24.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3290260580539475e+34, "policy_entropy": 306.20416259765625, "var_gnorm": 22.782670974731445, "vf_loss": 12621868695552.0}, "grad_gnorm": 0.0, "vf_explained_var": -5.078315734863281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 182, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185137.6806536815, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381219034428995, "mean_inference_ms": 5.255358667112222, "mean_action_processing_ms": 0.14513896262177386, "mean_env_wait_ms": 0.2613085368034655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015319108963012695, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.05990958213806152}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185137.6806536815, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1151122.0285406692, -1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381219034428995, "mean_inference_ms": 5.255358667112222, "mean_action_processing_ms": 0.14513896262177386, "mean_env_wait_ms": 0.2613085368034655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015319108963012695, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.05990958213806152}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61152, "timers": {"training_iteration_time_ms": 1978.653, "learn_time_ms": 19.059, "learn_throughput": 17629.519, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "done": false, "episodes_total": 182, "training_iteration": 182, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-52", "timestamp": 1706263852, "time_this_iter_s": 1.9799964427947998, "time_total_s": 359.49827432632446, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c218d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94273490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 359.49827432632446, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 24.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.624427517147223e+33, "policy_entropy": 307.3600769042969, "var_gnorm": 22.782672882080078, "vf_loss": 12259100196864.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.3272972106933594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 183, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185741.6530077795, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538070279519541, "mean_inference_ms": 5.255321956714335, "mean_action_processing_ms": 0.14513662134980612, "mean_env_wait_ms": 0.26129798511105895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015308141708374023, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05988574028015137}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185741.6530077795, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1240478.1687732649, -1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538070279519541, "mean_inference_ms": 5.255321956714335, "mean_action_processing_ms": 0.14513662134980612, "mean_env_wait_ms": 0.26129798511105895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015308141708374023, "StateBufferConnector_ms": 0.002264738082885742, "ViewRequirementAgentConnector_ms": 0.05988574028015137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61488, "timers": {"training_iteration_time_ms": 1978.485, "learn_time_ms": 19.062, "learn_throughput": 17627.094, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "done": false, "episodes_total": 183, "training_iteration": 183, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-54", "timestamp": 1706263854, "time_this_iter_s": 1.9752964973449707, "time_total_s": 361.47357082366943, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cc91e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942889d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 361.47357082366943, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 24.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.978501065681175e+33, "policy_entropy": 308.4752502441406, "var_gnorm": 22.78267478942871, "vf_loss": 11932127985664.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7670135498046875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 184, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185131.9878552228, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538014657176027, "mean_inference_ms": 5.255275416819472, "mean_action_processing_ms": 0.14513393042446343, "mean_env_wait_ms": 0.26128695674642155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015321493148803711, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.059900760650634766}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1185131.9878552228, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1236029.8645157283, -1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538014657176027, "mean_inference_ms": 5.255275416819472, "mean_action_processing_ms": 0.14513393042446343, "mean_env_wait_ms": 0.26128695674642155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015321493148803711, "StateBufferConnector_ms": 0.0022649765014648438, "ViewRequirementAgentConnector_ms": 0.059900760650634766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1971.54, "learn_time_ms": 18.992, "learn_throughput": 17692.086, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "done": false, "episodes_total": 184, "training_iteration": 184, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-56", "timestamp": 1706263856, "time_this_iter_s": 1.9645090103149414, "time_total_s": 363.4380798339844, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22aa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 363.4380798339844, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 24.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6447859383464223e+33, "policy_entropy": 305.2005615234375, "var_gnorm": 22.78267478942871, "vf_loss": 11582487658496.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.458427429199219e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 185, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1184423.8599614962, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379597069594234, "mean_inference_ms": 5.255230668971566, "mean_action_processing_ms": 0.1451315398753867, "mean_env_wait_ms": 0.26127638097683814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328407287597656, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05988168716430664}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1184423.8599614962, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1204064.8097818447, -1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379597069594234, "mean_inference_ms": 5.255230668971566, "mean_action_processing_ms": 0.1451315398753867, "mean_env_wait_ms": 0.26127638097683814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328407287597656, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05988168716430664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62160, "timers": {"training_iteration_time_ms": 1972.115, "learn_time_ms": 19.019, "learn_throughput": 17666.803, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "done": false, "episodes_total": 185, "training_iteration": 185, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-10-58", "timestamp": 1706263858, "time_this_iter_s": 1.9843215942382812, "time_total_s": 365.42240142822266, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428bac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 365.42240142822266, "timesteps_since_restore": 0, "iterations_since_restore": 185, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 24.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.656837737847835e+33, "policy_entropy": 307.9150390625, "var_gnorm": 22.78267478942871, "vf_loss": 10769087332352.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.029273986816406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 186, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1183455.9376121103, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379059358849756, "mean_inference_ms": 5.2551758230972405, "mean_action_processing_ms": 0.14512935945437028, "mean_env_wait_ms": 0.2612662700167941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322446823120117, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.05987119674682617}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1183455.9376121103, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1184906.785127457, -1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379059358849756, "mean_inference_ms": 5.2551758230972405, "mean_action_processing_ms": 0.14512935945437028, "mean_env_wait_ms": 0.2612662700167941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322446823120117, "StateBufferConnector_ms": 0.002262592315673828, "ViewRequirementAgentConnector_ms": 0.05987119674682617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62496, "timers": {"training_iteration_time_ms": 1974.515, "learn_time_ms": 19.009, "learn_throughput": 17675.622, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "done": false, "episodes_total": 186, "training_iteration": 186, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-00", "timestamp": 1706263860, "time_this_iter_s": 1.9863555431365967, "time_total_s": 367.40875697135925, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f1b9a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428bd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 367.40875697135925, "timesteps_since_restore": 0, "iterations_since_restore": 186, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 24.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.64282364864165e+33, "policy_entropy": 308.33367919921875, "var_gnorm": 22.78267478942871, "vf_loss": 9896415199232.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.494190216064453e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 187, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182506.489305611, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378524599312562, "mean_inference_ms": 5.255121052506912, "mean_action_processing_ms": 0.14512733455588647, "mean_env_wait_ms": 0.26125639345109286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015309333801269531, "StateBufferConnector_ms": 0.002263784408569336, "ViewRequirementAgentConnector_ms": 0.059892892837524414}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182506.489305611, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1172905.7227619588, -1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378524599312562, "mean_inference_ms": 5.255121052506912, "mean_action_processing_ms": 0.14512733455588647, "mean_env_wait_ms": 0.26125639345109286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015309333801269531, "StateBufferConnector_ms": 0.002263784408569336, "ViewRequirementAgentConnector_ms": 0.059892892837524414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62832, "timers": {"training_iteration_time_ms": 1976.469, "learn_time_ms": 19.033, "learn_throughput": 17653.569, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "done": false, "episodes_total": 187, "training_iteration": 187, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-02", "timestamp": 1706263862, "time_this_iter_s": 1.985823392868042, "time_total_s": 369.3945803642273, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c22d40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94288940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.3945803642273, "timesteps_since_restore": 0, "iterations_since_restore": 187, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 24.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.606070126321751e+33, "policy_entropy": 304.47479248046875, "var_gnorm": 22.78267478942871, "vf_loss": 10609403887616.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.291534423828125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 188, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182136.8175015743, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377981631848064, "mean_inference_ms": 5.25506378590205, "mean_action_processing_ms": 0.1451252374378169, "mean_env_wait_ms": 0.26124646857145456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015311241149902344, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05990791320800781}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182136.8175015743, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1193122.030159437, -1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377981631848064, "mean_inference_ms": 5.25506378590205, "mean_action_processing_ms": 0.1451252374378169, "mean_env_wait_ms": 0.26124646857145456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015311241149902344, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05990791320800781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63168, "timers": {"training_iteration_time_ms": 1978.612, "learn_time_ms": 19.051, "learn_throughput": 17636.955, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "done": false, "episodes_total": 188, "training_iteration": 188, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-04", "timestamp": 1706263864, "time_this_iter_s": 1.9912335872650146, "time_total_s": 371.3858139514923, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d25c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 371.3858139514923, "timesteps_since_restore": 0, "iterations_since_restore": 188, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 24.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.334101817845979e+33, "policy_entropy": 308.99090576171875, "var_gnorm": 22.782676696777344, "vf_loss": 10631946174464.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.076957702636719e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 189, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181245.9954725401, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377460467246945, "mean_inference_ms": 5.255009430796999, "mean_action_processing_ms": 0.14512346623814168, "mean_env_wait_ms": 0.2612369216142971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015296220779418945, "StateBufferConnector_ms": 0.0022623538970947266, "ViewRequirementAgentConnector_ms": 0.059906005859375}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181245.9954725401, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1229799.977241156, -1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377460467246945, "mean_inference_ms": 5.255009430796999, "mean_action_processing_ms": 0.14512346623814168, "mean_env_wait_ms": 0.2612369216142971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015296220779418945, "StateBufferConnector_ms": 0.0022623538970947266, "ViewRequirementAgentConnector_ms": 0.059906005859375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63504, "timers": {"training_iteration_time_ms": 1980.555, "learn_time_ms": 19.067, "learn_throughput": 17621.914, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "done": false, "episodes_total": 189, "training_iteration": 189, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-06", "timestamp": 1706263866, "time_this_iter_s": 1.9755520820617676, "time_total_s": 373.3613660335541, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c216f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 373.3613660335541, "timesteps_since_restore": 0, "iterations_since_restore": 189, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 24.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0302164031828567e+33, "policy_entropy": 305.97808837890625, "var_gnorm": 22.782676696777344, "vf_loss": 13599763333120.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.838539123535156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 190, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181448.2407113945, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153769459218274, "mean_inference_ms": 5.254923174207705, "mean_action_processing_ms": 0.14512172944964294, "mean_env_wait_ms": 0.26122751784860826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268564224243164, "StateBufferConnector_ms": 0.002259492874145508, "ViewRequirementAgentConnector_ms": 0.059832096099853516}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181448.2407113945, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1188574.686679589, -1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153769459218274, "mean_inference_ms": 5.254923174207705, "mean_action_processing_ms": 0.14512172944964294, "mean_env_wait_ms": 0.26122751784860826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268564224243164, "StateBufferConnector_ms": 0.002259492874145508, "ViewRequirementAgentConnector_ms": 0.059832096099853516}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63840, "timers": {"training_iteration_time_ms": 1980.426, "learn_time_ms": 19.109, "learn_throughput": 17583.569, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "done": false, "episodes_total": 190, "training_iteration": 190, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-08", "timestamp": 1706263868, "time_this_iter_s": 1.9821584224700928, "time_total_s": 375.34352445602417, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7f19840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f4700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 375.34352445602417, "timesteps_since_restore": 0, "iterations_since_restore": 190, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 24.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.9979102732995935e+34, "policy_entropy": 308.14080810546875, "var_gnorm": 22.782676696777344, "vf_loss": 10991482961920.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.802776336669922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 191, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1180662.5284122317, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376443699877318, "mean_inference_ms": 5.254842859902211, "mean_action_processing_ms": 0.14512002764543686, "mean_env_wait_ms": 0.26121859898051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268564224243164, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.05985689163208008}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1180662.5284122317, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1155667.8473003763, -1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376443699877318, "mean_inference_ms": 5.254842859902211, "mean_action_processing_ms": 0.14512002764543686, "mean_env_wait_ms": 0.26121859898051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268564224243164, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.05985689163208008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64176, "timers": {"training_iteration_time_ms": 1981.291, "learn_time_ms": 19.12, "learn_throughput": 17573.374, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "done": false, "episodes_total": 191, "training_iteration": 191, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-10", "timestamp": 1706263870, "time_this_iter_s": 1.9925563335418701, "time_total_s": 377.33608078956604, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d19c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f5900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 377.33608078956604, "timesteps_since_restore": 0, "iterations_since_restore": 191, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 25.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5564952810320644e+33, "policy_entropy": 307.18267822265625, "var_gnorm": 22.782676696777344, "vf_loss": 12189369892864.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.910064697265625e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 192, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181079.6286170974, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375959310740858, "mean_inference_ms": 5.254766328989118, "mean_action_processing_ms": 0.14511855476805458, "mean_env_wait_ms": 0.261210104749873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.0022602081298828125, "ViewRequirementAgentConnector_ms": 0.05986166000366211}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181079.6286170974, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1204297.1635423284, -1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375959310740858, "mean_inference_ms": 5.254766328989118, "mean_action_processing_ms": 0.14511855476805458, "mean_env_wait_ms": 0.261210104749873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.0022602081298828125, "ViewRequirementAgentConnector_ms": 0.05986166000366211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1982.426, "learn_time_ms": 19.139, "learn_throughput": 17555.816, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 192, "training_iteration": 192, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-12", "timestamp": 1706263872, "time_this_iter_s": 1.9913442134857178, "time_total_s": 379.32742500305176, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccbd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428bd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 379.32742500305176, "timesteps_since_restore": 0, "iterations_since_restore": 192, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 25.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.128863984243728e+34, "policy_entropy": 304.9498291015625, "var_gnorm": 22.782676696777344, "vf_loss": 12172088311808.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.504753112792969e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 193, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1180908.280593392, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375486678735975, "mean_inference_ms": 5.254692003699287, "mean_action_processing_ms": 0.14511707715750544, "mean_env_wait_ms": 0.2612017695202775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241384506225586, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.059861183166503906}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1180908.280593392, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1161817.936142345, -1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375486678735975, "mean_inference_ms": 5.254692003699287, "mean_action_processing_ms": 0.14511707715750544, "mean_env_wait_ms": 0.2612017695202775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241384506225586, "StateBufferConnector_ms": 0.002260923385620117, "ViewRequirementAgentConnector_ms": 0.059861183166503906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64848, "timers": {"training_iteration_time_ms": 1982.937, "learn_time_ms": 19.143, "learn_throughput": 17552.187, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "done": false, "episodes_total": 193, "training_iteration": 193, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-14", "timestamp": 1706263874, "time_this_iter_s": 1.98038649559021, "time_total_s": 381.30781149864197, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f55a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 381.30781149864197, "timesteps_since_restore": 0, "iterations_since_restore": 193, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 25.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.898072101328804e+33, "policy_entropy": 304.28350830078125, "var_gnorm": 22.782676696777344, "vf_loss": 13056409075712.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.528594970703125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 194, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181396.0467608536, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537504297066096, "mean_inference_ms": 5.254623947598832, "mean_action_processing_ms": 0.14511579492571333, "mean_env_wait_ms": 0.26119389535095705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015237092971801758, "StateBufferConnector_ms": 0.0022623538970947266, "ViewRequirementAgentConnector_ms": 0.059847116470336914}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181396.0467608536, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1193980.8774982814, -1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537504297066096, "mean_inference_ms": 5.254623947598832, "mean_action_processing_ms": 0.14511579492571333, "mean_env_wait_ms": 0.26119389535095705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015237092971801758, "StateBufferConnector_ms": 0.0022623538970947266, "ViewRequirementAgentConnector_ms": 0.059847116470336914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65184, "timers": {"training_iteration_time_ms": 1984.005, "learn_time_ms": 19.153, "learn_throughput": 17543.163, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "done": false, "episodes_total": 194, "training_iteration": 194, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-16", "timestamp": 1706263876, "time_this_iter_s": 1.9752297401428223, "time_total_s": 383.2830412387848, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd945d18a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f6050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 383.2830412387848, "timesteps_since_restore": 0, "iterations_since_restore": 194, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 25.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0819971967641157e+33, "policy_entropy": 306.45257568359375, "var_gnorm": 22.782676696777344, "vf_loss": 11725129646080.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.7550926208496094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 195, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181221.452834952, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374605717311335, "mean_inference_ms": 5.2545543887658, "mean_action_processing_ms": 0.1451144949530678, "mean_env_wait_ms": 0.2611859665186585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015235424041748047, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05983090400695801}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181221.452834952, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1181892.5325919339, -1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374605717311335, "mean_inference_ms": 5.2545543887658, "mean_action_processing_ms": 0.1451144949530678, "mean_env_wait_ms": 0.2611859665186585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015235424041748047, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.05983090400695801}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65520, "timers": {"training_iteration_time_ms": 1982.155, "learn_time_ms": 19.129, "learn_throughput": 17564.525, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "done": false, "episodes_total": 195, "training_iteration": 195, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-18", "timestamp": 1706263878, "time_this_iter_s": 1.9657702445983887, "time_total_s": 385.2488114833832, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 385.2488114833832, "timesteps_since_restore": 0, "iterations_since_restore": 195, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 25.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.967785208074545e+33, "policy_entropy": 305.64971923828125, "var_gnorm": 22.782676696777344, "vf_loss": 14355413336064.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.790855407714844e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 196, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182009.9542813106, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374173316143713, "mean_inference_ms": 5.254485291732598, "mean_action_processing_ms": 0.1451132509594842, "mean_env_wait_ms": 0.2611782470869111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015230178833007812, "StateBufferConnector_ms": 0.0022628307342529297, "ViewRequirementAgentConnector_ms": 0.05982685089111328}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1182009.9542813106, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1257270.2470568202, -1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374173316143713, "mean_inference_ms": 5.254485291732598, "mean_action_processing_ms": 0.1451132509594842, "mean_env_wait_ms": 0.2611782470869111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015230178833007812, "StateBufferConnector_ms": 0.0022628307342529297, "ViewRequirementAgentConnector_ms": 0.05982685089111328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65856, "timers": {"training_iteration_time_ms": 1980.029, "learn_time_ms": 19.118, "learn_throughput": 17574.666, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "done": false, "episodes_total": 196, "training_iteration": 196, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-20", "timestamp": 1706263880, "time_this_iter_s": 1.9650814533233643, "time_total_s": 387.21389293670654, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca7a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f5ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 387.21389293670654, "timesteps_since_restore": 0, "iterations_since_restore": 196, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 25.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9716434249665738e+33, "policy_entropy": 305.3583984375, "var_gnorm": 22.782676696777344, "vf_loss": 11511828316160.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.506111145019531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 197, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181212.4140907107, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373734813949538, "mean_inference_ms": 5.2544175161632145, "mean_action_processing_ms": 0.14511185850152705, "mean_env_wait_ms": 0.2611703579045799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015208005905151367, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.059827566146850586}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181212.4140907107, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1191549.6384599502, -1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373734813949538, "mean_inference_ms": 5.2544175161632145, "mean_action_processing_ms": 0.14511185850152705, "mean_env_wait_ms": 0.2611703579045799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015208005905151367, "StateBufferConnector_ms": 0.002261638641357422, "ViewRequirementAgentConnector_ms": 0.059827566146850586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66192, "timers": {"training_iteration_time_ms": 1978.214, "learn_time_ms": 19.109, "learn_throughput": 17583.745, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "done": false, "episodes_total": 197, "training_iteration": 197, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-22", "timestamp": 1706263882, "time_this_iter_s": 1.9676880836486816, "time_total_s": 389.1815810203552, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94cca5f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd94289240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 389.1815810203552, "timesteps_since_restore": 0, "iterations_since_restore": 197, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 25.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9094572711576287e+34, "policy_entropy": 305.6024475097656, "var_gnorm": 22.782676696777344, "vf_loss": 13514752131072.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.3511390686035156e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 198, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181671.2666681616, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373266663904642, "mean_inference_ms": 5.254343237034592, "mean_action_processing_ms": 0.1451100806352076, "mean_env_wait_ms": 0.26116212440525804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188932418823242, "StateBufferConnector_ms": 0.0022614002227783203, "ViewRequirementAgentConnector_ms": 0.059805870056152344}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181671.2666681616, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1191078.2604390995, -1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373266663904642, "mean_inference_ms": 5.254343237034592, "mean_action_processing_ms": 0.1451100806352076, "mean_env_wait_ms": 0.26116212440525804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188932418823242, "StateBufferConnector_ms": 0.0022614002227783203, "ViewRequirementAgentConnector_ms": 0.059805870056152344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66528, "timers": {"training_iteration_time_ms": 1975.155, "learn_time_ms": 19.151, "learn_throughput": 17544.473, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "done": false, "episodes_total": 198, "training_iteration": 198, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-24", "timestamp": 1706263884, "time_this_iter_s": 1.9606285095214844, "time_total_s": 391.1422095298767, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c20070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 391.1422095298767, "timesteps_since_restore": 0, "iterations_since_restore": 198, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 25.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0866312705586756e+33, "policy_entropy": 306.8118896484375, "var_gnorm": 22.782676696777344, "vf_loss": 11646960402432.0}, "grad_gnorm": 0.0, "vf_explained_var": -3.743171691894531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 199, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181313.2856689093, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232, -1155280.160513856], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372782871047724, "mean_inference_ms": 5.25426671047483, "mean_action_processing_ms": 0.14510814942101424, "mean_env_wait_ms": 0.2611537823452888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174627304077148, "StateBufferConnector_ms": 0.0022597312927246094, "ViewRequirementAgentConnector_ms": 0.05979585647583008}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181313.2856689093, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1167652.8809321362, -1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232, -1155280.160513856], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372782871047724, "mean_inference_ms": 5.25426671047483, "mean_action_processing_ms": 0.14510814942101424, "mean_env_wait_ms": 0.2611537823452888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174627304077148, "StateBufferConnector_ms": 0.0022597312927246094, "ViewRequirementAgentConnector_ms": 0.05979585647583008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66864, "timers": {"training_iteration_time_ms": 1973.587, "learn_time_ms": 19.193, "learn_throughput": 17506.769, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "done": false, "episodes_total": 199, "training_iteration": 199, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-26", "timestamp": 1706263886, "time_this_iter_s": 1.9598722457885742, "time_total_s": 393.1020817756653, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efee7c23a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd9428a7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 393.1020817756653, "timesteps_since_restore": 0, "iterations_since_restore": 199, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 25.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6965057114537223e+34, "policy_entropy": 303.04302978515625, "var_gnorm": 22.782678604125977, "vf_loss": 12671978045440.0}, "grad_gnorm": 0.0, "vf_explained_var": -4.506111145019531e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 200, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181731.3903588336, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232, -1155280.160513856, -1209463.3499246], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372311965246083, "mean_inference_ms": 5.254195142230324, "mean_action_processing_ms": 0.1451063171400273, "mean_env_wait_ms": 0.26114580680739696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015175819396972656, "StateBufferConnector_ms": 0.002259492874145508, "ViewRequirementAgentConnector_ms": 0.05976676940917969}}, "episode_reward_max": -1063984.0476234131, "episode_reward_min": -1283052.0380582747, "episode_reward_mean": -1181731.3903588336, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1262660.1572913085, -1200492.0596705338, -1282604.9888764431, -1199691.2486093363, -1191367.2504268363, -1112728.0041810006, -1226241.7661994635, -1257477.9008139714, -1135095.451379149, -1184209.5578898739, -1198779.115635488, -1176647.8992500596, -1169137.9533552744, -1206662.651459021, -1237155.5077697176, -1227615.5008226936, -1119515.21410144, -1212462.7723156742, -1174959.7702086312, -1132933.20613424, -1160908.4992665688, -1175063.3194348696, -1199614.1281065196, -1159907.7343986558, -1160299.582089863, -1225103.3375409069, -1233544.269219531, -1214690.146262033, -1213719.5008747447, -1168542.80244976, -1218260.6221737764, -1249498.315348712, -1235854.969627761, -1100763.3137023128, -1150533.4334449037, -1218199.969555479, -1175478.2331441166, -1138811.659686263, -1187363.0891217217, -1113510.6773021712, -1173499.6300663496, -1162005.8046117364, -1190769.5981632797, -1171950.803730862, -1245861.2407685027, -1159775.7119542537, -1170823.4521615554, -1251581.1326661939, -1151461.1458772728, -1145449.4590347433, -1256264.1194884554, -1156042.550689079, -1178416.0318458003, -1172798.6268049693, -1260350.1822961443, -1168311.7811960268, -1133317.3290658016, -1217041.794168742, -1122636.5379701788, -1253742.982816983, -1157429.0422135054, -1155672.80195202, -1212187.0976689013, -1114628.6871739111, -1153934.1407147378, -1196067.5183554094, -1201009.6669989543, -1169406.003545983, -1144064.3106691653, -1162054.3868562733, -1091336.73872396, -1120671.54509397, -1127300.0480841317, -1063984.0476234131, -1224077.903313993, -1160377.0772482888, -1218926.1310341777, -1191996.8857024028, -1147232.748674392, -1149442.0946765475, -1283052.0380582747, -1212500.1989236027, -1211519.2639504673, -1179511.6535175794, -1165217.0751431128, -1107272.5748432283, -1089961.954477529, -1135938.5423582755, -1104039.8272560425, -1250024.5011265737, -1110003.4567633295, -1197377.8677869265, -1187162.3611717774, -1210594.5528885191, -1176521.484908118, -1260742.6772277919, -1177516.2279968495, -1237434.8962050232, -1155280.160513856, -1209463.3499246], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372311965246083, "mean_inference_ms": 5.254195142230324, "mean_action_processing_ms": 0.1451063171400273, "mean_env_wait_ms": 0.26114580680739696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015175819396972656, "StateBufferConnector_ms": 0.002259492874145508, "ViewRequirementAgentConnector_ms": 0.05976676940917969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 67200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 1973.194, "learn_time_ms": 19.172, "learn_throughput": 17525.252, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": true, "episodes_total": 200, "training_iteration": 200, "trial_id": "52f48_00000", "experiment_id": "7f78955ebadf4f82b1eb736ecfddff32", "date": "2024-01-26_10-11-28", "timestamp": 1706263888, "time_this_iter_s": 1.9782288074493408, "time_total_s": 395.0803105831146, "pid": 39118, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7efd94ccacb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7efd942f6170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 395.0803105831146, "timesteps_since_restore": 0, "iterations_since_restore": 200, "warmup_time": 3.09731388092041, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 25.833333333333332}}
