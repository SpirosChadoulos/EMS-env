{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -498514208.0, "policy_entropy": 4227.8818359375, "var_gnorm": 22.627458572387695, "vf_loss": 2750551687168.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": 0.0, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -559125.1054484426, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -559125.1054484426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15781399757996512, "mean_inference_ms": 5.262769648158585, "mean_action_processing_ms": 0.14752025774041694, "mean_env_wait_ms": 0.26659441984725635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559257507324219, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06148815155029296}}, "episode_reward_max": -559125.1054484426, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -559125.1054484426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426], "episode_lengths": [336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15781399757996512, "mean_inference_ms": 5.262769648158585, "mean_action_processing_ms": 0.14752025774041694, "mean_env_wait_ms": 0.26659441984725635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559257507324219, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.06148815155029296}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2032.953, "learn_time_ms": 63.082, "learn_throughput": 5326.422, "synch_weights_time_ms": 0.204}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-34", "timestamp": 1711724254, "time_this_iter_s": 2.0331923961639404, "time_total_s": 2.0331923961639404, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7313ae79ae60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7313ae7aa4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.0331923961639404, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 9.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -494656736.0, "policy_entropy": 5404.16064453125, "var_gnorm": 22.62818145751953, "vf_loss": 1683435814912.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.4836273193359375e-06, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -439268.71239131974, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -499196.9089198812, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15771638410383568, "mean_inference_ms": 5.260483354943583, "mean_action_processing_ms": 0.14745166276802782, "mean_env_wait_ms": 0.2652560481271377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723705291748047, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.06079673767089844}}, "episode_reward_max": -439268.71239131974, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -499196.9089198812, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974], "episode_lengths": [336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15771638410383568, "mean_inference_ms": 5.260483354943583, "mean_action_processing_ms": 0.14745166276802782, "mean_env_wait_ms": 0.2652560481271377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015723705291748047, "StateBufferConnector_ms": 0.002753734588623047, "ViewRequirementAgentConnector_ms": 0.06079673767089844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 2005.145, "learn_time_ms": 41.021, "learn_throughput": 8190.929, "synch_weights_time_ms": 0.173}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-36", "timestamp": 1711724256, "time_this_iter_s": 1.9775850772857666, "time_total_s": 4.010777473449707, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d0da80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7313ae8ba3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 4.010777473449707, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 10.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -342102176.0, "policy_entropy": 5855.2119140625, "var_gnorm": 22.63177490234375, "vf_loss": 670499340288.0}, "grad_gnorm": 40.0, "vf_explained_var": -1.8715858459472656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -275573.90661837894, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -424655.90815271373, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1574430687590034, "mean_inference_ms": 5.257189525874479, "mean_action_processing_ms": 0.14727450580382395, "mean_env_wait_ms": 0.26451420291201855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015091896057128906, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.05985895792643229}}, "episode_reward_max": -275573.90661837894, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -424655.90815271373, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894], "episode_lengths": [336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1574430687590034, "mean_inference_ms": 5.257189525874479, "mean_action_processing_ms": 0.14727450580382395, "mean_env_wait_ms": 0.26451420291201855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015091896057128906, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.05985895792643229}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 1993.42, "learn_time_ms": 33.629, "learn_throughput": 9991.512, "synch_weights_time_ms": 0.164}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-38", "timestamp": 1711724258, "time_this_iter_s": 1.9702012538909912, "time_total_s": 5.980978727340698, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d0e8c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518d260e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 5.980978727340698, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -314169440.0, "policy_entropy": 5853.26171875, "var_gnorm": 22.635637283325195, "vf_loss": 565386870784.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -3.5643577575683594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -385235.9844672183, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15676531718699185, "mean_inference_ms": 5.25010886314338, "mean_action_processing_ms": 0.14683492063464254, "mean_env_wait_ms": 0.2634274814031088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014644861221313477, "StateBufferConnector_ms": 0.0025331974029541016, "ViewRequirementAgentConnector_ms": 0.05880594253540039}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -385235.9844672183, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319], "episode_lengths": [336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15676531718699185, "mean_inference_ms": 5.25010886314338, "mean_action_processing_ms": 0.14683492063464254, "mean_env_wait_ms": 0.2634274814031088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014644861221313477, "StateBufferConnector_ms": 0.0025331974029541016, "ViewRequirementAgentConnector_ms": 0.05880594253540039}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 1979.867, "learn_time_ms": 30.101, "learn_throughput": 11162.552, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-40", "timestamp": 1711724260, "time_this_iter_s": 1.939446210861206, "time_total_s": 7.920424938201904, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d0f8e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518d271c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 7.920424938201904, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 10.266666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -352113888.0, "policy_entropy": 5771.43994140625, "var_gnorm": 22.63760757446289, "vf_loss": 718114914304.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -3.5762786865234375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -366171.6045284521, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15622730904759027, "mean_inference_ms": 5.24561332044572, "mean_action_processing_ms": 0.14650425588409957, "mean_env_wait_ms": 0.2626763595578846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014772415161132812, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.05905628204345703}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -366171.6045284521, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873], "episode_lengths": [336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15622730904759027, "mean_inference_ms": 5.24561332044572, "mean_action_processing_ms": 0.14650425588409957, "mean_env_wait_ms": 0.2626763595578846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014772415161132812, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.05905628204345703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1976.412, "learn_time_ms": 27.861, "learn_throughput": 12059.755, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 5, "training_iteration": 5, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-42", "timestamp": 1711724262, "time_this_iter_s": 1.9628643989562988, "time_total_s": 9.883289337158203, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d88310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518d27400>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.883289337158203, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 10.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -342666112.0, "policy_entropy": 5662.8125, "var_gnorm": 22.639141082763672, "vf_loss": 669070852096.0}, "grad_gnorm": 40.0, "vf_explained_var": -4.780292510986328e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -351279.599933251, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1558240905395025, "mean_inference_ms": 5.242965327458971, "mean_action_processing_ms": 0.14627444672334566, "mean_env_wait_ms": 0.2620270094024124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014583269755045572, "StateBufferConnector_ms": 0.0024358431498209634, "ViewRequirementAgentConnector_ms": 0.05882581075032552}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -351279.599933251, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456], "episode_lengths": [336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1558240905395025, "mean_inference_ms": 5.242965327458971, "mean_action_processing_ms": 0.14627444672334566, "mean_env_wait_ms": 0.2620270094024124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014583269755045572, "StateBufferConnector_ms": 0.0024358431498209634, "ViewRequirementAgentConnector_ms": 0.05882581075032552}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1974.975, "learn_time_ms": 26.348, "learn_throughput": 12752.528, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-44", "timestamp": 1711724264, "time_this_iter_s": 1.968048095703125, "time_total_s": 11.851337432861328, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d88e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518d279a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.851337432861328, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 10.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -385113536.0, "policy_entropy": 5539.28759765625, "var_gnorm": 22.640642166137695, "vf_loss": 925492838400.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -3.635883331298828e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -347406.3431899624, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15551654352043442, "mean_inference_ms": 5.241661395729058, "mean_action_processing_ms": 0.14609676001318125, "mean_env_wait_ms": 0.2615316404596909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014812605721609933, "StateBufferConnector_ms": 0.002418245588030134, "ViewRequirementAgentConnector_ms": 0.05882467542375837}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -347406.3431899624, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311], "episode_lengths": [336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15551654352043442, "mean_inference_ms": 5.241661395729058, "mean_action_processing_ms": 0.14609676001318125, "mean_env_wait_ms": 0.2615316404596909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014812605721609933, "StateBufferConnector_ms": 0.002418245588030134, "ViewRequirementAgentConnector_ms": 0.05882467542375837}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1975.016, "learn_time_ms": 25.304, "learn_throughput": 13278.742, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-46", "timestamp": 1711724266, "time_this_iter_s": 1.9755134582519531, "time_total_s": 13.826850891113281, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d89330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dac0d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.826850891113281, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -393652288.0, "policy_entropy": 5413.5634765625, "var_gnorm": 22.642444610595703, "vf_loss": 829540204544.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -4.3392181396484375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -344613.22418531124, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15526985960991185, "mean_inference_ms": 5.2410645697695415, "mean_action_processing_ms": 0.1459593535654058, "mean_env_wait_ms": 0.2610865309697732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088915824890137, "StateBufferConnector_ms": 0.00241696834564209, "ViewRequirementAgentConnector_ms": 0.05889236927032471}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -344613.22418531124, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15526985960991185, "mean_inference_ms": 5.2410645697695415, "mean_action_processing_ms": 0.1459593535654058, "mean_env_wait_ms": 0.2610865309697732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088915824890137, "StateBufferConnector_ms": 0.00241696834564209, "ViewRequirementAgentConnector_ms": 0.05889236927032471}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1974.928, "learn_time_ms": 24.545, "learn_throughput": 13688.952, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-48", "timestamp": 1711724268, "time_this_iter_s": 1.9745664596557617, "time_total_s": 15.801417350769043, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d89b40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dac4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.801417350769043, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3662085120.0, "policy_entropy": 5313.439453125, "var_gnorm": 22.64415740966797, "vf_loss": 866319990784.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -4.482269287109375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -341584.2149338276, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550554693801717, "mean_inference_ms": 5.240262811481, "mean_action_processing_ms": 0.14584352330419278, "mean_env_wait_ms": 0.2607082160695917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014940897623697916, "StateBufferConnector_ms": 0.0024239222208658853, "ViewRequirementAgentConnector_ms": 0.05881256527370877}}, "episode_reward_max": -266976.2134107319, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -341584.2149338276, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1550554693801717, "mean_inference_ms": 5.240262811481, "mean_action_processing_ms": 0.14584352330419278, "mean_env_wait_ms": 0.2607082160695917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014940897623697916, "StateBufferConnector_ms": 0.0024239222208658853, "ViewRequirementAgentConnector_ms": 0.05881256527370877}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1973.072, "learn_time_ms": 23.998, "learn_throughput": 14001.339, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-50", "timestamp": 1711724270, "time_this_iter_s": 1.9584870338439941, "time_total_s": 17.759904384613037, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d8a080>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dac9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.759904384613037, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 10.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3517999872.0, "policy_entropy": 5236.658203125, "var_gnorm": 22.64527702331543, "vf_loss": 581442076672.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -5.9723854064941406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -332685.2529263477, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487246949897066, "mean_inference_ms": 5.239748597960289, "mean_action_processing_ms": 0.1457554391102585, "mean_env_wait_ms": 0.26037646413712356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01477956771850586, "StateBufferConnector_ms": 0.0023937225341796875, "ViewRequirementAgentConnector_ms": 0.05861997604370117}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -332685.2529263477, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15487246949897066, "mean_inference_ms": 5.239748597960289, "mean_action_processing_ms": 0.1457554391102585, "mean_env_wait_ms": 0.26037646413712356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01477956771850586, "StateBufferConnector_ms": 0.0023937225341796875, "ViewRequirementAgentConnector_ms": 0.05861997604370117}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1972.762, "learn_time_ms": 23.455, "learn_throughput": 14325.129, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-52", "timestamp": 1711724272, "time_this_iter_s": 1.970240592956543, "time_total_s": 19.73014497756958, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d8be50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dadc60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.73014497756958, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2608525568.0, "policy_entropy": 5159.578125, "var_gnorm": 22.64684295654297, "vf_loss": 819899006976.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -6.330013275146484e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -330742.25112752285, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15473862712862846, "mean_inference_ms": 5.23966038673766, "mean_action_processing_ms": 0.14569337259371087, "mean_env_wait_ms": 0.260102086824943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015456026250665838, "StateBufferConnector_ms": 0.002384185791015625, "ViewRequirementAgentConnector_ms": 0.058607621626420456}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -330742.25112752285, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15473862712862846, "mean_inference_ms": 5.23966038673766, "mean_action_processing_ms": 0.14569337259371087, "mean_env_wait_ms": 0.260102086824943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015456026250665838, "StateBufferConnector_ms": 0.002384185791015625, "ViewRequirementAgentConnector_ms": 0.058607621626420456}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1967.702, "learn_time_ms": 19.066, "learn_throughput": 17623.324, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-54", "timestamp": 1711724274, "time_this_iter_s": 1.9826245307922363, "time_total_s": 21.712769508361816, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d89fc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dad510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.712769508361816, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 10.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -10565485568.0, "policy_entropy": 5077.97412109375, "var_gnorm": 22.648937225341797, "vf_loss": 951687970816.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.14984130859375e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -331112.1310680606, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15462775796350076, "mean_inference_ms": 5.239782063587286, "mean_action_processing_ms": 0.14564865114093348, "mean_env_wait_ms": 0.2598757519873656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015459458033243815, "StateBufferConnector_ms": 0.00237425168355306, "ViewRequirementAgentConnector_ms": 0.05880594253540039}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -331112.1310680606, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15462775796350076, "mean_inference_ms": 5.239782063587286, "mean_action_processing_ms": 0.14564865114093348, "mean_env_wait_ms": 0.2598757519873656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015459458033243815, "StateBufferConnector_ms": 0.00237425168355306, "ViewRequirementAgentConnector_ms": 0.05880594253540039}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1967.883, "learn_time_ms": 19.09, "learn_throughput": 17600.39, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-56", "timestamp": 1711724276, "time_this_iter_s": 1.9793992042541504, "time_total_s": 23.692168712615967, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c28a30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dae5f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.692168712615967, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 11.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -15103135744.0, "policy_entropy": 5017.18701171875, "var_gnorm": 22.65038299560547, "vf_loss": 875061248000.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.888938903808594e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -330249.5793357693, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545497834398128, "mean_inference_ms": 5.239751388173681, "mean_action_processing_ms": 0.14561341104721717, "mean_env_wait_ms": 0.2596763981243645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015627420865572415, "StateBufferConnector_ms": 0.0023750158456655648, "ViewRequirementAgentConnector_ms": 0.05897375253530649}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -330249.5793357693, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1545497834398128, "mean_inference_ms": 5.239751388173681, "mean_action_processing_ms": 0.14561341104721717, "mean_env_wait_ms": 0.2596763981243645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015627420865572415, "StateBufferConnector_ms": 0.0023750158456655648, "ViewRequirementAgentConnector_ms": 0.05897375253530649}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1967.161, "learn_time_ms": 19.096, "learn_throughput": 17595.358, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-57-58", "timestamp": 1711724278, "time_this_iter_s": 1.963038682937622, "time_total_s": 25.65520739555359, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d8a7d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dad5a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.65520739555359, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 11.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -23263784960.0, "policy_entropy": 4952.1416015625, "var_gnorm": 22.6524715423584, "vf_loss": 780270698496.0}, "grad_gnorm": 40.0, "vf_explained_var": -5.841255187988281e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -328553.3474125058, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15447942919801538, "mean_inference_ms": 5.239749142177218, "mean_action_processing_ms": 0.14558167418307086, "mean_env_wait_ms": 0.259484620622424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601090022495814, "StateBufferConnector_ms": 0.002368858882359096, "ViewRequirementAgentConnector_ms": 0.05892174584524972}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -328553.3474125058, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15447942919801538, "mean_inference_ms": 5.239749142177218, "mean_action_processing_ms": 0.14558167418307086, "mean_env_wait_ms": 0.259484620622424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015601090022495814, "StateBufferConnector_ms": 0.002368858882359096, "ViewRequirementAgentConnector_ms": 0.05892174584524972}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1970.162, "learn_time_ms": 19.048, "learn_throughput": 17639.383, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-00", "timestamp": 1711724280, "time_this_iter_s": 1.9695117473602295, "time_total_s": 27.62471914291382, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c29b70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518daf1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.62471914291382, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 11.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -515702915072.0, "policy_entropy": 4888.01513671875, "var_gnorm": 22.655067443847656, "vf_loss": 1082985873408.0}, "grad_gnorm": 39.99999237060547, "vf_explained_var": -5.4001808166503906e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -329756.26422948117, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441670942456473, "mean_inference_ms": 5.239769346784538, "mean_action_processing_ms": 0.14555226510236854, "mean_env_wait_ms": 0.2593017918543457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452702840169271, "StateBufferConnector_ms": 0.002361933390299479, "ViewRequirementAgentConnector_ms": 0.05881627400716146}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -329756.26422948117, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15441670942456473, "mean_inference_ms": 5.239769346784538, "mean_action_processing_ms": 0.14555226510236854, "mean_env_wait_ms": 0.2593017918543457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015452702840169271, "StateBufferConnector_ms": 0.002361933390299479, "ViewRequirementAgentConnector_ms": 0.05881627400716146}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1970.83, "learn_time_ms": 19.047, "learn_throughput": 17640.708, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-02", "timestamp": 1711724282, "time_this_iter_s": 1.9695219993591309, "time_total_s": 29.59424114227295, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c2a1a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dad990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.59424114227295, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 11.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2968813043712.0, "policy_entropy": 4816.03466796875, "var_gnorm": 22.65822982788086, "vf_loss": 790074097664.0}, "grad_gnorm": 40.0, "vf_explained_var": -6.270408630371094e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -327522.91178435803, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15436125910678228, "mean_inference_ms": 5.23979403998899, "mean_action_processing_ms": 0.14552460736819955, "mean_env_wait_ms": 0.25912404943866585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388429164886475, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.05880296230316162}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -327522.91178435803, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15436125910678228, "mean_inference_ms": 5.23979403998899, "mean_action_processing_ms": 0.14552460736819955, "mean_env_wait_ms": 0.25912404943866585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015388429164886475, "StateBufferConnector_ms": 0.0023603439331054688, "ViewRequirementAgentConnector_ms": 0.05880296230316162}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1970.861, "learn_time_ms": 19.056, "learn_throughput": 17631.791, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-04", "timestamp": 1711724284, "time_this_iter_s": 1.9683806896209717, "time_total_s": 31.56262183189392, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c2b160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dafc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.56262183189392, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.2, "ram_util_percent": 11.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -566388812939264.0, "policy_entropy": 4745.44970703125, "var_gnorm": 22.661928176879883, "vf_loss": 991355994112.0}, "grad_gnorm": 0.0, "vf_explained_var": -6.854534149169922e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -328290.9784525921, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15431262938624726, "mean_inference_ms": 5.2398410342948445, "mean_action_processing_ms": 0.14549906406653496, "mean_env_wait_ms": 0.2589583765074218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015403242672190946, "StateBufferConnector_ms": 0.0023575390086454503, "ViewRequirementAgentConnector_ms": 0.05890621858484605}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -328290.9784525921, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15431262938624726, "mean_inference_ms": 5.2398410342948445, "mean_action_processing_ms": 0.14549906406653496, "mean_env_wait_ms": 0.2589583765074218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015403242672190946, "StateBufferConnector_ms": 0.0023575390086454503, "ViewRequirementAgentConnector_ms": 0.05890621858484605}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1970.413, "learn_time_ms": 19.06, "learn_throughput": 17628.13, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-06", "timestamp": 1711724286, "time_this_iter_s": 1.9710791110992432, "time_total_s": 33.533700942993164, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d8a710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518dadd80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.533700942993164, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 11.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4075207778107392.0, "policy_entropy": 4677.13818359375, "var_gnorm": 22.665483474731445, "vf_loss": 935904280576.0}, "grad_gnorm": 0.0, "vf_explained_var": -8.916854858398438e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -327702.4494644487, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427283615135176, "mean_inference_ms": 5.239954447278631, "mean_action_processing_ms": 0.14548156195821807, "mean_env_wait_ms": 0.25881536021100604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400515662299262, "StateBufferConnector_ms": 0.0023550457424587673, "ViewRequirementAgentConnector_ms": 0.05895164277818468}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -327702.4494644487, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427283615135176, "mean_inference_ms": 5.239954447278631, "mean_action_processing_ms": 0.14548156195821807, "mean_env_wait_ms": 0.25881536021100604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015400515662299262, "StateBufferConnector_ms": 0.0023550457424587673, "ViewRequirementAgentConnector_ms": 0.05895164277818468}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1970.829, "learn_time_ms": 19.036, "learn_throughput": 17650.871, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-08", "timestamp": 1711724288, "time_this_iter_s": 1.9787547588348389, "time_total_s": 35.512455701828, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c29f60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c54550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.512455701828, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 11.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7981221225168896.0, "policy_entropy": 4610.4296875, "var_gnorm": 22.66887855529785, "vf_loss": 764166930432.0}, "grad_gnorm": 0.0, "vf_explained_var": -8.106231689453125e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325972.866139341, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542439132362051, "mean_inference_ms": 5.240175735018573, "mean_action_processing_ms": 0.14546627590293368, "mean_env_wait_ms": 0.2586891757914181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015691707008763364, "StateBufferConnector_ms": 0.002350305256090666, "ViewRequirementAgentConnector_ms": 0.05899103064286081}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325972.866139341, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542439132362051, "mean_inference_ms": 5.240175735018573, "mean_action_processing_ms": 0.14546627590293368, "mean_env_wait_ms": 0.2586891757914181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015691707008763364, "StateBufferConnector_ms": 0.002350305256090666, "ViewRequirementAgentConnector_ms": 0.05899103064286081}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1973.536, "learn_time_ms": 18.96, "learn_throughput": 17721.408, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-10", "timestamp": 1711724290, "time_this_iter_s": 1.9855706691741943, "time_total_s": 37.4980263710022, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d898d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518daf5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.4980263710022, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 11.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2010745319325696e+17, "policy_entropy": 4544.763671875, "var_gnorm": 22.672103881835938, "vf_loss": 1040944594944.0}, "grad_gnorm": 0.0, "vf_explained_var": -7.176399230957031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -326171.2392229907, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421889872450462, "mean_inference_ms": 5.2403393910513625, "mean_action_processing_ms": 0.14545257548884913, "mean_env_wait_ms": 0.2585674878816781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015614032745361328, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.05897164344787598}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -326171.2392229907, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421889872450462, "mean_inference_ms": 5.2403393910513625, "mean_action_processing_ms": 0.14545257548884913, "mean_env_wait_ms": 0.2585674878816781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015614032745361328, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.05897164344787598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1973.009, "learn_time_ms": 18.985, "learn_throughput": 17698.308, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-12", "timestamp": 1711724292, "time_this_iter_s": 1.9649829864501953, "time_total_s": 39.46300935745239, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5d060>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c54d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.46300935745239, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 11.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0767305027627254e+18, "policy_entropy": 4484.46630859375, "var_gnorm": 22.67514991760254, "vf_loss": 808935358464.0}, "grad_gnorm": 0.0, "vf_explained_var": -8.797645568847656e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325250.90033603064, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154195012077154, "mean_inference_ms": 5.2405078686498054, "mean_action_processing_ms": 0.14544057330533308, "mean_env_wait_ms": 0.25845563698222823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015553973969959077, "StateBufferConnector_ms": 0.0023433140345982145, "ViewRequirementAgentConnector_ms": 0.05898816244942801}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325250.90033603064, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154195012077154, "mean_inference_ms": 5.2405078686498054, "mean_action_processing_ms": 0.14544057330533308, "mean_env_wait_ms": 0.25845563698222823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015553973969959077, "StateBufferConnector_ms": 0.0023433140345982145, "ViewRequirementAgentConnector_ms": 0.05898816244942801}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1972.058, "learn_time_ms": 18.953, "learn_throughput": 17727.739, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-14", "timestamp": 1711724294, "time_this_iter_s": 1.9731416702270508, "time_total_s": 41.43615102767944, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c2b340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518daeef0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.43615102767944, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 11.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.3530355157753555e+20, "policy_entropy": 4424.36962890625, "var_gnorm": 22.678016662597656, "vf_loss": 807703543808.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.465217590332031e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324221.23713071935, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417083921219443, "mean_inference_ms": 5.2406079349809085, "mean_action_processing_ms": 0.14542462094940298, "mean_env_wait_ms": 0.2583472034831181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015482035550204191, "StateBufferConnector_ms": 0.0023375857960094104, "ViewRequirementAgentConnector_ms": 0.05903460762717507}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324221.23713071935, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417083921219443, "mean_inference_ms": 5.2406079349809085, "mean_action_processing_ms": 0.14542462094940298, "mean_env_wait_ms": 0.2583472034831181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015482035550204191, "StateBufferConnector_ms": 0.0023375857960094104, "ViewRequirementAgentConnector_ms": 0.05903460762717507}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1970.06, "learn_time_ms": 18.905, "learn_throughput": 17773.102, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-16", "timestamp": 1711724296, "time_this_iter_s": 1.9594476222991943, "time_total_s": 43.39559864997864, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5dcf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c556c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.39559864997864, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.266666666666666, "ram_util_percent": 11.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2703507538282073e+21, "policy_entropy": 4369.5126953125, "var_gnorm": 22.680706024169922, "vf_loss": 906087628800.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.715557098388672e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324401.00541861006, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541458520190006, "mean_inference_ms": 5.240594233255415, "mean_action_processing_ms": 0.14540649652508061, "mean_env_wait_ms": 0.2582398473610715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015410133030103601, "StateBufferConnector_ms": 0.0023333922676418138, "ViewRequirementAgentConnector_ms": 0.05900134211001189}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324401.00541861006, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541458520190006, "mean_inference_ms": 5.240594233255415, "mean_action_processing_ms": 0.14540649652508061, "mean_env_wait_ms": 0.2582398473610715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015410133030103601, "StateBufferConnector_ms": 0.0023333922676418138, "ViewRequirementAgentConnector_ms": 0.05900134211001189}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1968.614, "learn_time_ms": 18.886, "learn_throughput": 17791.344, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-18", "timestamp": 1711724298, "time_this_iter_s": 1.9485962390899658, "time_total_s": 45.3441948890686, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518d8a530>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c55990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.3441948890686, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 11.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.763404770212638e+21, "policy_entropy": 4318.72900390625, "var_gnorm": 22.683216094970703, "vf_loss": 693420163072.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011467933654785156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322627.08671304036, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412374415702965, "mean_inference_ms": 5.240580203823014, "mean_action_processing_ms": 0.14538975261065248, "mean_env_wait_ms": 0.2581372762966099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538097858428955, "StateBufferConnector_ms": 0.002327561378479004, "ViewRequirementAgentConnector_ms": 0.058974822362264}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322627.08671304036, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15412374415702965, "mean_inference_ms": 5.240580203823014, "mean_action_processing_ms": 0.14538975261065248, "mean_env_wait_ms": 0.2581372762966099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01538097858428955, "StateBufferConnector_ms": 0.002327561378479004, "ViewRequirementAgentConnector_ms": 0.058974822362264}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1968.519, "learn_time_ms": 18.9, "learn_throughput": 17778.057, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-20", "timestamp": 1711724300, "time_this_iter_s": 1.968562364578247, "time_total_s": 47.31275725364685, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5d420>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c56050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.31275725364685, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 12.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4117035183351272e+22, "policy_entropy": 4268.90478515625, "var_gnorm": 22.685556411743164, "vf_loss": 915555811328.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011324882507324219, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323346.4713345121, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410238113787061, "mean_inference_ms": 5.240549545389516, "mean_action_processing_ms": 0.14537215157582598, "mean_env_wait_ms": 0.25803754533150797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015325546264648438, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.05893230438232422}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323346.4713345121, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410238113787061, "mean_inference_ms": 5.240549545389516, "mean_action_processing_ms": 0.14537215157582598, "mean_env_wait_ms": 0.25803754533150797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015325546264648438, "StateBufferConnector_ms": 0.002323150634765625, "ViewRequirementAgentConnector_ms": 0.05893230438232422}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1967.934, "learn_time_ms": 18.906, "learn_throughput": 17772.497, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-22", "timestamp": 1711724302, "time_this_iter_s": 1.9637389183044434, "time_total_s": 49.276496171951294, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5d7b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c54f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.276496171951294, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 12.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.235860901089814e+23, "policy_entropy": 4222.66845703125, "var_gnorm": 22.687732696533203, "vf_loss": 863541526528.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.334087371826172e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323110.8088097272, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408124999735218, "mean_inference_ms": 5.24052284596509, "mean_action_processing_ms": 0.14535352550619457, "mean_env_wait_ms": 0.257937899232059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002322747157170222, "ViewRequirementAgentConnector_ms": 0.05893432177030123}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323110.8088097272, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408124999735218, "mean_inference_ms": 5.24052284596509, "mean_action_processing_ms": 0.14535352550619457, "mean_env_wait_ms": 0.257937899232059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002322747157170222, "ViewRequirementAgentConnector_ms": 0.05893432177030123}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1967.772, "learn_time_ms": 18.914, "learn_throughput": 17765.014, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-24", "timestamp": 1711724304, "time_this_iter_s": 1.9667994976043701, "time_total_s": 51.243295669555664, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5fe50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c56b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.243295669555664, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 12.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5172638673826247e+24, "policy_entropy": 4180.9130859375, "var_gnorm": 22.68975257873535, "vf_loss": 881140629504.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001169443130493164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323379.6504340517, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406142030206496, "mean_inference_ms": 5.240498471185822, "mean_action_processing_ms": 0.14533573171737388, "mean_env_wait_ms": 0.25784386440683443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015294110333478009, "StateBufferConnector_ms": 0.0023206075032552085, "ViewRequirementAgentConnector_ms": 0.05897327705665871}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323379.6504340517, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406142030206496, "mean_inference_ms": 5.240498471185822, "mean_action_processing_ms": 0.14533573171737388, "mean_env_wait_ms": 0.25784386440683443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015294110333478009, "StateBufferConnector_ms": 0.0023206075032552085, "ViewRequirementAgentConnector_ms": 0.05897327705665871}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1967.508, "learn_time_ms": 18.907, "learn_throughput": 17771.444, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 27, "training_iteration": 27, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-26", "timestamp": 1711724306, "time_this_iter_s": 1.9684503078460693, "time_total_s": 53.21174597740173, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c2a8f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c557e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.21174597740173, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0105789333443241e+25, "policy_entropy": 4142.767578125, "var_gnorm": 22.69162368774414, "vf_loss": 687000059904.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013506412506103516, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321669.2021560598, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15404480155441375, "mean_inference_ms": 5.2405067137631525, "mean_action_processing_ms": 0.14531949973496205, "mean_env_wait_ms": 0.25775397149532475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015279224940708705, "StateBufferConnector_ms": 0.002313511712210519, "ViewRequirementAgentConnector_ms": 0.05895069667271206}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321669.2021560598, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15404480155441375, "mean_inference_ms": 5.2405067137631525, "mean_action_processing_ms": 0.14531949973496205, "mean_env_wait_ms": 0.25775397149532475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015279224940708705, "StateBufferConnector_ms": 0.002313511712210519, "ViewRequirementAgentConnector_ms": 0.05895069667271206}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1967.33, "learn_time_ms": 18.913, "learn_throughput": 17766.0, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-28", "timestamp": 1711724308, "time_this_iter_s": 1.9770183563232422, "time_total_s": 55.188764333724976, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6cc10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c57760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 55.188764333724976, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 12.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.534322997804855e+25, "policy_entropy": 4103.33544921875, "var_gnorm": 22.6933536529541, "vf_loss": 824681562112.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013053417205810547, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321124.8170888574, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402938389169266, "mean_inference_ms": 5.240515854029487, "mean_action_processing_ms": 0.14530523833827727, "mean_env_wait_ms": 0.25766961363087837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01523576933762123, "StateBufferConnector_ms": 0.0023118380842537716, "ViewRequirementAgentConnector_ms": 0.05894036128603179}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321124.8170888574, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15402938389169266, "mean_inference_ms": 5.240515854029487, "mean_action_processing_ms": 0.14530523833827727, "mean_env_wait_ms": 0.25766961363087837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01523576933762123, "StateBufferConnector_ms": 0.0023118380842537716, "ViewRequirementAgentConnector_ms": 0.05894036128603179}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1965.729, "learn_time_ms": 18.916, "learn_throughput": 17762.283, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": false, "episodes_total": 29, "training_iteration": 29, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-30", "timestamp": 1711724310, "time_this_iter_s": 1.969604730606079, "time_total_s": 57.158369064331055, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5df90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c571c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 57.158369064331055, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.599999999999999, "ram_util_percent": 12.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.843740826930236e+25, "policy_entropy": 4069.228515625, "var_gnorm": 22.6949520111084, "vf_loss": 837189304320.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011146068572998047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 30, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320873.5863324381, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401561127058297, "mean_inference_ms": 5.2405623980129805, "mean_action_processing_ms": 0.14529204524003922, "mean_env_wait_ms": 0.2575891283564093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015428860982259115, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.05888779958089193}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320873.5863324381, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15401561127058297, "mean_inference_ms": 5.2405623980129805, "mean_action_processing_ms": 0.14529204524003922, "mean_env_wait_ms": 0.2575891283564093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015428860982259115, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.05888779958089193}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080, "num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10080, "timers": {"training_iteration_time_ms": 1967.272, "learn_time_ms": 18.938, "learn_throughput": 17741.844, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 10080, "num_env_steps_trained": 10080, "num_agent_steps_sampled": 10080, "num_agent_steps_trained": 10080}, "done": false, "episodes_total": 30, "training_iteration": 30, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-32", "timestamp": 1711724312, "time_this_iter_s": 1.9804420471191406, "time_total_s": 59.138811111450195, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6dc30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c57c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 59.138811111450195, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 12.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2288818762884496e+27, "policy_entropy": 4037.708984375, "var_gnorm": 22.69642448425293, "vf_loss": 819587514368.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010728836059570312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 31, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320487.27295741707, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540034653705948, "mean_inference_ms": 5.240640727202941, "mean_action_processing_ms": 0.14527846452722287, "mean_env_wait_ms": 0.25751086738994616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015387996550529234, "StateBufferConnector_ms": 0.002307276571950605, "ViewRequirementAgentConnector_ms": 0.05894014912266885}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320487.27295741707, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540034653705948, "mean_inference_ms": 5.240640727202941, "mean_action_processing_ms": 0.14527846452722287, "mean_env_wait_ms": 0.25751086738994616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015387996550529234, "StateBufferConnector_ms": 0.002307276571950605, "ViewRequirementAgentConnector_ms": 0.05894014912266885}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416, "num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10416, "timers": {"training_iteration_time_ms": 1967.942, "learn_time_ms": 18.964, "learn_throughput": 17717.688, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 10416, "num_env_steps_trained": 10416, "num_agent_steps_sampled": 10416, "num_agent_steps_trained": 10416}, "done": false, "episodes_total": 31, "training_iteration": 31, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-34", "timestamp": 1711724314, "time_this_iter_s": 1.979875087738037, "time_total_s": 61.11868619918823, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6cc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c57910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 61.11868619918823, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 12.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.992639901380447e+26, "policy_entropy": 4009.148681640625, "var_gnorm": 22.69778060913086, "vf_loss": 961600552960.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011467933654785156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 32, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320789.77065879165, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399153714325578, "mean_inference_ms": 5.240714569613247, "mean_action_processing_ms": 0.14526508354735176, "mean_env_wait_ms": 0.2574340736856236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533403992652893, "StateBufferConnector_ms": 0.0023089349269866943, "ViewRequirementAgentConnector_ms": 0.058945268392562866}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320789.77065879165, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399153714325578, "mean_inference_ms": 5.240714569613247, "mean_action_processing_ms": 0.14526508354735176, "mean_env_wait_ms": 0.2574340736856236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533403992652893, "StateBufferConnector_ms": 0.0023089349269866943, "ViewRequirementAgentConnector_ms": 0.058945268392562866}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 10752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 1968.813, "learn_time_ms": 18.96, "learn_throughput": 17721.119, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-36", "timestamp": 1711724316, "time_this_iter_s": 1.9682238101959229, "time_total_s": 63.086910009384155, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6ea70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c843a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 63.086910009384155, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 12.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.753355242026046e+27, "policy_entropy": 3980.93310546875, "var_gnorm": 22.69902801513672, "vf_loss": 1130537418752.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011837482452392578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 33, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322068.79163887707, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539816817934268, "mean_inference_ms": 5.240775832717762, "mean_action_processing_ms": 0.1452530572480526, "mean_env_wait_ms": 0.25736118142091896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328869675145004, "StateBufferConnector_ms": 0.002309047814571496, "ViewRequirementAgentConnector_ms": 0.05897391926158558}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322068.79163887707, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539816817934268, "mean_inference_ms": 5.240775832717762, "mean_action_processing_ms": 0.1452530572480526, "mean_env_wait_ms": 0.25736118142091896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328869675145004, "StateBufferConnector_ms": 0.002309047814571496, "ViewRequirementAgentConnector_ms": 0.05897391926158558}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088, "num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11088, "timers": {"training_iteration_time_ms": 1970.677, "learn_time_ms": 18.978, "learn_throughput": 17705.134, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 11088, "num_env_steps_trained": 11088, "num_agent_steps_sampled": 11088, "num_agent_steps_trained": 11088}, "done": false, "episodes_total": 33, "training_iteration": 33, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-38", "timestamp": 1711724318, "time_this_iter_s": 1.967252254486084, "time_total_s": 65.05416226387024, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c2b820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c56b00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 65.05416226387024, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 12.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.312167202407553e+28, "policy_entropy": 3957.299560546875, "var_gnorm": 22.70017433166504, "vf_loss": 873473703936.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011277198791503906, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 34, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322092.4481001794, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397094736240355, "mean_inference_ms": 5.240775935577932, "mean_action_processing_ms": 0.14524015683708735, "mean_env_wait_ms": 0.2572876721160118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015281929689295152, "StateBufferConnector_ms": 0.002306349137250115, "ViewRequirementAgentConnector_ms": 0.058960914611816406}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322092.4481001794, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397094736240355, "mean_inference_ms": 5.240775935577932, "mean_action_processing_ms": 0.14524015683708735, "mean_env_wait_ms": 0.2572876721160118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015281929689295152, "StateBufferConnector_ms": 0.002306349137250115, "ViewRequirementAgentConnector_ms": 0.058960914611816406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424, "num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11424, "timers": {"training_iteration_time_ms": 1968.257, "learn_time_ms": 18.96, "learn_throughput": 17721.921, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 11424, "num_env_steps_trained": 11424, "num_agent_steps_sampled": 11424, "num_agent_steps_trained": 11424}, "done": false, "episodes_total": 34, "training_iteration": 34, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-40", "timestamp": 1711724320, "time_this_iter_s": 1.9443926811218262, "time_total_s": 66.99855494499207, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6ca30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c84670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 66.99855494499207, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.944486296047957e+28, "policy_entropy": 3933.08544921875, "var_gnorm": 22.70122718811035, "vf_loss": 1154266038272.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010979175567626953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 35, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323593.3227083787, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395868392682416, "mean_inference_ms": 5.2407153100942745, "mean_action_processing_ms": 0.14522640022276498, "mean_env_wait_ms": 0.25721551467125126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241077968052455, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.05892413003104074}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323593.3227083787, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395868392682416, "mean_inference_ms": 5.2407153100942745, "mean_action_processing_ms": 0.14522640022276498, "mean_env_wait_ms": 0.25721551467125126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241077968052455, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.05892413003104074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760, "num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 11760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 11760, "timers": {"training_iteration_time_ms": 1966.018, "learn_time_ms": 18.963, "learn_throughput": 17718.467, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 11760, "num_env_steps_trained": 11760, "num_agent_steps_sampled": 11760, "num_agent_steps_trained": 11760}, "done": false, "episodes_total": 35, "training_iteration": 35, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-42", "timestamp": 1711724322, "time_this_iter_s": 1.9413466453552246, "time_total_s": 68.93990159034729, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5f8b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c56d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 68.93990159034729, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 12.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0260101485038046e+29, "policy_entropy": 3913.28515625, "var_gnorm": 22.702192306518555, "vf_loss": 795712684032.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010526180267333984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 36, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322854.3979864273, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394657609739468, "mean_inference_ms": 5.240628972451735, "mean_action_processing_ms": 0.14521231599419376, "mean_env_wait_ms": 0.25714518442563744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015199846691555448, "StateBufferConnector_ms": 0.0023080243004692923, "ViewRequirementAgentConnector_ms": 0.058912568622165255}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322854.3979864273, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15394657609739468, "mean_inference_ms": 5.240628972451735, "mean_action_processing_ms": 0.14521231599419376, "mean_env_wait_ms": 0.25714518442563744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015199846691555448, "StateBufferConnector_ms": 0.0023080243004692923, "ViewRequirementAgentConnector_ms": 0.058912568622165255}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096, "num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12096, "timers": {"training_iteration_time_ms": 1964.694, "learn_time_ms": 18.928, "learn_throughput": 17751.029, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 12096, "num_env_steps_trained": 12096, "num_agent_steps_sampled": 12096, "num_agent_steps_trained": 12096}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-44", "timestamp": 1711724324, "time_this_iter_s": 1.9535834789276123, "time_total_s": 70.8934850692749, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5dc60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c56170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 70.8934850692749, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 13.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.124779512508582e+28, "policy_entropy": 3893.942138671875, "var_gnorm": 22.703079223632812, "vf_loss": 927289769984.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001093149185180664, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 37, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322491.6948976227, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393675762198966, "mean_inference_ms": 5.240585837622248, "mean_action_processing_ms": 0.14519893969263958, "mean_env_wait_ms": 0.2570781286721929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015171154125316723, "StateBufferConnector_ms": 0.00230814959551837, "ViewRequirementAgentConnector_ms": 0.058949960244668496}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322491.6948976227, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393675762198966, "mean_inference_ms": 5.240585837622248, "mean_action_processing_ms": 0.14519893969263958, "mean_env_wait_ms": 0.2570781286721929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015171154125316723, "StateBufferConnector_ms": 0.00230814959551837, "ViewRequirementAgentConnector_ms": 0.058949960244668496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432, "num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12432, "timers": {"training_iteration_time_ms": 1966.472, "learn_time_ms": 18.938, "learn_throughput": 17741.643, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 12432, "num_env_steps_trained": 12432, "num_agent_steps_sampled": 12432, "num_agent_steps_trained": 12432}, "done": false, "episodes_total": 37, "training_iteration": 37, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-46", "timestamp": 1711724326, "time_this_iter_s": 1.986269235610962, "time_total_s": 72.87975430488586, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c943d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c84e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 72.87975430488586, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.199999999999999, "ram_util_percent": 13.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6679383456397504e+29, "policy_entropy": 3875.993408203125, "var_gnorm": 22.703887939453125, "vf_loss": 849479598080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011730194091796875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 38, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322041.581951737, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15392764959948882, "mean_inference_ms": 5.240560512009373, "mean_action_processing_ms": 0.14518686282863036, "mean_env_wait_ms": 0.25701495023942195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533156947085732, "StateBufferConnector_ms": 0.0023082682960911803, "ViewRequirementAgentConnector_ms": 0.05892703407689145}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322041.581951737, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15392764959948882, "mean_inference_ms": 5.240560512009373, "mean_action_processing_ms": 0.14518686282863036, "mean_env_wait_ms": 0.25701495023942195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533156947085732, "StateBufferConnector_ms": 0.0023082682960911803, "ViewRequirementAgentConnector_ms": 0.05892703407689145}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768, "num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 12768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 12768, "timers": {"training_iteration_time_ms": 1966.433, "learn_time_ms": 18.947, "learn_throughput": 17733.584, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 12768, "num_env_steps_trained": 12768, "num_agent_steps_sampled": 12768, "num_agent_steps_trained": 12768}, "done": false, "episodes_total": 38, "training_iteration": 38, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-48", "timestamp": 1711724328, "time_this_iter_s": 1.9766356945037842, "time_total_s": 74.85638999938965, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6fbb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c577f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 74.85638999938965, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.4, "ram_util_percent": 13.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2331503507459308e+30, "policy_entropy": 3859.90625, "var_gnorm": 22.704631805419922, "vf_loss": 827919630336.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001361370086669922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 39, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321911.0378398979, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539191928335666, "mean_inference_ms": 5.240551192628884, "mean_action_processing_ms": 0.14517599814640297, "mean_env_wait_ms": 0.2569548590650363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015307084108010316, "StateBufferConnector_ms": 0.002308380909455128, "ViewRequirementAgentConnector_ms": 0.058925457489796176}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321911.0378398979, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539191928335666, "mean_inference_ms": 5.240551192628884, "mean_action_processing_ms": 0.14517599814640297, "mean_env_wait_ms": 0.2569548590650363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015307084108010316, "StateBufferConnector_ms": 0.002308380909455128, "ViewRequirementAgentConnector_ms": 0.058925457489796176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104, "num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13104, "timers": {"training_iteration_time_ms": 1967.119, "learn_time_ms": 18.957, "learn_throughput": 17724.306, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 13104, "num_env_steps_trained": 13104, "num_agent_steps_sampled": 13104, "num_agent_steps_trained": 13104}, "done": false, "episodes_total": 39, "training_iteration": 39, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-50", "timestamp": 1711724330, "time_this_iter_s": 1.9764862060546875, "time_total_s": 76.83287620544434, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96080>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c84160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 76.83287620544434, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.933333333333334, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.303572274337872e+29, "policy_entropy": 3845.40087890625, "var_gnorm": 22.705310821533203, "vf_loss": 1032607629312.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010263919830322266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 40, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322707.5244414912, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391159291358916, "mean_inference_ms": 5.240544596352285, "mean_action_processing_ms": 0.14516519568925754, "mean_env_wait_ms": 0.25689834899827624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260577201843262, "StateBufferConnector_ms": 0.0023055076599121094, "ViewRequirementAgentConnector_ms": 0.05894184112548828}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322707.5244414912, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391159291358916, "mean_inference_ms": 5.240544596352285, "mean_action_processing_ms": 0.14516519568925754, "mean_env_wait_ms": 0.25689834899827624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260577201843262, "StateBufferConnector_ms": 0.0023055076599121094, "ViewRequirementAgentConnector_ms": 0.05894184112548828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440, "num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13440, "timers": {"training_iteration_time_ms": 1966.058, "learn_time_ms": 18.91, "learn_throughput": 17768.508, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 13440, "num_env_steps_trained": 13440, "num_agent_steps_sampled": 13440, "num_agent_steps_trained": 13440}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-52", "timestamp": 1711724332, "time_this_iter_s": 1.9698565006256104, "time_total_s": 78.80273270606995, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94fa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c85090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 78.80273270606995, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 13.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.750611055093018e+30, "policy_entropy": 3832.006591796875, "var_gnorm": 22.705928802490234, "vf_loss": 1117346594816.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001214742660522461, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 41, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323328.1547844104, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390346308680736, "mean_inference_ms": 5.240512332140092, "mean_action_processing_ms": 0.14515359289927807, "mean_env_wait_ms": 0.25684165046634977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015248903414098227, "StateBufferConnector_ms": 0.002308008147449028, "ViewRequirementAgentConnector_ms": 0.058969637242759144}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323328.1547844104, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390346308680736, "mean_inference_ms": 5.240512332140092, "mean_action_processing_ms": 0.14515359289927807, "mean_env_wait_ms": 0.25684165046634977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015248903414098227, "StateBufferConnector_ms": 0.002308008147449028, "ViewRequirementAgentConnector_ms": 0.058969637242759144}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776, "num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 13776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 13776, "timers": {"training_iteration_time_ms": 1963.187, "learn_time_ms": 18.893, "learn_throughput": 17784.563, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 13776, "num_env_steps_trained": 13776, "num_agent_steps_sampled": 13776, "num_agent_steps_trained": 13776}, "done": false, "episodes_total": 41, "training_iteration": 41, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-54", "timestamp": 1711724334, "time_this_iter_s": 1.9511957168579102, "time_total_s": 80.75392842292786, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c86320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 80.75392842292786, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 13.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2024449949692663e+30, "policy_entropy": 3819.2392578125, "var_gnorm": 22.706497192382812, "vf_loss": 1169101946880.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010836124420166016, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 42, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324187.5942674348, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538954453806368, "mean_inference_ms": 5.240481770584866, "mean_action_processing_ms": 0.14514225346952503, "mean_env_wait_ms": 0.2567861028066265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015208834693545387, "StateBufferConnector_ms": 0.00230755124773298, "ViewRequirementAgentConnector_ms": 0.058941046396891274}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324187.5942674348, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538954453806368, "mean_inference_ms": 5.240481770584866, "mean_action_processing_ms": 0.14514225346952503, "mean_env_wait_ms": 0.2567861028066265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015208834693545387, "StateBufferConnector_ms": 0.00230755124773298, "ViewRequirementAgentConnector_ms": 0.058941046396891274}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112, "num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14112, "timers": {"training_iteration_time_ms": 1963.06, "learn_time_ms": 18.893, "learn_throughput": 17784.765, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 14112, "num_env_steps_trained": 14112, "num_agent_steps_sampled": 14112, "num_agent_steps_trained": 14112}, "done": false, "episodes_total": 42, "training_iteration": 42, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-56", "timestamp": 1711724336, "time_this_iter_s": 1.9669480323791504, "time_total_s": 82.720876455307, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96b00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c84c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 82.720876455307, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 13.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.044637454580554e+29, "policy_entropy": 3807.474853515625, "var_gnorm": 22.707014083862305, "vf_loss": 942291877888.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013947486877441406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 43, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324244.9035079151, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388661121696484, "mean_inference_ms": 5.240440981588838, "mean_action_processing_ms": 0.1451302803562135, "mean_env_wait_ms": 0.25673095049318007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015181164408839026, "StateBufferConnector_ms": 0.0023043432901071947, "ViewRequirementAgentConnector_ms": 0.058932082597599474}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324244.9035079151, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15388661121696484, "mean_inference_ms": 5.240440981588838, "mean_action_processing_ms": 0.1451302803562135, "mean_env_wait_ms": 0.25673095049318007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015181164408839026, "StateBufferConnector_ms": 0.0023043432901071947, "ViewRequirementAgentConnector_ms": 0.058932082597599474}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 1962.131, "learn_time_ms": 18.872, "learn_throughput": 17803.728, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 43, "training_iteration": 43, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-58-58", "timestamp": 1711724338, "time_this_iter_s": 1.9579932689666748, "time_total_s": 84.67886972427368, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb07c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c86b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 84.67886972427368, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 13.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.339539766607866e+30, "policy_entropy": 3798.914794921875, "var_gnorm": 22.707487106323242, "vf_loss": 986840694784.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001232624053955078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 44, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324464.0919904936, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538769760042313, "mean_inference_ms": 5.240372829949191, "mean_action_processing_ms": 0.1451173783903758, "mean_env_wait_ms": 0.25667562167369384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156377445567738, "StateBufferConnector_ms": 0.002301823009144176, "ViewRequirementAgentConnector_ms": 0.05892081694169478}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324464.0919904936, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538769760042313, "mean_inference_ms": 5.240372829949191, "mean_action_processing_ms": 0.1451173783903758, "mean_env_wait_ms": 0.25667562167369384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015156377445567738, "StateBufferConnector_ms": 0.002301823009144176, "ViewRequirementAgentConnector_ms": 0.05892081694169478}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784, "num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 14784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 14784, "timers": {"training_iteration_time_ms": 1962.262, "learn_time_ms": 18.883, "learn_throughput": 17793.658, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 14784, "num_env_steps_trained": 14784, "num_agent_steps_sampled": 14784, "num_agent_steps_trained": 14784}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-00", "timestamp": 1711724340, "time_this_iter_s": 1.9457314014434814, "time_total_s": 86.62460112571716, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95e10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c867a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 86.62460112571716, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 13.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6624564564632416e+30, "policy_entropy": 3788.135986328125, "var_gnorm": 22.707918167114258, "vf_loss": 1012130054144.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010633468627929688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 45, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324572.656497037, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386716817977236, "mean_inference_ms": 5.240285856876913, "mean_action_processing_ms": 0.14510413531591512, "mean_env_wait_ms": 0.2566203974891621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015138520134819878, "StateBufferConnector_ms": 0.0022983551025390625, "ViewRequirementAgentConnector_ms": 0.05890263451470269}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324572.656497037, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386716817977236, "mean_inference_ms": 5.240285856876913, "mean_action_processing_ms": 0.14510413531591512, "mean_env_wait_ms": 0.2566203974891621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015138520134819878, "StateBufferConnector_ms": 0.0022983551025390625, "ViewRequirementAgentConnector_ms": 0.05890263451470269}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120, "num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15120, "timers": {"training_iteration_time_ms": 1963.131, "learn_time_ms": 18.874, "learn_throughput": 17802.199, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 15120, "num_env_steps_trained": 15120, "num_agent_steps_sampled": 15120, "num_agent_steps_trained": 15120}, "done": false, "episodes_total": 45, "training_iteration": 45, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-02", "timestamp": 1711724342, "time_this_iter_s": 1.9500524997711182, "time_total_s": 88.57465362548828, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c286d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c85f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 88.57465362548828, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 13.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.1118117958572925e+30, "policy_entropy": 3780.073974609375, "var_gnorm": 22.708311080932617, "vf_loss": 859965751296.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012791156768798828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 46, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324412.3832533741, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385715916790385, "mean_inference_ms": 5.240190093101926, "mean_action_processing_ms": 0.14508751292865235, "mean_env_wait_ms": 0.2565620043204734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268118485160496, "StateBufferConnector_ms": 0.0023002209870711617, "ViewRequirementAgentConnector_ms": 0.05888316942297894}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324412.3832533741, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15385715916790385, "mean_inference_ms": 5.240190093101926, "mean_action_processing_ms": 0.14508751292865235, "mean_env_wait_ms": 0.2565620043204734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268118485160496, "StateBufferConnector_ms": 0.0023002209870711617, "ViewRequirementAgentConnector_ms": 0.05888316942297894}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456, "num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15456, "timers": {"training_iteration_time_ms": 1962.897, "learn_time_ms": 18.924, "learn_throughput": 17754.808, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 15456, "num_env_steps_trained": 15456, "num_agent_steps_sampled": 15456, "num_agent_steps_trained": 15456}, "done": false, "episodes_total": 46, "training_iteration": 46, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-04", "timestamp": 1711724344, "time_this_iter_s": 1.9512310028076172, "time_total_s": 90.5258846282959, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1e40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c87490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 90.5258846282959, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 13.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5430012268550095e+31, "policy_entropy": 3771.0283203125, "var_gnorm": 22.708667755126953, "vf_loss": 919939383296.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012063980102539062, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 47, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324416.27235851646, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384681192905156, "mean_inference_ms": 5.240088123955354, "mean_action_processing_ms": 0.14506743938839878, "mean_env_wait_ms": 0.25650128626142843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015243063581750748, "StateBufferConnector_ms": 0.002297949283681017, "ViewRequirementAgentConnector_ms": 0.058869098095183675}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324416.27235851646, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384681192905156, "mean_inference_ms": 5.240088123955354, "mean_action_processing_ms": 0.14506743938839878, "mean_env_wait_ms": 0.25650128626142843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015243063581750748, "StateBufferConnector_ms": 0.002297949283681017, "ViewRequirementAgentConnector_ms": 0.058869098095183675}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792, "num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 15792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 15792, "timers": {"training_iteration_time_ms": 1959.491, "learn_time_ms": 18.931, "learn_throughput": 17748.972, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 15792, "num_env_steps_trained": 15792, "num_agent_steps_sampled": 15792, "num_agent_steps_trained": 15792}, "done": false, "episodes_total": 47, "training_iteration": 47, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-06", "timestamp": 1711724346, "time_this_iter_s": 1.9522202014923096, "time_total_s": 92.47810482978821, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5fb20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c867a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 92.47810482978821, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 14.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.237893419762929e+30, "policy_entropy": 3763.85107421875, "var_gnorm": 22.708995819091797, "vf_loss": 885663399936.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013947486877441406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 48, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324383.89312014263, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383574671141695, "mean_inference_ms": 5.239970073920779, "mean_action_processing_ms": 0.14504500649778831, "mean_env_wait_ms": 0.25643863410810636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236934026082357, "StateBufferConnector_ms": 0.002298752466837565, "ViewRequirementAgentConnector_ms": 0.05888640880584717}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324383.89312014263, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383574671141695, "mean_inference_ms": 5.239970073920779, "mean_action_processing_ms": 0.14504500649778831, "mean_env_wait_ms": 0.25643863410810636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236934026082357, "StateBufferConnector_ms": 0.002298752466837565, "ViewRequirementAgentConnector_ms": 0.05888640880584717}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16128, "timers": {"training_iteration_time_ms": 1956.229, "learn_time_ms": 18.919, "learn_throughput": 17759.999, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 16128, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 16128, "num_agent_steps_trained": 16128}, "done": false, "episodes_total": 48, "training_iteration": 48, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-08", "timestamp": 1711724348, "time_this_iter_s": 1.9440515041351318, "time_total_s": 94.42215633392334, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1480>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca0310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 94.42215633392334, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.652678769766462e+29, "policy_entropy": 3757.049072265625, "var_gnorm": 22.709293365478516, "vf_loss": 949421604864.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012052059173583984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 49, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324256.0144977363, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538235977284839, "mean_inference_ms": 5.239829717350866, "mean_action_processing_ms": 0.14501927810726956, "mean_env_wait_ms": 0.25637354035284504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200887407575334, "StateBufferConnector_ms": 0.002296603455835459, "ViewRequirementAgentConnector_ms": 0.058841705322265625}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324256.0144977363, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538235977284839, "mean_inference_ms": 5.239829717350866, "mean_action_processing_ms": 0.14501927810726956, "mean_env_wait_ms": 0.25637354035284504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200887407575334, "StateBufferConnector_ms": 0.002296603455835459, "ViewRequirementAgentConnector_ms": 0.058841705322265625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464, "num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16464, "timers": {"training_iteration_time_ms": 1952.099, "learn_time_ms": 18.885, "learn_throughput": 17791.95, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 16464, "num_env_steps_trained": 16464, "num_agent_steps_sampled": 16464, "num_agent_steps_trained": 16464}, "done": false, "episodes_total": 49, "training_iteration": 49, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-10", "timestamp": 1711724350, "time_this_iter_s": 1.9352073669433594, "time_total_s": 96.3573637008667, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c86d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 96.3573637008667, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 14.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.298961521995405e+31, "policy_entropy": 3750.565185546875, "var_gnorm": 22.709562301635742, "vf_loss": 1098268737536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011444091796875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 50, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324866.39921583136, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381210793459973, "mean_inference_ms": 5.2396907666686765, "mean_action_processing_ms": 0.14499268659037579, "mean_env_wait_ms": 0.25630896874735193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015193939208984375, "StateBufferConnector_ms": 0.00229644775390625, "ViewRequirementAgentConnector_ms": 0.05884695053100586}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324866.39921583136, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381210793459973, "mean_inference_ms": 5.2396907666686765, "mean_action_processing_ms": 0.14499268659037579, "mean_env_wait_ms": 0.25630896874735193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015193939208984375, "StateBufferConnector_ms": 0.00229644775390625, "ViewRequirementAgentConnector_ms": 0.05884695053100586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800, "num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 16800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 1951.015, "learn_time_ms": 18.958, "learn_throughput": 17723.749, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 16800, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 16800}, "done": false, "episodes_total": 50, "training_iteration": 50, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-12", "timestamp": 1711724352, "time_this_iter_s": 1.9590301513671875, "time_total_s": 98.31639385223389, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2920>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca0af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 98.31639385223389, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 14.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2659220780913444e+31, "policy_entropy": 3745.500244140625, "var_gnorm": 22.709810256958008, "vf_loss": 947876200448.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011467933654785156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 51, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325304.3624761357, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380137265601032, "mean_inference_ms": 5.239565439759877, "mean_action_processing_ms": 0.14496462901538945, "mean_env_wait_ms": 0.25624446284260377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520082062365962, "StateBufferConnector_ms": 0.0022981681075750614, "ViewRequirementAgentConnector_ms": 0.058894531399595974}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325304.3624761357, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380137265601032, "mean_inference_ms": 5.239565439759877, "mean_action_processing_ms": 0.14496462901538945, "mean_env_wait_ms": 0.25624446284260377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520082062365962, "StateBufferConnector_ms": 0.0022981681075750614, "ViewRequirementAgentConnector_ms": 0.058894531399595974}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136, "num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17136, "timers": {"training_iteration_time_ms": 1952.743, "learn_time_ms": 18.961, "learn_throughput": 17720.294, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 17136, "num_env_steps_trained": 17136, "num_agent_steps_sampled": 17136, "num_agent_steps_trained": 17136}, "done": false, "episodes_total": 51, "training_iteration": 51, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-14", "timestamp": 1711724354, "time_this_iter_s": 1.9684953689575195, "time_total_s": 100.2848892211914, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c87490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 100.2848892211914, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 14.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.216777294067019e+31, "policy_entropy": 3741.1708984375, "var_gnorm": 22.71003532409668, "vf_loss": 732668952576.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012612342834472656, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 52, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324580.6263104355, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537911812934836, "mean_inference_ms": 5.239450015107276, "mean_action_processing_ms": 0.14493806974473278, "mean_env_wait_ms": 0.2561829508258056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188180483304538, "StateBufferConnector_ms": 0.002297529807457557, "ViewRequirementAgentConnector_ms": 0.05888938903808594}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324580.6263104355, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537911812934836, "mean_inference_ms": 5.239450015107276, "mean_action_processing_ms": 0.14493806974473278, "mean_env_wait_ms": 0.2561829508258056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188180483304538, "StateBufferConnector_ms": 0.002297529807457557, "ViewRequirementAgentConnector_ms": 0.05888938903808594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472, "num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17472, "timers": {"training_iteration_time_ms": 1953.175, "learn_time_ms": 19.017, "learn_throughput": 17668.619, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 17472, "num_env_steps_trained": 17472, "num_agent_steps_sampled": 17472, "num_agent_steps_trained": 17472}, "done": false, "episodes_total": 52, "training_iteration": 52, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-16", "timestamp": 1711724356, "time_this_iter_s": 1.9712886810302734, "time_total_s": 102.25617790222168, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb39d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 102.25617790222168, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 14.466666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.8414432281551145e+30, "policy_entropy": 3736.837158203125, "var_gnorm": 22.710237503051758, "vf_loss": 973986791424.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015103816986083984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 53, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324880.4134854541, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378228883094294, "mean_inference_ms": 5.239352185027499, "mean_action_processing_ms": 0.14491307794165, "mean_env_wait_ms": 0.2561243983263745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169719480118662, "StateBufferConnector_ms": 0.0022964657477612766, "ViewRequirementAgentConnector_ms": 0.05892717613364166}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324880.4134854541, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378228883094294, "mean_inference_ms": 5.239352185027499, "mean_action_processing_ms": 0.14491307794165, "mean_env_wait_ms": 0.2561243983263745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015169719480118662, "StateBufferConnector_ms": 0.0022964657477612766, "ViewRequirementAgentConnector_ms": 0.05892717613364166}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808, "num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 17808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 17808, "timers": {"training_iteration_time_ms": 1955.389, "learn_time_ms": 19.056, "learn_throughput": 17632.188, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 17808, "num_env_steps_trained": 17808, "num_agent_steps_sampled": 17808, "num_agent_steps_trained": 17808}, "done": false, "episodes_total": 53, "training_iteration": 53, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-18", "timestamp": 1711724358, "time_this_iter_s": 1.980158805847168, "time_total_s": 104.23633670806885, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc4190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca1d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 104.23633670806885, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 14.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.074896958643158e+31, "policy_entropy": 3731.89013671875, "var_gnorm": 22.710424423217773, "vf_loss": 823241080832.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014591217041015625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 54, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324569.0816788948, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377423364254383, "mean_inference_ms": 5.239278204756302, "mean_action_processing_ms": 0.14489009224687197, "mean_env_wait_ms": 0.2560691591260793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189471068205658, "StateBufferConnector_ms": 0.0022980901930067274, "ViewRequirementAgentConnector_ms": 0.05907879935370551}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324569.0816788948, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377423364254383, "mean_inference_ms": 5.239278204756302, "mean_action_processing_ms": 0.14489009224687197, "mean_env_wait_ms": 0.2560691591260793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189471068205658, "StateBufferConnector_ms": 0.0022980901930067274, "ViewRequirementAgentConnector_ms": 0.05907879935370551}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144, "num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18144, "timers": {"training_iteration_time_ms": 1959.657, "learn_time_ms": 19.053, "learn_throughput": 17635.321, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 18144, "num_env_steps_trained": 18144, "num_agent_steps_sampled": 18144, "num_agent_steps_trained": 18144}, "done": false, "episodes_total": 54, "training_iteration": 54, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-20", "timestamp": 1711724360, "time_this_iter_s": 1.988403081893921, "time_total_s": 106.22473978996277, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3520>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.22473978996277, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 14.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.407047136340123e+31, "policy_entropy": 3730.1298828125, "var_gnorm": 22.710594177246094, "vf_loss": 1063556218880.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012409687042236328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 55, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324886.3408496744, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537672261250027, "mean_inference_ms": 5.239217112727874, "mean_action_processing_ms": 0.14486888397410294, "mean_env_wait_ms": 0.25601708739605133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174258839000355, "StateBufferConnector_ms": 0.0022970546375621448, "ViewRequirementAgentConnector_ms": 0.059146881103515625}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324886.3408496744, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537672261250027, "mean_inference_ms": 5.239217112727874, "mean_action_processing_ms": 0.14486888397410294, "mean_env_wait_ms": 0.25601708739605133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174258839000355, "StateBufferConnector_ms": 0.0022970546375621448, "ViewRequirementAgentConnector_ms": 0.059146881103515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480, "num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18480, "timers": {"training_iteration_time_ms": 1962.613, "learn_time_ms": 19.074, "learn_throughput": 17615.152, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 18480, "num_env_steps_trained": 18480, "num_agent_steps_sampled": 18480, "num_agent_steps_trained": 18480}, "done": false, "episodes_total": 55, "training_iteration": 55, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-22", "timestamp": 1711724362, "time_this_iter_s": 1.9796411991119385, "time_total_s": 108.2043809890747, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3dc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca1510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 108.2043809890747, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 14.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.887011027032259e+31, "policy_entropy": 3725.68701171875, "var_gnorm": 22.71074676513672, "vf_loss": 1070845919232.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001176595687866211, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 56, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325514.1359794826, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376243261797753, "mean_inference_ms": 5.239219173139633, "mean_action_processing_ms": 0.14485038081934268, "mean_env_wait_ms": 0.2559700928332651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015185560498918806, "StateBufferConnector_ms": 0.002295630318777902, "ViewRequirementAgentConnector_ms": 0.059166124888828824}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325514.1359794826, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376243261797753, "mean_inference_ms": 5.239219173139633, "mean_action_processing_ms": 0.14485038081934268, "mean_env_wait_ms": 0.2559700928332651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015185560498918806, "StateBufferConnector_ms": 0.002295630318777902, "ViewRequirementAgentConnector_ms": 0.059166124888828824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816, "num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 18816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 18816, "timers": {"training_iteration_time_ms": 1971.362, "learn_time_ms": 19.097, "learn_throughput": 17594.524, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 18816, "num_env_steps_trained": 18816, "num_agent_steps_sampled": 18816, "num_agent_steps_trained": 18816}, "done": false, "episodes_total": 56, "training_iteration": 56, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-24", "timestamp": 1711724364, "time_this_iter_s": 2.0387845039367676, "time_total_s": 110.24316549301147, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3730>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c570a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 110.24316549301147, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.099999999999999, "ram_util_percent": 14.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.8598429129664555e+31, "policy_entropy": 3722.0966796875, "var_gnorm": 22.710886001586914, "vf_loss": 893375545344.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014662742614746094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 57, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325424.4585522938, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376340464593632, "mean_inference_ms": 5.2393410086335095, "mean_action_processing_ms": 0.14483734509234475, "mean_env_wait_ms": 0.2559331543647911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015357920998021177, "StateBufferConnector_ms": 0.002306804322359855, "ViewRequirementAgentConnector_ms": 0.05944737216882538}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325424.4585522938, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376340464593632, "mean_inference_ms": 5.2393410086335095, "mean_action_processing_ms": 0.14483734509234475, "mean_env_wait_ms": 0.2559331543647911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015357920998021177, "StateBufferConnector_ms": 0.002306804322359855, "ViewRequirementAgentConnector_ms": 0.05944737216882538}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152, "num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19152, "timers": {"training_iteration_time_ms": 1988.408, "learn_time_ms": 19.378, "learn_throughput": 17339.213, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 19152, "num_env_steps_trained": 19152, "num_agent_steps_sampled": 19152, "num_agent_steps_trained": 19152}, "done": false, "episodes_total": 57, "training_iteration": 57, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-26", "timestamp": 1711724366, "time_this_iter_s": 2.1227617263793945, "time_total_s": 112.36592721939087, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb28c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c84310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 112.36592721939087, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 11.133333333333335, "ram_util_percent": 14.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.075010658372919e+31, "policy_entropy": 3718.58544921875, "var_gnorm": 22.71101188659668, "vf_loss": 1232367255552.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.238719940185547e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 58, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -326133.7153063816, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376546033781538, "mean_inference_ms": 5.23947977585491, "mean_action_processing_ms": 0.14482593656140733, "mean_env_wait_ms": 0.25589859173455665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002306494219549771, "ViewRequirementAgentConnector_ms": 0.05942953043970568}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -326133.7153063816, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376546033781538, "mean_inference_ms": 5.23947977585491, "mean_action_processing_ms": 0.14482593656140733, "mean_env_wait_ms": 0.25589859173455665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002306494219549771, "ViewRequirementAgentConnector_ms": 0.05942953043970568}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488, "num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19488, "timers": {"training_iteration_time_ms": 1993.832, "learn_time_ms": 19.379, "learn_throughput": 17337.976, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 19488, "num_env_steps_trained": 19488, "num_agent_steps_sampled": 19488, "num_agent_steps_trained": 19488}, "done": false, "episodes_total": 58, "training_iteration": 58, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-28", "timestamp": 1711724368, "time_this_iter_s": 1.998304843902588, "time_total_s": 114.36423206329346, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb27a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c87250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 114.36423206329346, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.866666666666667, "ram_util_percent": 15.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.9665864537446335e+31, "policy_entropy": 3715.9248046875, "var_gnorm": 22.71112823486328, "vf_loss": 734357356544.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012755393981933594, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 59, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325293.7781125418, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376729272328948, "mean_inference_ms": 5.239609423398189, "mean_action_processing_ms": 0.14481481901045504, "mean_env_wait_ms": 0.25586488723420076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322636749784825, "StateBufferConnector_ms": 0.0023057905294127383, "ViewRequirementAgentConnector_ms": 0.05945997723078324}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325293.7781125418, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376729272328948, "mean_inference_ms": 5.239609423398189, "mean_action_processing_ms": 0.14481481901045504, "mean_env_wait_ms": 0.25586488723420076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015322636749784825, "StateBufferConnector_ms": 0.0023057905294127383, "ViewRequirementAgentConnector_ms": 0.05945997723078324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824, "num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 19824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 19824, "timers": {"training_iteration_time_ms": 1996.863, "learn_time_ms": 19.456, "learn_throughput": 17269.394, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 19824, "num_env_steps_trained": 19824, "num_agent_steps_sampled": 19824, "num_agent_steps_trained": 19824}, "done": false, "episodes_total": 59, "training_iteration": 59, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-30", "timestamp": 1711724370, "time_this_iter_s": 1.9655344486236572, "time_total_s": 116.32976651191711, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca1ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 116.32976651191711, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 15.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.677108199097255e+30, "policy_entropy": 3713.275634765625, "var_gnorm": 22.711233139038086, "vf_loss": 979435651072.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010144710540771484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 60, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325470.2403443299, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376902108377713, "mean_inference_ms": 5.239720933123893, "mean_action_processing_ms": 0.14480392150595106, "mean_env_wait_ms": 0.25583204035862334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300512313842773, "StateBufferConnector_ms": 0.002303918202718099, "ViewRequirementAgentConnector_ms": 0.0594782829284668}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325470.2403443299, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15376902108377713, "mean_inference_ms": 5.239720933123893, "mean_action_processing_ms": 0.14480392150595106, "mean_env_wait_ms": 0.25583204035862334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300512313842773, "StateBufferConnector_ms": 0.002303918202718099, "ViewRequirementAgentConnector_ms": 0.0594782829284668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160, "num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20160, "timers": {"training_iteration_time_ms": 1996.317, "learn_time_ms": 19.432, "learn_throughput": 17290.666, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 20160, "num_env_steps_trained": 20160, "num_agent_steps_sampled": 20160, "num_agent_steps_trained": 20160}, "done": false, "episodes_total": 60, "training_iteration": 60, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-32", "timestamp": 1711724372, "time_this_iter_s": 1.9536221027374268, "time_total_s": 118.28338861465454, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97c70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c872e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 118.28338861465454, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 15.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.203761454420003e+31, "policy_entropy": 3712.312744140625, "var_gnorm": 22.711328506469727, "vf_loss": 877604306944.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001347064971923828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 61, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325237.5950188968, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537706021509813, "mean_inference_ms": 5.239821068583757, "mean_action_processing_ms": 0.14479354832742425, "mean_env_wait_ms": 0.2558000245583169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01528458517105853, "StateBufferConnector_ms": 0.002304061514432313, "ViewRequirementAgentConnector_ms": 0.059468238080134156}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325237.5950188968, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537706021509813, "mean_inference_ms": 5.239821068583757, "mean_action_processing_ms": 0.14479354832742425, "mean_env_wait_ms": 0.2558000245583169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01528458517105853, "StateBufferConnector_ms": 0.002304061514432313, "ViewRequirementAgentConnector_ms": 0.059468238080134156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496, "num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20496, "timers": {"training_iteration_time_ms": 1995.536, "learn_time_ms": 19.435, "learn_throughput": 17288.588, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 20496, "num_env_steps_trained": 20496, "num_agent_steps_sampled": 20496, "num_agent_steps_trained": 20496}, "done": false, "episodes_total": 61, "training_iteration": 61, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-34", "timestamp": 1711724374, "time_this_iter_s": 1.9606995582580566, "time_total_s": 120.2440881729126, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 120.2440881729126, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 15.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.592604933783288e+31, "policy_entropy": 3711.425048828125, "var_gnorm": 22.71141242980957, "vf_loss": 975837265920.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012934207916259766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 62, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325527.03986081807, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377218418234126, "mean_inference_ms": 5.239917947767174, "mean_action_processing_ms": 0.14478366548080185, "mean_env_wait_ms": 0.2557688388024638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526417270783455, "StateBufferConnector_ms": 0.002303431110997354, "ViewRequirementAgentConnector_ms": 0.05944621178411668}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -325527.03986081807, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377218418234126, "mean_inference_ms": 5.239917947767174, "mean_action_processing_ms": 0.14478366548080185, "mean_env_wait_ms": 0.2557688388024638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526417270783455, "StateBufferConnector_ms": 0.002303431110997354, "ViewRequirementAgentConnector_ms": 0.05944621178411668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832, "num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 20832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 20832, "timers": {"training_iteration_time_ms": 1995.504, "learn_time_ms": 19.468, "learn_throughput": 17258.904, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 20832, "num_env_steps_trained": 20832, "num_agent_steps_sampled": 20832, "num_agent_steps_trained": 20832}, "done": false, "episodes_total": 62, "training_iteration": 62, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-36", "timestamp": 1711724376, "time_this_iter_s": 1.9709887504577637, "time_total_s": 122.21507692337036, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5f9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca3250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 122.21507692337036, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 15.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5486310583286936e+31, "policy_entropy": 3708.565185546875, "var_gnorm": 22.71149253845215, "vf_loss": 659355533312.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017559528350830078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 63, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324636.42561867106, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537743322153371, "mean_inference_ms": 5.240030797576745, "mean_action_processing_ms": 0.14477451237386435, "mean_env_wait_ms": 0.25573920556707463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267114790659102, "StateBufferConnector_ms": 0.002303956046937004, "ViewRequirementAgentConnector_ms": 0.059496031867133245}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324636.42561867106, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537743322153371, "mean_inference_ms": 5.240030797576745, "mean_action_processing_ms": 0.14477451237386435, "mean_env_wait_ms": 0.25573920556707463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267114790659102, "StateBufferConnector_ms": 0.002303956046937004, "ViewRequirementAgentConnector_ms": 0.059496031867133245}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168, "num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21168, "timers": {"training_iteration_time_ms": 1997.317, "learn_time_ms": 19.495, "learn_throughput": 17235.221, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 21168, "num_env_steps_trained": 21168, "num_agent_steps_sampled": 21168, "num_agent_steps_trained": 21168}, "done": false, "episodes_total": 63, "training_iteration": 63, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-38", "timestamp": 1711724378, "time_this_iter_s": 1.998326063156128, "time_total_s": 124.21340298652649, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb25f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca15a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 124.21340298652649, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 15.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.356242557868184e+31, "policy_entropy": 3707.501708984375, "var_gnorm": 22.71156120300293, "vf_loss": 831939280896.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001373291015625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 64, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324253.26328021334, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537769016763826, "mean_inference_ms": 5.240157593899356, "mean_action_processing_ms": 0.144766386902829, "mean_env_wait_ms": 0.2557116086829768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015254318714141846, "StateBufferConnector_ms": 0.0023052096366882324, "ViewRequirementAgentConnector_ms": 0.059520453214645386}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324253.26328021334, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537769016763826, "mean_inference_ms": 5.240157593899356, "mean_action_processing_ms": 0.144766386902829, "mean_env_wait_ms": 0.2557116086829768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015254318714141846, "StateBufferConnector_ms": 0.0023052096366882324, "ViewRequirementAgentConnector_ms": 0.059520453214645386}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 1998.306, "learn_time_ms": 19.501, "learn_throughput": 17230.038, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 64, "training_iteration": 64, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-40", "timestamp": 1711724380, "time_this_iter_s": 1.9983315467834473, "time_total_s": 126.21173453330994, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca36d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 126.21173453330994, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 15.699999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.164462524948365e+30, "policy_entropy": 3706.22900390625, "var_gnorm": 22.711627960205078, "vf_loss": 814126596096.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.000164031982421875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 65, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324091.9529155888, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377950278542687, "mean_inference_ms": 5.240275189767437, "mean_action_processing_ms": 0.14475836788392793, "mean_env_wait_ms": 0.25568447019831364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336550199068509, "StateBufferConnector_ms": 0.0023053242610051082, "ViewRequirementAgentConnector_ms": 0.05951844728910006}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -324091.9529155888, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377950278542687, "mean_inference_ms": 5.240275189767437, "mean_action_processing_ms": 0.14475836788392793, "mean_env_wait_ms": 0.25568447019831364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336550199068509, "StateBufferConnector_ms": 0.0023053242610051082, "ViewRequirementAgentConnector_ms": 0.05951844728910006}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840, "num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 21840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 21840, "timers": {"training_iteration_time_ms": 1996.652, "learn_time_ms": 19.489, "learn_throughput": 17240.218, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 21840, "num_env_steps_trained": 21840, "num_agent_steps_sampled": 21840, "num_agent_steps_trained": 21840}, "done": false, "episodes_total": 65, "training_iteration": 65, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-42", "timestamp": 1711724382, "time_this_iter_s": 1.9631648063659668, "time_total_s": 128.1748993396759, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca1cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 128.1748993396759, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 15.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.492880703625994e+31, "policy_entropy": 3703.604248046875, "var_gnorm": 22.711687088012695, "vf_loss": 828959227904.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013124942779541016, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 66, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323861.6425031291, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378199576462523, "mean_inference_ms": 5.240387696550151, "mean_action_processing_ms": 0.14475078624303528, "mean_env_wait_ms": 0.2556580301583805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346209208170572, "StateBufferConnector_ms": 0.002306519132671934, "ViewRequirementAgentConnector_ms": 0.05955948974146987}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323861.6425031291, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378199576462523, "mean_inference_ms": 5.240387696550151, "mean_action_processing_ms": 0.14475078624303528, "mean_env_wait_ms": 0.2556580301583805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015346209208170572, "StateBufferConnector_ms": 0.002306519132671934, "ViewRequirementAgentConnector_ms": 0.05955948974146987}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176, "num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22176, "timers": {"training_iteration_time_ms": 1989.712, "learn_time_ms": 19.497, "learn_throughput": 17233.325, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 22176, "num_env_steps_trained": 22176, "num_agent_steps_sampled": 22176, "num_agent_steps_trained": 22176}, "done": false, "episodes_total": 66, "training_iteration": 66, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-44", "timestamp": 1711724384, "time_this_iter_s": 1.9693889617919922, "time_total_s": 130.1442883014679, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb21d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c877f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 130.1442883014679, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.400000000000001, "ram_util_percent": 15.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0014955227772496e+32, "policy_entropy": 3703.93408203125, "var_gnorm": 22.71173858642578, "vf_loss": 698449657856.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001291036605834961, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 67, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323322.790480921, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378450802637944, "mean_inference_ms": 5.24049796625697, "mean_action_processing_ms": 0.1447436999801324, "mean_env_wait_ms": 0.25563244065199947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015326756149975222, "StateBufferConnector_ms": 0.002306254942025711, "ViewRequirementAgentConnector_ms": 0.0595366776879154}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -323322.790480921, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378450802637944, "mean_inference_ms": 5.24049796625697, "mean_action_processing_ms": 0.1447436999801324, "mean_env_wait_ms": 0.25563244065199947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015326756149975222, "StateBufferConnector_ms": 0.002306254942025711, "ViewRequirementAgentConnector_ms": 0.0595366776879154}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512, "num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22512, "timers": {"training_iteration_time_ms": 1974.812, "learn_time_ms": 19.222, "learn_throughput": 17480.32, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 22512, "num_env_steps_trained": 22512, "num_agent_steps_sampled": 22512, "num_agent_steps_trained": 22512}, "done": false, "episodes_total": 67, "training_iteration": 67, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-46", "timestamp": 1711724386, "time_this_iter_s": 1.9737229347229004, "time_total_s": 132.1180112361908, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2d10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca3880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 132.1180112361908, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 15.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3711480936423558e+32, "policy_entropy": 3701.946533203125, "var_gnorm": 22.711788177490234, "vf_loss": 632588992512.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016808509826660156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 68, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322626.1630436523, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378698014933115, "mean_inference_ms": 5.2405961300346595, "mean_action_processing_ms": 0.1447368061508649, "mean_env_wait_ms": 0.2556073525664254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334522022920497, "StateBufferConnector_ms": 0.002305297290577608, "ViewRequirementAgentConnector_ms": 0.05958465968861299}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322626.1630436523, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378698014933115, "mean_inference_ms": 5.2405961300346595, "mean_action_processing_ms": 0.1447368061508649, "mean_env_wait_ms": 0.2556073525664254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334522022920497, "StateBufferConnector_ms": 0.002305297290577608, "ViewRequirementAgentConnector_ms": 0.05958465968861299}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848, "num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 22848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 22848, "timers": {"training_iteration_time_ms": 1970.688, "learn_time_ms": 19.228, "learn_throughput": 17474.706, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 22848, "num_env_steps_trained": 22848, "num_agent_steps_sampled": 22848, "num_agent_steps_trained": 22848}, "done": false, "episodes_total": 68, "training_iteration": 68, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-48", "timestamp": 1711724388, "time_this_iter_s": 1.9570801258087158, "time_total_s": 134.0750913619995, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 134.0750913619995, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 16.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.20825427598466e+31, "policy_entropy": 3702.4501953125, "var_gnorm": 22.711833953857422, "vf_loss": 955992637440.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011742115020751953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 69, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322579.7592374098, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378964719523236, "mean_inference_ms": 5.240693193317616, "mean_action_processing_ms": 0.1447303284432371, "mean_env_wait_ms": 0.25558324144760036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306127244147701, "StateBufferConnector_ms": 0.0023033307946246605, "ViewRequirementAgentConnector_ms": 0.05955937979877859}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322579.7592374098, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378964719523236, "mean_inference_ms": 5.240693193317616, "mean_action_processing_ms": 0.1447303284432371, "mean_env_wait_ms": 0.25558324144760036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306127244147701, "StateBufferConnector_ms": 0.0023033307946246605, "ViewRequirementAgentConnector_ms": 0.05955937979877859}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184, "num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23184, "timers": {"training_iteration_time_ms": 1971.612, "learn_time_ms": 19.171, "learn_throughput": 17526.582, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 23184, "num_env_steps_trained": 23184, "num_agent_steps_sampled": 23184, "num_agent_steps_trained": 23184}, "done": false, "episodes_total": 69, "training_iteration": 69, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-50", "timestamp": 1711724390, "time_this_iter_s": 1.9747824668884277, "time_total_s": 136.04987382888794, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca3e20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 136.04987382888794, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 16.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.063263511008044e+32, "policy_entropy": 3699.794677734375, "var_gnorm": 22.711872100830078, "vf_loss": 923771731968.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001493692398071289, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 70, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322742.4558790185, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379240931541008, "mean_inference_ms": 5.2407884285094255, "mean_action_processing_ms": 0.14472421324678453, "mean_env_wait_ms": 0.2555597836945133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288761683872767, "StateBufferConnector_ms": 0.0023024422781808035, "ViewRequirementAgentConnector_ms": 0.059572969164167135}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322742.4558790185, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379240931541008, "mean_inference_ms": 5.2407884285094255, "mean_action_processing_ms": 0.14472421324678453, "mean_env_wait_ms": 0.2555597836945133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015288761683872767, "StateBufferConnector_ms": 0.0023024422781808035, "ViewRequirementAgentConnector_ms": 0.059572969164167135}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520, "num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23520, "timers": {"training_iteration_time_ms": 1973.546, "learn_time_ms": 19.153, "learn_throughput": 17542.552, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 23520, "num_env_steps_trained": 23520, "num_agent_steps_sampled": 23520, "num_agent_steps_trained": 23520}, "done": false, "episodes_total": 70, "training_iteration": 70, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-52", "timestamp": 1711724392, "time_this_iter_s": 1.972963571548462, "time_total_s": 138.0228374004364, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 138.0228374004364, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5142523512259846e+31, "policy_entropy": 3699.763671875, "var_gnorm": 22.71190643310547, "vf_loss": 894067146752.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001291036605834961, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 71, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322519.90277124126, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379500733178222, "mean_inference_ms": 5.240878594752654, "mean_action_processing_ms": 0.14471827535094872, "mean_env_wait_ms": 0.2555366973558887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290354339169785, "StateBufferConnector_ms": 0.002301914591184804, "ViewRequirementAgentConnector_ms": 0.059590541141133914}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -322519.90277124126, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379500733178222, "mean_inference_ms": 5.240878594752654, "mean_action_processing_ms": 0.14471827535094872, "mean_env_wait_ms": 0.2555366973558887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015290354339169785, "StateBufferConnector_ms": 0.002301914591184804, "ViewRequirementAgentConnector_ms": 0.059590541141133914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856, "num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 23856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 23856, "timers": {"training_iteration_time_ms": 1974.107, "learn_time_ms": 19.151, "learn_throughput": 17545.107, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 23856, "num_env_steps_trained": 23856, "num_agent_steps_sampled": 23856, "num_agent_steps_trained": 23856}, "done": false, "episodes_total": 71, "training_iteration": 71, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-54", "timestamp": 1711724394, "time_this_iter_s": 1.966313123703003, "time_total_s": 139.9891505241394, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6eec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 139.9891505241394, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 16.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1232056045564523e+31, "policy_entropy": 3699.58056640625, "var_gnorm": 22.711938858032227, "vf_loss": 698850148352.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012373924255371094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 72, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321859.1817525739, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537971412496023, "mean_inference_ms": 5.240961108105958, "mean_action_processing_ms": 0.1447122548362486, "mean_env_wait_ms": 0.25551397337653525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015276008182101779, "StateBufferConnector_ms": 0.0023000770144992405, "ViewRequirementAgentConnector_ms": 0.05957749154832628}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321859.1817525739, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537971412496023, "mean_inference_ms": 5.240961108105958, "mean_action_processing_ms": 0.1447122548362486, "mean_env_wait_ms": 0.25551397337653525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015276008182101779, "StateBufferConnector_ms": 0.0023000770144992405, "ViewRequirementAgentConnector_ms": 0.05957749154832628}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192, "num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24192, "timers": {"training_iteration_time_ms": 1973.06, "learn_time_ms": 19.112, "learn_throughput": 17580.301, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 24192, "num_env_steps_trained": 24192, "num_agent_steps_sampled": 24192, "num_agent_steps_trained": 24192}, "done": false, "episodes_total": 72, "training_iteration": 72, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-56", "timestamp": 1711724396, "time_this_iter_s": 1.9605193138122559, "time_total_s": 141.94966983795166, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c87760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 141.94966983795166, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 16.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3286084119017562e+32, "policy_entropy": 3697.046630859375, "var_gnorm": 22.711971282958984, "vf_loss": 683009048576.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016248226165771484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 73, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321314.3326417048, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537993783867574, "mean_inference_ms": 5.241038524469429, "mean_action_processing_ms": 0.1447066644241505, "mean_env_wait_ms": 0.2554920195599342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352523490174175, "StateBufferConnector_ms": 0.002299596185553564, "ViewRequirementAgentConnector_ms": 0.05955859406353676}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321314.3326417048, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537993783867574, "mean_inference_ms": 5.241038524469429, "mean_action_processing_ms": 0.1447066644241505, "mean_env_wait_ms": 0.2554920195599342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015352523490174175, "StateBufferConnector_ms": 0.002299596185553564, "ViewRequirementAgentConnector_ms": 0.05955859406353676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528, "num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24528, "timers": {"training_iteration_time_ms": 1969.872, "learn_time_ms": 19.045, "learn_throughput": 17642.784, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 24528, "num_env_steps_trained": 24528, "num_agent_steps_sampled": 24528, "num_agent_steps_trained": 24528}, "done": false, "episodes_total": 73, "training_iteration": 73, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_14-59-58", "timestamp": 1711724398, "time_this_iter_s": 1.9664595127105713, "time_total_s": 143.91612935066223, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96f80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b012d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 143.91612935066223, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.66505573726021e+30, "policy_entropy": 3697.25439453125, "var_gnorm": 22.71199607849121, "vf_loss": 794472087552.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012004375457763672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 74, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320885.86668029206, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380149554296857, "mean_inference_ms": 5.241112041541559, "mean_action_processing_ms": 0.14470146043174242, "mean_env_wait_ms": 0.25547059485441287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335469632535367, "StateBufferConnector_ms": 0.0022994505392538536, "ViewRequirementAgentConnector_ms": 0.05954149607065562}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320885.86668029206, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380149554296857, "mean_inference_ms": 5.241112041541559, "mean_action_processing_ms": 0.14470146043174242, "mean_env_wait_ms": 0.25547059485441287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015335469632535367, "StateBufferConnector_ms": 0.0022994505392538536, "ViewRequirementAgentConnector_ms": 0.05954149607065562}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864, "num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 24864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 24864, "timers": {"training_iteration_time_ms": 1966.761, "learn_time_ms": 18.992, "learn_throughput": 17691.42, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 24864, "num_env_steps_trained": 24864, "num_agent_steps_sampled": 24864, "num_agent_steps_trained": 24864}, "done": false, "episodes_total": 74, "training_iteration": 74, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-00", "timestamp": 1711724400, "time_this_iter_s": 1.9672441482543945, "time_total_s": 145.88337349891663, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6eec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca3760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 145.88337349891663, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 16.533333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.626894648769994e+31, "policy_entropy": 3696.296875, "var_gnorm": 22.712020874023438, "vf_loss": 985417383936.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013136863708496094, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 75, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321040.7160968898, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380393515763502, "mean_inference_ms": 5.24119150238438, "mean_action_processing_ms": 0.14469660140639987, "mean_env_wait_ms": 0.25545010375013855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532745361328125, "StateBufferConnector_ms": 0.0022986729939778647, "ViewRequirementAgentConnector_ms": 0.05956554412841797}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321040.7160968898, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380393515763502, "mean_inference_ms": 5.24119150238438, "mean_action_processing_ms": 0.14469660140639987, "mean_env_wait_ms": 0.25545010375013855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01532745361328125, "StateBufferConnector_ms": 0.0022986729939778647, "ViewRequirementAgentConnector_ms": 0.05956554412841797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200, "num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 1969.209, "learn_time_ms": 19.007, "learn_throughput": 17677.284, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 25200, "num_env_steps_trained": 25200, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 25200}, "done": false, "episodes_total": 75, "training_iteration": 75, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-02", "timestamp": 1711724402, "time_this_iter_s": 1.987642765045166, "time_total_s": 147.8710162639618, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ae0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 147.8710162639618, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 16.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4347392358932e+32, "policy_entropy": 3696.45703125, "var_gnorm": 22.71204376220703, "vf_loss": 742953320448.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018465518951416016, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 76, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320619.16582976107, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380619581338595, "mean_inference_ms": 5.241267940582617, "mean_action_processing_ms": 0.14469176703826245, "mean_env_wait_ms": 0.2554299353921633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310237282200864, "StateBufferConnector_ms": 0.0022982296190763776, "ViewRequirementAgentConnector_ms": 0.05957107794912238}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320619.16582976107, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380619581338595, "mean_inference_ms": 5.241267940582617, "mean_action_processing_ms": 0.14469176703826245, "mean_env_wait_ms": 0.2554299353921633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015310237282200864, "StateBufferConnector_ms": 0.0022982296190763776, "ViewRequirementAgentConnector_ms": 0.05957107794912238}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536, "num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25536, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25536, "timers": {"training_iteration_time_ms": 1969.082, "learn_time_ms": 18.95, "learn_throughput": 17731.085, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25536, "num_env_steps_trained": 25536, "num_agent_steps_sampled": 25536, "num_agent_steps_trained": 25536}, "done": false, "episodes_total": 76, "training_iteration": 76, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-04", "timestamp": 1711724404, "time_this_iter_s": 1.9681401252746582, "time_total_s": 149.83915638923645, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6d6c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 149.83915638923645, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 16.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.1831652725434303e+31, "policy_entropy": 3698.268798828125, "var_gnorm": 22.71206283569336, "vf_loss": 751804874752.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012803077697753906, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 77, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320049.8993375489, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380859427065938, "mean_inference_ms": 5.241342040029454, "mean_action_processing_ms": 0.14468708383334922, "mean_env_wait_ms": 0.25540993986424615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01529532593566102, "StateBufferConnector_ms": 0.0022990362984793527, "ViewRequirementAgentConnector_ms": 0.05962569992263596}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320049.8993375489, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380859427065938, "mean_inference_ms": 5.241342040029454, "mean_action_processing_ms": 0.14468708383334922, "mean_env_wait_ms": 0.25540993986424615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01529532593566102, "StateBufferConnector_ms": 0.0022990362984793527, "ViewRequirementAgentConnector_ms": 0.05962569992263596}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872, "num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 25872, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 25872, "timers": {"training_iteration_time_ms": 1968.704, "learn_time_ms": 18.929, "learn_throughput": 17750.828, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 25872, "num_env_steps_trained": 25872, "num_agent_steps_sampled": 25872, "num_agent_steps_trained": 25872}, "done": false, "episodes_total": 77, "training_iteration": 77, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-06", "timestamp": 1711724406, "time_this_iter_s": 1.9699761867523193, "time_total_s": 151.80913257598877, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ed0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b02950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 151.80913257598877, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 16.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.283958404559069e+31, "policy_entropy": 3696.213134765625, "var_gnorm": 22.712081909179688, "vf_loss": 1005673971712.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014865398406982422, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 78, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320303.8946696228, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381063497481057, "mean_inference_ms": 5.241408492959949, "mean_action_processing_ms": 0.1446822955171438, "mean_env_wait_ms": 0.255390007676325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278351612580128, "StateBufferConnector_ms": 0.002297071310190054, "ViewRequirementAgentConnector_ms": 0.05962634697938577}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320303.8946696228, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381063497481057, "mean_inference_ms": 5.241408492959949, "mean_action_processing_ms": 0.1446822955171438, "mean_env_wait_ms": 0.255390007676325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015278351612580128, "StateBufferConnector_ms": 0.002297071310190054, "ViewRequirementAgentConnector_ms": 0.05962634697938577}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208, "num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26208, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26208, "timers": {"training_iteration_time_ms": 1968.677, "learn_time_ms": 18.889, "learn_throughput": 17788.402, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 26208, "num_env_steps_trained": 26208, "num_agent_steps_sampled": 26208, "num_agent_steps_trained": 26208}, "done": false, "episodes_total": 78, "training_iteration": 78, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-08", "timestamp": 1711724408, "time_this_iter_s": 1.9568307399749756, "time_total_s": 153.76596331596375, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3880>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ca28c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 153.76596331596375, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.9, "ram_util_percent": 16.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.617422887565775e+32, "policy_entropy": 3695.301513671875, "var_gnorm": 22.712095260620117, "vf_loss": 863795609600.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013911724090576172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 79, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320492.6783923547, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381264054142246, "mean_inference_ms": 5.241473539297257, "mean_action_processing_ms": 0.1446777075367715, "mean_env_wait_ms": 0.2553709010925291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526422138455548, "StateBufferConnector_ms": 0.0022963632511187205, "ViewRequirementAgentConnector_ms": 0.059609473506106604}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320492.6783923547, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381264054142246, "mean_inference_ms": 5.241473539297257, "mean_action_processing_ms": 0.1446777075367715, "mean_env_wait_ms": 0.2553709010925291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526422138455548, "StateBufferConnector_ms": 0.0022963632511187205, "ViewRequirementAgentConnector_ms": 0.059609473506106604}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544, "num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26544, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26544, "timers": {"training_iteration_time_ms": 1968.401, "learn_time_ms": 18.888, "learn_throughput": 17789.3, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 26544, "num_env_steps_trained": 26544, "num_agent_steps_sampled": 26544, "num_agent_steps_trained": 26544}, "done": false, "episodes_total": 79, "training_iteration": 79, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-10", "timestamp": 1711724410, "time_this_iter_s": 1.9720478057861328, "time_total_s": 155.73801112174988, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 155.73801112174988, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 16.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.1047763463331425e+31, "policy_entropy": 3695.183349609375, "var_gnorm": 22.712112426757812, "vf_loss": 823687053312.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012540817260742188, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 80, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320329.1124308307, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381457518300684, "mean_inference_ms": 5.241534798643406, "mean_action_processing_ms": 0.1446732970116372, "mean_env_wait_ms": 0.2553521990678605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015240907669067383, "StateBufferConnector_ms": 0.002295970916748047, "ViewRequirementAgentConnector_ms": 0.059590041637420654}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320329.1124308307, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381457518300684, "mean_inference_ms": 5.241534798643406, "mean_action_processing_ms": 0.1446732970116372, "mean_env_wait_ms": 0.2553521990678605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015240907669067383, "StateBufferConnector_ms": 0.002295970916748047, "ViewRequirementAgentConnector_ms": 0.059590041637420654}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 26880, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 26880, "timers": {"training_iteration_time_ms": 1967.686, "learn_time_ms": 18.88, "learn_throughput": 17796.736, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 26880, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 26880, "num_agent_steps_trained": 26880}, "done": false, "episodes_total": 80, "training_iteration": 80, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-12", "timestamp": 1711724412, "time_this_iter_s": 1.9658453464508057, "time_total_s": 157.70385646820068, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc4430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b03e20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 157.70385646820068, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 17.033333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.519524041512029e+32, "policy_entropy": 3695.60693359375, "var_gnorm": 22.712125778198242, "vf_loss": 902261440512.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013935565948486328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 81, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320428.1729404489, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381620940891025, "mean_inference_ms": 5.241583936660989, "mean_action_processing_ms": 0.1446687972593032, "mean_env_wait_ms": 0.2553334867430922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015224056479371624, "StateBufferConnector_ms": 0.002295882613570602, "ViewRequirementAgentConnector_ms": 0.05957521038290895}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320428.1729404489, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381620940891025, "mean_inference_ms": 5.241583936660989, "mean_action_processing_ms": 0.1446687972593032, "mean_env_wait_ms": 0.2553334867430922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015224056479371624, "StateBufferConnector_ms": 0.002295882613570602, "ViewRequirementAgentConnector_ms": 0.05957521038290895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216, "num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27216, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27216, "timers": {"training_iteration_time_ms": 1965.554, "learn_time_ms": 18.863, "learn_throughput": 17812.797, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 27216, "num_env_steps_trained": 27216, "num_agent_steps_sampled": 27216, "num_agent_steps_trained": 27216}, "done": false, "episodes_total": 81, "training_iteration": 81, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-14", "timestamp": 1711724414, "time_this_iter_s": 1.9450747966766357, "time_total_s": 159.64893126487732, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 159.64893126487732, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 17.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.1847014995966e+31, "policy_entropy": 3696.6748046875, "var_gnorm": 22.71213722229004, "vf_loss": 786332385280.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015497207641601562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 82, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320224.8594244705, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381772702696148, "mean_inference_ms": 5.241626164984784, "mean_action_processing_ms": 0.14466432574741656, "mean_env_wait_ms": 0.2553148778059549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015204417996290253, "StateBufferConnector_ms": 0.0022957964641291922, "ViewRequirementAgentConnector_ms": 0.05956074086631217}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320224.8594244705, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381772702696148, "mean_inference_ms": 5.241626164984784, "mean_action_processing_ms": 0.14466432574741656, "mean_env_wait_ms": 0.2553148778059549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015204417996290253, "StateBufferConnector_ms": 0.0022957964641291922, "ViewRequirementAgentConnector_ms": 0.05956074086631217}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552, "num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27552, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27552, "timers": {"training_iteration_time_ms": 1965.101, "learn_time_ms": 18.819, "learn_throughput": 17854.682, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 27552, "num_env_steps_trained": 27552, "num_agent_steps_sampled": 27552, "num_agent_steps_trained": 27552}, "done": false, "episodes_total": 82, "training_iteration": 82, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-16", "timestamp": 1711724416, "time_this_iter_s": 1.9560248851776123, "time_total_s": 161.60495615005493, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1c160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 161.60495615005493, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.107761553032359e+32, "policy_entropy": 3694.71240234375, "var_gnorm": 22.712148666381836, "vf_loss": 809768976384.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015020370483398438, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 83, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320058.194642977, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538190471485552, "mean_inference_ms": 5.241667762147453, "mean_action_processing_ms": 0.1446599151189955, "mean_env_wait_ms": 0.25529664585098216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186114483569041, "StateBufferConnector_ms": 0.002294276134077325, "ViewRequirementAgentConnector_ms": 0.05955782281347068}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320058.194642977, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538190471485552, "mean_inference_ms": 5.241667762147453, "mean_action_processing_ms": 0.1446599151189955, "mean_env_wait_ms": 0.25529664585098216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186114483569041, "StateBufferConnector_ms": 0.002294276134077325, "ViewRequirementAgentConnector_ms": 0.05955782281347068}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888, "num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 27888, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 27888, "timers": {"training_iteration_time_ms": 1965.795, "learn_time_ms": 19.14, "learn_throughput": 17554.811, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 27888, "num_env_steps_trained": 27888, "num_agent_steps_sampled": 27888, "num_agent_steps_trained": 27888}, "done": false, "episodes_total": 83, "training_iteration": 83, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-18", "timestamp": 1711724418, "time_this_iter_s": 1.9733994007110596, "time_total_s": 163.578355550766, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc5330>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1cc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 163.578355550766, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 17.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.8445175717850062e+31, "policy_entropy": 3692.5322265625, "var_gnorm": 22.712160110473633, "vf_loss": 1021355491328.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010788440704345703, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 84, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320250.34386964445, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382002937019626, "mean_inference_ms": 5.241699919439394, "mean_action_processing_ms": 0.14465539586349488, "mean_env_wait_ms": 0.25527833381352394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015255099251156761, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.05954276947748093}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320250.34386964445, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382002937019626, "mean_inference_ms": 5.241699919439394, "mean_action_processing_ms": 0.14465539586349488, "mean_env_wait_ms": 0.25527833381352394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015255099251156761, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.05954276947748093}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224, "num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28224, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28224, "timers": {"training_iteration_time_ms": 1963.836, "learn_time_ms": 19.178, "learn_throughput": 17520.198, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 28224, "num_env_steps_trained": 28224, "num_agent_steps_sampled": 28224, "num_agent_steps_trained": 28224}, "done": false, "episodes_total": 84, "training_iteration": 84, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-20", "timestamp": 1711724420, "time_this_iter_s": 1.9477005004882812, "time_total_s": 165.52605605125427, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96b60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b036d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 165.52605605125427, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 17.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.1551336829545413e+32, "policy_entropy": 3694.955810546875, "var_gnorm": 22.712169647216797, "vf_loss": 1287966294016.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011944770812988281, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 85, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320857.51452257263, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153820970476499, "mean_inference_ms": 5.241730185143135, "mean_action_processing_ms": 0.14465103369502622, "mean_env_wait_ms": 0.2552603612897529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01524055705350988, "StateBufferConnector_ms": 0.0022947087007410384, "ViewRequirementAgentConnector_ms": 0.05954489988439223}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320857.51452257263, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153820970476499, "mean_inference_ms": 5.241730185143135, "mean_action_processing_ms": 0.14465103369502622, "mean_env_wait_ms": 0.2552603612897529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01524055705350988, "StateBufferConnector_ms": 0.0022947087007410384, "ViewRequirementAgentConnector_ms": 0.05954489988439223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560, "num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28560, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28560, "timers": {"training_iteration_time_ms": 1961.766, "learn_time_ms": 19.155, "learn_throughput": 17541.416, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 28560, "num_env_steps_trained": 28560, "num_agent_steps_sampled": 28560, "num_agent_steps_trained": 28560}, "done": false, "episodes_total": 85, "training_iteration": 85, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-22", "timestamp": 1711724422, "time_this_iter_s": 1.9669532775878906, "time_total_s": 167.49300932884216, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1570>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c57760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 167.49300932884216, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 17.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.127971431409685e+30, "policy_entropy": 3693.499267578125, "var_gnorm": 22.712175369262695, "vf_loss": 861076783104.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012969970703125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 86, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320731.7921145126, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382195040875263, "mean_inference_ms": 5.2417724856296095, "mean_action_processing_ms": 0.14464674828722088, "mean_env_wait_ms": 0.25524272477193505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223026275634766, "StateBufferConnector_ms": 0.002304066059201263, "ViewRequirementAgentConnector_ms": 0.0595516936723576}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320731.7921145126, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382195040875263, "mean_inference_ms": 5.2417724856296095, "mean_action_processing_ms": 0.14464674828722088, "mean_env_wait_ms": 0.25524272477193505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015223026275634766, "StateBufferConnector_ms": 0.002304066059201263, "ViewRequirementAgentConnector_ms": 0.0595516936723576}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 28896, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 1965.082, "learn_time_ms": 19.153, "learn_throughput": 17543.098, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 86, "training_iteration": 86, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-24", "timestamp": 1711724424, "time_this_iter_s": 2.001328945159912, "time_total_s": 169.49433827400208, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96620>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518c57490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 169.49433827400208, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.0938298643657565e+32, "policy_entropy": 3694.272705078125, "var_gnorm": 22.71218490600586, "vf_loss": 908719816704.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014638900756835938, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 87, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320636.6656377213, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538228627667262, "mean_inference_ms": 5.241812697051049, "mean_action_processing_ms": 0.1446425131804283, "mean_env_wait_ms": 0.2552252146720317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520398019374102, "StateBufferConnector_ms": 0.0023030686652523347, "ViewRequirementAgentConnector_ms": 0.059540518398942616}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320636.6656377213, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538228627667262, "mean_inference_ms": 5.241812697051049, "mean_action_processing_ms": 0.1446425131804283, "mean_env_wait_ms": 0.2552252146720317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520398019374102, "StateBufferConnector_ms": 0.0023030686652523347, "ViewRequirementAgentConnector_ms": 0.059540518398942616}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232, "num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29232, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29232, "timers": {"training_iteration_time_ms": 1964.785, "learn_time_ms": 19.205, "learn_throughput": 17495.663, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 29232, "num_env_steps_trained": 29232, "num_agent_steps_sampled": 29232, "num_agent_steps_trained": 29232}, "done": false, "episodes_total": 87, "training_iteration": 87, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-26", "timestamp": 1711724426, "time_this_iter_s": 1.9669971466064453, "time_total_s": 171.46133542060852, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b03eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 171.46133542060852, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 17.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0242042755150875e+32, "policy_entropy": 3693.818603515625, "var_gnorm": 22.712188720703125, "vf_loss": 951581933568.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001251697540283203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 88, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320706.9722535438, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382371178248216, "mean_inference_ms": 5.241850893999061, "mean_action_processing_ms": 0.1446383896825975, "mean_env_wait_ms": 0.25520814530393005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188889069990679, "StateBufferConnector_ms": 0.0023015520789406514, "ViewRequirementAgentConnector_ms": 0.05952715873718262}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320706.9722535438, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382371178248216, "mean_inference_ms": 5.241850893999061, "mean_action_processing_ms": 0.1446383896825975, "mean_env_wait_ms": 0.25520814530393005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015188889069990679, "StateBufferConnector_ms": 0.0023015520789406514, "ViewRequirementAgentConnector_ms": 0.05952715873718262}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568, "num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29568, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29568, "timers": {"training_iteration_time_ms": 1965.864, "learn_time_ms": 19.253, "learn_throughput": 17451.66, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 29568, "num_env_steps_trained": 29568, "num_agent_steps_sampled": 29568, "num_agent_steps_trained": 29568}, "done": false, "episodes_total": 88, "training_iteration": 88, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-28", "timestamp": 1711724428, "time_this_iter_s": 1.9676587581634521, "time_total_s": 173.42899417877197, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5ec50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 173.42899417877197, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 17.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.073663367906828e+32, "policy_entropy": 3693.697998046875, "var_gnorm": 22.712194442749023, "vf_loss": 926449532928.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013387203216552734, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 89, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320786.2272470238, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382442582891986, "mean_inference_ms": 5.24188403204225, "mean_action_processing_ms": 0.14463424801106886, "mean_env_wait_ms": 0.25519113296008455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518351308415445, "StateBufferConnector_ms": 0.002302212661571717, "ViewRequirementAgentConnector_ms": 0.059546781389900806}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320786.2272470238, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382442582891986, "mean_inference_ms": 5.24188403204225, "mean_action_processing_ms": 0.14463424801106886, "mean_env_wait_ms": 0.25519113296008455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518351308415445, "StateBufferConnector_ms": 0.002302212661571717, "ViewRequirementAgentConnector_ms": 0.059546781389900806}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904, "num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 29904, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 29904, "timers": {"training_iteration_time_ms": 1964.393, "learn_time_ms": 19.251, "learn_throughput": 17453.778, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 29904, "num_env_steps_trained": 29904, "num_agent_steps_sampled": 29904, "num_agent_steps_trained": 29904}, "done": false, "episodes_total": 89, "training_iteration": 89, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-30", "timestamp": 1711724430, "time_this_iter_s": 1.95735764503479, "time_total_s": 175.38635182380676, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb18a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1ca60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 175.38635182380676, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 17.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.566161111354532e+32, "policy_entropy": 3692.72802734375, "var_gnorm": 22.712202072143555, "vf_loss": 974058487808.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001246929168701172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 90, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321016.8346753459, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382500170252073, "mean_inference_ms": 5.24190966432907, "mean_action_processing_ms": 0.14463003593195922, "mean_env_wait_ms": 0.25517421445144756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168984731038412, "StateBufferConnector_ms": 0.0023023287455240884, "ViewRequirementAgentConnector_ms": 0.05956305397881402}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -321016.8346753459, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382500170252073, "mean_inference_ms": 5.24190966432907, "mean_action_processing_ms": 0.14463003593195922, "mean_env_wait_ms": 0.25517421445144756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015168984731038412, "StateBufferConnector_ms": 0.0023023287455240884, "ViewRequirementAgentConnector_ms": 0.05956305397881402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240, "num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30240, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30240, "timers": {"training_iteration_time_ms": 1962.79, "learn_time_ms": 19.249, "learn_throughput": 17455.313, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 30240, "num_env_steps_trained": 30240, "num_agent_steps_sampled": 30240, "num_agent_steps_trained": 30240}, "done": false, "episodes_total": 90, "training_iteration": 90, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-32", "timestamp": 1711724432, "time_this_iter_s": 1.9498302936553955, "time_total_s": 177.33618211746216, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96ef0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b03760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 177.33618211746216, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.550000000000001, "ram_util_percent": 17.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.163581076297615e+32, "policy_entropy": 3692.58447265625, "var_gnorm": 22.71220588684082, "vf_loss": 693675950080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015819072723388672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 91, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320513.3245795889, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538253950345779, "mean_inference_ms": 5.241929484678103, "mean_action_processing_ms": 0.1446257477298137, "mean_env_wait_ms": 0.2551573315975922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015165779616806534, "StateBufferConnector_ms": 0.0023016562828650842, "ViewRequirementAgentConnector_ms": 0.05955931904551747}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320513.3245795889, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538253950345779, "mean_inference_ms": 5.241929484678103, "mean_action_processing_ms": 0.1446257477298137, "mean_env_wait_ms": 0.2551573315975922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015165779616806534, "StateBufferConnector_ms": 0.0023016562828650842, "ViewRequirementAgentConnector_ms": 0.05955931904551747}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576, "num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30576, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30576, "timers": {"training_iteration_time_ms": 1963.589, "learn_time_ms": 19.242, "learn_throughput": 17461.759, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 30576, "num_env_steps_trained": 30576, "num_agent_steps_sampled": 30576, "num_agent_steps_trained": 30576}, "done": false, "episodes_total": 91, "training_iteration": 91, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-34", "timestamp": 1711724434, "time_this_iter_s": 1.953064203262329, "time_total_s": 179.2892463207245, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb08e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1c3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 179.2892463207245, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 18.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.0660115112857732e+32, "policy_entropy": 3692.664794921875, "var_gnorm": 22.71221160888672, "vf_loss": 771082420224.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001537799835205078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 92, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320315.45292889414, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538255278257241, "mean_inference_ms": 5.241942740855309, "mean_action_processing_ms": 0.14462134298733673, "mean_env_wait_ms": 0.2551404724405309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015227172685706097, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05954737248628036}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320315.45292889414, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538255278257241, "mean_inference_ms": 5.241942740855309, "mean_action_processing_ms": 0.14462134298733673, "mean_env_wait_ms": 0.2551404724405309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015227172685706097, "StateBufferConnector_ms": 0.002300739288330078, "ViewRequirementAgentConnector_ms": 0.05954737248628036}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912, "num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 30912, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 30912, "timers": {"training_iteration_time_ms": 1962.967, "learn_time_ms": 19.259, "learn_throughput": 17446.432, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 30912, "num_env_steps_trained": 30912, "num_agent_steps_sampled": 30912, "num_agent_steps_trained": 30912}, "done": false, "episodes_total": 92, "training_iteration": 92, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-36", "timestamp": 1711724436, "time_this_iter_s": 1.9498236179351807, "time_total_s": 181.23906993865967, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1d900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 181.23906993865967, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 18.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9694349399364887e+32, "policy_entropy": 3693.001220703125, "var_gnorm": 22.712215423583984, "vf_loss": 834794684416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013315677642822266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 93, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320213.98125446314, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382559079960118, "mean_inference_ms": 5.241952797898157, "mean_action_processing_ms": 0.14461695265679064, "mean_env_wait_ms": 0.25512363588985243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015218027176395539, "StateBufferConnector_ms": 0.0023011238344254033, "ViewRequirementAgentConnector_ms": 0.05953158101727886}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320213.98125446314, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382559079960118, "mean_inference_ms": 5.241952797898157, "mean_action_processing_ms": 0.14461695265679064, "mean_env_wait_ms": 0.25512363588985243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015218027176395539, "StateBufferConnector_ms": 0.0023011238344254033, "ViewRequirementAgentConnector_ms": 0.05953158101727886}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248, "num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31248, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31248, "timers": {"training_iteration_time_ms": 1961.55, "learn_time_ms": 18.948, "learn_throughput": 17732.758, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 31248, "num_env_steps_trained": 31248, "num_agent_steps_sampled": 31248, "num_agent_steps_trained": 31248}, "done": false, "episodes_total": 93, "training_iteration": 93, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-38", "timestamp": 1711724438, "time_this_iter_s": 1.9592809677124023, "time_total_s": 183.19835090637207, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94af0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b03880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 183.19835090637207, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.046435716817978e+32, "policy_entropy": 3690.93896484375, "var_gnorm": 22.712221145629883, "vf_loss": 883875184640.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001462697982788086, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 94, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320214.3397681217, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382542915626288, "mean_inference_ms": 5.241954381935324, "mean_action_processing_ms": 0.14461252561128374, "mean_env_wait_ms": 0.255106730008929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015204257153450175, "StateBufferConnector_ms": 0.0023012465619026345, "ViewRequirementAgentConnector_ms": 0.05953869921095828}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320214.3397681217, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382542915626288, "mean_inference_ms": 5.241954381935324, "mean_action_processing_ms": 0.14461252561128374, "mean_env_wait_ms": 0.255106730008929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015204257153450175, "StateBufferConnector_ms": 0.0023012465619026345, "ViewRequirementAgentConnector_ms": 0.05953869921095828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584, "num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31584, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31584, "timers": {"training_iteration_time_ms": 1960.982, "learn_time_ms": 18.902, "learn_throughput": 17775.837, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 31584, "num_env_steps_trained": 31584, "num_agent_steps_sampled": 31584, "num_agent_steps_trained": 31584}, "done": false, "episodes_total": 94, "training_iteration": 94, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-40", "timestamp": 1711724440, "time_this_iter_s": 1.9420545101165771, "time_total_s": 185.14040541648865, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3dc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1caf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 185.14040541648865, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.192653587028541e+31, "policy_entropy": 3692.466796875, "var_gnorm": 22.712223052978516, "vf_loss": 777923854336.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001380443572998047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 95, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320081.3120839159, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382512241136115, "mean_inference_ms": 5.24194829132281, "mean_action_processing_ms": 0.14460797915880633, "mean_env_wait_ms": 0.25508971581151796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518450285259046, "StateBufferConnector_ms": 0.002299860904091283, "ViewRequirementAgentConnector_ms": 0.05951304184763055}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320081.3120839159, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382512241136115, "mean_inference_ms": 5.24194829132281, "mean_action_processing_ms": 0.14460797915880633, "mean_env_wait_ms": 0.25508971581151796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518450285259046, "StateBufferConnector_ms": 0.002299860904091283, "ViewRequirementAgentConnector_ms": 0.05951304184763055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920, "num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 31920, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 31920, "timers": {"training_iteration_time_ms": 1958.563, "learn_time_ms": 18.85, "learn_throughput": 17824.873, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 31920, "num_env_steps_trained": 31920, "num_agent_steps_sampled": 31920, "num_agent_steps_trained": 31920}, "done": false, "episodes_total": 95, "training_iteration": 95, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-42", "timestamp": 1711724442, "time_this_iter_s": 1.9427621364593506, "time_total_s": 187.083167552948, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c966e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 187.083167552948, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2441098495656534e+32, "policy_entropy": 3692.729736328125, "var_gnorm": 22.71222496032715, "vf_loss": 1027482320896.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013959407806396484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 96, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320353.0060088637, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382469756279496, "mean_inference_ms": 5.24193986098989, "mean_action_processing_ms": 0.14460336799396686, "mean_env_wait_ms": 0.25507275538618135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174100796381632, "StateBufferConnector_ms": 0.0022999942302703857, "ViewRequirementAgentConnector_ms": 0.059504558642705284}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320353.0060088637, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382469756279496, "mean_inference_ms": 5.24193986098989, "mean_action_processing_ms": 0.14460336799396686, "mean_env_wait_ms": 0.25507275538618135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015174100796381632, "StateBufferConnector_ms": 0.0022999942302703857, "ViewRequirementAgentConnector_ms": 0.059504558642705284}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32256, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 1954.384, "learn_time_ms": 18.889, "learn_throughput": 17788.043, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 96, "training_iteration": 96, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-44", "timestamp": 1711724444, "time_this_iter_s": 1.9595460891723633, "time_total_s": 189.04271364212036, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1d900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 189.04271364212036, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.65, "ram_util_percent": 18.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6497019474806567e+32, "policy_entropy": 3692.329345703125, "var_gnorm": 22.712228775024414, "vf_loss": 950875324416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011098384857177734, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 97, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320418.71218529285, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382432203578436, "mean_inference_ms": 5.2419318125007806, "mean_action_processing_ms": 0.14459891991404802, "mean_env_wait_ms": 0.25505621194339223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01517177857074541, "StateBufferConnector_ms": 0.0022996332227569263, "ViewRequirementAgentConnector_ms": 0.05950853996670123}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320418.71218529285, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382432203578436, "mean_inference_ms": 5.2419318125007806, "mean_action_processing_ms": 0.14459891991404802, "mean_env_wait_ms": 0.25505621194339223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01517177857074541, "StateBufferConnector_ms": 0.0022996332227569263, "ViewRequirementAgentConnector_ms": 0.05950853996670123}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592, "num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32592, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32592, "timers": {"training_iteration_time_ms": 1954.73, "learn_time_ms": 18.894, "learn_throughput": 17783.8, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 32592, "num_env_steps_trained": 32592, "num_agent_steps_sampled": 32592, "num_agent_steps_trained": 32592}, "done": false, "episodes_total": 97, "training_iteration": 97, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-46", "timestamp": 1711724446, "time_this_iter_s": 1.9705109596252441, "time_total_s": 191.0132246017456, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96f80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1c3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 191.0132246017456, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 18.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.464708122935179e+32, "policy_entropy": 3691.69775390625, "var_gnorm": 22.712230682373047, "vf_loss": 973367672832.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010693073272705078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 98, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320495.7049696057, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382392427423647, "mean_inference_ms": 5.2419209744872575, "mean_action_processing_ms": 0.14459454484521683, "mean_env_wait_ms": 0.25504000796901405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515806937704281, "StateBufferConnector_ms": 0.0022990362984793527, "ViewRequirementAgentConnector_ms": 0.05949541014067981}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320495.7049696057, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382392427423647, "mean_inference_ms": 5.2419209744872575, "mean_action_processing_ms": 0.14459454484521683, "mean_env_wait_ms": 0.25504000796901405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01515806937704281, "StateBufferConnector_ms": 0.0022990362984793527, "ViewRequirementAgentConnector_ms": 0.05949541014067981}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928, "num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 32928, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 32928, "timers": {"training_iteration_time_ms": 1953.808, "learn_time_ms": 18.817, "learn_throughput": 17855.746, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 32928, "num_env_steps_trained": 32928, "num_agent_steps_sampled": 32928, "num_agent_steps_trained": 32928}, "done": false, "episodes_total": 98, "training_iteration": 98, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-48", "timestamp": 1711724448, "time_this_iter_s": 1.9584486484527588, "time_total_s": 192.97167325019836, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb26b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1e9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 192.97167325019836, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 18.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.835655761500964e+32, "policy_entropy": 3691.279541015625, "var_gnorm": 22.71223258972168, "vf_loss": 905439215616.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016379356384277344, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 99, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320649.0508591065, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538231772318353, "mean_inference_ms": 5.241903338683157, "mean_action_processing_ms": 0.14458993845785095, "mean_env_wait_ms": 0.2550237109953882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015166070726182725, "StateBufferConnector_ms": 0.002300378048058712, "ViewRequirementAgentConnector_ms": 0.059551181215228455}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320649.0508591065, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538231772318353, "mean_inference_ms": 5.241903338683157, "mean_action_processing_ms": 0.14458993845785095, "mean_env_wait_ms": 0.2550237109953882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015166070726182725, "StateBufferConnector_ms": 0.002300378048058712, "ViewRequirementAgentConnector_ms": 0.059551181215228455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264, "num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33264, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33264, "timers": {"training_iteration_time_ms": 1952.241, "learn_time_ms": 18.819, "learn_throughput": 17853.958, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 33264, "num_env_steps_trained": 33264, "num_agent_steps_sampled": 33264, "num_agent_steps_trained": 33264}, "done": false, "episodes_total": 99, "training_iteration": 99, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-50", "timestamp": 1711724450, "time_this_iter_s": 1.9417359828948975, "time_total_s": 194.91340923309326, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6c2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1e7a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 194.91340923309326, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 18.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.85445742906658e+32, "policy_entropy": 3691.7265625, "var_gnorm": 22.712234497070312, "vf_loss": 770520776704.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012886524200439453, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 100, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320428.51767980604, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538224743145269, "mean_inference_ms": 5.241887271631235, "mean_action_processing_ms": 0.144585422963, "mean_env_wait_ms": 0.2550077910773251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015159845352172852, "StateBufferConnector_ms": 0.002299070358276367, "ViewRequirementAgentConnector_ms": 0.05956006050109863}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -559125.1054484426, "episode_reward_mean": -320428.51767980604, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-559125.1054484426, -439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538224743145269, "mean_inference_ms": 5.241887271631235, "mean_action_processing_ms": 0.144585422963, "mean_env_wait_ms": 0.2550077910773251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015159845352172852, "StateBufferConnector_ms": 0.002299070358276367, "ViewRequirementAgentConnector_ms": 0.05956006050109863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600, "num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33600, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 1954.509, "learn_time_ms": 18.826, "learn_throughput": 17848.102, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 33600, "num_env_steps_trained": 33600, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 33600}, "done": false, "episodes_total": 100, "training_iteration": 100, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-52", "timestamp": 1711724452, "time_this_iter_s": 1.972569227218628, "time_total_s": 196.8859784603119, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2440>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1f520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 196.8859784603119, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 18.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4483983899830185e+32, "policy_entropy": 3692.541748046875, "var_gnorm": 22.712236404418945, "vf_loss": 858650836992.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012969970703125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 101, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -439268.71239131974, "episode_reward_mean": -317864.08585826086, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153781657997155, "mean_inference_ms": 5.24165722215607, "mean_action_processing_ms": 0.1445513741090889, "mean_env_wait_ms": 0.25487596287865694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150785446166992, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.059530019760131836}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -439268.71239131974, "episode_reward_mean": -317864.08585826086, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-439268.71239131974, -275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153781657997155, "mean_inference_ms": 5.24165722215607, "mean_action_processing_ms": 0.1445513741090889, "mean_env_wait_ms": 0.25487596287865694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015150785446166992, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.059530019760131836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936, "num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 33936, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 33936, "timers": {"training_iteration_time_ms": 1954.3, "learn_time_ms": 19.131, "learn_throughput": 17563.321, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 33936, "num_env_steps_trained": 33936, "num_agent_steps_sampled": 33936, "num_agent_steps_trained": 33936}, "done": false, "episodes_total": 101, "training_iteration": 101, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-54", "timestamp": 1711724454, "time_this_iter_s": 1.9509506225585938, "time_total_s": 198.83692908287048, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b03eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 198.83692908287048, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 18.866666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.9880114239761062e+32, "policy_entropy": 3692.951416015625, "var_gnorm": 22.712236404418945, "vf_loss": 925890969600.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011682510375976562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 102, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -316628.00413817615, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374289823400356, "mean_inference_ms": 5.241475966565093, "mean_action_processing_ms": 0.14451871289030818, "mean_env_wait_ms": 0.25477085143963757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513051986694336, "StateBufferConnector_ms": 0.0022890567779541016, "ViewRequirementAgentConnector_ms": 0.059528350830078125}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -316628.00413817615, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275573.90661837894, -266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374289823400356, "mean_inference_ms": 5.241475966565093, "mean_action_processing_ms": 0.14451871289030818, "mean_env_wait_ms": 0.25477085143963757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01513051986694336, "StateBufferConnector_ms": 0.0022890567779541016, "ViewRequirementAgentConnector_ms": 0.059528350830078125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272, "num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34272, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34272, "timers": {"training_iteration_time_ms": 1957.228, "learn_time_ms": 19.158, "learn_throughput": 17538.687, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 34272, "num_env_steps_trained": 34272, "num_agent_steps_sampled": 34272, "num_agent_steps_trained": 34272}, "done": false, "episodes_total": 102, "training_iteration": 102, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-56", "timestamp": 1711724456, "time_this_iter_s": 1.979135513305664, "time_total_s": 200.81606459617615, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 200.81606459617615, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 18.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.300120292056333e+31, "policy_entropy": 3693.641845703125, "var_gnorm": 22.712238311767578, "vf_loss": 994981904384.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001035928726196289, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 103, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317219.7581170247, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371160686352636, "mean_inference_ms": 5.2413751874756205, "mean_action_processing_ms": 0.14449080918358267, "mean_env_wait_ms": 0.2546748189057231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015133857727050781, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.05952739715576172}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317219.7581170247, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-266976.2134107319, -289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371160686352636, "mean_inference_ms": 5.2413751874756205, "mean_action_processing_ms": 0.14449080918358267, "mean_env_wait_ms": 0.2546748189057231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015133857727050781, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.05952739715576172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608, "num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34608, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34608, "timers": {"training_iteration_time_ms": 1959.886, "learn_time_ms": 19.171, "learn_throughput": 17526.473, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 34608, "num_env_steps_trained": 34608, "num_agent_steps_sampled": 34608, "num_agent_steps_trained": 34608}, "done": false, "episodes_total": 103, "training_iteration": 103, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-00-58", "timestamp": 1711724458, "time_this_iter_s": 1.9858601093292236, "time_total_s": 202.80192470550537, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97d30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1fd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 202.80192470550537, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.266666666666667, "ram_util_percent": 19.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5684636798276028e+32, "policy_entropy": 3692.393310546875, "var_gnorm": 22.71224021911621, "vf_loss": 990673633280.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012540817260742188, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 104, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317909.5610477164, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537020682668251, "mean_inference_ms": 5.241491990912676, "mean_action_processing_ms": 0.1444769902855322, "mean_env_wait_ms": 0.25460734133222174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514291763305664, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.059615373611450195}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317909.5610477164, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-289914.0847733873, -276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537020682668251, "mean_inference_ms": 5.241491990912676, "mean_action_processing_ms": 0.1444769902855322, "mean_env_wait_ms": 0.25460734133222174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514291763305664, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.059615373611450195}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944, "num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 34944, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 34944, "timers": {"training_iteration_time_ms": 1962.685, "learn_time_ms": 19.263, "learn_throughput": 17442.934, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 34944, "num_env_steps_trained": 34944, "num_agent_steps_sampled": 34944, "num_agent_steps_trained": 34944}, "done": false, "episodes_total": 104, "training_iteration": 104, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-00", "timestamp": 1711724460, "time_this_iter_s": 1.9700472354888916, "time_total_s": 204.77197194099426, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b01e10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 204.77197194099426, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 19.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.435950549213095e+32, "policy_entropy": 3693.042724609375, "var_gnorm": 22.712242126464844, "vf_loss": 859003092992.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013720989227294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 105, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318163.56814847566, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15369930083612404, "mean_inference_ms": 5.24162616314471, "mean_action_processing_ms": 0.1444665093366131, "mean_env_wait_ms": 0.25454507961577133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015138626098632812, "StateBufferConnector_ms": 0.0022857189178466797, "ViewRequirementAgentConnector_ms": 0.05961465835571289}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318163.56814847566, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276819.5769572456, -324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15369930083612404, "mean_inference_ms": 5.24162616314471, "mean_action_processing_ms": 0.1444665093366131, "mean_env_wait_ms": 0.25454507961577133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015138626098632812, "StateBufferConnector_ms": 0.0022857189178466797, "ViewRequirementAgentConnector_ms": 0.05961465835571289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280, "num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35280, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35280, "timers": {"training_iteration_time_ms": 1967.225, "learn_time_ms": 19.361, "learn_throughput": 17354.48, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 35280, "num_env_steps_trained": 35280, "num_agent_steps_sampled": 35280, "num_agent_steps_trained": 35280}, "done": false, "episodes_total": 105, "training_iteration": 105, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-02", "timestamp": 1711724462, "time_this_iter_s": 1.9881975650787354, "time_total_s": 206.760169506073, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1f5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 206.760169506073, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0054116051875644e+32, "policy_entropy": 3693.5556640625, "var_gnorm": 22.712242126464844, "vf_loss": 843165466624.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012814998626708984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 106, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318488.57522918755, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536991053698635, "mean_inference_ms": 5.241737184119078, "mean_action_processing_ms": 0.1444565920645015, "mean_env_wait_ms": 0.2544916426948922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514124870300293, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.059628963470458984}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318488.57522918755, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-324166.8027302311, -325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536991053698635, "mean_inference_ms": 5.241737184119078, "mean_action_processing_ms": 0.1444565920645015, "mean_env_wait_ms": 0.2544916426948922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01514124870300293, "StateBufferConnector_ms": 0.0022859573364257812, "ViewRequirementAgentConnector_ms": 0.059628963470458984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616, "num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35616, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35616, "timers": {"training_iteration_time_ms": 1967.257, "learn_time_ms": 19.315, "learn_throughput": 17396.146, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 35616, "num_env_steps_trained": 35616, "num_agent_steps_sampled": 35616, "num_agent_steps_trained": 35616}, "done": false, "episodes_total": 106, "training_iteration": 106, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-04", "timestamp": 1711724464, "time_this_iter_s": 1.9598808288574219, "time_total_s": 208.72005033493042, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b684c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 208.72005033493042, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 19.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.058463685817917e+32, "policy_entropy": 3691.27099609375, "var_gnorm": 22.712244033813477, "vf_loss": 970845913088.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010800361633300781, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 107, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318580.40559953486, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537003323145213, "mean_inference_ms": 5.241808818122614, "mean_action_processing_ms": 0.14444761924823274, "mean_env_wait_ms": 0.25444033294771007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512598991394043, "StateBufferConnector_ms": 0.0022852420806884766, "ViewRequirementAgentConnector_ms": 0.05965137481689453}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318580.40559953486, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-325061.39115275285, -317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537003323145213, "mean_inference_ms": 5.241808818122614, "mean_action_processing_ms": 0.14444761924823274, "mean_env_wait_ms": 0.25444033294771007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512598991394043, "StateBufferConnector_ms": 0.0022852420806884766, "ViewRequirementAgentConnector_ms": 0.05965137481689453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952, "num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 35952, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 35952, "timers": {"training_iteration_time_ms": 1967.716, "learn_time_ms": 19.286, "learn_throughput": 17421.587, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 35952, "num_env_steps_trained": 35952, "num_agent_steps_sampled": 35952, "num_agent_steps_trained": 35952}, "done": false, "episodes_total": 107, "training_iteration": 107, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-06", "timestamp": 1711724466, "time_this_iter_s": 1.975114345550537, "time_total_s": 210.69516468048096, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5fca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1fd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 210.69516468048096, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 19.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2231492035629783e+32, "policy_entropy": 3692.0859375, "var_gnorm": 22.712244033813477, "vf_loss": 922319192064.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015437602996826172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 108, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318491.2439633658, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537027117422573, "mean_inference_ms": 5.241848484616394, "mean_action_processing_ms": 0.1444389767501835, "mean_env_wait_ms": 0.2543946733554723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.002283811569213867, "ViewRequirementAgentConnector_ms": 0.059647560119628906}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318491.2439633658, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317352.14092195843, -252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537027117422573, "mean_inference_ms": 5.241848484616394, "mean_action_processing_ms": 0.1444389767501835, "mean_env_wait_ms": 0.2543946733554723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.002283811569213867, "ViewRequirementAgentConnector_ms": 0.059647560119628906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288, "num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36288, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36288, "timers": {"training_iteration_time_ms": 1968.06, "learn_time_ms": 19.336, "learn_throughput": 17377.205, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 36288, "num_env_steps_trained": 36288, "num_agent_steps_sampled": 36288, "num_agent_steps_trained": 36288}, "done": false, "episodes_total": 108, "training_iteration": 108, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-08", "timestamp": 1711724468, "time_this_iter_s": 1.9618887901306152, "time_total_s": 212.65705347061157, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b697e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 212.65705347061157, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 19.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.267046916690937e+32, "policy_entropy": 3692.657958984375, "var_gnorm": 22.71224594116211, "vf_loss": 743283621888.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014078617095947266, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 109, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "sampler_results": {"episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318176.39825717494, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15370711845249832, "mean_inference_ms": 5.241919022884216, "mean_action_processing_ms": 0.14443118732892443, "mean_env_wait_ms": 0.25435189110277534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015110969543457031, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.059659719467163086}}, "episode_reward_max": -252594.59485902925, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318176.39825717494, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-252594.59485902925, -311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15370711845249832, "mean_inference_ms": 5.241919022884216, "mean_action_processing_ms": 0.14443118732892443, "mean_env_wait_ms": 0.25435189110277534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015110969543457031, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.059659719467163086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624, "num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36624, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36624, "timers": {"training_iteration_time_ms": 1970.981, "learn_time_ms": 19.386, "learn_throughput": 17332.005, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 36624, "num_env_steps_trained": 36624, "num_agent_steps_sampled": 36624, "num_agent_steps_trained": 36624}, "done": false, "episodes_total": 109, "training_iteration": 109, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-10", "timestamp": 1711724470, "time_this_iter_s": 1.9709219932556152, "time_total_s": 214.6279754638672, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6fbb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1ecb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 214.6279754638672, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 19.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.731197607273539e+32, "policy_entropy": 3693.20849609375, "var_gnorm": 22.712247848510742, "vf_loss": 742912950272.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014293193817138672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 110, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318602.41089349956, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371275511524973, "mean_inference_ms": 5.241979308763003, "mean_action_processing_ms": 0.1444230841661166, "mean_env_wait_ms": 0.2543119783418025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015117645263671875, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.059691667556762695}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318602.41089349956, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-311312.23313927365, -335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371275511524973, "mean_inference_ms": 5.241979308763003, "mean_action_processing_ms": 0.1444230841661166, "mean_env_wait_ms": 0.2543119783418025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015117645263671875, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.059691667556762695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960, "num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 36960, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 36960, "timers": {"training_iteration_time_ms": 1971.597, "learn_time_ms": 19.427, "learn_throughput": 17295.314, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 36960, "num_env_steps_trained": 36960, "num_agent_steps_sampled": 36960, "num_agent_steps_trained": 36960}, "done": false, "episodes_total": 110, "training_iteration": 110, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-12", "timestamp": 1711724472, "time_this_iter_s": 1.9787049293518066, "time_total_s": 216.606680393219, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b69900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 216.606680393219, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 19.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5653593517509635e+32, "policy_entropy": 3691.9697265625, "var_gnorm": 22.712247848510742, "vf_loss": 790063480832.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001837015151977539, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 111, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318507.9984190859, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371691651780017, "mean_inference_ms": 5.242008497227982, "mean_action_processing_ms": 0.14441420043268416, "mean_env_wait_ms": 0.25427278016199323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015105485916137695, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.059705495834350586}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318507.9984190859, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-335180.81041397556, -319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15371691651780017, "mean_inference_ms": 5.242008497227982, "mean_action_processing_ms": 0.14441420043268416, "mean_env_wait_ms": 0.25427278016199323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015105485916137695, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.059705495834350586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296, "num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37296, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37296, "timers": {"training_iteration_time_ms": 1975.809, "learn_time_ms": 19.168, "learn_throughput": 17528.98, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 37296, "num_env_steps_trained": 37296, "num_agent_steps_sampled": 37296, "num_agent_steps_trained": 37296}, "done": false, "episodes_total": 111, "training_iteration": 111, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-14", "timestamp": 1711724474, "time_this_iter_s": 1.9930849075317383, "time_total_s": 218.59976530075073, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 218.59976530075073, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.400000000000001, "ram_util_percent": 19.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.49134234202197e+33, "policy_entropy": 3691.7236328125, "var_gnorm": 22.712247848510742, "vf_loss": 822658203648.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001348257064819336, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 112, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318104.76013229165, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537210684170046, "mean_inference_ms": 5.242018196522061, "mean_action_processing_ms": 0.14440463652740124, "mean_env_wait_ms": 0.25423341515072573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015095233917236328, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.059693336486816406}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318104.76013229165, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-319898.9585482739, -306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537210684170046, "mean_inference_ms": 5.242018196522061, "mean_action_processing_ms": 0.14440463652740124, "mean_env_wait_ms": 0.25423341515072573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015095233917236328, "StateBufferConnector_ms": 0.002281665802001953, "ViewRequirementAgentConnector_ms": 0.059693336486816406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632, "num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37632, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37632, "timers": {"training_iteration_time_ms": 1976.43, "learn_time_ms": 19.174, "learn_throughput": 17523.64, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 37632, "num_env_steps_trained": 37632, "num_agent_steps_sampled": 37632, "num_agent_steps_trained": 37632}, "done": false, "episodes_total": 112, "training_iteration": 112, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-16", "timestamp": 1711724476, "time_this_iter_s": 1.9853777885437012, "time_total_s": 220.58514308929443, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b69000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 220.58514308929443, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 19.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.02427604301173e+32, "policy_entropy": 3691.635009765625, "var_gnorm": 22.712249755859375, "vf_loss": 745963061248.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013685226440429688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 113, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317957.45069370343, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372344188171383, "mean_inference_ms": 5.242050820200247, "mean_action_processing_ms": 0.14439506247228548, "mean_env_wait_ms": 0.2541954015493188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015073299407958984, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.0597071647644043}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317957.45069370343, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-306502.33241008094, -346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372344188171383, "mean_inference_ms": 5.242050820200247, "mean_action_processing_ms": 0.14439506247228548, "mean_env_wait_ms": 0.2541954015493188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015073299407958984, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.0597071647644043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 37968, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 1977.242, "learn_time_ms": 19.2, "learn_throughput": 17499.573, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 113, "training_iteration": 113, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-18", "timestamp": 1711724478, "time_this_iter_s": 1.9940223693847656, "time_total_s": 222.5791654586792, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 222.5791654586792, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 19.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.986784476158942e+32, "policy_entropy": 3691.19677734375, "var_gnorm": 22.712249755859375, "vf_loss": 852317175808.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001437664031982422, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 114, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318007.8654435852, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372645515678202, "mean_inference_ms": 5.242083719251437, "mean_action_processing_ms": 0.1443859890345306, "mean_env_wait_ms": 0.254160614790832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015063047409057617, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.059717655181884766}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318007.8654435852, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-346597.099667136, -294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15372645515678202, "mean_inference_ms": 5.242083719251437, "mean_action_processing_ms": 0.1443859890345306, "mean_env_wait_ms": 0.254160614790832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015063047409057617, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.059717655181884766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304, "num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38304, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38304, "timers": {"training_iteration_time_ms": 1978.88, "learn_time_ms": 19.187, "learn_throughput": 17512.12, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 38304, "num_env_steps_trained": 38304, "num_agent_steps_sampled": 38304, "num_agent_steps_trained": 38304}, "done": false, "episodes_total": 114, "training_iteration": 114, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-20", "timestamp": 1711724480, "time_this_iter_s": 1.9864113330841064, "time_total_s": 224.5655767917633, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96ce0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 224.5655767917633, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3999999999999995, "ram_util_percent": 19.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.405178266918418e+32, "policy_entropy": 3693.82470703125, "var_gnorm": 22.712251663208008, "vf_loss": 780347310080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016069412231445312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 115, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317648.9101660698, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537298684679592, "mean_inference_ms": 5.2421176580031865, "mean_action_processing_ms": 0.1443773194418622, "mean_env_wait_ms": 0.2541285264816604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015078067779541016, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05975794792175293}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317648.9101660698, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-294022.62510751095, -340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537298684679592, "mean_inference_ms": 5.2421176580031865, "mean_action_processing_ms": 0.1443773194418622, "mean_env_wait_ms": 0.2541285264816604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015078067779541016, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05975794792175293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38640, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 1978.894, "learn_time_ms": 19.172, "learn_throughput": 17525.361, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 115, "training_iteration": 115, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-22", "timestamp": 1711724482, "time_this_iter_s": 1.9883666038513184, "time_total_s": 226.55394339561462, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb18a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6aa70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 226.55394339561462, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.583784707717445e+32, "policy_entropy": 3693.092529296875, "var_gnorm": 22.712251663208008, "vf_loss": 954331299840.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012028217315673828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 116, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318028.5648449639, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373360703936215, "mean_inference_ms": 5.242157324691151, "mean_action_processing_ms": 0.14436915773075623, "mean_env_wait_ms": 0.2540995065810856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015081405639648438, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05977010726928711}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318028.5648449639, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-340580.0451443377, -317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373360703936215, "mean_inference_ms": 5.242157324691151, "mean_action_processing_ms": 0.14436915773075623, "mean_env_wait_ms": 0.2540995065810856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015081405639648438, "StateBufferConnector_ms": 0.00228118896484375, "ViewRequirementAgentConnector_ms": 0.05977010726928711}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976, "num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 38976, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 38976, "timers": {"training_iteration_time_ms": 1982.825, "learn_time_ms": 19.223, "learn_throughput": 17479.453, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 38976, "num_env_steps_trained": 38976, "num_agent_steps_sampled": 38976, "num_agent_steps_trained": 38976}, "done": false, "episodes_total": 116, "training_iteration": 116, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-24", "timestamp": 1711724484, "time_this_iter_s": 1.9992103576660156, "time_total_s": 228.55315375328064, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95390>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b1fbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 228.55315375328064, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 20.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.927811206759536e+32, "policy_entropy": 3690.640869140625, "var_gnorm": 22.712251663208008, "vf_loss": 767041470464.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012171268463134766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 117, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317519.75108166825, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373725697669116, "mean_inference_ms": 5.242194760882672, "mean_action_processing_ms": 0.14436119524390897, "mean_env_wait_ms": 0.2540719443622241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015076875686645508, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.05975079536437988}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317519.75108166825, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317697.4566660109, -294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15373725697669116, "mean_inference_ms": 5.242194760882672, "mean_action_processing_ms": 0.14436119524390897, "mean_env_wait_ms": 0.2540719443622241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015076875686645508, "StateBufferConnector_ms": 0.0022797584533691406, "ViewRequirementAgentConnector_ms": 0.05975079536437988}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312, "num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39312, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39312, "timers": {"training_iteration_time_ms": 1983.09, "learn_time_ms": 19.203, "learn_throughput": 17497.509, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 39312, "num_env_steps_trained": 39312, "num_agent_steps_sampled": 39312, "num_agent_steps_trained": 39312}, "done": false, "episodes_total": 117, "training_iteration": 117, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-26", "timestamp": 1711724486, "time_this_iter_s": 1.9777162075042725, "time_total_s": 230.5308699607849, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2c80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b69870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 230.5308699607849, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 20.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.377969626829146e+32, "policy_entropy": 3691.177978515625, "var_gnorm": 22.712251663208008, "vf_loss": 1112836669440.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012195110321044922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 118, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317893.3527130034, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374034862232996, "mean_inference_ms": 5.242223249761364, "mean_action_processing_ms": 0.14435251474667557, "mean_env_wait_ms": 0.2540437370434958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015067338943481445, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.059762001037597656}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317893.3527130034, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-294840.36628740065, -329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374034862232996, "mean_inference_ms": 5.242223249761364, "mean_action_processing_ms": 0.14435251474667557, "mean_env_wait_ms": 0.2540437370434958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015067338943481445, "StateBufferConnector_ms": 0.002278566360473633, "ViewRequirementAgentConnector_ms": 0.059762001037597656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648, "num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39648, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39648, "timers": {"training_iteration_time_ms": 1985.599, "learn_time_ms": 19.188, "learn_throughput": 17510.945, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 39648, "num_env_steps_trained": 39648, "num_agent_steps_sampled": 39648, "num_agent_steps_trained": 39648}, "done": false, "episodes_total": 118, "training_iteration": 118, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-28", "timestamp": 1711724488, "time_this_iter_s": 1.9869749546051025, "time_total_s": 232.51784491539001, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95120>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 232.51784491539001, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 20.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5805018729971285e+32, "policy_entropy": 3692.31982421875, "var_gnorm": 22.712251663208008, "vf_loss": 837494702080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012814998626708984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 119, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317979.8650288306, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537426962700278, "mean_inference_ms": 5.242234872704899, "mean_action_processing_ms": 0.14434401734166255, "mean_env_wait_ms": 0.2540157094183089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508021354675293, "StateBufferConnector_ms": 0.0022802352905273438, "ViewRequirementAgentConnector_ms": 0.05977463722229004}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317979.8650288306, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-329940.32781233505, -306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537426962700278, "mean_inference_ms": 5.242234872704899, "mean_action_processing_ms": 0.14434401734166255, "mean_env_wait_ms": 0.2540157094183089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508021354675293, "StateBufferConnector_ms": 0.0022802352905273438, "ViewRequirementAgentConnector_ms": 0.05977463722229004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984, "num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 39984, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 39984, "timers": {"training_iteration_time_ms": 1988.408, "learn_time_ms": 19.168, "learn_throughput": 17529.307, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 39984, "num_env_steps_trained": 39984, "num_agent_steps_sampled": 39984, "num_agent_steps_trained": 39984}, "done": false, "episodes_total": 119, "training_iteration": 119, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-30", "timestamp": 1711724490, "time_this_iter_s": 1.9990427494049072, "time_total_s": 234.51688766479492, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6bac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 234.51688766479492, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 20.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2078458716728576e+33, "policy_entropy": 3690.916748046875, "var_gnorm": 22.712251663208008, "vf_loss": 808931426304.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013911724090576172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 120, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317666.33236279746, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374510997579274, "mean_inference_ms": 5.2422576181774945, "mean_action_processing_ms": 0.1443357345653078, "mean_env_wait_ms": 0.2539896610645147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508641242980957, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.05979156494140625}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -317666.33236279746, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-306844.12259683025, -302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374510997579274, "mean_inference_ms": 5.2422576181774945, "mean_action_processing_ms": 0.1443357345653078, "mean_env_wait_ms": 0.2539896610645147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01508641242980957, "StateBufferConnector_ms": 0.002280712127685547, "ViewRequirementAgentConnector_ms": 0.05979156494140625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320, "num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40320, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40320, "timers": {"training_iteration_time_ms": 1989.533, "learn_time_ms": 19.134, "learn_throughput": 17560.235, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 40320, "num_env_steps_trained": 40320, "num_agent_steps_sampled": 40320, "num_agent_steps_trained": 40320}, "done": false, "episodes_total": 120, "training_iteration": 120, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-32", "timestamp": 1711724492, "time_this_iter_s": 1.9899418354034424, "time_total_s": 236.50682950019836, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6bd00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 236.50682950019836, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 20.466666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.670998583807109e+32, "policy_entropy": 3693.7548828125, "var_gnorm": 22.712251663208008, "vf_loss": 1163082465280.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010907649993896484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 121, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318337.87421026954, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374781773593807, "mean_inference_ms": 5.242276930805378, "mean_action_processing_ms": 0.14432745459940607, "mean_env_wait_ms": 0.2539641378997903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015092134475708008, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.059798240661621094}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318337.87421026954, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-302598.3098191821, -328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15374781773593807, "mean_inference_ms": 5.242276930805378, "mean_action_processing_ms": 0.14432745459940607, "mean_env_wait_ms": 0.2539641378997903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015092134475708008, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.059798240661621094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656, "num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40656, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40656, "timers": {"training_iteration_time_ms": 1987.815, "learn_time_ms": 19.195, "learn_throughput": 17504.29, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 40656, "num_env_steps_trained": 40656, "num_agent_steps_sampled": 40656, "num_agent_steps_trained": 40656}, "done": false, "episodes_total": 121, "training_iteration": 121, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-34", "timestamp": 1711724494, "time_this_iter_s": 1.9758975505828857, "time_total_s": 238.48272705078125, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a5f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 238.48272705078125, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 20.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2095452096718877e+32, "policy_entropy": 3690.96044921875, "var_gnorm": 22.712251663208008, "vf_loss": 789940469760.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014531612396240234, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 122, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318334.2316578915, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375108822632877, "mean_inference_ms": 5.242309365614371, "mean_action_processing_ms": 0.14432034599308888, "mean_env_wait_ms": 0.2539399271638206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015094757080078125, "StateBufferConnector_ms": 0.0022802352905273438, "ViewRequirementAgentConnector_ms": 0.059792518615722656}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318334.2316578915, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-328355.9077522053, -281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375108822632877, "mean_inference_ms": 5.242309365614371, "mean_action_processing_ms": 0.14432034599308888, "mean_env_wait_ms": 0.2539399271638206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015094757080078125, "StateBufferConnector_ms": 0.0022802352905273438, "ViewRequirementAgentConnector_ms": 0.059792518615722656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992, "num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 40992, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 40992, "timers": {"training_iteration_time_ms": 1986.892, "learn_time_ms": 19.168, "learn_throughput": 17529.35, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 40992, "num_env_steps_trained": 40992, "num_agent_steps_sampled": 40992, "num_agent_steps_trained": 40992}, "done": false, "episodes_total": 122, "training_iteration": 122, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-36", "timestamp": 1711724496, "time_this_iter_s": 1.9760935306549072, "time_total_s": 240.45882058143616, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2d40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba4e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 240.45882058143616, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 20.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6652736525684642e+32, "policy_entropy": 3692.78759765625, "var_gnorm": 22.71225357055664, "vf_loss": 1037394247680.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011801719665527344, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 123, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318377.89129190583, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375496622406318, "mean_inference_ms": 5.242366769827332, "mean_action_processing_ms": 0.1443140811623137, "mean_env_wait_ms": 0.2539175306903881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106439590454102, "StateBufferConnector_ms": 0.0022804737091064453, "ViewRequirementAgentConnector_ms": 0.05979728698730469}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318377.89129190583, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-281826.9564849384, -340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375496622406318, "mean_inference_ms": 5.242366769827332, "mean_action_processing_ms": 0.1443140811623137, "mean_env_wait_ms": 0.2539175306903881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015106439590454102, "StateBufferConnector_ms": 0.0022804737091064453, "ViewRequirementAgentConnector_ms": 0.05979728698730469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328, "num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41328, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41328, "timers": {"training_iteration_time_ms": 1984.814, "learn_time_ms": 19.144, "learn_throughput": 17551.487, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 41328, "num_env_steps_trained": 41328, "num_agent_steps_sampled": 41328, "num_agent_steps_trained": 41328}, "done": false, "episodes_total": 123, "training_iteration": 123, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-38", "timestamp": 1711724498, "time_this_iter_s": 1.97322416305542, "time_total_s": 242.43204474449158, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95c30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6b880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 242.43204474449158, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 20.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.4668532380795085e+32, "policy_entropy": 3693.9404296875, "var_gnorm": 22.71225357055664, "vf_loss": 751655518208.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001513957977294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 124, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318492.20875399443, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375856826946485, "mean_inference_ms": 5.242424764031596, "mean_action_processing_ms": 0.14430784386218168, "mean_env_wait_ms": 0.2538958074406492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.0022814273834228516, "ViewRequirementAgentConnector_ms": 0.05980205535888672}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318492.20875399443, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-340611.7022498346, -317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15375856826946485, "mean_inference_ms": 5.242424764031596, "mean_action_processing_ms": 0.14430784386218168, "mean_env_wait_ms": 0.2538958074406492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.0022814273834228516, "ViewRequirementAgentConnector_ms": 0.05980205535888672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664, "num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 41664, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 41664, "timers": {"training_iteration_time_ms": 1983.143, "learn_time_ms": 19.097, "learn_throughput": 17594.524, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 41664, "num_env_steps_trained": 41664, "num_agent_steps_sampled": 41664, "num_agent_steps_trained": 41664}, "done": false, "episodes_total": 124, "training_iteration": 124, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-40", "timestamp": 1711724500, "time_this_iter_s": 1.9696903228759766, "time_total_s": 244.40173506736755, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2e00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba48b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 244.40173506736755, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 20.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.3197616861819475e+32, "policy_entropy": 3692.78369140625, "var_gnorm": 22.71225357055664, "vf_loss": 903873036288.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010132789611816406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 125, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318149.59266162536, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537624979843265, "mean_inference_ms": 5.24248880795226, "mean_action_processing_ms": 0.14430221344931024, "mean_env_wait_ms": 0.2538756013791997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.05981945991516113}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318149.59266162536, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317219.2456901043, -330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537624979843265, "mean_inference_ms": 5.24248880795226, "mean_action_processing_ms": 0.14430221344931024, "mean_env_wait_ms": 0.2538756013791997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015102863311767578, "StateBufferConnector_ms": 0.002282381057739258, "ViewRequirementAgentConnector_ms": 0.05981945991516113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42000, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 1982.15, "learn_time_ms": 19.048, "learn_throughput": 17639.405, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 125, "training_iteration": 125, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-42", "timestamp": 1711724502, "time_this_iter_s": 1.9784274101257324, "time_total_s": 246.3801624774933, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2320>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6ba30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 246.3801624774933, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 20.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5043345172299973e+32, "policy_entropy": 3693.14111328125, "var_gnorm": 22.71225357055664, "vf_loss": 974233272320.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014126300811767578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 126, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318309.27867898677, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537667330855509, "mean_inference_ms": 5.242553785865382, "mean_action_processing_ms": 0.14429719592599816, "mean_env_wait_ms": 0.25385723288969575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015092611312866211, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.059828758239746094}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318309.27867898677, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-330369.5326664871, -275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537667330855509, "mean_inference_ms": 5.242553785865382, "mean_action_processing_ms": 0.14429719592599816, "mean_env_wait_ms": 0.25385723288969575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015092611312866211, "StateBufferConnector_ms": 0.0022819042205810547, "ViewRequirementAgentConnector_ms": 0.059828758239746094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336, "num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42336, "timers": {"training_iteration_time_ms": 1979.922, "learn_time_ms": 19.163, "learn_throughput": 17534.061, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 42336, "num_env_steps_trained": 42336, "num_agent_steps_sampled": 42336, "num_agent_steps_trained": 42336}, "done": false, "episodes_total": 126, "training_iteration": 126, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-44", "timestamp": 1711724504, "time_this_iter_s": 1.9769339561462402, "time_total_s": 248.35709643363953, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 248.35709643363953, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.533333333333334, "ram_util_percent": 20.966666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.282505140168483e+32, "policy_entropy": 3692.328125, "var_gnorm": 22.71225357055664, "vf_loss": 975344107520.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011229515075683594, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 127, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318380.0851599563, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377097891537025, "mean_inference_ms": 5.242623491908114, "mean_action_processing_ms": 0.14429232892581015, "mean_env_wait_ms": 0.25383916070194373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015090227127075195, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.0598146915435791}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318380.0851599563, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275487.0986502789, -305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377097891537025, "mean_inference_ms": 5.242623491908114, "mean_action_processing_ms": 0.14429232892581015, "mean_env_wait_ms": 0.25383916070194373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015090227127075195, "StateBufferConnector_ms": 0.0022821426391601562, "ViewRequirementAgentConnector_ms": 0.0598146915435791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672, "num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 42672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 42672, "timers": {"training_iteration_time_ms": 1981.15, "learn_time_ms": 19.129, "learn_throughput": 17564.722, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 42672, "num_env_steps_trained": 42672, "num_agent_steps_sampled": 42672, "num_agent_steps_trained": 42672}, "done": false, "episodes_total": 127, "training_iteration": 127, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-46", "timestamp": 1711724506, "time_this_iter_s": 1.9900257587432861, "time_total_s": 250.3471221923828, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2ce0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b00700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 250.3471221923828, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.656813205656534e+32, "policy_entropy": 3691.597412109375, "var_gnorm": 22.71225357055664, "vf_loss": 849777065984.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012111663818359375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 128, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318824.7319615332, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377466759335034, "mean_inference_ms": 5.242684937450451, "mean_action_processing_ms": 0.1442874322302958, "mean_env_wait_ms": 0.25382183495670924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507711410522461, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.05980229377746582}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318824.7319615332, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305882.03520719206, -313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15377466759335034, "mean_inference_ms": 5.242684937450451, "mean_action_processing_ms": 0.1442874322302958, "mean_env_wait_ms": 0.25382183495670924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01507711410522461, "StateBufferConnector_ms": 0.002282857894897461, "ViewRequirementAgentConnector_ms": 0.05980229377746582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 1979.707, "learn_time_ms": 19.144, "learn_throughput": 17551.575, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 128, "training_iteration": 128, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-48", "timestamp": 1711724508, "time_this_iter_s": 1.9725544452667236, "time_total_s": 252.31967663764954, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 252.31967663764954, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.600067808290226e+32, "policy_entropy": 3691.2431640625, "var_gnorm": 22.71225357055664, "vf_loss": 774804799488.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014293193817138672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 129, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318777.88306994847, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537782448052992, "mean_inference_ms": 5.242748133937454, "mean_action_processing_ms": 0.1442822558097794, "mean_env_wait_ms": 0.2538045741893417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015085458755493164, "StateBufferConnector_ms": 0.0022840499877929688, "ViewRequirementAgentConnector_ms": 0.0598301887512207}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318777.88306994847, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-313587.89439627674, -308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537782448052992, "mean_inference_ms": 5.242748133937454, "mean_action_processing_ms": 0.1442822558097794, "mean_env_wait_ms": 0.2538045741893417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015085458755493164, "StateBufferConnector_ms": 0.0022840499877929688, "ViewRequirementAgentConnector_ms": 0.0598301887512207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344, "num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43344, "timers": {"training_iteration_time_ms": 1977.705, "learn_time_ms": 19.115, "learn_throughput": 17577.757, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 43344, "num_env_steps_trained": 43344, "num_agent_steps_sampled": 43344, "num_agent_steps_trained": 43344}, "done": false, "episodes_total": 129, "training_iteration": 129, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-50", "timestamp": 1711724510, "time_this_iter_s": 1.9790410995483398, "time_total_s": 254.29871773719788, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6e6e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6b370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 254.29871773719788, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 21.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.980805778532224e+32, "policy_entropy": 3691.6806640625, "var_gnorm": 22.71225357055664, "vf_loss": 720076275712.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012600421905517578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 130, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318441.0855621574, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378170163418423, "mean_inference_ms": 5.242802519069342, "mean_action_processing_ms": 0.14427716538658542, "mean_env_wait_ms": 0.2537879213343729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015089988708496094, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.05984902381896973}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318441.0855621574, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-308897.87170678726, -330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378170163418423, "mean_inference_ms": 5.242802519069342, "mean_action_processing_ms": 0.14427716538658542, "mean_env_wait_ms": 0.2537879213343729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015089988708496094, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.05984902381896973}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680, "num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 43680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 43680, "timers": {"training_iteration_time_ms": 1977.103, "learn_time_ms": 19.167, "learn_throughput": 17530.004, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 43680, "num_env_steps_trained": 43680, "num_agent_steps_sampled": 43680, "num_agent_steps_trained": 43680}, "done": false, "episodes_total": 130, "training_iteration": 130, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-52", "timestamp": 1711724512, "time_this_iter_s": 1.9839279651641846, "time_total_s": 256.28264570236206, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 256.28264570236206, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 21.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.22221878673084e+32, "policy_entropy": 3690.83447265625, "var_gnorm": 22.71225357055664, "vf_loss": 1028038328320.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013959407806396484, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 131, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318886.61339519575, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378505706319046, "mean_inference_ms": 5.2428487419531855, "mean_action_processing_ms": 0.1442725755769731, "mean_env_wait_ms": 0.25377237668094926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015100240707397461, "StateBufferConnector_ms": 0.0022873878479003906, "ViewRequirementAgentConnector_ms": 0.0598454475402832}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318886.61339519575, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-330167.19940140215, -362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378505706319046, "mean_inference_ms": 5.2428487419531855, "mean_action_processing_ms": 0.1442725755769731, "mean_env_wait_ms": 0.25377237668094926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015100240707397461, "StateBufferConnector_ms": 0.0022873878479003906, "ViewRequirementAgentConnector_ms": 0.0598454475402832}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016, "num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44016, "timers": {"training_iteration_time_ms": 1977.955, "learn_time_ms": 19.081, "learn_throughput": 17609.539, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 44016, "num_env_steps_trained": 44016, "num_agent_steps_sampled": 44016, "num_agent_steps_trained": 44016}, "done": false, "episodes_total": 131, "training_iteration": 131, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-54", "timestamp": 1711724514, "time_this_iter_s": 1.984452486038208, "time_total_s": 258.26709818840027, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc5030>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba6e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 258.26709818840027, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 21.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.008817360655224e+32, "policy_entropy": 3690.82666015625, "var_gnorm": 22.71225357055664, "vf_loss": 1141115584512.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011169910430908203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 132, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -319226.0021289806, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378848021741473, "mean_inference_ms": 5.242890625553582, "mean_action_processing_ms": 0.14426814084553824, "mean_env_wait_ms": 0.253757664752002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015100240707397461, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05983924865722656}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -319226.0021289806, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-362997.4630016107, -322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15378848021741473, "mean_inference_ms": 5.242890625553582, "mean_action_processing_ms": 0.14426814084553824, "mean_env_wait_ms": 0.253757664752002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015100240707397461, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05983924865722656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352, "num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44352, "timers": {"training_iteration_time_ms": 1975.46, "learn_time_ms": 19.134, "learn_throughput": 17560.213, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 44352, "num_env_steps_trained": 44352, "num_agent_steps_sampled": 44352, "num_agent_steps_trained": 44352}, "done": false, "episodes_total": 132, "training_iteration": 132, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-56", "timestamp": 1711724516, "time_this_iter_s": 1.951127529144287, "time_total_s": 260.21822571754456, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba6b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 260.21822571754456, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 21.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.6529383594495e+32, "policy_entropy": 3692.6767578125, "var_gnorm": 22.71225357055664, "vf_loss": 899975479296.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016450881958007812, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 133, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318775.60212473664, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379147093397497, "mean_inference_ms": 5.242934715962918, "mean_action_processing_ms": 0.14426353445150014, "mean_env_wait_ms": 0.2537431742273014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129327774047852, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059842586517333984}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318775.60212473664, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-322873.1113231562, -374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379147093397497, "mean_inference_ms": 5.242934715962918, "mean_action_processing_ms": 0.14426353445150014, "mean_env_wait_ms": 0.2537431742273014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129327774047852, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059842586517333984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688, "num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 44688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 44688, "timers": {"training_iteration_time_ms": 1975.025, "learn_time_ms": 19.145, "learn_throughput": 17550.635, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 44688, "num_env_steps_trained": 44688, "num_agent_steps_sampled": 44688, "num_agent_steps_trained": 44688}, "done": false, "episodes_total": 133, "training_iteration": 133, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-01-58", "timestamp": 1711724518, "time_this_iter_s": 1.9688563346862793, "time_total_s": 262.18708205223083, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5fb20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 262.18708205223083, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 21.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.3478641520052195e+32, "policy_entropy": 3691.228271484375, "var_gnorm": 22.71225357055664, "vf_loss": 933347065856.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012695789337158203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 134, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318773.6335840003, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379473697729895, "mean_inference_ms": 5.242993263922365, "mean_action_processing_ms": 0.14425933135642222, "mean_env_wait_ms": 0.25372999263168866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129804611206055, "StateBufferConnector_ms": 0.0022878646850585938, "ViewRequirementAgentConnector_ms": 0.0598444938659668}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -374623.0593871574, "episode_reward_mean": -318773.6335840003, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-374623.0593871574, -296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15379473697729895, "mean_inference_ms": 5.242993263922365, "mean_action_processing_ms": 0.14425933135642222, "mean_env_wait_ms": 0.25372999263168866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015129804611206055, "StateBufferConnector_ms": 0.0022878646850585938, "ViewRequirementAgentConnector_ms": 0.0598444938659668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024, "num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45024, "timers": {"training_iteration_time_ms": 1972.508, "learn_time_ms": 19.143, "learn_throughput": 17552.252, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 45024, "num_env_steps_trained": 45024, "num_agent_steps_sampled": 45024, "num_agent_steps_trained": 45024}, "done": false, "episodes_total": 134, "training_iteration": 134, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-00", "timestamp": 1711724520, "time_this_iter_s": 1.9445538520812988, "time_total_s": 264.13163590431213, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6e6b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b69870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 264.13163590431213, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.350399607948181e+32, "policy_entropy": 3692.173095703125, "var_gnorm": 22.71225357055664, "vf_loss": 854636888064.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013566017150878906, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 135, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318191.6829377647, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537986203468943, "mean_inference_ms": 5.2430676253483295, "mean_action_processing_ms": 0.14425560801216963, "mean_env_wait_ms": 0.2537175950637956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015131235122680664, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05986189842224121}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318191.6829377647, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-296992.0327181272, -309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537986203468943, "mean_inference_ms": 5.2430676253483295, "mean_action_processing_ms": 0.14425560801216963, "mean_env_wait_ms": 0.2537175950637956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015131235122680664, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.05986189842224121}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360, "num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45360, "timers": {"training_iteration_time_ms": 1969.023, "learn_time_ms": 19.11, "learn_throughput": 17582.121, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 45360, "num_env_steps_trained": 45360, "num_agent_steps_sampled": 45360, "num_agent_steps_trained": 45360}, "done": false, "episodes_total": 135, "training_iteration": 135, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-02", "timestamp": 1711724522, "time_this_iter_s": 1.9435558319091797, "time_total_s": 266.0751917362213, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb36a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba6f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 266.0751917362213, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.02018326400362e+32, "policy_entropy": 3692.8056640625, "var_gnorm": 22.71225357055664, "vf_loss": 993188511744.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012683868408203125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 136, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318640.4124263427, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380271746224639, "mean_inference_ms": 5.243151749843162, "mean_action_processing_ms": 0.14425232351498582, "mean_env_wait_ms": 0.25370585421276487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015136480331420898, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059877872467041016}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318640.4124263427, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-309434.38370065624, -305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380271746224639, "mean_inference_ms": 5.243151749843162, "mean_action_processing_ms": 0.14425232351498582, "mean_env_wait_ms": 0.25370585421276487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015136480331420898, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059877872467041016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696, "num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 45696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 45696, "timers": {"training_iteration_time_ms": 1968.021, "learn_time_ms": 18.952, "learn_throughput": 17729.412, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 45696, "num_env_steps_trained": 45696, "num_agent_steps_sampled": 45696, "num_agent_steps_trained": 45696}, "done": false, "episodes_total": 136, "training_iteration": 136, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-04", "timestamp": 1711724524, "time_this_iter_s": 1.9668869972229004, "time_total_s": 268.0420787334442, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c964a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 268.0420787334442, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 21.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.83840730418777e+32, "policy_entropy": 3693.573486328125, "var_gnorm": 22.71225357055664, "vf_loss": 872128970752.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001246929168701172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 137, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318723.5554648192, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380621661560379, "mean_inference_ms": 5.243222362969922, "mean_action_processing_ms": 0.14424909714172965, "mean_env_wait_ms": 0.25369425876185625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015139102935791016, "StateBufferConnector_ms": 0.0022869110107421875, "ViewRequirementAgentConnector_ms": 0.05985879898071289}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318723.5554648192, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305387.40295396704, -316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380621661560379, "mean_inference_ms": 5.243222362969922, "mean_action_processing_ms": 0.14424909714172965, "mean_env_wait_ms": 0.25369425876185625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015139102935791016, "StateBufferConnector_ms": 0.0022869110107421875, "ViewRequirementAgentConnector_ms": 0.05985879898071289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032, "num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46032, "timers": {"training_iteration_time_ms": 1966.409, "learn_time_ms": 18.963, "learn_throughput": 17718.824, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 46032, "num_env_steps_trained": 46032, "num_agent_steps_sampled": 46032, "num_agent_steps_trained": 46032}, "done": false, "episodes_total": 137, "training_iteration": 137, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-06", "timestamp": 1711724526, "time_this_iter_s": 1.9739010334014893, "time_total_s": 270.0159797668457, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1960>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba6e60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 270.0159797668457, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 21.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5480829313620804e+32, "policy_entropy": 3691.952392578125, "var_gnorm": 22.71225357055664, "vf_loss": 734623301632.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013720989227294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 138, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318695.8945266277, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380950107953176, "mean_inference_ms": 5.243282711792554, "mean_action_processing_ms": 0.14424560797453487, "mean_env_wait_ms": 0.25368243044616173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015132427215576172, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059870004653930664}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318695.8945266277, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-316950.361590013, -353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15380950107953176, "mean_inference_ms": 5.243282711792554, "mean_action_processing_ms": 0.14424560797453487, "mean_env_wait_ms": 0.25368243044616173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015132427215576172, "StateBufferConnector_ms": 0.002287149429321289, "ViewRequirementAgentConnector_ms": 0.059870004653930664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368, "num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46368, "timers": {"training_iteration_time_ms": 1964.116, "learn_time_ms": 19.03, "learn_throughput": 17656.134, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 46368, "num_env_steps_trained": 46368, "num_agent_steps_sampled": 46368, "num_agent_steps_trained": 46368}, "done": false, "episodes_total": 138, "training_iteration": 138, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-08", "timestamp": 1711724528, "time_this_iter_s": 1.9496431350708008, "time_total_s": 271.9656229019165, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 271.9656229019165, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 21.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.413602476407118e+32, "policy_entropy": 3693.623779296875, "var_gnorm": 22.71225357055664, "vf_loss": 944567943168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012135505676269531, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 139, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318837.87638595805, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381254265004535, "mean_inference_ms": 5.243333082442673, "mean_action_processing_ms": 0.14424183897687867, "mean_env_wait_ms": 0.25367042075813695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015131950378417969, "StateBufferConnector_ms": 0.002286672592163086, "ViewRequirementAgentConnector_ms": 0.05988335609436035}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318837.87638595805, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-353770.50190362654, -348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381254265004535, "mean_inference_ms": 5.243333082442673, "mean_action_processing_ms": 0.14424183897687867, "mean_env_wait_ms": 0.25367042075813695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015131950378417969, "StateBufferConnector_ms": 0.002286672592163086, "ViewRequirementAgentConnector_ms": 0.05988335609436035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704, "num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 46704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 46704, "timers": {"training_iteration_time_ms": 1961.044, "learn_time_ms": 19.031, "learn_throughput": 17655.537, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 46704, "num_env_steps_trained": 46704, "num_agent_steps_sampled": 46704, "num_agent_steps_trained": 46704}, "done": false, "episodes_total": 139, "training_iteration": 139, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-10", "timestamp": 1711724530, "time_this_iter_s": 1.94832444190979, "time_total_s": 273.9139473438263, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 273.9139473438263, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 22.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.2998596116382754e+32, "policy_entropy": 3691.46240234375, "var_gnorm": 22.71225357055664, "vf_loss": 667803975680.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001882314682006836, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 140, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318149.1716288304, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538153996726793, "mean_inference_ms": 5.243382114730296, "mean_action_processing_ms": 0.1442382793349239, "mean_env_wait_ms": 0.25365807024721054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144824981689453, "StateBufferConnector_ms": 0.0022873878479003906, "ViewRequirementAgentConnector_ms": 0.05990791320800781}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -318149.1716288304, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-348153.3685011796, -359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538153996726793, "mean_inference_ms": 5.243382114730296, "mean_action_processing_ms": 0.1442382793349239, "mean_env_wait_ms": 0.25365807024721054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015144824981689453, "StateBufferConnector_ms": 0.0022873878479003906, "ViewRequirementAgentConnector_ms": 0.05990791320800781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040, "num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47040, "timers": {"training_iteration_time_ms": 1959.406, "learn_time_ms": 18.969, "learn_throughput": 17713.1, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 47040, "num_env_steps_trained": 47040, "num_agent_steps_sampled": 47040, "num_agent_steps_trained": 47040}, "done": false, "episodes_total": 140, "training_iteration": 140, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-12", "timestamp": 1711724532, "time_this_iter_s": 1.9675195217132568, "time_total_s": 275.88146686553955, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcc1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 275.88146686553955, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 22.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1077919212489478e+32, "policy_entropy": 3691.707275390625, "var_gnorm": 22.71225357055664, "vf_loss": 690005934080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00018131732940673828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 141, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -317543.6939201836, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381877539657596, "mean_inference_ms": 5.243443763942041, "mean_action_processing_ms": 0.1442353421360949, "mean_env_wait_ms": 0.2536471028466978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015152454376220703, "StateBufferConnector_ms": 0.0022864341735839844, "ViewRequirementAgentConnector_ms": 0.05995011329650879}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -317543.6939201836, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-359424.6130714353, -326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15381877539657596, "mean_inference_ms": 5.243443763942041, "mean_action_processing_ms": 0.1442353421360949, "mean_env_wait_ms": 0.2536471028466978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015152454376220703, "StateBufferConnector_ms": 0.0022864341735839844, "ViewRequirementAgentConnector_ms": 0.05995011329650879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376, "num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47376, "timers": {"training_iteration_time_ms": 1959.122, "learn_time_ms": 18.99, "learn_throughput": 17693.775, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 47376, "num_env_steps_trained": 47376, "num_agent_steps_sampled": 47376, "num_agent_steps_trained": 47376}, "done": false, "episodes_total": 141, "training_iteration": 141, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-14", "timestamp": 1711724534, "time_this_iter_s": 1.9816210269927979, "time_total_s": 277.86308789253235, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c977c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba7910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 277.86308789253235, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 22.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.863522499135095e+32, "policy_entropy": 3692.13818359375, "var_gnorm": 22.71225357055664, "vf_loss": 766279483392.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013720989227294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 142, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316952.44004034135, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382229398634661, "mean_inference_ms": 5.243506350214993, "mean_action_processing_ms": 0.14423266419984082, "mean_env_wait_ms": 0.25363681245526076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155792236328125, "StateBufferConnector_ms": 0.0022869110107421875, "ViewRequirementAgentConnector_ms": 0.0599665641784668}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316952.44004034135, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-326651.89160808723, -333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382229398634661, "mean_inference_ms": 5.243506350214993, "mean_action_processing_ms": 0.14423266419984082, "mean_env_wait_ms": 0.25363681245526076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015155792236328125, "StateBufferConnector_ms": 0.0022869110107421875, "ViewRequirementAgentConnector_ms": 0.0599665641784668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712, "num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 47712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 47712, "timers": {"training_iteration_time_ms": 1961.588, "learn_time_ms": 18.914, "learn_throughput": 17764.746, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 47712, "num_env_steps_trained": 47712, "num_agent_steps_sampled": 47712, "num_agent_steps_trained": 47712}, "done": false, "episodes_total": 142, "training_iteration": 142, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-16", "timestamp": 1711724536, "time_this_iter_s": 1.9758260250091553, "time_total_s": 279.8389139175415, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb18d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcc1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 279.8389139175415, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.533333333333334, "ram_util_percent": 22.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.2025009439920916e+32, "policy_entropy": 3691.859619140625, "var_gnorm": 22.71225357055664, "vf_loss": 760890720256.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012922286987304688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 143, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316729.50320966134, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382694185788698, "mean_inference_ms": 5.243582604254052, "mean_action_processing_ms": 0.14423099784313456, "mean_env_wait_ms": 0.25362832827468457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015198945999145508, "StateBufferConnector_ms": 0.0022928714752197266, "ViewRequirementAgentConnector_ms": 0.06014370918273926}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316729.50320966134, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333889.1967413695, -329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15382694185788698, "mean_inference_ms": 5.243582604254052, "mean_action_processing_ms": 0.14423099784313456, "mean_env_wait_ms": 0.25362832827468457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015198945999145508, "StateBufferConnector_ms": 0.0022928714752197266, "ViewRequirementAgentConnector_ms": 0.06014370918273926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048, "num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48048, "timers": {"training_iteration_time_ms": 1967.059, "learn_time_ms": 19.093, "learn_throughput": 17597.621, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 48048, "num_env_steps_trained": 48048, "num_agent_steps_sampled": 48048, "num_agent_steps_trained": 48048}, "done": false, "episodes_total": 143, "training_iteration": 143, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-18", "timestamp": 1711724538, "time_this_iter_s": 2.0236804485321045, "time_total_s": 281.8625943660736, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2710>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bccc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 281.8625943660736, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.533333333333334, "ram_util_percent": 22.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.496464059299392e+32, "policy_entropy": 3692.3740234375, "var_gnorm": 22.71225357055664, "vf_loss": 955044003840.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011134147644042969, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 144, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316557.6374122743, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383239198797002, "mean_inference_ms": 5.243676304619726, "mean_action_processing_ms": 0.14423022017791973, "mean_env_wait_ms": 0.2536213149241734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015207052230834961, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.06016850471496582}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -373998.30734404136, "episode_reward_mean": -316557.6374122743, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-329349.49478494737, -317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383239198797002, "mean_inference_ms": 5.243676304619726, "mean_action_processing_ms": 0.14423022017791973, "mean_env_wait_ms": 0.2536213149241734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015207052230834961, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.06016850471496582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 1972.257, "learn_time_ms": 19.068, "learn_throughput": 17620.967, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 144, "training_iteration": 144, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-20", "timestamp": 1711724540, "time_this_iter_s": 1.9965662956237793, "time_total_s": 283.8591606616974, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2050>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba4a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 283.8591606616974, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 22.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.694033547428122e+32, "policy_entropy": 3692.781982421875, "var_gnorm": 22.71225357055664, "vf_loss": 1358541357056.0}, "grad_gnorm": 0.0, "vf_explained_var": -9.441375732421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 145, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317097.885615689, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383858321378144, "mean_inference_ms": 5.243784643032654, "mean_action_processing_ms": 0.14423027281802311, "mean_env_wait_ms": 0.25361615870650256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200376510620117, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.060182809829711914}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317097.885615689, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317200.0872885418, -324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15383858321378144, "mean_inference_ms": 5.243784643032654, "mean_action_processing_ms": 0.14423027281802311, "mean_env_wait_ms": 0.25361615870650256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015200376510620117, "StateBufferConnector_ms": 0.0022940635681152344, "ViewRequirementAgentConnector_ms": 0.060182809829711914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720, "num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 48720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 48720, "timers": {"training_iteration_time_ms": 1978.152, "learn_time_ms": 19.102, "learn_throughput": 17589.846, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 48720, "num_env_steps_trained": 48720, "num_agent_steps_sampled": 48720, "num_agent_steps_trained": 48720}, "done": false, "episodes_total": 145, "training_iteration": 145, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-22", "timestamp": 1711724542, "time_this_iter_s": 2.002504348754883, "time_total_s": 285.86166501045227, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97e50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcc820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 285.86166501045227, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 22.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.7747808944843468e+32, "policy_entropy": 3693.62548828125, "var_gnorm": 22.71225357055664, "vf_loss": 869174083584.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001512765884399414, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 146, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317192.1275771359, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384489400250997, "mean_inference_ms": 5.243893506748829, "mean_action_processing_ms": 0.1442320729002358, "mean_env_wait_ms": 0.2536132662731362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189409255981445, "StateBufferConnector_ms": 0.002292633056640625, "ViewRequirementAgentConnector_ms": 0.06020665168762207}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317192.1275771359, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-324595.1711950671, -322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15384489400250997, "mean_inference_ms": 5.243893506748829, "mean_action_processing_ms": 0.1442320729002358, "mean_env_wait_ms": 0.2536132662731362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015189409255981445, "StateBufferConnector_ms": 0.002292633056640625, "ViewRequirementAgentConnector_ms": 0.06020665168762207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056, "num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49056, "timers": {"training_iteration_time_ms": 1975.701, "learn_time_ms": 19.095, "learn_throughput": 17596.369, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 49056, "num_env_steps_trained": 49056, "num_agent_steps_sampled": 49056, "num_agent_steps_trained": 49056}, "done": false, "episodes_total": 146, "training_iteration": 146, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-24", "timestamp": 1711724544, "time_this_iter_s": 1.9424021244049072, "time_total_s": 287.8040671348572, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95000>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 287.8040671348572, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.166666666666667, "ram_util_percent": 22.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.2216580992813863e+32, "policy_entropy": 3693.953125, "var_gnorm": 22.71225357055664, "vf_loss": 754172231680.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014674663543701172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 147, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316967.73159435304, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153851563050816, "mean_inference_ms": 5.244004575129818, "mean_action_processing_ms": 0.14423583131686735, "mean_env_wait_ms": 0.2536126117881989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518392562866211, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.060207366943359375}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316967.73159435304, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-322862.0689165716, -318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.153851563050816, "mean_inference_ms": 5.244004575129818, "mean_action_processing_ms": 0.14423583131686735, "mean_env_wait_ms": 0.2536126117881989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01518392562866211, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.060207366943359375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392, "num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49392, "timers": {"training_iteration_time_ms": 1974.029, "learn_time_ms": 19.042, "learn_throughput": 17645.39, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 49392, "num_env_steps_trained": 49392, "num_agent_steps_sampled": 49392, "num_agent_steps_trained": 49392}, "done": false, "episodes_total": 147, "training_iteration": 147, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-26", "timestamp": 1711724546, "time_this_iter_s": 1.9571843147277832, "time_total_s": 289.76125144958496, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb16f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 289.76125144958496, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 22.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5321984833375807e+32, "policy_entropy": 3692.790283203125, "var_gnorm": 22.71225357055664, "vf_loss": 977303175168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014030933380126953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 148, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317264.2549059304, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538593353000635, "mean_inference_ms": 5.244132484043426, "mean_action_processing_ms": 0.14424170904079164, "mean_env_wait_ms": 0.253615112775596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015178442001342773, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.06022167205810547}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317264.2549059304, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-318117.8406222323, -354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538593353000635, "mean_inference_ms": 5.244132484043426, "mean_action_processing_ms": 0.14424170904079164, "mean_env_wait_ms": 0.253615112775596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015178442001342773, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.06022167205810547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728, "num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 49728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 49728, "timers": {"training_iteration_time_ms": 1980.721, "learn_time_ms": 18.942, "learn_throughput": 17738.428, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 49728, "num_env_steps_trained": 49728, "num_agent_steps_sampled": 49728, "num_agent_steps_trained": 49728}, "done": false, "episodes_total": 148, "training_iteration": 148, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-28", "timestamp": 1711724548, "time_this_iter_s": 2.01656436920166, "time_total_s": 291.7778158187866, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c96260>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5120>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 291.7778158187866, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.833333333333333, "ram_util_percent": 22.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.674063993988046e+32, "policy_entropy": 3690.876953125, "var_gnorm": 22.71225357055664, "vf_loss": 854069346304.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012683868408203125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 149, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317258.31061759166, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386812148534892, "mean_inference_ms": 5.244277093451383, "mean_action_processing_ms": 0.14424979816022884, "mean_env_wait_ms": 0.2536202808694164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015183687210083008, "StateBufferConnector_ms": 0.0022933483123779297, "ViewRequirementAgentConnector_ms": 0.06024789810180664}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317258.31061759166, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-354775.2504024908, -347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15386812148534892, "mean_inference_ms": 5.244277093451383, "mean_action_processing_ms": 0.14424979816022884, "mean_env_wait_ms": 0.2536202808694164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015183687210083008, "StateBufferConnector_ms": 0.0022933483123779297, "ViewRequirementAgentConnector_ms": 0.06024789810180664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064, "num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50064, "timers": {"training_iteration_time_ms": 1985.048, "learn_time_ms": 18.973, "learn_throughput": 17709.739, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 50064, "num_env_steps_trained": 50064, "num_agent_steps_sampled": 50064, "num_agent_steps_trained": 50064}, "done": false, "episodes_total": 149, "training_iteration": 149, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-30", "timestamp": 1711724550, "time_this_iter_s": 1.991581678390503, "time_total_s": 293.7693974971771, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2b60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd6c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 293.7693974971771, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 23.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.4179548359672156e+32, "policy_entropy": 3690.8916015625, "var_gnorm": 22.71225357055664, "vf_loss": 918430416896.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001361370086669922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 150, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317081.1458486248, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387742594278453, "mean_inference_ms": 5.244435298618139, "mean_action_processing_ms": 0.14425940407919882, "mean_env_wait_ms": 0.25362741982839376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186309814453125, "StateBufferConnector_ms": 0.0022933483123779297, "ViewRequirementAgentConnector_ms": 0.060257673263549805}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317081.1458486248, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-347202.5254913529, -287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15387742594278453, "mean_inference_ms": 5.244435298618139, "mean_action_processing_ms": 0.14425940407919882, "mean_env_wait_ms": 0.25362741982839376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015186309814453125, "StateBufferConnector_ms": 0.0022933483123779297, "ViewRequirementAgentConnector_ms": 0.060257673263549805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400, "num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50400, "timers": {"training_iteration_time_ms": 1992.335, "learn_time_ms": 19.023, "learn_throughput": 17663.282, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 50400, "num_env_steps_trained": 50400, "num_agent_steps_sampled": 50400, "num_agent_steps_trained": 50400}, "done": false, "episodes_total": 150, "training_iteration": 150, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-32", "timestamp": 1711724552, "time_this_iter_s": 2.0404305458068848, "time_total_s": 295.809828042984, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95ab0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 295.809828042984, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 23.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.4064902510905856e+32, "policy_entropy": 3692.451416015625, "var_gnorm": 22.71225357055664, "vf_loss": 885594128384.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001347064971923828, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 151, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316765.7904726777, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538868436131968, "mean_inference_ms": 5.244594393357025, "mean_action_processing_ms": 0.14427052458365197, "mean_env_wait_ms": 0.2536359980615203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015182256698608398, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06027054786682129}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316765.7904726777, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-287670.08185972314, -340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1538868436131968, "mean_inference_ms": 5.244594393357025, "mean_action_processing_ms": 0.14427052458365197, "mean_env_wait_ms": 0.2536359980615203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015182256698608398, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06027054786682129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736, "num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 50736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 50736, "timers": {"training_iteration_time_ms": 1994.313, "learn_time_ms": 19.051, "learn_throughput": 17636.822, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 50736, "num_env_steps_trained": 50736, "num_agent_steps_sampled": 50736, "num_agent_steps_trained": 50736}, "done": false, "episodes_total": 151, "training_iteration": 151, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-34", "timestamp": 1711724554, "time_this_iter_s": 2.001415491104126, "time_total_s": 297.81124353408813, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1690>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bccc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 297.81124353408813, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 23.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.6960386566168554e+32, "policy_entropy": 3690.5244140625, "var_gnorm": 22.71225357055664, "vf_loss": 729400737792.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016260147094726562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 152, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316766.2247135935, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389631140239882, "mean_inference_ms": 5.244751527441627, "mean_action_processing_ms": 0.14428147708115172, "mean_env_wait_ms": 0.2536443642403394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015184879302978516, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.06031036376953125}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316766.2247135935, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-340469.34658642154, -308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15389631140239882, "mean_inference_ms": 5.244751527441627, "mean_action_processing_ms": 0.14428147708115172, "mean_env_wait_ms": 0.2536443642403394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015184879302978516, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.06031036376953125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072, "num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51072, "timers": {"training_iteration_time_ms": 1994.402, "learn_time_ms": 19.086, "learn_throughput": 17604.854, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 51072, "num_env_steps_trained": 51072, "num_agent_steps_sampled": 51072, "num_agent_steps_trained": 51072}, "done": false, "episodes_total": 152, "training_iteration": 152, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-36", "timestamp": 1711724556, "time_this_iter_s": 1.9767234325408936, "time_total_s": 299.787966966629, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb26e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bce9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 299.787966966629, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.699999999999999, "ram_util_percent": 23.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0649796025575087e+32, "policy_entropy": 3692.6953125, "var_gnorm": 22.71225357055664, "vf_loss": 738383036416.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001577138900756836, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 153, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316383.38022564317, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390545731151598, "mean_inference_ms": 5.24490225781111, "mean_action_processing_ms": 0.14429220876227106, "mean_env_wait_ms": 0.25365245699519406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520228385925293, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.06030845642089844}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316383.38022564317, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-308068.49593125394, -342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15390545731151598, "mean_inference_ms": 5.24490225781111, "mean_action_processing_ms": 0.14429220876227106, "mean_env_wait_ms": 0.25365245699519406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01520228385925293, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.06030845642089844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408, "num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51408, "timers": {"training_iteration_time_ms": 1989.713, "learn_time_ms": 18.903, "learn_throughput": 17775.254, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 51408, "num_env_steps_trained": 51408, "num_agent_steps_sampled": 51408, "num_agent_steps_trained": 51408}, "done": false, "episodes_total": 153, "training_iteration": 153, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-38", "timestamp": 1711724558, "time_this_iter_s": 1.9767115116119385, "time_total_s": 301.76467847824097, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bccdc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 301.76467847824097, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8999999999999995, "ram_util_percent": 23.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.243540817185198e+32, "policy_entropy": 3692.0537109375, "var_gnorm": 22.71225357055664, "vf_loss": 910879621120.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013244152069091797, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 154, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316545.2116312815, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391449069032498, "mean_inference_ms": 5.245046748400182, "mean_action_processing_ms": 0.14430260602356124, "mean_env_wait_ms": 0.2536602867158656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015194416046142578, "StateBufferConnector_ms": 0.0023000240325927734, "ViewRequirementAgentConnector_ms": 0.06025552749633789}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316545.2116312815, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-342018.336071774, -360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15391449069032498, "mean_inference_ms": 5.245046748400182, "mean_action_processing_ms": 0.14430260602356124, "mean_env_wait_ms": 0.2536602867158656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015194416046142578, "StateBufferConnector_ms": 0.0023000240325927734, "ViewRequirementAgentConnector_ms": 0.06025552749633789}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744, "num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 51744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 51744, "timers": {"training_iteration_time_ms": 1990.092, "learn_time_ms": 18.947, "learn_throughput": 17733.316, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 51744, "num_env_steps_trained": 51744, "num_agent_steps_sampled": 51744, "num_agent_steps_trained": 51744}, "done": false, "episodes_total": 154, "training_iteration": 154, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-40", "timestamp": 1711724560, "time_this_iter_s": 2.000389337539673, "time_total_s": 303.76506781578064, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 303.76506781578064, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 23.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.406759116192868e+32, "policy_entropy": 3692.28369140625, "var_gnorm": 22.71225357055664, "vf_loss": 821210578944.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016999244689941406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 155, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316272.895903633, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539232181675538, "mean_inference_ms": 5.2451866491212265, "mean_action_processing_ms": 0.14431258855451554, "mean_env_wait_ms": 0.25366771467783655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015206575393676758, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.0602421760559082}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316272.895903633, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-360042.8681189354, -320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539232181675538, "mean_inference_ms": 5.2451866491212265, "mean_action_processing_ms": 0.14431258855451554, "mean_env_wait_ms": 0.25366771467783655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015206575393676758, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.0602421760559082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080, "num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52080, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52080, "timers": {"training_iteration_time_ms": 1987.867, "learn_time_ms": 19.011, "learn_throughput": 17673.981, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 52080, "num_env_steps_trained": 52080, "num_agent_steps_sampled": 52080, "num_agent_steps_trained": 52080}, "done": false, "episodes_total": 155, "training_iteration": 155, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-42", "timestamp": 1711724562, "time_this_iter_s": 1.9802825450897217, "time_total_s": 305.74535036087036, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc5150>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf5b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 305.74535036087036, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.466666666666668, "ram_util_percent": 23.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.7577423631754e+32, "policy_entropy": 3692.887451171875, "var_gnorm": 22.71225357055664, "vf_loss": 882981404672.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001468658447265625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 156, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315822.08470627654, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393097464032252, "mean_inference_ms": 5.245295889468856, "mean_action_processing_ms": 0.14432161604127797, "mean_env_wait_ms": 0.2536735764086828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01521754264831543, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06029343605041504}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315822.08470627654, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-320402.52262971894, -366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393097464032252, "mean_inference_ms": 5.245295889468856, "mean_action_processing_ms": 0.14432161604127797, "mean_env_wait_ms": 0.2536735764086828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01521754264831543, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06029343605041504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416, "num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52416, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52416, "timers": {"training_iteration_time_ms": 1992.946, "learn_time_ms": 19.046, "learn_throughput": 17641.679, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 52416, "num_env_steps_trained": 52416, "num_agent_steps_sampled": 52416, "num_agent_steps_trained": 52416}, "done": false, "episodes_total": 156, "training_iteration": 156, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-44", "timestamp": 1711724564, "time_this_iter_s": 1.9931819438934326, "time_total_s": 307.7385323047638, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c964d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 307.7385323047638, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666667, "ram_util_percent": 23.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.05995837134993e+32, "policy_entropy": 3692.76953125, "var_gnorm": 22.71225357055664, "vf_loss": 699602436096.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012409687042236328, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 157, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315441.1041420889, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393687489073474, "mean_inference_ms": 5.2453559238877565, "mean_action_processing_ms": 0.1443290225793878, "mean_env_wait_ms": 0.2536767208085818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015214204788208008, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.06025433540344238}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315441.1041420889, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-366561.3502893855, -276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15393687489073474, "mean_inference_ms": 5.2453559238877565, "mean_action_processing_ms": 0.1443290225793878, "mean_env_wait_ms": 0.2536767208085818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015214204788208008, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.06025433540344238}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752, "num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 52752, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 52752, "timers": {"training_iteration_time_ms": 2007.142, "learn_time_ms": 19.256, "learn_throughput": 17448.765, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 52752, "num_env_steps_trained": 52752, "num_agent_steps_sampled": 52752, "num_agent_steps_trained": 52752}, "done": false, "episodes_total": 157, "training_iteration": 157, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-47", "timestamp": 1711724567, "time_this_iter_s": 2.0992653369903564, "time_total_s": 309.83779764175415, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1630>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd3f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 309.83779764175415, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 10.266666666666667, "ram_util_percent": 23.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.19321098336977e+32, "policy_entropy": 3692.77099609375, "var_gnorm": 22.71225357055664, "vf_loss": 953078775808.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013387203216552734, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 158, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315178.4673574895, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539422352782043, "mean_inference_ms": 5.245404778139797, "mean_action_processing_ms": 0.144335906686184, "mean_env_wait_ms": 0.25367950456361726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152130126953125, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06025195121765137}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315178.4673574895, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276577.4208698354, -335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539422352782043, "mean_inference_ms": 5.245404778139797, "mean_action_processing_ms": 0.144335906686184, "mean_env_wait_ms": 0.25367950456361726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152130126953125, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06025195121765137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088, "num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53088, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53088, "timers": {"training_iteration_time_ms": 2003.652, "learn_time_ms": 19.28, "learn_throughput": 17427.468, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 53088, "num_env_steps_trained": 53088, "num_agent_steps_sampled": 53088, "num_agent_steps_trained": 53088}, "done": false, "episodes_total": 158, "training_iteration": 158, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-49", "timestamp": 1711724569, "time_this_iter_s": 1.981651782989502, "time_total_s": 311.81944942474365, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1a80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba77f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 311.81944942474365, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.566666666666666, "ram_util_percent": 23.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2051292896278983e+33, "policy_entropy": 3691.324462890625, "var_gnorm": 22.71225357055664, "vf_loss": 835750854656.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001583099365234375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 159, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315567.1068679692, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539476410467315, "mean_inference_ms": 5.245454890540668, "mean_action_processing_ms": 0.1443427823572834, "mean_env_wait_ms": 0.2536824136417313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015209197998046875, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.060237884521484375}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315567.1068679692, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-335881.5120198285, -311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539476410467315, "mean_inference_ms": 5.245454890540668, "mean_action_processing_ms": 0.1443427823572834, "mean_env_wait_ms": 0.2536824136417313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015209197998046875, "StateBufferConnector_ms": 0.0022993087768554688, "ViewRequirementAgentConnector_ms": 0.060237884521484375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424, "num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53424, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53424, "timers": {"training_iteration_time_ms": 2000.978, "learn_time_ms": 19.232, "learn_throughput": 17470.461, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 53424, "num_env_steps_trained": 53424, "num_agent_steps_sampled": 53424, "num_agent_steps_trained": 53424}, "done": false, "episodes_total": 159, "training_iteration": 159, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-51", "timestamp": 1711724571, "time_this_iter_s": 1.9648549556732178, "time_total_s": 313.78430438041687, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c947f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 313.78430438041687, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 24.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1499448434413362e+32, "policy_entropy": 3693.14697265625, "var_gnorm": 22.71225357055664, "vf_loss": 972405342208.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001354217529296875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 160, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315589.6771972001, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395297383229303, "mean_inference_ms": 5.245510918675936, "mean_action_processing_ms": 0.14434973935939618, "mean_env_wait_ms": 0.2536854222387883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015211343765258789, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.06020951271057129}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315589.6771972001, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-311278.87549290777, -343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395297383229303, "mean_inference_ms": 5.245510918675936, "mean_action_processing_ms": 0.14434973935939618, "mean_env_wait_ms": 0.2536854222387883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015211343765258789, "StateBufferConnector_ms": 0.002299785614013672, "ViewRequirementAgentConnector_ms": 0.06020951271057129}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 53760, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 1992.856, "learn_time_ms": 19.173, "learn_throughput": 17525.1, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 160, "training_iteration": 160, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-53", "timestamp": 1711724573, "time_this_iter_s": 1.959183931350708, "time_total_s": 315.7434883117676, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0760>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518b6a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 315.7434883117676, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 24.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.611678845783491e+32, "policy_entropy": 3691.306396484375, "var_gnorm": 22.71225357055664, "vf_loss": 928951042048.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001628398895263672, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 161, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315796.5275073798, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539586326010706, "mean_inference_ms": 5.2455729299836085, "mean_action_processing_ms": 0.14435679401079957, "mean_env_wait_ms": 0.25368888525214794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.06035208702087402}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315796.5275073798, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-343183.1752180156, -269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539586326010706, "mean_inference_ms": 5.2455729299836085, "mean_action_processing_ms": 0.14435679401079957, "mean_env_wait_ms": 0.25368888525214794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015236139297485352, "StateBufferConnector_ms": 0.002302408218383789, "ViewRequirementAgentConnector_ms": 0.06035208702087402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54096, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 1991.295, "learn_time_ms": 19.273, "learn_throughput": 17433.936, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 161, "training_iteration": 161, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-55", "timestamp": 1711724575, "time_this_iter_s": 1.9859004020690918, "time_total_s": 317.72938871383667, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2f50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bce560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 317.72938871383667, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.699999999999999, "ram_util_percent": 24.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.6178857279022356e+32, "policy_entropy": 3691.220947265625, "var_gnorm": 22.71225357055664, "vf_loss": 828708225024.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013327598571777344, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 162, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "sampler_results": {"episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315446.8327254039, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539646494579691, "mean_inference_ms": 5.245644965089611, "mean_action_processing_ms": 0.14436414909956158, "mean_env_wait_ms": 0.2536932349722122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01525115966796875, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.06038665771484375}}, "episode_reward_max": -269418.342605558, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315446.8327254039, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-269418.342605558, -300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539646494579691, "mean_inference_ms": 5.245644965089611, "mean_action_processing_ms": 0.14436414909956158, "mean_env_wait_ms": 0.2536932349722122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01525115966796875, "StateBufferConnector_ms": 0.0023016929626464844, "ViewRequirementAgentConnector_ms": 0.06038665771484375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432, "num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54432, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54432, "timers": {"training_iteration_time_ms": 1997.243, "learn_time_ms": 19.252, "learn_throughput": 17452.741, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 54432, "num_env_steps_trained": 54432, "num_agent_steps_sampled": 54432, "num_agent_steps_trained": 54432}, "done": false, "episodes_total": 162, "training_iteration": 162, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-57", "timestamp": 1711724577, "time_this_iter_s": 2.036191940307617, "time_total_s": 319.7655806541443, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1de0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bce710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 319.7655806541443, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 8.166666666666666, "ram_util_percent": 24.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5012141346184736e+32, "policy_entropy": 3692.509765625, "var_gnorm": 22.71225357055664, "vf_loss": 765602758656.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001436471939086914, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 163, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315719.8679379409, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397045200406667, "mean_inference_ms": 5.245707993922648, "mean_action_processing_ms": 0.1443713468654731, "mean_env_wait_ms": 0.2536974343283994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015234708786010742, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.06035757064819336}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315719.8679379409, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-300114.0359573764, -313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15397045200406667, "mean_inference_ms": 5.245707993922648, "mean_action_processing_ms": 0.1443713468654731, "mean_env_wait_ms": 0.2536974343283994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015234708786010742, "StateBufferConnector_ms": 0.0023005008697509766, "ViewRequirementAgentConnector_ms": 0.06035757064819336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768, "num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 54768, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 54768, "timers": {"training_iteration_time_ms": 1998.904, "learn_time_ms": 19.312, "learn_throughput": 17398.251, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 54768, "num_env_steps_trained": 54768, "num_agent_steps_sampled": 54768, "num_agent_steps_trained": 54768}, "done": false, "episodes_total": 163, "training_iteration": 163, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-02-59", "timestamp": 1711724579, "time_this_iter_s": 1.9935054779052734, "time_total_s": 321.75908613204956, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a04a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 321.75908613204956, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.433333333333333, "ram_util_percent": 24.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.057176327721121e+32, "policy_entropy": 3692.51416015625, "var_gnorm": 22.71225357055664, "vf_loss": 736022429696.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001380443572998047, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 164, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315522.1716664393, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539764781836001, "mean_inference_ms": 5.2457685984310665, "mean_action_processing_ms": 0.1443785302153671, "mean_env_wait_ms": 0.2537017649457521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239953994750977, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06033635139465332}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315522.1716664393, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-313768.0895796184, -308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1539764781836001, "mean_inference_ms": 5.2457685984310665, "mean_action_processing_ms": 0.1443785302153671, "mean_env_wait_ms": 0.2537017649457521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239953994750977, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06033635139465332}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104, "num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55104, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55104, "timers": {"training_iteration_time_ms": 2002.147, "learn_time_ms": 19.355, "learn_throughput": 17359.439, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 55104, "num_env_steps_trained": 55104, "num_agent_steps_sampled": 55104, "num_agent_steps_trained": 55104}, "done": false, "episodes_total": 164, "training_iteration": 164, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-01", "timestamp": 1711724581, "time_this_iter_s": 2.032808780670166, "time_total_s": 323.7918949127197, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c967d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 323.7918949127197, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.3999999999999995, "ram_util_percent": 24.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.643015363596689e+32, "policy_entropy": 3691.8408203125, "var_gnorm": 22.71225357055664, "vf_loss": 745003220992.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00016510486602783203, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 165, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315296.76078531746, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398277823898343, "mean_inference_ms": 5.2458429755830105, "mean_action_processing_ms": 0.14438614217527615, "mean_env_wait_ms": 0.2537069852719348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260934829711914, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06037449836730957}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315296.76078531746, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-308891.46569324733, -287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398277823898343, "mean_inference_ms": 5.2458429755830105, "mean_action_processing_ms": 0.14438614217527615, "mean_env_wait_ms": 0.2537069852719348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015260934829711914, "StateBufferConnector_ms": 0.002300262451171875, "ViewRequirementAgentConnector_ms": 0.06037449836730957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440, "num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55440, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55440, "timers": {"training_iteration_time_ms": 2008.044, "learn_time_ms": 19.369, "learn_throughput": 17346.982, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 55440, "num_env_steps_trained": 55440, "num_agent_steps_sampled": 55440, "num_agent_steps_trained": 55440}, "done": false, "episodes_total": 165, "training_iteration": 165, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-03", "timestamp": 1711724583, "time_this_iter_s": 2.039247989654541, "time_total_s": 325.83114290237427, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb23e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcd2d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 325.83114290237427, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.133333333333333, "ram_util_percent": 24.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.5384461152592836e+32, "policy_entropy": 3689.648681640625, "var_gnorm": 22.71225357055664, "vf_loss": 1011896811520.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011968612670898438, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 166, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315668.19319435145, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398923032740355, "mean_inference_ms": 5.245921130703055, "mean_action_processing_ms": 0.14439376748428404, "mean_env_wait_ms": 0.25371254798735454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015242815017700195, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.0603489875793457}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315668.19319435145, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-287758.5570151861, -275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15398923032740355, "mean_inference_ms": 5.245921130703055, "mean_action_processing_ms": 0.14439376748428404, "mean_env_wait_ms": 0.25371254798735454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015242815017700195, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.0603489875793457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776, "num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 55776, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 55776, "timers": {"training_iteration_time_ms": 2008.052, "learn_time_ms": 19.399, "learn_throughput": 17320.609, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 55776, "num_env_steps_trained": 55776, "num_agent_steps_sampled": 55776, "num_agent_steps_trained": 55776}, "done": false, "episodes_total": 166, "training_iteration": 166, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-05", "timestamp": 1711724585, "time_this_iter_s": 1.9932410717010498, "time_total_s": 327.8243839740753, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95fc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 327.8243839740753, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.1000000000000005, "ram_util_percent": 24.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.2379814329054439e+32, "policy_entropy": 3691.83837890625, "var_gnorm": 22.71225357055664, "vf_loss": 982259335168.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010633468627929688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 167, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316001.535187706, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399570493422682, "mean_inference_ms": 5.246000230643286, "mean_action_processing_ms": 0.14440130525953782, "mean_env_wait_ms": 0.2537181838453992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015246152877807617, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06037569046020508}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316001.535187706, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275952.1247466531, -319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15399570493422682, "mean_inference_ms": 5.246000230643286, "mean_action_processing_ms": 0.14440130525953782, "mean_env_wait_ms": 0.2537181838453992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015246152877807617, "StateBufferConnector_ms": 0.002298593521118164, "ViewRequirementAgentConnector_ms": 0.06037569046020508}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56112, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56112, "timers": {"training_iteration_time_ms": 1996.775, "learn_time_ms": 19.321, "learn_throughput": 17390.779, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 56112, "num_agent_steps_trained": 56112}, "done": false, "episodes_total": 167, "training_iteration": 167, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-07", "timestamp": 1711724587, "time_this_iter_s": 1.9864015579223633, "time_total_s": 329.8107855319977, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3760>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a04160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 329.8107855319977, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.033333333333334, "ram_util_percent": 24.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.302371530051955e+32, "policy_entropy": 3692.228759765625, "var_gnorm": 22.71225357055664, "vf_loss": 779943149568.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001392364501953125, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 168, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316273.8945953772, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540020180343934, "mean_inference_ms": 5.246085055608104, "mean_action_processing_ms": 0.14440875965677985, "mean_env_wait_ms": 0.25372374820384525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015233278274536133, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.060343265533447266}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316273.8945953772, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-319424.300412921, -333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540020180343934, "mean_inference_ms": 5.246085055608104, "mean_action_processing_ms": 0.14440875965677985, "mean_env_wait_ms": 0.25372374820384525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015233278274536133, "StateBufferConnector_ms": 0.002297639846801758, "ViewRequirementAgentConnector_ms": 0.060343265533447266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448, "num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56448, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56448, "timers": {"training_iteration_time_ms": 1995.621, "learn_time_ms": 19.34, "learn_throughput": 17372.964, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 56448, "num_env_steps_trained": 56448, "num_agent_steps_sampled": 56448, "num_agent_steps_trained": 56448}, "done": false, "episodes_total": 168, "training_iteration": 168, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-09", "timestamp": 1711724589, "time_this_iter_s": 1.9701194763183594, "time_total_s": 331.78090500831604, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6e800>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf2e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 331.78090500831604, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.166666666666667, "ram_util_percent": 24.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.7516438946941635e+32, "policy_entropy": 3691.890380859375, "var_gnorm": 22.71225357055664, "vf_loss": 890121355264.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011754035949707031, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 169, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316337.2440529701, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540081388408568, "mean_inference_ms": 5.246165683459457, "mean_action_processing_ms": 0.14441604502349775, "mean_env_wait_ms": 0.25372917157197733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241146087646484, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.06034660339355469}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316337.2440529701, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333968.52415001695, -306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540081388408568, "mean_inference_ms": 5.246165683459457, "mean_action_processing_ms": 0.14441604502349775, "mean_env_wait_ms": 0.25372917157197733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015241146087646484, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.06034660339355469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784, "num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 56784, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 56784, "timers": {"training_iteration_time_ms": 1994.893, "learn_time_ms": 19.369, "learn_throughput": 17347.046, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 56784, "num_env_steps_trained": 56784, "num_agent_steps_sampled": 56784, "num_agent_steps_trained": 56784}, "done": false, "episodes_total": 169, "training_iteration": 169, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-11", "timestamp": 1711724591, "time_this_iter_s": 1.9575304985046387, "time_total_s": 333.7384355068207, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0d60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a05ab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 333.7384355068207, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 25.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -9.056275698821177e+32, "policy_entropy": 3690.7998046875, "var_gnorm": 22.71225357055664, "vf_loss": 780618235904.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00015473365783691406, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 170, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316001.5184640075, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540141856340488, "mean_inference_ms": 5.246245929453966, "mean_action_processing_ms": 0.14442336093907535, "mean_env_wait_ms": 0.25373474700151866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239477157592773, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.060359954833984375}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316001.5184640075, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-306941.18522683386, -274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540141856340488, "mean_inference_ms": 5.246245929453966, "mean_action_processing_ms": 0.14442336093907535, "mean_env_wait_ms": 0.25373474700151866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015239477157592773, "StateBufferConnector_ms": 0.0022988319396972656, "ViewRequirementAgentConnector_ms": 0.060359954833984375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120, "num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57120, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57120, "timers": {"training_iteration_time_ms": 1996.764, "learn_time_ms": 19.396, "learn_throughput": 17323.206, "synch_weights_time_ms": 0.158}, "counters": {"num_env_steps_sampled": 57120, "num_env_steps_trained": 57120, "num_agent_steps_sampled": 57120, "num_agent_steps_trained": 57120}, "done": false, "episodes_total": 170, "training_iteration": 170, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-13", "timestamp": 1711724593, "time_this_iter_s": 1.977916955947876, "time_total_s": 335.71635246276855, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6fee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcf370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 335.71635246276855, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 25.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.956689639882228e+32, "policy_entropy": 3692.5595703125, "var_gnorm": 22.71225357055664, "vf_loss": 768772341760.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001684427261352539, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 171, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "sampler_results": {"episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315927.8246299124, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154020784035379, "mean_inference_ms": 5.246333866607219, "mean_action_processing_ms": 0.14443108975331648, "mean_env_wait_ms": 0.2537412733190614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015232324600219727, "StateBufferConnector_ms": 0.0023000240325927734, "ViewRequirementAgentConnector_ms": 0.06036996841430664}}, "episode_reward_max": -274947.98942718416, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -315927.8246299124, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-274947.98942718416, -282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.154020784035379, "mean_inference_ms": 5.246333866607219, "mean_action_processing_ms": 0.14443108975331648, "mean_env_wait_ms": 0.2537412733190614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015232324600219727, "StateBufferConnector_ms": 0.0023000240325927734, "ViewRequirementAgentConnector_ms": 0.06036996841430664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456, "num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57456, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57456, "timers": {"training_iteration_time_ms": 2000.111, "learn_time_ms": 19.309, "learn_throughput": 17401.366, "synch_weights_time_ms": 0.159}, "counters": {"num_env_steps_sampled": 57456, "num_env_steps_trained": 57456, "num_agent_steps_sampled": 57456, "num_agent_steps_trained": 57456}, "done": false, "episodes_total": 171, "training_iteration": 171, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-15", "timestamp": 1711724595, "time_this_iter_s": 2.019258737564087, "time_total_s": 337.73561120033264, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1360>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a05750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 337.73561120033264, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.400000000000001, "ram_util_percent": 25.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.7928236771288e+32, "policy_entropy": 3690.615478515625, "var_gnorm": 22.71225357055664, "vf_loss": 977927667712.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011444091796875, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 172, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316515.97352429666, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540280604018175, "mean_inference_ms": 5.246429237171647, "mean_action_processing_ms": 0.14443931108737418, "mean_env_wait_ms": 0.25374847143540213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263080596923828, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.06049656867980957}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316515.97352429666, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-282085.19665913424, -289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540280604018175, "mean_inference_ms": 5.246429237171647, "mean_action_processing_ms": 0.14443931108737418, "mean_env_wait_ms": 0.25374847143540213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263080596923828, "StateBufferConnector_ms": 0.0023050308227539062, "ViewRequirementAgentConnector_ms": 0.06049656867980957}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792, "num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 57792, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 57792, "timers": {"training_iteration_time_ms": 1996.916, "learn_time_ms": 19.409, "learn_throughput": 17311.885, "synch_weights_time_ms": 0.162}, "counters": {"num_env_steps_sampled": 57792, "num_env_steps_trained": 57792, "num_agent_steps_sampled": 57792, "num_agent_steps_trained": 57792}, "done": false, "episodes_total": 172, "training_iteration": 172, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-17", "timestamp": 1711724597, "time_this_iter_s": 2.0043041706085205, "time_total_s": 339.73991537094116, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6d900>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a04820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 339.73991537094116, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 25.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.607990171322683e+32, "policy_entropy": 3690.781005859375, "var_gnorm": 22.71225357055664, "vf_loss": 733154639872.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012385845184326172, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 173, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316563.52892755775, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540352313255024, "mean_inference_ms": 5.246526437201685, "mean_action_processing_ms": 0.1444473228941043, "mean_env_wait_ms": 0.2537554469292511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015257120132446289, "StateBufferConnector_ms": 0.002306222915649414, "ViewRequirementAgentConnector_ms": 0.060509681701660156}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316563.52892755775, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-289607.8514971606, -332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540352313255024, "mean_inference_ms": 5.246526437201685, "mean_action_processing_ms": 0.1444473228941043, "mean_env_wait_ms": 0.2537554469292511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015257120132446289, "StateBufferConnector_ms": 0.002306222915649414, "ViewRequirementAgentConnector_ms": 0.060509681701660156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128, "num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58128, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58128, "timers": {"training_iteration_time_ms": 1994.907, "learn_time_ms": 19.384, "learn_throughput": 17334.073, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 58128, "num_env_steps_trained": 58128, "num_agent_steps_sampled": 58128, "num_agent_steps_trained": 58128}, "done": false, "episodes_total": 173, "training_iteration": 173, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-19", "timestamp": 1711724599, "time_this_iter_s": 1.9732372760772705, "time_total_s": 341.71315264701843, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb38b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a069e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 341.71315264701843, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.6000000000000005, "ram_util_percent": 25.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.502697087397194e+32, "policy_entropy": 3693.0166015625, "var_gnorm": 22.71225357055664, "vf_loss": 771625582592.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013208389282226562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 174, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316630.3566602588, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540429145690062, "mean_inference_ms": 5.246641095473692, "mean_action_processing_ms": 0.1444555430339157, "mean_env_wait_ms": 0.25376318601687464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268802642822266, "StateBufferConnector_ms": 0.002306222915649414, "ViewRequirementAgentConnector_ms": 0.0605316162109375}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316630.3566602588, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-332499.57292512315, -289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540429145690062, "mean_inference_ms": 5.246641095473692, "mean_action_processing_ms": 0.1444555430339157, "mean_env_wait_ms": 0.25376318601687464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015268802642822266, "StateBufferConnector_ms": 0.002306222915649414, "ViewRequirementAgentConnector_ms": 0.0605316162109375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464, "num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58464, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58464, "timers": {"training_iteration_time_ms": 1999.519, "learn_time_ms": 19.371, "learn_throughput": 17345.274, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 58464, "num_env_steps_trained": 58464, "num_agent_steps_sampled": 58464, "num_agent_steps_trained": 58464}, "done": false, "episodes_total": 174, "training_iteration": 174, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-21", "timestamp": 1711724601, "time_this_iter_s": 2.078871488571167, "time_total_s": 343.7920241355896, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2ec0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a07250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 343.7920241355896, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.533333333333334, "ram_util_percent": 25.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0420182326804041e+33, "policy_entropy": 3692.486572265625, "var_gnorm": 22.71225357055664, "vf_loss": 998763069440.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001373291015625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 175, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316654.72577739495, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540507104594645, "mean_inference_ms": 5.246754884444897, "mean_action_processing_ms": 0.1444639279615554, "mean_env_wait_ms": 0.2537712601910224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526021957397461, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.06050992012023926}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316654.72577739495, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-289002.89579510473, -276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540507104594645, "mean_inference_ms": 5.246754884444897, "mean_action_processing_ms": 0.1444639279615554, "mean_env_wait_ms": 0.2537712601910224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526021957397461, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.06050992012023926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 58800, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 58800, "timers": {"training_iteration_time_ms": 1996.889, "learn_time_ms": 19.291, "learn_throughput": 17417.797, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 58800, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 58800, "num_agent_steps_trained": 58800}, "done": false, "episodes_total": 175, "training_iteration": 175, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-23", "timestamp": 1711724603, "time_this_iter_s": 2.0129339694976807, "time_total_s": 345.8049581050873, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f520>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a04ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 345.8049581050873, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.133333333333333, "ram_util_percent": 25.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.794429614187576e+31, "policy_entropy": 3691.0458984375, "var_gnorm": 22.71225357055664, "vf_loss": 897251016704.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001277923583984375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 176, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316901.28592284897, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15405857494674868, "mean_inference_ms": 5.246870468077638, "mean_action_processing_ms": 0.14447240540635803, "mean_env_wait_ms": 0.25377947401625545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267372131347656, "StateBufferConnector_ms": 0.0023064613342285156, "ViewRequirementAgentConnector_ms": 0.06053471565246582}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316901.28592284897, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276785.64592942083, -339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15405857494674868, "mean_inference_ms": 5.246870468077638, "mean_action_processing_ms": 0.14447240540635803, "mean_env_wait_ms": 0.25377947401625545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015267372131347656, "StateBufferConnector_ms": 0.0023064613342285156, "ViewRequirementAgentConnector_ms": 0.06053471565246582}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136, "num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59136, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59136, "timers": {"training_iteration_time_ms": 1995.785, "learn_time_ms": 19.282, "learn_throughput": 17425.593, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 59136, "num_env_steps_trained": 59136, "num_agent_steps_sampled": 59136, "num_agent_steps_trained": 59136}, "done": false, "episodes_total": 176, "training_iteration": 176, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-25", "timestamp": 1711724605, "time_this_iter_s": 1.982245922088623, "time_total_s": 347.7872040271759, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc4bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a07c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 347.7872040271759, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.5808720944401273e+32, "policy_entropy": 3691.19384765625, "var_gnorm": 22.71225357055664, "vf_loss": 1070539472896.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010788440704345703, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 177, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317549.25315951597, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540662811297112, "mean_inference_ms": 5.2469865151045925, "mean_action_processing_ms": 0.1444809460523019, "mean_env_wait_ms": 0.2537880511065489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526331901550293, "StateBufferConnector_ms": 0.0023059844970703125, "ViewRequirementAgentConnector_ms": 0.06048440933227539}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317549.25315951597, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-339861.5352393181, -335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540662811297112, "mean_inference_ms": 5.2469865151045925, "mean_action_processing_ms": 0.1444809460523019, "mean_env_wait_ms": 0.2537880511065489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01526331901550293, "StateBufferConnector_ms": 0.0023059844970703125, "ViewRequirementAgentConnector_ms": 0.06048440933227539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472, "num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59472, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59472, "timers": {"training_iteration_time_ms": 1994.942, "learn_time_ms": 19.218, "learn_throughput": 17483.161, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 59472, "num_env_steps_trained": 59472, "num_agent_steps_sampled": 59472, "num_agent_steps_trained": 59472}, "done": false, "episodes_total": 177, "training_iteration": 177, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-27", "timestamp": 1711724607, "time_this_iter_s": 1.9779434204101562, "time_total_s": 349.76514744758606, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6cbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a06560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 349.76514744758606, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1973765353893687e+33, "policy_entropy": 3692.51904296875, "var_gnorm": 22.71225357055664, "vf_loss": 1129193275392.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001417398452758789, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 178, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317738.5888485108, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540740515537279, "mean_inference_ms": 5.247104493390161, "mean_action_processing_ms": 0.14448951288057876, "mean_env_wait_ms": 0.25379674985437967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263557434082031, "StateBufferConnector_ms": 0.0023069381713867188, "ViewRequirementAgentConnector_ms": 0.0604705810546875}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317738.5888485108, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-335217.808765443, -307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540740515537279, "mean_inference_ms": 5.247104493390161, "mean_action_processing_ms": 0.14448951288057876, "mean_env_wait_ms": 0.25379674985437967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015263557434082031, "StateBufferConnector_ms": 0.0023069381713867188, "ViewRequirementAgentConnector_ms": 0.0604705810546875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808, "num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 59808, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 59808, "timers": {"training_iteration_time_ms": 1993.613, "learn_time_ms": 19.183, "learn_throughput": 17515.69, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 59808, "num_env_steps_trained": 59808, "num_agent_steps_sampled": 59808, "num_agent_steps_trained": 59808}, "done": false, "episodes_total": 178, "training_iteration": 178, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-29", "timestamp": 1711724609, "time_this_iter_s": 1.9568421840667725, "time_total_s": 351.72198963165283, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb36a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518bcfe20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 351.72198963165283, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 26.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0219139316999046e+33, "policy_entropy": 3692.794189453125, "var_gnorm": 22.71225357055664, "vf_loss": 745512108032.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017583370208740234, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 179, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317479.31598830386, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408183244035759, "mean_inference_ms": 5.2472241334646785, "mean_action_processing_ms": 0.14449801822224162, "mean_env_wait_ms": 0.25380522405311084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287160873413086, "StateBufferConnector_ms": 0.002309560775756836, "ViewRequirementAgentConnector_ms": 0.06053972244262695}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317479.31598830386, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-307407.401470437, -328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408183244035759, "mean_inference_ms": 5.2472241334646785, "mean_action_processing_ms": 0.14449801822224162, "mean_env_wait_ms": 0.25380522405311084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015287160873413086, "StateBufferConnector_ms": 0.002309560775756836, "ViewRequirementAgentConnector_ms": 0.06053972244262695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144, "num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60144, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60144, "timers": {"training_iteration_time_ms": 1996.581, "learn_time_ms": 19.181, "learn_throughput": 17517.78, "synch_weights_time_ms": 0.154}, "counters": {"num_env_steps_sampled": 60144, "num_env_steps_trained": 60144, "num_agent_steps_sampled": 60144, "num_agent_steps_trained": 60144}, "done": false, "episodes_total": 179, "training_iteration": 179, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-31", "timestamp": 1711724611, "time_this_iter_s": 1.9872443675994873, "time_total_s": 353.7092339992523, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb15a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a05e10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 353.7092339992523, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 26.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.797481039670349e+32, "policy_entropy": 3692.64013671875, "var_gnorm": 22.71225357055664, "vf_loss": 957066969088.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012230873107910156, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 180, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317751.018617038, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408972834771043, "mean_inference_ms": 5.2473511422443115, "mean_action_processing_ms": 0.14450661367217074, "mean_env_wait_ms": 0.25381406091784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302181243896484, "StateBufferConnector_ms": 0.0023097991943359375, "ViewRequirementAgentConnector_ms": 0.06055283546447754}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317751.018617038, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-328353.0137099033, -303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15408972834771043, "mean_inference_ms": 5.2473511422443115, "mean_action_processing_ms": 0.14450661367217074, "mean_env_wait_ms": 0.25381406091784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015302181243896484, "StateBufferConnector_ms": 0.0023097991943359375, "ViewRequirementAgentConnector_ms": 0.06055283546447754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480, "num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60480, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60480, "timers": {"training_iteration_time_ms": 2000.109, "learn_time_ms": 19.182, "learn_throughput": 17516.038, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 60480, "num_env_steps_trained": 60480, "num_agent_steps_sampled": 60480, "num_agent_steps_trained": 60480}, "done": false, "episodes_total": 180, "training_iteration": 180, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-33", "timestamp": 1711724613, "time_this_iter_s": 2.013204574584961, "time_total_s": 355.7224385738373, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6d660>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a077f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 355.7224385738373, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.233333333333333, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.205819883410224e+32, "policy_entropy": 3691.618896484375, "var_gnorm": 22.71225357055664, "vf_loss": 1133883686912.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012946128845214844, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 181, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318113.07725450426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15409775688766034, "mean_inference_ms": 5.247486392200633, "mean_action_processing_ms": 0.14451538746820805, "mean_env_wait_ms": 0.2538232596036137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300989151000977, "StateBufferConnector_ms": 0.0023093223571777344, "ViewRequirementAgentConnector_ms": 0.060552358627319336}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318113.07725450426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-303756.4646302228, -306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15409775688766034, "mean_inference_ms": 5.247486392200633, "mean_action_processing_ms": 0.14451538746820805, "mean_env_wait_ms": 0.2538232596036137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015300989151000977, "StateBufferConnector_ms": 0.0023093223571777344, "ViewRequirementAgentConnector_ms": 0.060552358627319336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816, "num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 60816, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 60816, "timers": {"training_iteration_time_ms": 1995.469, "learn_time_ms": 19.08, "learn_throughput": 17610.397, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 60816, "num_env_steps_trained": 60816, "num_agent_steps_sampled": 60816, "num_agent_steps_trained": 60816}, "done": false, "episodes_total": 181, "training_iteration": 181, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-35", "timestamp": 1711724615, "time_this_iter_s": 1.9728567600250244, "time_total_s": 357.6952953338623, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a06dd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 357.6952953338623, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.0709589496613226e+33, "policy_entropy": 3692.570556640625, "var_gnorm": 22.71225357055664, "vf_loss": 946760450048.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017392635345458984, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 182, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318518.0897483361, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410578957850268, "mean_inference_ms": 5.247624373950449, "mean_action_processing_ms": 0.14452412697334563, "mean_env_wait_ms": 0.25383260987496964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306711196899414, "StateBufferConnector_ms": 0.002309083938598633, "ViewRequirementAgentConnector_ms": 0.0605626106262207}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318518.0897483361, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-306391.6825605047, -336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15410578957850268, "mean_inference_ms": 5.247624373950449, "mean_action_processing_ms": 0.14452412697334563, "mean_env_wait_ms": 0.25383260987496964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015306711196899414, "StateBufferConnector_ms": 0.002309083938598633, "ViewRequirementAgentConnector_ms": 0.0605626106262207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152, "num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61152, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61152, "timers": {"training_iteration_time_ms": 1991.272, "learn_time_ms": 19.007, "learn_throughput": 17677.661, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 61152, "num_env_steps_trained": 61152, "num_agent_steps_sampled": 61152, "num_agent_steps_trained": 61152}, "done": false, "episodes_total": 182, "training_iteration": 182, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-37", "timestamp": 1711724617, "time_this_iter_s": 1.9622859954833984, "time_total_s": 359.6575813293457, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97df0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a34b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 359.6575813293457, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.733333333333334, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.138706898461678e+32, "policy_entropy": 3691.967041015625, "var_gnorm": 22.71225357055664, "vf_loss": 804686135296.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001627206802368164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 183, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318551.27896191465, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15411385186735715, "mean_inference_ms": 5.247759926490042, "mean_action_processing_ms": 0.14453282117174646, "mean_env_wait_ms": 0.2538418338104968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015317916870117188, "StateBufferConnector_ms": 0.002309560775756836, "ViewRequirementAgentConnector_ms": 0.06056833267211914}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318551.27896191465, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-336198.7296830463, -371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15411385186735715, "mean_inference_ms": 5.247759926490042, "mean_action_processing_ms": 0.14453282117174646, "mean_env_wait_ms": 0.2538418338104968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015317916870117188, "StateBufferConnector_ms": 0.002309560775756836, "ViewRequirementAgentConnector_ms": 0.06056833267211914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488, "num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61488, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61488, "timers": {"training_iteration_time_ms": 1989.99, "learn_time_ms": 18.959, "learn_throughput": 17722.746, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 61488, "num_env_steps_trained": 61488, "num_agent_steps_sampled": 61488, "num_agent_steps_trained": 61488}, "done": false, "episodes_total": 183, "training_iteration": 183, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-39", "timestamp": 1711724619, "time_this_iter_s": 1.960456132888794, "time_total_s": 361.6180374622345, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c97010>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a065f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 361.6180374622345, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.8, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.258960780734122e+31, "policy_entropy": 3691.029052734375, "var_gnorm": 22.71225357055664, "vf_loss": 880914661376.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012040138244628906, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 184, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318320.9042293606, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541221838600843, "mean_inference_ms": 5.247902105910432, "mean_action_processing_ms": 0.14454171504532862, "mean_env_wait_ms": 0.2538514220514871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312671661376953, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06058001518249512}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -318320.9042293606, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-371859.8493685391, -310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541221838600843, "mean_inference_ms": 5.247902105910432, "mean_action_processing_ms": 0.14454171504532862, "mean_env_wait_ms": 0.2538514220514871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015312671661376953, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06058001518249512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824, "num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 61824, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 61824, "timers": {"training_iteration_time_ms": 1979.344, "learn_time_ms": 18.91, "learn_throughput": 17768.262, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 61824, "num_env_steps_trained": 61824, "num_agent_steps_sampled": 61824, "num_agent_steps_trained": 61824}, "done": false, "episodes_total": 184, "training_iteration": 184, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-41", "timestamp": 1711724621, "time_this_iter_s": 1.9723775386810303, "time_total_s": 363.5904150009155, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb0190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a34f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 363.5904150009155, "timesteps_since_restore": 0, "iterations_since_restore": 184, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.566666666666666, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1599443041086639e+32, "policy_entropy": 3692.32470703125, "var_gnorm": 22.71225357055664, "vf_loss": 982343811072.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011396408081054688, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 185, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317983.40898620314, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541304400807778, "mean_inference_ms": 5.248044932122594, "mean_action_processing_ms": 0.14455055766314073, "mean_env_wait_ms": 0.2538609346606611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313386917114258, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06057286262512207}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317983.40898620314, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-310045.3874294073, -312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541304400807778, "mean_inference_ms": 5.248044932122594, "mean_action_processing_ms": 0.14455055766314073, "mean_env_wait_ms": 0.2538609346606611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015313386917114258, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06057286262512207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160, "num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62160, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62160, "timers": {"training_iteration_time_ms": 1975.266, "learn_time_ms": 18.936, "learn_throughput": 17743.877, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 62160, "num_env_steps_trained": 62160, "num_agent_steps_sampled": 62160, "num_agent_steps_trained": 62160}, "done": false, "episodes_total": 185, "training_iteration": 185, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-43", "timestamp": 1711724623, "time_this_iter_s": 1.9721269607543945, "time_total_s": 365.5625419616699, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cc4af0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a35c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 365.5625419616699, "timesteps_since_restore": 0, "iterations_since_restore": 185, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.6, "ram_util_percent": 26.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -6.228909045749299e+31, "policy_entropy": 3690.5849609375, "var_gnorm": 22.71225357055664, "vf_loss": 748626116608.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013339519500732422, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 186, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317828.9113014543, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413855265747314, "mean_inference_ms": 5.248177171362674, "mean_action_processing_ms": 0.14455942877819639, "mean_env_wait_ms": 0.2538704177328003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328407287597656, "StateBufferConnector_ms": 0.0023012161254882812, "ViewRequirementAgentConnector_ms": 0.06056690216064453}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317828.9113014543, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-312455.7886336757, -326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15413855265747314, "mean_inference_ms": 5.248177171362674, "mean_action_processing_ms": 0.14455942877819639, "mean_env_wait_ms": 0.2538704177328003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015328407287597656, "StateBufferConnector_ms": 0.0023012161254882812, "ViewRequirementAgentConnector_ms": 0.06056690216064453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496, "num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62496, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62496, "timers": {"training_iteration_time_ms": 1974.75, "learn_time_ms": 18.93, "learn_throughput": 17749.799, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 62496, "num_env_steps_trained": 62496, "num_agent_steps_sampled": 62496, "num_agent_steps_trained": 62496}, "done": false, "episodes_total": 186, "training_iteration": 186, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-45", "timestamp": 1711724625, "time_this_iter_s": 1.977055549621582, "time_total_s": 367.5395975112915, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb20e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a35090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 367.5395975112915, "timesteps_since_restore": 0, "iterations_since_restore": 186, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7.798237702997999e+32, "policy_entropy": 3692.498779296875, "var_gnorm": 22.71225357055664, "vf_loss": 695219716096.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001462697982788086, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 187, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317504.8769776353, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15414666022616932, "mean_inference_ms": 5.248309343576895, "mean_action_processing_ms": 0.14456831977439683, "mean_env_wait_ms": 0.25388004478878484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.060565948486328125}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317504.8769776353, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-326823.6478300991, -327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15414666022616932, "mean_inference_ms": 5.248309343576895, "mean_action_processing_ms": 0.14456831977439683, "mean_env_wait_ms": 0.25388004478878484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015330314636230469, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.060565948486328125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832, "num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 62832, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 62832, "timers": {"training_iteration_time_ms": 1973.794, "learn_time_ms": 18.951, "learn_throughput": 17730.037, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 62832, "num_env_steps_trained": 62832, "num_agent_steps_sampled": 62832, "num_agent_steps_trained": 62832}, "done": false, "episodes_total": 187, "training_iteration": 187, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-47", "timestamp": 1711724627, "time_this_iter_s": 1.9684131145477295, "time_total_s": 369.50801062583923, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c94e80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a35f30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 369.50801062583923, "timesteps_since_restore": 0, "iterations_since_restore": 187, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.314607893171827e+32, "policy_entropy": 3691.720703125, "var_gnorm": 22.71225357055664, "vf_loss": 791501012992.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013744831085205078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 188, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317276.21833396907, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415473498902202, "mean_inference_ms": 5.2484429717339784, "mean_action_processing_ms": 0.14457723962724353, "mean_env_wait_ms": 0.25388956068375446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339136123657227, "StateBufferConnector_ms": 0.002308368682861328, "ViewRequirementAgentConnector_ms": 0.06057310104370117}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317276.21833396907, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-327760.6666732629, -341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15415473498902202, "mean_inference_ms": 5.2484429717339784, "mean_action_processing_ms": 0.14457723962724353, "mean_env_wait_ms": 0.25388956068375446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339136123657227, "StateBufferConnector_ms": 0.002308368682861328, "ViewRequirementAgentConnector_ms": 0.06057310104370117}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168, "num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63168, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63168, "timers": {"training_iteration_time_ms": 1975.952, "learn_time_ms": 19.014, "learn_throughput": 17671.211, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 63168, "num_env_steps_trained": 63168, "num_agent_steps_sampled": 63168, "num_agent_steps_trained": 63168}, "done": false, "episodes_total": 188, "training_iteration": 188, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-49", "timestamp": 1711724629, "time_this_iter_s": 1.978421688079834, "time_total_s": 371.48643231391907, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c943d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a07eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 371.48643231391907, "timesteps_since_restore": 0, "iterations_since_restore": 188, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -8.410949935742101e+32, "policy_entropy": 3692.438720703125, "var_gnorm": 22.71225357055664, "vf_loss": 669904666624.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014328956604003906, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 189, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316770.80740685784, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541629518759324, "mean_inference_ms": 5.248581194397435, "mean_action_processing_ms": 0.14458631908111902, "mean_env_wait_ms": 0.2538994353358119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336036682128906, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.060553550720214844}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316770.80740685784, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-341540.89579601475, -275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1541629518759324, "mean_inference_ms": 5.248581194397435, "mean_action_processing_ms": 0.14458631908111902, "mean_env_wait_ms": 0.2538994353358119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015336036682128906, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.060553550720214844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504, "num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63504, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63504, "timers": {"training_iteration_time_ms": 1975.515, "learn_time_ms": 19.078, "learn_throughput": 17612.048, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 63504, "num_env_steps_trained": 63504, "num_agent_steps_sampled": 63504, "num_agent_steps_trained": 63504}, "done": false, "episodes_total": 189, "training_iteration": 189, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-51", "timestamp": 1711724631, "time_this_iter_s": 1.982877492904663, "time_total_s": 373.46930980682373, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3640>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a35c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 373.46930980682373, "timesteps_since_restore": 0, "iterations_since_restore": 189, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.433333333333334, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.3587821696859696e+32, "policy_entropy": 3692.539306640625, "var_gnorm": 22.71225357055664, "vf_loss": 901141889024.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012505054473876953, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 190, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "sampler_results": {"episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316539.61793809367, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417137402487613, "mean_inference_ms": 5.248725535557386, "mean_action_processing_ms": 0.1445956287646011, "mean_env_wait_ms": 0.25390965783546837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533818244934082, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.06054258346557617}}, "episode_reward_max": -275197.41596146056, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316539.61793809367, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275197.41596146056, -302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417137402487613, "mean_inference_ms": 5.248725535557386, "mean_action_processing_ms": 0.1445956287646011, "mean_env_wait_ms": 0.25390965783546837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01533818244934082, "StateBufferConnector_ms": 0.002307415008544922, "ViewRequirementAgentConnector_ms": 0.06054258346557617}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840, "num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 63840, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 63840, "timers": {"training_iteration_time_ms": 1971.964, "learn_time_ms": 19.076, "learn_throughput": 17613.721, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 63840, "num_env_steps_trained": 63840, "num_agent_steps_sampled": 63840, "num_agent_steps_trained": 63840}, "done": false, "episodes_total": 190, "training_iteration": 190, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-53", "timestamp": 1711724633, "time_this_iter_s": 1.977642297744751, "time_total_s": 375.4469521045685, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb36a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a07d90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 375.4469521045685, "timesteps_since_restore": 0, "iterations_since_restore": 190, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.133333333333333, "ram_util_percent": 27.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.7740121779098495e+32, "policy_entropy": 3693.6435546875, "var_gnorm": 22.71225357055664, "vf_loss": 891893448704.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00010156631469726562, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 191, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316852.1668377349, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417994134805516, "mean_inference_ms": 5.248873477376703, "mean_action_processing_ms": 0.1446050765888831, "mean_env_wait_ms": 0.2539200472770332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.0023071765899658203, "ViewRequirementAgentConnector_ms": 0.06055736541748047}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316852.1668377349, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-302309.1327156715, -310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15417994134805516, "mean_inference_ms": 5.248873477376703, "mean_action_processing_ms": 0.1446050765888831, "mean_env_wait_ms": 0.2539200472770332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015334844589233398, "StateBufferConnector_ms": 0.0023071765899658203, "ViewRequirementAgentConnector_ms": 0.06055736541748047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176, "num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64176, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64176, "timers": {"training_iteration_time_ms": 1971.462, "learn_time_ms": 19.188, "learn_throughput": 17511.25, "synch_weights_time_ms": 0.151}, "counters": {"num_env_steps_sampled": 64176, "num_env_steps_trained": 64176, "num_agent_steps_sampled": 64176, "num_agent_steps_trained": 64176}, "done": false, "episodes_total": 191, "training_iteration": 191, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-55", "timestamp": 1711724635, "time_this_iter_s": 1.9678406715393066, "time_total_s": 377.4147927761078, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c5ef20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a34f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 377.4147927761078, "timesteps_since_restore": 0, "iterations_since_restore": 191, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 27.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.0674279523087458e+32, "policy_entropy": 3691.4072265625, "var_gnorm": 22.71225357055664, "vf_loss": 805584109568.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012826919555664062, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 192, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316954.53214886884, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15418907472849305, "mean_inference_ms": 5.249034780643676, "mean_action_processing_ms": 0.1446150808028047, "mean_env_wait_ms": 0.25393126640126945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015338420867919922, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06058549880981445}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -316954.53214886884, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-310878.5872068108, -320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15418907472849305, "mean_inference_ms": 5.249034780643676, "mean_action_processing_ms": 0.1446150808028047, "mean_env_wait_ms": 0.25393126640126945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015338420867919922, "StateBufferConnector_ms": 0.0023088455200195312, "ViewRequirementAgentConnector_ms": 0.06058549880981445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64512, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 1978.588, "learn_time_ms": 19.175, "learn_throughput": 17522.572, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 192, "training_iteration": 192, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-57", "timestamp": 1711724637, "time_this_iter_s": 2.0335450172424316, "time_total_s": 379.4483377933502, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2ce0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a07250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 379.4483377933502, "timesteps_since_restore": 0, "iterations_since_restore": 192, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 8.233333333333333, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.236148767725615e+32, "policy_entropy": 3691.89990234375, "var_gnorm": 22.71225357055664, "vf_loss": 945784750080.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001169443130493164, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 193, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317233.3284849262, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15419834279701056, "mean_inference_ms": 5.249199936145723, "mean_action_processing_ms": 0.14462519728807632, "mean_env_wait_ms": 0.25394278576814255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015340805053710938, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.060614585876464844}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317233.3284849262, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-320247.6815383688, -307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15419834279701056, "mean_inference_ms": 5.249199936145723, "mean_action_processing_ms": 0.14462519728807632, "mean_env_wait_ms": 0.25394278576814255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015340805053710938, "StateBufferConnector_ms": 0.0023076534271240234, "ViewRequirementAgentConnector_ms": 0.060614585876464844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848, "num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 64848, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 64848, "timers": {"training_iteration_time_ms": 1980.94, "learn_time_ms": 19.183, "learn_throughput": 17515.146, "synch_weights_time_ms": 0.153}, "counters": {"num_env_steps_sampled": 64848, "num_env_steps_trained": 64848, "num_agent_steps_sampled": 64848, "num_agent_steps_trained": 64848}, "done": false, "episodes_total": 193, "training_iteration": 193, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-03-59", "timestamp": 1711724639, "time_this_iter_s": 1.98390793800354, "time_total_s": 381.43224573135376, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3c10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a349d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 381.43224573135376, "timesteps_since_restore": 0, "iterations_since_restore": 193, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.466666666666666, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.642722900262408e+32, "policy_entropy": 3691.42138671875, "var_gnorm": 22.71225357055664, "vf_loss": 1050759135232.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00011718273162841797, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 194, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317351.5615079281, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542080054689834, "mean_inference_ms": 5.249376455915885, "mean_action_processing_ms": 0.14463564482415153, "mean_env_wait_ms": 0.25395500524962594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339374542236328, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.06059098243713379}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317351.5615079281, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-307576.70976856776, -346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1542080054689834, "mean_inference_ms": 5.249376455915885, "mean_action_processing_ms": 0.14463564482415153, "mean_env_wait_ms": 0.25395500524962594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015339374542236328, "StateBufferConnector_ms": 0.002307891845703125, "ViewRequirementAgentConnector_ms": 0.06059098243713379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184, "num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65184, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65184, "timers": {"training_iteration_time_ms": 1984.103, "learn_time_ms": 19.188, "learn_throughput": 17510.815, "synch_weights_time_ms": 0.152}, "counters": {"num_env_steps_sampled": 65184, "num_env_steps_trained": 65184, "num_agent_steps_sampled": 65184, "num_agent_steps_trained": 65184}, "done": false, "episodes_total": 194, "training_iteration": 194, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-01", "timestamp": 1711724641, "time_this_iter_s": 2.004023313522339, "time_total_s": 383.4362690448761, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c95210>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a37130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 383.4362690448761, "timesteps_since_restore": 0, "iterations_since_restore": 194, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.733333333333333, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.145526013796829e+32, "policy_entropy": 3691.511474609375, "var_gnorm": 22.71225357055664, "vf_loss": 826012336128.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0001266002655029297, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 195, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317474.1445590471, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421794223316357, "mean_inference_ms": 5.2495647858032495, "mean_action_processing_ms": 0.14464640886714344, "mean_env_wait_ms": 0.2539678469364262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355825424194336, "StateBufferConnector_ms": 0.002309083938598633, "ViewRequirementAgentConnector_ms": 0.060632944107055664}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317474.1445590471, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-346163.9288788984, -326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421794223316357, "mean_inference_ms": 5.2495647858032495, "mean_action_processing_ms": 0.14464640886714344, "mean_env_wait_ms": 0.2539678469364262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015355825424194336, "StateBufferConnector_ms": 0.002309083938598633, "ViewRequirementAgentConnector_ms": 0.060632944107055664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520, "num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65520, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65520, "timers": {"training_iteration_time_ms": 1987.856, "learn_time_ms": 19.271, "learn_throughput": 17435.144, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 65520, "num_env_steps_trained": 65520, "num_agent_steps_sampled": 65520, "num_agent_steps_trained": 65520}, "done": false, "episodes_total": 195, "training_iteration": 195, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-03", "timestamp": 1711724643, "time_this_iter_s": 2.0096869468688965, "time_total_s": 385.445955991745, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb13c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518ba5090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 385.445955991745, "timesteps_since_restore": 0, "iterations_since_restore": 195, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4.64419588866238e+32, "policy_entropy": 3691.72021484375, "var_gnorm": 22.71225357055664, "vf_loss": 985745391616.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012874603271484375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 196, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317262.2715876426, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422913648730377, "mean_inference_ms": 5.249781417729759, "mean_action_processing_ms": 0.14465844853992715, "mean_env_wait_ms": 0.25398299911249433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378236770629883, "StateBufferConnector_ms": 0.0023114681243896484, "ViewRequirementAgentConnector_ms": 0.06074237823486328}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317262.2715876426, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-326726.5051224949, -327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422913648730377, "mean_inference_ms": 5.249781417729759, "mean_action_processing_ms": 0.14465844853992715, "mean_env_wait_ms": 0.25398299911249433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015378236770629883, "StateBufferConnector_ms": 0.0023114681243896484, "ViewRequirementAgentConnector_ms": 0.06074237823486328}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856, "num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 65856, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 65856, "timers": {"training_iteration_time_ms": 2007.806, "learn_time_ms": 19.313, "learn_throughput": 17397.198, "synch_weights_time_ms": 0.155}, "counters": {"num_env_steps_sampled": 65856, "num_env_steps_trained": 65856, "num_agent_steps_sampled": 65856, "num_agent_steps_trained": 65856}, "done": false, "episodes_total": 196, "training_iteration": 196, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-05", "timestamp": 1711724645, "time_this_iter_s": 2.176652431488037, "time_total_s": 387.62260842323303, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6ec20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a35ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 387.62260842323303, "timesteps_since_restore": 0, "iterations_since_restore": 196, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 19.666666666666668, "ram_util_percent": 27.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3.271945544814732e+32, "policy_entropy": 3692.84765625, "var_gnorm": 22.71225357055664, "vf_loss": 1010021498880.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00012600421905517578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 197, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317439.30573325814, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15424056875036515, "mean_inference_ms": 5.250001700175951, "mean_action_processing_ms": 0.14467061476702534, "mean_env_wait_ms": 0.2539984565420131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371561050415039, "StateBufferConnector_ms": 0.002312183380126953, "ViewRequirementAgentConnector_ms": 0.060739994049072266}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317439.30573325814, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-327964.00504794915, -335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15424056875036515, "mean_inference_ms": 5.250001700175951, "mean_action_processing_ms": 0.14467061476702534, "mean_env_wait_ms": 0.2539984565420131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371561050415039, "StateBufferConnector_ms": 0.002312183380126953, "ViewRequirementAgentConnector_ms": 0.060739994049072266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192, "num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66192, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66192, "timers": {"training_iteration_time_ms": 2011.873, "learn_time_ms": 19.335, "learn_throughput": 17377.934, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 66192, "num_env_steps_trained": 66192, "num_agent_steps_sampled": 66192, "num_agent_steps_trained": 66192}, "done": false, "episodes_total": 197, "training_iteration": 197, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-07", "timestamp": 1711724647, "time_this_iter_s": 2.0090792179107666, "time_total_s": 389.6316876411438, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518c6f850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a04040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 389.6316876411438, "timesteps_since_restore": 0, "iterations_since_restore": 197, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 8.866666666666667, "ram_util_percent": 27.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -5.527052944204387e+32, "policy_entropy": 3691.47900390625, "var_gnorm": 22.71225357055664, "vf_loss": 979809665024.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00014543533325195312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 198, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317504.46878859686, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15425196774947803, "mean_inference_ms": 5.250221912115352, "mean_action_processing_ms": 0.14468270096331534, "mean_env_wait_ms": 0.2540136294308308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379667282104492, "StateBufferConnector_ms": 0.0023136138916015625, "ViewRequirementAgentConnector_ms": 0.06076550483703613}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317504.46878859686, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-335676.94803018315, -298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15425196774947803, "mean_inference_ms": 5.250221912115352, "mean_action_processing_ms": 0.14468270096331534, "mean_env_wait_ms": 0.2540136294308308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379667282104492, "StateBufferConnector_ms": 0.0023136138916015625, "ViewRequirementAgentConnector_ms": 0.06076550483703613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528, "num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66528, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66528, "timers": {"training_iteration_time_ms": 2009.563, "learn_time_ms": 19.354, "learn_throughput": 17360.872, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 66528, "num_env_steps_trained": 66528, "num_agent_steps_sampled": 66528, "num_agent_steps_trained": 66528}, "done": false, "episodes_total": 198, "training_iteration": 198, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-09", "timestamp": 1711724649, "time_this_iter_s": 1.955317497253418, "time_total_s": 391.5870051383972, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb1ba0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a37130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 391.5870051383972, "timesteps_since_restore": 0, "iterations_since_restore": 198, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6063582485316271e+32, "policy_entropy": 3692.062255859375, "var_gnorm": 22.71225357055664, "vf_loss": 929860419584.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00013017654418945312, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 199, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317455.6811695286, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335, -330798.1861233535], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426389007531532, "mean_inference_ms": 5.250452372217935, "mean_action_processing_ms": 0.1446952337668116, "mean_env_wait_ms": 0.2540295313364638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015376091003417969, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.0607142448425293}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317455.6811695286, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-298595.7329290573, -302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335, -330798.1861233535], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15426389007531532, "mean_inference_ms": 5.250452372217935, "mean_action_processing_ms": 0.1446952337668116, "mean_env_wait_ms": 0.2540295313364638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015376091003417969, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.0607142448425293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864, "num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 66864, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 66864, "timers": {"training_iteration_time_ms": 2011.638, "learn_time_ms": 19.287, "learn_throughput": 17420.682, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 66864, "num_env_steps_trained": 66864, "num_agent_steps_sampled": 66864, "num_agent_steps_trained": 66864}, "done": false, "episodes_total": 199, "training_iteration": 199, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-11", "timestamp": 1711724651, "time_this_iter_s": 2.0036191940307617, "time_total_s": 393.590624332428, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb3790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a36200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 393.590624332428, "timesteps_since_restore": 0, "iterations_since_restore": 199, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 7.2, "ram_util_percent": 27.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -2.654951200103489e+32, "policy_entropy": 3690.425048828125, "var_gnorm": 22.71225357055664, "vf_loss": 816751443968.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.00017559528350830078, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 200, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "sampler_results": {"episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317545.4185227097, "episode_len_mean": 336.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335, -330798.1861233535, -307569.46824716864], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427578485263713, "mean_inference_ms": 5.250682527033932, "mean_action_processing_ms": 0.1447077877217418, "mean_env_wait_ms": 0.2540455014172473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373945236206055, "StateBufferConnector_ms": 0.002313375473022461, "ViewRequirementAgentConnector_ms": 0.06069326400756836}}, "episode_reward_max": -277219.57396214746, "episode_reward_min": -383374.31512641814, "episode_reward_mean": -317545.4185227097, "episode_len_mean": 336.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-302681.9232939274, -315660.54038284905, -334749.30450324784, -335956.50647989206, -315314.79484930995, -309320.28502844064, -333349.8397649629, -316145.2275358396, -285867.5703028749, -295195.8584914915, -301870.9856979132, -294856.9817345463, -305168.014689445, -311543.8073982688, -310701.57191559335, -331988.09299691673, -289698.66881477344, -355057.61979952455, -303491.5978701186, -298587.0612090223, -373998.30734404136, -302234.0545813687, -332721.871153644, -293258.7026937931, -306350.0930129358, -333187.8474262441, -337450.18076344574, -319951.7788079675, -301197.14604871173, -279908.1436171755, -353450.6550106203, -364106.0727798863, -317957.46257721586, -322676.2572495183, -316427.9947635982, -341864.9815759311, -317748.6875483046, -302621.3091348096, -331148.5475230501, -284900.0261908636, -287605.5976365027, -300299.2250872132, -304358.2085400809, -316702.6170026713, -383374.31512641814, -326624.28343323147, -302155.57291677623, -352514.4000743076, -317523.41178836586, -337058.77350580704, -315666.98789663566, -287713.50595130306, -302184.89779139485, -324251.63649508316, -314786.7633069221, -314961.7483832894, -282304.466210958, -340297.6718294486, -315441.37191780406, -338138.5449429178, -331963.90651087556, -308213.6970204223, -296721.86385925894, -280344.40880721674, -291227.0014674351, -346034.7065966459, -321092.7563506406, -303188.0655137709, -325759.2461722136, -300395.965253754, -299571.80181732285, -333762.8788656098, -286840.73698524316, -296290.62476726604, -334936.4846387449, -313658.9103405033, -341582.36959612323, -358795.1041388024, -309290.52274475055, -334577.66434384923, -364558.8774565318, -344257.71401340404, -309710.6039183592, -313161.2564276377, -338110.3250527952, -294595.61895452265, -280052.3562517817, -303957.7834634653, -277219.57396214746, -318421.9489195932, -306452.3059255853, -312545.66382906155, -338758.2208125512, -332070.9838385579, -319835.0148804723, -324976.6317384471, -344429.9196840478, -334480.31058182335, -330798.1861233535, -307569.46824716864], "episode_lengths": [336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336, 336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15427578485263713, "mean_inference_ms": 5.250682527033932, "mean_action_processing_ms": 0.1447077877217418, "mean_env_wait_ms": 0.2540455014172473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015373945236206055, "StateBufferConnector_ms": 0.002313375473022461, "ViewRequirementAgentConnector_ms": 0.06069326400756836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200, "num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 67200, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 67200, "timers": {"training_iteration_time_ms": 2012.318, "learn_time_ms": 19.27, "learn_throughput": 17436.308, "synch_weights_time_ms": 0.156}, "counters": {"num_env_steps_sampled": 67200, "num_env_steps_trained": 67200, "num_agent_steps_sampled": 67200, "num_agent_steps_trained": 67200}, "done": true, "episodes_total": 200, "training_iteration": 200, "trial_id": "a860d_00000", "experiment_id": "b7185085f9c6419e9401664da1ba6730", "date": "2024-03-29_15-04-14", "timestamp": 1711724654, "time_this_iter_s": 1.9844944477081299, "time_total_s": 395.5751187801361, "pid": 159714, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x731518cb2980>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x731518a37eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 395.5751187801361, "timesteps_since_restore": 0, "iterations_since_restore": 200, "warmup_time": 3.033953905105591, "perf": {"cpu_util_percent": 6.733333333333333, "ram_util_percent": 27.933333333333334}}
