{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -150195440.0, "policy_entropy": 4233.193359375, "var_gnorm": 22.627458572387695, "vf_loss": 271259697152.0}, "grad_gnorm": 40.0, "vf_explained_var": 2.384185791015625e-07, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 1, "diff_num_grad_updates_vs_sampler_policy": 0}}, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "sampler_results": {"episode_reward_max": -56576.7129336526, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -77746.2218294952, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753], "episode_lengths": [48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17594159180049723, "mean_inference_ms": 5.326222948928968, "mean_action_processing_ms": 0.1528079148923608, "mean_env_wait_ms": 0.269579250663961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014959062848772322, "StateBufferConnector_ms": 0.0025306429181780133, "ViewRequirementAgentConnector_ms": 0.06205354418073382}}, "episode_reward_max": -56576.7129336526, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -77746.2218294952, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753], "episode_lengths": [48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17594159180049723, "mean_inference_ms": 5.326222948928968, "mean_action_processing_ms": 0.1528079148923608, "mean_env_wait_ms": 0.269579250663961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014959062848772322, "StateBufferConnector_ms": 0.0025306429181780133, "ViewRequirementAgentConnector_ms": 0.06205354418073382}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336, "num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 336, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 336, "timers": {"training_iteration_time_ms": 2056.161, "learn_time_ms": 55.174, "learn_throughput": 6089.865, "synch_weights_time_ms": 0.184}, "counters": {"num_env_steps_sampled": 336, "num_env_steps_trained": 336, "num_agent_steps_sampled": 336, "num_agent_steps_trained": 336}, "done": false, "episodes_total": 7, "training_iteration": 1, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-15", "timestamp": 1711723935, "time_this_iter_s": 2.056445837020874, "time_total_s": 2.056445837020874, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1870>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760e4292320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 2.056445837020874, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 6.833333333333333, "ram_util_percent": 10.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -92162184.0, "policy_entropy": 4347.36328125, "var_gnorm": 22.627676010131836, "vf_loss": 115057672192.0}, "grad_gnorm": 40.0, "vf_explained_var": -3.337860107421875e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 2, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "sampler_results": {"episode_reward_max": -38711.75745563855, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -67656.7001819353, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17604077685601016, "mean_inference_ms": 5.3301100571088975, "mean_action_processing_ms": 0.15312266334759977, "mean_env_wait_ms": 0.27034121542250117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01567431858607701, "StateBufferConnector_ms": 0.0025442668369838168, "ViewRequirementAgentConnector_ms": 0.06263596670968193}}, "episode_reward_max": -38711.75745563855, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -67656.7001819353, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17604077685601016, "mean_inference_ms": 5.3301100571088975, "mean_action_processing_ms": 0.15312266334759977, "mean_env_wait_ms": 0.27034121542250117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01567431858607701, "StateBufferConnector_ms": 0.0025442668369838168, "ViewRequirementAgentConnector_ms": 0.06263596670968193}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672, "num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 672, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 672, "timers": {"training_iteration_time_ms": 2038.012, "learn_time_ms": 36.854, "learn_throughput": 9117.108, "synch_weights_time_ms": 0.165}, "counters": {"num_env_steps_sampled": 672, "num_env_steps_trained": 672, "num_agent_steps_sampled": 672, "num_agent_steps_trained": 672}, "done": false, "episodes_total": 14, "training_iteration": 2, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-17", "timestamp": 1711723937, "time_this_iter_s": 2.0201313495635986, "time_total_s": 4.076577186584473, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc531840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x775f69cf1e10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 4.076577186584473, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 10.133333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -80490280.0, "policy_entropy": 4106.05224609375, "var_gnorm": 22.631507873535156, "vf_loss": 88478343168.0}, "grad_gnorm": 40.0, "vf_explained_var": -8.606910705566406e-05, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 3, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "sampler_results": {"episode_reward_max": -38711.75745563855, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -61171.82040639302, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1753096225029403, "mean_inference_ms": 5.320489835907505, "mean_action_processing_ms": 0.15273371211661213, "mean_env_wait_ms": 0.2696847742970976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015367780412946428, "StateBufferConnector_ms": 0.002524966285342262, "ViewRequirementAgentConnector_ms": 0.06185713268461682}}, "episode_reward_max": -38711.75745563855, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -61171.82040639302, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1753096225029403, "mean_inference_ms": 5.320489835907505, "mean_action_processing_ms": 0.15273371211661213, "mean_env_wait_ms": 0.2696847742970976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015367780412946428, "StateBufferConnector_ms": 0.002524966285342262, "ViewRequirementAgentConnector_ms": 0.06185713268461682}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008, "num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1008, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1008, "timers": {"training_iteration_time_ms": 2017.779, "learn_time_ms": 30.927, "learn_throughput": 10864.369, "synch_weights_time_ms": 0.184}, "counters": {"num_env_steps_sampled": 1008, "num_env_steps_trained": 1008, "num_agent_steps_sampled": 1008, "num_agent_steps_trained": 1008}, "done": false, "episodes_total": 21, "training_iteration": 3, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-19", "timestamp": 1711723939, "time_this_iter_s": 1.977595567703247, "time_total_s": 6.05417275428772, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69fd9780>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc46a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 6.05417275428772, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 6.366666666666667, "ram_util_percent": 10.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -69931888.0, "policy_entropy": 3591.47021484375, "var_gnorm": 22.635944366455078, "vf_loss": 80915939328.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.00015246868133544922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 4, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "sampler_results": {"episode_reward_max": -33355.37795701299, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -57048.50639977389, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1743243072286361, "mean_inference_ms": 5.309883702459367, "mean_action_processing_ms": 0.15213041435610908, "mean_env_wait_ms": 0.2685468705506451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014896903719220842, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.06107687950134277}}, "episode_reward_max": -33355.37795701299, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -57048.50639977389, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1743243072286361, "mean_inference_ms": 5.309883702459367, "mean_action_processing_ms": 0.15213041435610908, "mean_env_wait_ms": 0.2685468705506451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014896903719220842, "StateBufferConnector_ms": 0.0024437904357910156, "ViewRequirementAgentConnector_ms": 0.06107687950134277}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344, "num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1344, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1344, "timers": {"training_iteration_time_ms": 2003.937, "learn_time_ms": 27.941, "learn_throughput": 12025.318, "synch_weights_time_ms": 0.175}, "counters": {"num_env_steps_sampled": 1344, "num_env_steps_trained": 1344, "num_agent_steps_sampled": 1344, "num_agent_steps_trained": 1344}, "done": false, "episodes_total": 28, "training_iteration": 4, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-21", "timestamp": 1711723941, "time_this_iter_s": 1.9627301692962646, "time_total_s": 8.016902923583984, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a0e20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4adbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 8.016902923583984, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.266666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -65685988.0, "policy_entropy": 3136.2802734375, "var_gnorm": 22.638202667236328, "vf_loss": 84433723392.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.00019466876983642578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 5, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "sampler_results": {"episode_reward_max": -31043.667134209954, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -54521.79696387848, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17353441065229294, "mean_inference_ms": 5.301744795451459, "mean_action_processing_ms": 0.15161455919975708, "mean_env_wait_ms": 0.26755889330032445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014743804931640625, "StateBufferConnector_ms": 0.0024053028651646207, "ViewRequirementAgentConnector_ms": 0.06085736410958426}}, "episode_reward_max": -31043.667134209954, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -54521.79696387848, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17353441065229294, "mean_inference_ms": 5.301744795451459, "mean_action_processing_ms": 0.15161455919975708, "mean_env_wait_ms": 0.26755889330032445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014743804931640625, "StateBufferConnector_ms": 0.0024053028651646207, "ViewRequirementAgentConnector_ms": 0.06085736410958426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680, "num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 1680, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 1680, "timers": {"training_iteration_time_ms": 1997.685, "learn_time_ms": 26.135, "learn_throughput": 12856.198, "synch_weights_time_ms": 0.168}, "counters": {"num_env_steps_sampled": 1680, "num_env_steps_trained": 1680, "num_agent_steps_sampled": 1680, "num_agent_steps_trained": 1680}, "done": false, "episodes_total": 35, "training_iteration": 5, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-23", "timestamp": 1711723943, "time_this_iter_s": 1.9730093479156494, "time_total_s": 9.989912271499634, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1f90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4ae9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 9.989912271499634, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.333333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -38929728.0, "policy_entropy": 2446.301513671875, "var_gnorm": 22.64280128479004, "vf_loss": 43784609792.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0003657341003417969, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 6, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -50920.5830497485, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1729096661350853, "mean_inference_ms": 5.295773771270335, "mean_action_processing_ms": 0.15120344963073556, "mean_env_wait_ms": 0.2667331858609116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014773436955043249, "StateBufferConnector_ms": 0.00238361812773205, "ViewRequirementAgentConnector_ms": 0.060720670790899364}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -50920.5830497485, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1729096661350853, "mean_inference_ms": 5.295773771270335, "mean_action_processing_ms": 0.15120344963073556, "mean_env_wait_ms": 0.2667331858609116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014773436955043249, "StateBufferConnector_ms": 0.00238361812773205, "ViewRequirementAgentConnector_ms": 0.060720670790899364}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016, "num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2016, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2016, "timers": {"training_iteration_time_ms": 1994.539, "learn_time_ms": 24.977, "learn_throughput": 13452.543, "synch_weights_time_ms": 0.171}, "counters": {"num_env_steps_sampled": 2016, "num_env_steps_trained": 2016, "num_agent_steps_sampled": 2016, "num_agent_steps_trained": 2016}, "done": false, "episodes_total": 42, "training_iteration": 6, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-25", "timestamp": 1711723945, "time_this_iter_s": 1.9791450500488281, "time_total_s": 11.969057321548462, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1cc0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4ae830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 11.969057321548462, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 10.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -33073200.0, "policy_entropy": 1828.671630859375, "var_gnorm": 22.646711349487305, "vf_loss": 44227276800.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.00047397613525390625, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 7, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -48499.91161900389, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17242876710016863, "mean_inference_ms": 5.29034846005009, "mean_action_processing_ms": 0.15086262471116266, "mean_env_wait_ms": 0.2660063002746319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250030828981983, "StateBufferConnector_ms": 0.002368129029565928, "ViewRequirementAgentConnector_ms": 0.0606926120057398}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -48499.91161900389, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17242876710016863, "mean_inference_ms": 5.29034846005009, "mean_action_processing_ms": 0.15086262471116266, "mean_env_wait_ms": 0.2660063002746319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015250030828981983, "StateBufferConnector_ms": 0.002368129029565928, "ViewRequirementAgentConnector_ms": 0.0606926120057398}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352, "num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2352, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2352, "timers": {"training_iteration_time_ms": 1990.275, "learn_time_ms": 24.12, "learn_throughput": 13930.413, "synch_weights_time_ms": 0.167}, "counters": {"num_env_steps_sampled": 2352, "num_env_steps_trained": 2352, "num_agent_steps_sampled": 2352, "num_agent_steps_trained": 2352}, "done": false, "episodes_total": 49, "training_iteration": 7, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-27", "timestamp": 1711723947, "time_this_iter_s": 1.9650378227233887, "time_total_s": 13.93409514427185, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a0190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4af010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 13.93409514427185, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -24084978.0, "policy_entropy": 1141.781005859375, "var_gnorm": 22.649681091308594, "vf_loss": 47474995200.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0005310773849487305, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 8, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -46806.40953363472, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1720383223518214, "mean_inference_ms": 5.286333352604978, "mean_action_processing_ms": 0.15057440314933834, "mean_env_wait_ms": 0.2653693611743596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.0023599181856427875, "ViewRequirementAgentConnector_ms": 0.060757994651794434}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -46806.40953363472, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1720383223518214, "mean_inference_ms": 5.286333352604978, "mean_action_processing_ms": 0.15057440314933834, "mean_env_wait_ms": 0.2653693611743596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519918441772461, "StateBufferConnector_ms": 0.0023599181856427875, "ViewRequirementAgentConnector_ms": 0.060757994651794434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688, "num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 2688, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 2688, "timers": {"training_iteration_time_ms": 1989.228, "learn_time_ms": 23.463, "learn_throughput": 14320.213, "synch_weights_time_ms": 0.163}, "counters": {"num_env_steps_sampled": 2688, "num_env_steps_trained": 2688, "num_agent_steps_sampled": 2688, "num_agent_steps_trained": 2688}, "done": false, "episodes_total": 56, "training_iteration": 8, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-29", "timestamp": 1711723949, "time_this_iter_s": 1.982276439666748, "time_total_s": 15.916371583938599, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69ce8f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc469990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 15.916371583938599, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.85, "ram_util_percent": 10.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -21759470.0, "policy_entropy": 582.429931640625, "var_gnorm": 22.652034759521484, "vf_loss": 69238816768.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0004353523254394531, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 9, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -46362.339183718825, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1716921394824852, "mean_inference_ms": 5.282812248604621, "mean_action_processing_ms": 0.15032606832935613, "mean_env_wait_ms": 0.26482604430363904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503361596001519, "StateBufferConnector_ms": 0.0023440709189763145, "ViewRequirementAgentConnector_ms": 0.06067828526572576}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -46362.339183718825, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1716921394824852, "mean_inference_ms": 5.282812248604621, "mean_action_processing_ms": 0.15032606832935613, "mean_env_wait_ms": 0.26482604430363904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01503361596001519, "StateBufferConnector_ms": 0.0023440709189763145, "ViewRequirementAgentConnector_ms": 0.06067828526572576}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024, "num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3024, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3024, "timers": {"training_iteration_time_ms": 1987.029, "learn_time_ms": 22.916, "learn_throughput": 14662.262, "synch_weights_time_ms": 0.161}, "counters": {"num_env_steps_sampled": 3024, "num_env_steps_trained": 3024, "num_agent_steps_sampled": 3024, "num_agent_steps_trained": 3024}, "done": false, "episodes_total": 63, "training_iteration": 9, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-31", "timestamp": 1711723951, "time_this_iter_s": 1.9698209762573242, "time_total_s": 17.886192560195923, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1210>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4ad480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 17.886192560195923, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 10.666666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -12512539.0, "policy_entropy": -16.609817504882812, "var_gnorm": 22.655643463134766, "vf_loss": 48374362112.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0005745887756347656, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 10, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -45356.709225520484, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17138333272253645, "mean_inference_ms": 5.279342000897943, "mean_action_processing_ms": 0.15009945388166276, "mean_env_wait_ms": 0.26434563541371736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014893327440534319, "StateBufferConnector_ms": 0.002330711909702846, "ViewRequirementAgentConnector_ms": 0.060551847730364115}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -45356.709225520484, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17138333272253645, "mean_inference_ms": 5.279342000897943, "mean_action_processing_ms": 0.15009945388166276, "mean_env_wait_ms": 0.26434563541371736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014893327440534319, "StateBufferConnector_ms": 0.002330711909702846, "ViewRequirementAgentConnector_ms": 0.060551847730364115}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360, "num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3360, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3360, "timers": {"training_iteration_time_ms": 1983.966, "learn_time_ms": 22.483, "learn_throughput": 14944.853, "synch_weights_time_ms": 0.16}, "counters": {"num_env_steps_sampled": 3360, "num_env_steps_trained": 3360, "num_agent_steps_sampled": 3360, "num_agent_steps_trained": 3360}, "done": false, "episodes_total": 70, "training_iteration": 10, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-33", "timestamp": 1711723953, "time_this_iter_s": 1.9567875862121582, "time_total_s": 19.84298014640808, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69fd9e70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4afd90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 19.84298014640808, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 10.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4996852.0, "policy_entropy": -536.521728515625, "var_gnorm": 22.658872604370117, "vf_loss": 49192501248.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0006802082061767578, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 11, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "sampler_results": {"episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -44600.09718570754, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1711062639684518, "mean_inference_ms": 5.276170160782992, "mean_action_processing_ms": 0.1498906979513571, "mean_env_wait_ms": 0.26390319005302776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014741080147879464, "StateBufferConnector_ms": 0.0023213299837979403, "ViewRequirementAgentConnector_ms": 0.060558319091796875}}, "episode_reward_max": -27523.99517032468, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -44600.09718570754, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1711062639684518, "mean_inference_ms": 5.276170160782992, "mean_action_processing_ms": 0.1498906979513571, "mean_env_wait_ms": 0.26390319005302776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014741080147879464, "StateBufferConnector_ms": 0.0023213299837979403, "ViewRequirementAgentConnector_ms": 0.060558319091796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696, "num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 3696, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 3696, "timers": {"training_iteration_time_ms": 1974.592, "learn_time_ms": 18.878, "learn_throughput": 17798.601, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 3696, "num_env_steps_trained": 3696, "num_agent_steps_sampled": 3696, "num_agent_steps_trained": 3696}, "done": false, "episodes_total": 77, "training_iteration": 11, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-35", "timestamp": 1711723955, "time_this_iter_s": 1.9628353118896484, "time_total_s": 21.80581545829773, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a17b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4af910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 21.80581545829773, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 10.833333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": 551423.9375, "policy_entropy": -1092.6094970703125, "var_gnorm": 22.662742614746094, "vf_loss": 39015424000.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.000826716423034668, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 12, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "sampler_results": {"episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -43476.015313159725, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17085013535995838, "mean_inference_ms": 5.27320438818401, "mean_action_processing_ms": 0.14969750731167253, "mean_env_wait_ms": 0.2635021447433236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01464457738967169, "StateBufferConnector_ms": 0.0023146470387776694, "ViewRequirementAgentConnector_ms": 0.060494456972394674}}, "episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -43476.015313159725, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17085013535995838, "mean_inference_ms": 5.27320438818401, "mean_action_processing_ms": 0.14969750731167253, "mean_env_wait_ms": 0.2635021447433236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01464457738967169, "StateBufferConnector_ms": 0.0023146470387776694, "ViewRequirementAgentConnector_ms": 0.060494456972394674}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032, "num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4032, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4032, "timers": {"training_iteration_time_ms": 1968.444, "learn_time_ms": 18.88, "learn_throughput": 17796.174, "synch_weights_time_ms": 0.157}, "counters": {"num_env_steps_sampled": 4032, "num_env_steps_trained": 4032, "num_agent_steps_sampled": 4032, "num_agent_steps_trained": 4032}, "done": false, "episodes_total": 84, "training_iteration": 12, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-37", "timestamp": 1711723957, "time_this_iter_s": 1.9588024616241455, "time_total_s": 23.764617919921875, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69d905e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4aff40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 23.764617919921875, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.766666666666667, "ram_util_percent": 10.933333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": 10043897.0, "policy_entropy": -1726.249755859375, "var_gnorm": 22.667617797851562, "vf_loss": 46744129536.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0008896589279174805, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 13, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "sampler_results": {"episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -42672.538606603695, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17062171129747677, "mean_inference_ms": 5.270570005624704, "mean_action_processing_ms": 0.1495231588244431, "mean_env_wait_ms": 0.2631528842656767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014652786674080313, "StateBufferConnector_ms": 0.0023084682422679858, "ViewRequirementAgentConnector_ms": 0.060427843869387446}}, "episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -42672.538606603695, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17062171129747677, "mean_inference_ms": 5.270570005624704, "mean_action_processing_ms": 0.1495231588244431, "mean_env_wait_ms": 0.2631528842656767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014652786674080313, "StateBufferConnector_ms": 0.0023084682422679858, "ViewRequirementAgentConnector_ms": 0.060427843869387446}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368, "num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4368, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4368, "timers": {"training_iteration_time_ms": 1967.593, "learn_time_ms": 18.989, "learn_throughput": 17694.352, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 4368, "num_env_steps_trained": 4368, "num_agent_steps_sampled": 4368, "num_agent_steps_trained": 4368}, "done": false, "episodes_total": 91, "training_iteration": 13, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-39", "timestamp": 1711723959, "time_this_iter_s": 1.969252586364746, "time_total_s": 25.73387050628662, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1ea0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc358820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 25.73387050628662, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.866666666666667, "ram_util_percent": 11.033333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": 13441291.0, "policy_entropy": -2356.43603515625, "var_gnorm": 22.672725677490234, "vf_loss": 45401595904.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0009577274322509766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 14, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "sampler_results": {"episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -41963.91076799287, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17043805251199334, "mean_inference_ms": 5.268436239725827, "mean_action_processing_ms": 0.14937945989395346, "mean_env_wait_ms": 0.2628567459750878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014912595554273956, "StateBufferConnector_ms": 0.002304875120824697, "ViewRequirementAgentConnector_ms": 0.06043327097990075}}, "episode_reward_max": -26406.76000880952, "episode_reward_min": -91823.19517190478, "episode_reward_mean": -41963.91076799287, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-73575.60033544914, -80713.66963294914, -91823.19517190478, -83388.48641585498, -85446.13328793828, -56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17043805251199334, "mean_inference_ms": 5.268436239725827, "mean_action_processing_ms": 0.14937945989395346, "mean_env_wait_ms": 0.2628567459750878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014912595554273956, "StateBufferConnector_ms": 0.002304875120824697, "ViewRequirementAgentConnector_ms": 0.06043327097990075}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704, "num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 4704, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 4704, "timers": {"training_iteration_time_ms": 1969.878, "learn_time_ms": 18.967, "learn_throughput": 17714.637, "synch_weights_time_ms": 0.15}, "counters": {"num_env_steps_sampled": 4704, "num_env_steps_trained": 4704, "num_agent_steps_sampled": 4704, "num_agent_steps_trained": 4704}, "done": false, "episodes_total": 98, "training_iteration": 14, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-41", "timestamp": 1711723961, "time_this_iter_s": 1.9857230186462402, "time_total_s": 27.71959352493286, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a3340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc3592d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 27.71959352493286, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 11.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": 508784.0, "policy_entropy": -3028.91748046875, "var_gnorm": 22.6784610748291, "vf_loss": 39628083200.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0011217594146728516, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 15, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -72699.75502871753, "episode_reward_mean": -39104.718318995125, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1700043664037542, "mean_inference_ms": 5.26378379662778, "mean_action_processing_ms": 0.14907995698169413, "mean_env_wait_ms": 0.2622693242695668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014858245849609375, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.06035184860229492}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -72699.75502871753, "episode_reward_mean": -39104.718318995125, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56576.7129336526, -72699.75502871753, -55737.688815265145, -66694.59996050326, -67342.22248577922, -38711.75745563855, -57825.075719529224, -59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1700043664037542, "mean_inference_ms": 5.26378379662778, "mean_action_processing_ms": 0.14907995698169413, "mean_env_wait_ms": 0.2622693242695668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014858245849609375, "StateBufferConnector_ms": 0.0022916793823242188, "ViewRequirementAgentConnector_ms": 0.06035184860229492}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040, "num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5040, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5040, "timers": {"training_iteration_time_ms": 1971.73, "learn_time_ms": 18.938, "learn_throughput": 17742.336, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 5040, "num_env_steps_trained": 5040, "num_agent_steps_sampled": 5040, "num_agent_steps_trained": 5040}, "done": false, "episodes_total": 105, "training_iteration": 15, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-43", "timestamp": 1711723963, "time_this_iter_s": 1.9916534423828125, "time_total_s": 29.711246967315674, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1600>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4afac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 29.711246967315674, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.933333333333333, "ram_util_percent": 11.199999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -137071232.0, "policy_entropy": -3499.81640625, "var_gnorm": 22.682268142700195, "vf_loss": 43435511808.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.001211404800415039, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 16, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -59561.91360545996, "episode_reward_mean": -37190.42868788837, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1694572159550522, "mean_inference_ms": 5.257505382837199, "mean_action_processing_ms": 0.14867951681409936, "mean_env_wait_ms": 0.26147617524489764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01474905014038086, "StateBufferConnector_ms": 0.002274036407470703, "ViewRequirementAgentConnector_ms": 0.060224056243896484}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -59561.91360545996, "episode_reward_mean": -37190.42868788837, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59561.91360545996, -57096.99169845237, -49246.88735301949, -57875.780115010835, -46223.159694632035, -48836.36261622294, -52215.87638038962, -42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1694572159550522, "mean_inference_ms": 5.257505382837199, "mean_action_processing_ms": 0.14867951681409936, "mean_env_wait_ms": 0.26147617524489764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01474905014038086, "StateBufferConnector_ms": 0.002274036407470703, "ViewRequirementAgentConnector_ms": 0.060224056243896484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376, "num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5376, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5376, "timers": {"training_iteration_time_ms": 1971.057, "learn_time_ms": 18.91, "learn_throughput": 17768.643, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 5376, "num_env_steps_trained": 5376, "num_agent_steps_sampled": 5376, "num_agent_steps_trained": 5376}, "done": false, "episodes_total": 112, "training_iteration": 16, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-45", "timestamp": 1711723965, "time_this_iter_s": 1.9725537300109863, "time_total_s": 31.68380069732666, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a2260>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc3597e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 31.68380069732666, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 11.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -648812672.0, "policy_entropy": -4041.013916015625, "var_gnorm": 22.6871395111084, "vf_loss": 48924303360.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0011556148529052734, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 17, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -59181.818720113646, "episode_reward_mean": -35895.35362986104, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16901720703174064, "mean_inference_ms": 5.2525650969591595, "mean_action_processing_ms": 0.14834145832154935, "mean_env_wait_ms": 0.2607741546451205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014671087265014648, "StateBufferConnector_ms": 0.00225067138671875, "ViewRequirementAgentConnector_ms": 0.060172319412231445}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -59181.818720113646, "episode_reward_mean": -35895.35362986104, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42399.825779572515, -40616.5340483117, -33355.37795701299, -46204.50692169914, -52002.74551109305, -33944.92477422078, -59181.818720113646, -36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16901720703174064, "mean_inference_ms": 5.2525650969591595, "mean_action_processing_ms": 0.14834145832154935, "mean_env_wait_ms": 0.2607741546451205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014671087265014648, "StateBufferConnector_ms": 0.00225067138671875, "ViewRequirementAgentConnector_ms": 0.060172319412231445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712, "num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 5712, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 5712, "timers": {"training_iteration_time_ms": 1970.978, "learn_time_ms": 18.891, "learn_throughput": 17786.224, "synch_weights_time_ms": 0.144}, "counters": {"num_env_steps_sampled": 5712, "num_env_steps_trained": 5712, "num_agent_steps_sampled": 5712, "num_agent_steps_trained": 5712}, "done": false, "episodes_total": 119, "training_iteration": 17, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-47", "timestamp": 1711723967, "time_this_iter_s": 1.9643747806549072, "time_total_s": 33.64817547798157, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69d90160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4aecb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 33.64817547798157, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.666666666666667, "ram_util_percent": 11.366666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -7142223360.0, "policy_entropy": -4684.09375, "var_gnorm": 22.69316864013672, "vf_loss": 49872261120.0}, "grad_gnorm": 40.000003814697266, "vf_explained_var": -0.0012496709823608398, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 18, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -55138.2375672998, "episode_reward_mean": -35188.97335051688, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1687459717758174, "mean_inference_ms": 5.249297717032529, "mean_action_processing_ms": 0.14811299253094026, "mean_env_wait_ms": 0.26028021795654616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014688491821289062, "StateBufferConnector_ms": 0.0022482872009277344, "ViewRequirementAgentConnector_ms": 0.06023454666137695}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -55138.2375672998, "episode_reward_mean": -35188.97335051688, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-36922.24749385281, -51138.32928142316, -54109.67061920455, -55138.2375672998, -31043.667134209954, -42122.91554765693, -43096.51605845778, -42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1687459717758174, "mean_inference_ms": 5.249297717032529, "mean_action_processing_ms": 0.14811299253094026, "mean_env_wait_ms": 0.26028021795654616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014688491821289062, "StateBufferConnector_ms": 0.0022482872009277344, "ViewRequirementAgentConnector_ms": 0.06023454666137695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048, "num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6048, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6048, "timers": {"training_iteration_time_ms": 1969.077, "learn_time_ms": 18.866, "learn_throughput": 17810.051, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 6048, "num_env_steps_trained": 6048, "num_agent_steps_sampled": 6048, "num_agent_steps_trained": 6048}, "done": false, "episodes_total": 126, "training_iteration": 18, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-49", "timestamp": 1711723969, "time_this_iter_s": 1.9633655548095703, "time_total_s": 35.61154103279114, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a18d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc359b40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 35.61154103279114, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.7, "ram_util_percent": 11.433333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -30466736128.0, "policy_entropy": -5400.81005859375, "var_gnorm": 22.700300216674805, "vf_loss": 42618478592.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0013720989227294922, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 19, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -34247.93318772268, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16857432822362323, "mean_inference_ms": 5.2468388624315025, "mean_action_processing_ms": 0.1479522083643934, "mean_env_wait_ms": 0.2599194517890402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014707565307617188, "StateBufferConnector_ms": 0.002250194549560547, "ViewRequirementAgentConnector_ms": 0.06029534339904785}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -34247.93318772268, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42207.945810000005, -43185.76180524893, -27523.99517032468, -29803.147073149365, -29732.43094219156, -49365.94172953464, -32564.51994559524, -28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16857432822362323, "mean_inference_ms": 5.2468388624315025, "mean_action_processing_ms": 0.1479522083643934, "mean_env_wait_ms": 0.2599194517890402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014707565307617188, "StateBufferConnector_ms": 0.002250194549560547, "ViewRequirementAgentConnector_ms": 0.06029534339904785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384, "num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6384, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6384, "timers": {"training_iteration_time_ms": 1968.669, "learn_time_ms": 18.876, "learn_throughput": 17800.243, "synch_weights_time_ms": 0.145}, "counters": {"num_env_steps_sampled": 6384, "num_env_steps_trained": 6384, "num_agent_steps_sampled": 6384, "num_agent_steps_trained": 6384}, "done": false, "episodes_total": 133, "training_iteration": 19, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-51", "timestamp": 1711723971, "time_this_iter_s": 1.9658324718475342, "time_total_s": 37.57737350463867, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc531840>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc359fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 37.57737350463867, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 11.533333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -608816201728.0, "policy_entropy": -6157.2890625, "var_gnorm": 22.708332061767578, "vf_loss": 40761786368.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0014554262161254883, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 20, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33915.50439795222, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16845445954390162, "mean_inference_ms": 5.244795593296475, "mean_action_processing_ms": 0.14782783005650404, "mean_env_wait_ms": 0.2596462762426781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014757394790649414, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.06038475036621094}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33915.50439795222, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28858.2031980249, -32553.356294870133, -31194.250372229442, -35587.046538993505, -39948.897994945895, -36553.07067878788, -33454.60278955626, -30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16845445954390162, "mean_inference_ms": 5.244795593296475, "mean_action_processing_ms": 0.14782783005650404, "mean_env_wait_ms": 0.2596462762426781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014757394790649414, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.06038475036621094}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720, "num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 6720, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 6720, "timers": {"training_iteration_time_ms": 1971.349, "learn_time_ms": 18.902, "learn_throughput": 17776.263, "synch_weights_time_ms": 0.143}, "counters": {"num_env_steps_sampled": 6720, "num_env_steps_trained": 6720, "num_agent_steps_sampled": 6720, "num_agent_steps_trained": 6720}, "done": false, "episodes_total": 140, "training_iteration": 20, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-53", "timestamp": 1711723973, "time_this_iter_s": 1.9836595058441162, "time_total_s": 39.56103301048279, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a1cf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc35a680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 39.56103301048279, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 11.633333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -3950398668800.0, "policy_entropy": -6849.89111328125, "var_gnorm": 22.714611053466797, "vf_loss": 42128609280.0}, "grad_gnorm": 40.0, "vf_explained_var": -0.0016628503799438477, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 21, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33779.819752231546, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1683523178872941, "mean_inference_ms": 5.243275450453763, "mean_action_processing_ms": 0.1477247586080226, "mean_env_wait_ms": 0.25943168749575324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014729738235473633, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.060362815856933594}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33779.819752231546, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30931.450548143934, -30161.862319096323, -38079.24249481061, -30795.879708143937, -31482.32390801407, -31332.486570773795, -40623.55872921537, -35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1683523178872941, "mean_inference_ms": 5.243275450453763, "mean_action_processing_ms": 0.1477247586080226, "mean_env_wait_ms": 0.25943168749575324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014729738235473633, "StateBufferConnector_ms": 0.002251863479614258, "ViewRequirementAgentConnector_ms": 0.060362815856933594}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056, "num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7056, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7056, "timers": {"training_iteration_time_ms": 1972.973, "learn_time_ms": 18.862, "learn_throughput": 17813.225, "synch_weights_time_ms": 0.142}, "counters": {"num_env_steps_sampled": 7056, "num_env_steps_trained": 7056, "num_agent_steps_sampled": 7056, "num_agent_steps_trained": 7056}, "done": false, "episodes_total": 147, "training_iteration": 21, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-55", "timestamp": 1711723975, "time_this_iter_s": 1.979137897491455, "time_total_s": 41.54017090797424, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69fdb6a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc35a0e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 41.54017090797424, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.75, "ram_util_percent": 11.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -43799271178240.0, "policy_entropy": -7622.5322265625, "var_gnorm": 22.722043991088867, "vf_loss": 41178574848.0}, "grad_gnorm": 39.999996185302734, "vf_explained_var": -0.0017393827438354492, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 22, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33625.480018446164, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1682682825915319, "mean_inference_ms": 5.242026627436334, "mean_action_processing_ms": 0.1476410742450764, "mean_env_wait_ms": 0.2592757993260635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014678955078125, "StateBufferConnector_ms": 0.002248525619506836, "ViewRequirementAgentConnector_ms": 0.06033778190612793}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -33625.480018446164, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35291.42855042748, -37058.34459096862, -46631.79706073051, -42719.74902705627, -42640.47002287337, -42998.68047660716, -42262.1294362933, -48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1682682825915319, "mean_inference_ms": 5.242026627436334, "mean_action_processing_ms": 0.1476410742450764, "mean_env_wait_ms": 0.2592757993260635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014678955078125, "StateBufferConnector_ms": 0.002248525619506836, "ViewRequirementAgentConnector_ms": 0.06033778190612793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392, "num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7392, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7392, "timers": {"training_iteration_time_ms": 1976.134, "learn_time_ms": 18.901, "learn_throughput": 17776.465, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 7392, "num_env_steps_trained": 7392, "num_agent_steps_sampled": 7392, "num_agent_steps_trained": 7392}, "done": false, "episodes_total": 154, "training_iteration": 22, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-57", "timestamp": 1711723977, "time_this_iter_s": 1.9904568195343018, "time_total_s": 43.530627727508545, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a24a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc35b0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 43.530627727508545, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 6.233333333333334, "ram_util_percent": 11.800000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -358915854303232.0, "policy_entropy": -8194.1669921875, "var_gnorm": 22.727075576782227, "vf_loss": 43507822592.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0018790960311889648, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 23, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -32966.588638055575, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16820085918698802, "mean_inference_ms": 5.240853067247156, "mean_action_processing_ms": 0.14756854037713085, "mean_env_wait_ms": 0.2591473293272301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014693498611450195, "StateBufferConnector_ms": 0.0022499561309814453, "ViewRequirementAgentConnector_ms": 0.060302019119262695}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -51333.11246976734, "episode_reward_mean": -32966.588638055575, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48521.39318199675, -33894.21548518397, -34069.221120719696, -51333.11246976734, -34122.59858062229, -33328.887762884195, -31946.229725773806, -41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16820085918698802, "mean_inference_ms": 5.240853067247156, "mean_action_processing_ms": 0.14756854037713085, "mean_env_wait_ms": 0.2591473293272301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014693498611450195, "StateBufferConnector_ms": 0.0022499561309814453, "ViewRequirementAgentConnector_ms": 0.060302019119262695}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728, "num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 7728, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 7728, "timers": {"training_iteration_time_ms": 1975.581, "learn_time_ms": 18.752, "learn_throughput": 17918.223, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 7728, "num_env_steps_trained": 7728, "num_agent_steps_sampled": 7728, "num_agent_steps_trained": 7728}, "done": false, "episodes_total": 161, "training_iteration": 23, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-52-59", "timestamp": 1711723979, "time_this_iter_s": 1.9637365341186523, "time_total_s": 45.4943642616272, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a3cd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4aff40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 45.4943642616272, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 6.0, "ram_util_percent": 11.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1202902362226688.0, "policy_entropy": -8726.05859375, "var_gnorm": 22.731830596923828, "vf_loss": 42175459328.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0018990039825439453, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 24, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -32565.0590557322, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681531366306649, "mean_inference_ms": 5.240070294092199, "mean_action_processing_ms": 0.1475119391442512, "mean_env_wait_ms": 0.25904835454081343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014750957489013672, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.060376644134521484}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -32565.0590557322, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41635.725111287866, -27706.50244109308, -31913.91545554113, -38883.3278566775, -38203.89331449675, -39925.402721580074, -41286.51714498917, -29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681531366306649, "mean_inference_ms": 5.240070294092199, "mean_action_processing_ms": 0.1475119391442512, "mean_env_wait_ms": 0.25904835454081343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014750957489013672, "StateBufferConnector_ms": 0.0022530555725097656, "ViewRequirementAgentConnector_ms": 0.060376644134521484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064, "num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8064, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8064, "timers": {"training_iteration_time_ms": 1974.517, "learn_time_ms": 18.828, "learn_throughput": 17845.978, "synch_weights_time_ms": 0.146}, "counters": {"num_env_steps_sampled": 8064, "num_env_steps_trained": 8064, "num_agent_steps_sampled": 8064, "num_agent_steps_trained": 8064}, "done": false, "episodes_total": 168, "training_iteration": 24, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-01", "timestamp": 1711723981, "time_this_iter_s": 1.9750890731811523, "time_total_s": 47.46945333480835, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a0820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc359870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 47.46945333480835, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 11.966666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -4633482659627008.0, "policy_entropy": -9216.5048828125, "var_gnorm": 22.736305236816406, "vf_loss": 39454273536.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.002097487449645996, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 25, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -32126.472178298867, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16812501846467673, "mean_inference_ms": 5.239560041911004, "mean_action_processing_ms": 0.14747080291498724, "mean_env_wait_ms": 0.25897998045085235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014805316925048828, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.060384511947631836}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -32126.472178298867, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29983.13240557901, -39041.648614182894, -29054.101699475108, -26406.76000880952, -34764.15376811687, -32259.34365312229, -33409.38761286796, -32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16812501846467673, "mean_inference_ms": 5.239560041911004, "mean_action_processing_ms": 0.14747080291498724, "mean_env_wait_ms": 0.25897998045085235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014805316925048828, "StateBufferConnector_ms": 0.0022573471069335938, "ViewRequirementAgentConnector_ms": 0.060384511947631836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8400, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 1972.343, "learn_time_ms": 18.831, "learn_throughput": 17843.131, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8400, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 8400}, "done": false, "episodes_total": 175, "training_iteration": 25, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-03", "timestamp": 1711723983, "time_this_iter_s": 1.9699318408966064, "time_total_s": 49.439385175704956, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a30a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4af1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 49.439385175704956, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.733333333333333, "ram_util_percent": 12.066666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.9743335447003136e+16, "policy_entropy": -9674.0302734375, "var_gnorm": 22.740501403808594, "vf_loss": 37048586240.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0022127628326416016, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 26, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31979.305728494208, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681384842406291, "mean_inference_ms": 5.239369213905092, "mean_action_processing_ms": 0.14744720196634203, "mean_env_wait_ms": 0.2589414627129822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014903545379638672, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.060480594635009766}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31979.305728494208, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-32283.548170303027, -29600.50809324134, -31382.570807629876, -31334.177969053027, -33345.715141488094, -36743.373675416675, -34159.182361017316, -29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681384842406291, "mean_inference_ms": 5.239369213905092, "mean_action_processing_ms": 0.14744720196634203, "mean_env_wait_ms": 0.2589414627129822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014903545379638672, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.060480594635009766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736, "num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 8736, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 8736, "timers": {"training_iteration_time_ms": 1973.58, "learn_time_ms": 18.803, "learn_throughput": 17869.806, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 8736, "num_env_steps_trained": 8736, "num_agent_steps_sampled": 8736, "num_agent_steps_trained": 8736}, "done": false, "episodes_total": 182, "training_iteration": 26, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-05", "timestamp": 1711723985, "time_this_iter_s": 1.9849345684051514, "time_total_s": 51.42431974411011, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a2440>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc359a20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 51.42431974411011, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.833333333333333, "ram_util_percent": 12.166666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.6678349288819917e+17, "policy_entropy": -10100.6513671875, "var_gnorm": 22.74442481994629, "vf_loss": 43449819136.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0020809173583984375, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 27, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "sampler_results": {"episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31984.9178635855, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681704291208149, "mean_inference_ms": 5.239459644630665, "mean_action_processing_ms": 0.1474401994803135, "mean_env_wait_ms": 0.2589207295183765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014995574951171875, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.060594797134399414}}, "episode_reward_max": -25665.48483511904, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31984.9178635855, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29568.727131260817, -34681.97980965369, -35342.040256774904, -31227.77953271104, -34344.35802546535, -30893.04001974567, -36710.93121435606, -34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1681704291208149, "mean_inference_ms": 5.239459644630665, "mean_action_processing_ms": 0.1474401994803135, "mean_env_wait_ms": 0.2589207295183765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014995574951171875, "StateBufferConnector_ms": 0.0022635459899902344, "ViewRequirementAgentConnector_ms": 0.060594797134399414}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072, "num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9072, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9072, "timers": {"training_iteration_time_ms": 1977.621, "learn_time_ms": 19.902, "learn_throughput": 16882.895, "synch_weights_time_ms": 0.147}, "counters": {"num_env_steps_sampled": 9072, "num_env_steps_trained": 9072, "num_agent_steps_sampled": 9072, "num_agent_steps_trained": 9072}, "done": false, "episodes_total": 189, "training_iteration": 27, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-07", "timestamp": 1711723987, "time_this_iter_s": 2.0048136711120605, "time_total_s": 53.42913341522217, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x775f69fdbd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc4afeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 53.42913341522217, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.6000000000000005, "ram_util_percent": 12.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.1012458324909097e+18, "policy_entropy": -10488.083984375, "var_gnorm": 22.74808120727539, "vf_loss": 41266237440.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0023005008697509766, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 28, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "sampler_results": {"episode_reward_max": -25519.862992938317, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31836.478246760933, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783, -32201.125549550863, -30464.763698603896, -31198.955350892855, -31870.85680508117, -25519.862992938317, -30540.201711829002, -36129.12819861473], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16819125513652136, "mean_inference_ms": 5.239434932508858, "mean_action_processing_ms": 0.14743027568925282, "mean_env_wait_ms": 0.25889842429989884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014935016632080078, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06055283546447754}}, "episode_reward_max": -25519.862992938317, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31836.478246760933, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34257.02051790584, -26487.072495405842, -25665.48483511904, -31504.26125857143, -30109.20470198593, -30605.55379915043, -28256.20205922619, -30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783, -32201.125549550863, -30464.763698603896, -31198.955350892855, -31870.85680508117, -25519.862992938317, -30540.201711829002, -36129.12819861473], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16819125513652136, "mean_inference_ms": 5.239434932508858, "mean_action_processing_ms": 0.14743027568925282, "mean_env_wait_ms": 0.25889842429989884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014935016632080078, "StateBufferConnector_ms": 0.0022678375244140625, "ViewRequirementAgentConnector_ms": 0.06055283546447754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408, "num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9408, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9408, "timers": {"training_iteration_time_ms": 1978.028, "learn_time_ms": 19.917, "learn_throughput": 16869.839, "synch_weights_time_ms": 0.149}, "counters": {"num_env_steps_sampled": 9408, "num_env_steps_trained": 9408, "num_agent_steps_sampled": 9408, "num_agent_steps_trained": 9408}, "done": false, "episodes_total": 196, "training_iteration": 28, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-09", "timestamp": 1711723989, "time_this_iter_s": 1.9674410820007324, "time_total_s": 55.3965744972229, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a2260>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc359900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 55.3965744972229, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.800000000000001, "ram_util_percent": 12.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_lr": 0.0010000000474974513, "entropy_coeff": 0.009999999776482582, "policy_loss": -1.913494379469734e+18, "policy_entropy": -10853.8828125, "var_gnorm": 22.751482009887695, "vf_loss": 39730487296.0}, "grad_gnorm": 0.0, "vf_explained_var": -0.0022760629653930664, "custom_metrics": {}, "num_agent_steps_trained": 336, "num_grad_updates_lifetime": 29, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "sampler_results": {"episode_reward_max": -25519.862992938317, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31949.27685673561, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783, -32201.125549550863, -30464.763698603896, -31198.955350892855, -31870.85680508117, -25519.862992938317, -30540.201711829002, -36129.12819861473, -32122.776075865808, -32508.43693473486, -27562.907711883116, -26955.733859431813, -29081.903664009733, -37701.94067469155, -32230.96174421537], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16820744655774214, "mean_inference_ms": 5.239262018159535, "mean_action_processing_ms": 0.14741674230473603, "mean_env_wait_ms": 0.25886059994188615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01496577262878418, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.06055092811584473}}, "episode_reward_max": -25519.862992938317, "episode_reward_min": -41779.855546336585, "episode_reward_mean": -31949.27685673561, "episode_len_mean": 48.0, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30881.562977489186, -35933.39184876624, -31405.283896688314, -33494.580810286796, -31993.013483771647, -31470.71687906927, -32990.07813728356, -31943.349387716444, -30861.82669359308, -34073.78904520022, -34481.01350345237, -36869.87861127164, -34745.675351953476, -34152.1016357197, -33697.26035573052, -33529.747157126614, -34396.07203209416, -34591.91837515152, -35800.274673950225, -31821.058986509735, -31370.186336212126, -34175.75171939395, -34912.44365429654, -35147.06599889069, -29679.518210027058, -34855.63909436687, -32555.839603008662, -26340.061893728358, -30072.967919237013, -30816.47470342533, -30796.715670735943, -41779.855546336585, -27022.214380270572, -31444.97039347402, -32069.21213237013, -28950.853817353895, -29077.0415584578, -35024.68293833874, -31692.628616406924, -33199.10674260281, -29276.45492527056, -32033.35946380952, -31590.098542889613, -31764.63206602273, -33749.754532132036, -30588.840200854975, -27853.70126430195, -34997.930949832255, -27810.408987283547, -30157.454770871216, -32814.74019438311, -30281.0596248539, -29702.68425339286, -32527.707037959965, -37845.64341361472, -32706.57632152057, -31551.084816774885, -29098.705657781386, -29231.08161204546, -35975.95809928571, -30896.633195925333, -30233.795076271643, -34248.04493938312, -36155.6367536526, -30321.55041804654, -30137.10332536255, -32695.434933116867, -28144.1222561526, -33494.286385681815, -27387.178169653675, -31832.918990010832, -32005.55224235389, -30845.488440059526, -31761.04501535714, -33546.891762104984, -28757.1210024026, -29331.220636352813, -28341.847419377707, -27618.26850603355, -36062.01831798701, -32836.259834891775, -33428.887327840916, -32457.01440455628, -30463.10707860391, -28910.696227900433, -35252.30653549783, -32201.125549550863, -30464.763698603896, -31198.955350892855, -31870.85680508117, -25519.862992938317, -30540.201711829002, -36129.12819861473, -32122.776075865808, -32508.43693473486, -27562.907711883116, -26955.733859431813, -29081.903664009733, -37701.94067469155, -32230.96174421537], "episode_lengths": [48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16820744655774214, "mean_inference_ms": 5.239262018159535, "mean_action_processing_ms": 0.14741674230473603, "mean_env_wait_ms": 0.25886059994188615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01496577262878418, "StateBufferConnector_ms": 0.0022673606872558594, "ViewRequirementAgentConnector_ms": 0.06055092811584473}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744, "num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_env_steps_sampled_this_iter": 336, "num_env_steps_trained_this_iter": 336, "timesteps_total": 9744, "num_steps_trained_this_iter": 336, "agent_timesteps_total": 9744, "timers": {"training_iteration_time_ms": 1979.315, "learn_time_ms": 19.914, "learn_throughput": 16872.142, "synch_weights_time_ms": 0.148}, "counters": {"num_env_steps_sampled": 9744, "num_env_steps_trained": 9744, "num_agent_steps_sampled": 9744, "num_agent_steps_trained": 9744}, "done": true, "episodes_total": 203, "training_iteration": 29, "trial_id": "ea6f7_00000", "experiment_id": "7172e80198a5407f825516472b925a7c", "date": "2024-03-29_14-53-11", "timestamp": 1711723991, "time_this_iter_s": 1.9786911010742188, "time_total_s": 57.37526559829712, "pid": 155475, "hostname": "mmlabaimensgpuserver", "node_ip": "195.251.234.24", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 1, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "SmartHomeGymEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 300, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 300, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "swish", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "swish", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7760bc4a0940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": true, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7760bc3a0430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class '__main__.MyCallbackRL'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf2", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 57.37526559829712, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 2.955839157104492, "perf": {"cpu_util_percent": 5.633333333333333, "ram_util_percent": 12.4}}
